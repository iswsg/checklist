var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var n={exports:{}},r={},i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var u=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var n,r,u=s(e),l=1;l<arguments.length;l++){for(var c in n=Object(arguments[l]))a.call(n,c)&&(u[c]=n[c]);if(i){r=i(n);for(var f=0;f<r.length;f++)o.call(n,r[f])&&(u[r[f]]=n[r[f]])}}return u},l=u,c=60103,f=60106;
/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */r.Fragment=60107,r.StrictMode=60108,r.Profiler=60114;var p=60109,h=60110,d=60112;r.Suspense=60113;var v=60115,m=60116;if("function"==typeof Symbol&&Symbol.for){var y=Symbol.for;c=y("react.element"),f=y("react.portal"),r.Fragment=y("react.fragment"),r.StrictMode=y("react.strict_mode"),r.Profiler=y("react.profiler"),p=y("react.provider"),h=y("react.context"),d=y("react.forward_ref"),r.Suspense=y("react.suspense"),v=y("react.memo"),m=y("react.lazy")}var g="function"==typeof Symbol&&Symbol.iterator;function _(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E={};function x(e,t,n){this.props=e,this.context=t,this.refs=E,this.updater=n||b}function S(){}function T(e,t,n){this.props=e,this.context=t,this.refs=E,this.updater=n||b}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(_(85));this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},S.prototype=x.prototype;var A=T.prototype=new S;A.constructor=T,l(A,x.prototype),A.isPureReactComponent=!0;var w={current:null},C=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,n){var r,i={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,r)&&!k.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return{$$typeof:c,type:e,key:a,ref:o,props:i,_owner:w.current}}function M(e){return"object"==typeof e&&null!==e&&e.$$typeof===c}var R=/\/+/g;function P(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,n,r,i){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var o=!1;if(null===e)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case c:case f:o=!0}}if(o)return i=i(o=e),e=""===r?"."+P(o,0):r,Array.isArray(i)?(n="",null!=e&&(n=e.replace(R,"$&/")+"/"),I(i,t,n,"",(function(e){return e}))):null!=i&&(M(i)&&(i=function(e,t){return{$$typeof:c,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(R,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=""===r?".":r+":",Array.isArray(e))for(var s=0;s<e.length;s++){var u=r+P(a=e[s],s);o+=I(a,t,n,u,i)}else if("function"==typeof(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=g&&e[g]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),s=0;!(a=e.next()).done;)o+=I(a=a.value,t,n,u=r+P(a,s++),i);else if("object"===a)throw t=""+e,Error(_(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return o}function L(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function N(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var D={current:null};function F(){var e=D.current;if(null===e)throw Error(_(321));return e}var j={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:l};r.Children={map:L,forEach:function(e,t,n){L(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return L(e,(function(){t++})),t},toArray:function(e){return L(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error(_(143));return e}},r.Component=x,r.PureComponent=T,r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,r.cloneElement=function(e,t,n){if(null==e)throw Error(_(267,e));var r=l({},e.props),i=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=w.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)C.call(t,u)&&!k.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==s?s[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){s=Array(u);for(var f=0;f<u;f++)s[f]=arguments[f+2];r.children=s}return{$$typeof:c,type:e.type,key:i,ref:a,props:r,_owner:o}},r.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:h,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:p,_context:e},e.Consumer=e},r.createElement=O,r.createFactory=function(e){var t=O.bind(null,e);return t.type=e,t},r.createRef=function(){return{current:null}},r.forwardRef=function(e){return{$$typeof:d,render:e}},r.isValidElement=M,r.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:N}},r.memo=function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},r.useCallback=function(e,t){return F().useCallback(e,t)},r.useContext=function(e,t){return F().useContext(e,t)},r.useDebugValue=function(){},r.useEffect=function(e,t){return F().useEffect(e,t)},r.useImperativeHandle=function(e,t,n){return F().useImperativeHandle(e,t,n)},r.useLayoutEffect=function(e,t){return F().useLayoutEffect(e,t)},r.useMemo=function(e,t){return F().useMemo(e,t)},r.useReducer=function(e,t,n){return F().useReducer(e,t,n)},r.useRef=function(e){return F().useRef(e)},r.useState=function(e){return F().useState(e)},r.version="17.0.2",n.exports=r;var U=n.exports,B={exports:{}},z={},V={exports:{}},H={};
/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(e){var t,n,r,i;if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var u=null,l=null,c=function(){if(null!==u)try{var t=e.unstable_now();u(!0,t),u=null}catch(n){throw setTimeout(c,0),n}};t=function(e){null!==u?setTimeout(t,0,e):(u=e,setTimeout(c,0))},n=function(e,t){l=setTimeout(e,t)},r=function(){clearTimeout(l)},e.unstable_shouldYield=function(){return!1},i=e.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var h=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var d=!1,v=null,m=-1,y=5,g=0;e.unstable_shouldYield=function(){return e.unstable_now()>=g},i=function(){},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<e?Math.floor(1e3/e):5};var _=new MessageChannel,b=_.port2;_.port1.onmessage=function(){if(null!==v){var t=e.unstable_now();g=t+y;try{v(!0,t)?b.postMessage(null):(d=!1,v=null)}catch(n){throw b.postMessage(null),n}}else d=!1},t=function(e){v=e,d||(d=!0,b.postMessage(null))},n=function(t,n){m=f((function(){t(e.unstable_now())}),n)},r=function(){p(m),m=-1}}function E(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<T(i,t)))break e;e[r]=t,e[n]=i,n=r}}function x(e){return void 0===(e=e[0])?null:e}function S(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var a=2*(r+1)-1,o=e[a],s=a+1,u=e[s];if(void 0!==o&&0>T(o,n))void 0!==u&&0>T(u,o)?(e[r]=u,e[s]=n,r=s):(e[r]=o,e[a]=n,r=a);else{if(!(void 0!==u&&0>T(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function T(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var A=[],w=[],C=1,k=null,O=3,M=!1,R=!1,P=!1;function I(e){for(var t=x(w);null!==t;){if(null===t.callback)S(w);else{if(!(t.startTime<=e))break;S(w),t.sortIndex=t.expirationTime,E(A,t)}t=x(w)}}function L(e){if(P=!1,I(e),!R)if(null!==x(A))R=!0,t(N);else{var r=x(w);null!==r&&n(L,r.startTime-e)}}function N(t,i){R=!1,P&&(P=!1,r()),M=!0;var a=O;try{for(I(i),k=x(A);null!==k&&(!(k.expirationTime>i)||t&&!e.unstable_shouldYield());){var o=k.callback;if("function"==typeof o){k.callback=null,O=k.priorityLevel;var s=o(k.expirationTime<=i);i=e.unstable_now(),"function"==typeof s?k.callback=s:k===x(A)&&S(A),I(i)}else S(A);k=x(A)}if(null!==k)var u=!0;else{var l=x(w);null!==l&&n(L,l.startTime-i),u=!1}return u}finally{k=null,O=a,M=!1}}var D=i;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){R||M||(R=!0,t(N))},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return x(A)},e.unstable_next=function(e){switch(O){case 1:case 2:case 3:var t=3;break;default:t=O}var n=O;O=t;try{return e()}finally{O=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=D,e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=O;O=e;try{return t()}finally{O=n}},e.unstable_scheduleCallback=function(i,a,o){var s=e.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?s+o:s:o=s,i){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return i={id:C++,callback:a,priorityLevel:i,startTime:o,expirationTime:u=o+u,sortIndex:-1},o>s?(i.sortIndex=o,E(w,i),null===x(A)&&i===x(w)&&(P?r():P=!0,n(L,o-s))):(i.sortIndex=u,E(A,i),R||M||(R=!0,t(N))),i},e.unstable_wrapCallback=function(e){var t=O;return function(){var n=O;O=t;try{return e.apply(this,arguments)}finally{O=n}}}}(H),V.exports=H;
/** @license React v17.0.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var G=n.exports,W=u,X=V.exports;function Y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!G)throw Error(Y(227));var q=new Set,Z={};function K(e,t){Q(e,t),Q(e+"Capture",t)}function Q(e,t){for(Z[e]=t,e=0;e<t.length;e++)q.add(t[e])}var J=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ee=Object.prototype.hasOwnProperty,te={},ne={};function re(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var ie={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){ie[e]=new re(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];ie[t]=new re(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){ie[e]=new re(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){ie[e]=new re(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){ie[e]=new re(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){ie[e]=new re(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){ie[e]=new re(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){ie[e]=new re(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){ie[e]=new re(e,5,!1,e.toLowerCase(),null,!1,!1)}));var ae=/[\-:]([a-z])/g;function oe(e){return e[1].toUpperCase()}function se(e,t,n,r){var i=ie.hasOwnProperty(t)?ie[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!ee.call(ne,e)||!ee.call(te,e)&&($.test(e)?ne[e]=!0:(te[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(ae,oe);ie[t]=new re(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(ae,oe);ie[t]=new re(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(ae,oe);ie[t]=new re(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){ie[e]=new re(e,1,!1,e.toLowerCase(),null,!1,!1)})),ie.xlinkHref=new re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){ie[e]=new re(e,1,!1,e.toLowerCase(),null,!0,!0)}));var ue=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,le=60103,ce=60106,fe=60107,pe=60108,he=60114,de=60109,ve=60110,me=60112,ye=60113,ge=60120,_e=60115,be=60116,Ee=60121,xe=60128,Se=60129,Te=60130,Ae=60131;if("function"==typeof Symbol&&Symbol.for){var we=Symbol.for;le=we("react.element"),ce=we("react.portal"),fe=we("react.fragment"),pe=we("react.strict_mode"),he=we("react.profiler"),de=we("react.provider"),ve=we("react.context"),me=we("react.forward_ref"),ye=we("react.suspense"),ge=we("react.suspense_list"),_e=we("react.memo"),be=we("react.lazy"),Ee=we("react.block"),we("react.scope"),xe=we("react.opaque.id"),Se=we("react.debug_trace_mode"),Te=we("react.offscreen"),Ae=we("react.legacy_hidden")}var Ce,ke="function"==typeof Symbol&&Symbol.iterator;function Oe(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=ke&&e[ke]||e["@@iterator"])?e:null}function Me(e){if(void 0===Ce)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ce=t&&t[1]||""}return"\n"+Ce+e}var Re=!1;function Pe(e,t){if(!e||Re)return"";Re=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"==typeof u.stack){for(var i=u.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s])return"\n"+i[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{Re=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Me(e):""}function Ie(e){switch(e.tag){case 5:return Me(e.type);case 16:return Me("Lazy");case 13:return Me("Suspense");case 19:return Me("SuspenseList");case 0:case 2:case 15:return e=Pe(e.type,!1);case 11:return e=Pe(e.type.render,!1);case 22:return e=Pe(e.type._render,!1);case 1:return e=Pe(e.type,!0);default:return""}}function Le(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case fe:return"Fragment";case ce:return"Portal";case he:return"Profiler";case pe:return"StrictMode";case ye:return"Suspense";case ge:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case ve:return(e.displayName||"Context")+".Consumer";case de:return(e._context.displayName||"Context")+".Provider";case me:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case _e:return Le(e.type);case Ee:return Le(e._render);case be:t=e._payload,e=e._init;try{return Le(e(t))}catch(n){}}return null}function Ne(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function De(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Fe(e){e._valueTracker||(e._valueTracker=function(e){var t=De(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function je(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=De(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Ue(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Be(e,t){var n=t.checked;return W({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ze(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Ne(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Ve(e,t){null!=(t=t.checked)&&se(e,"checked",t,!1)}function He(e,t){Ve(e,t);var n=Ne(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?We(e,t.type,n):t.hasOwnProperty("defaultValue")&&We(e,t.type,Ne(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ge(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function We(e,t,n){"number"===t&&Ue(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Xe(e,t){return e=W({children:void 0},t),(t=function(e){var t="";return G.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Ye(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ne(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function qe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(Y(91));return W({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ze(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(Y(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(Y(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Ne(n)}}function Ke(e,t){var n=Ne(t.value),r=Ne(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Qe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Je="http://www.w3.org/1999/xhtml",$e="http://www.w3.org/2000/svg";function et(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tt(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?et(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var nt,rt,it=(rt=function(e,t){if(e.namespaceURI!==$e||"innerHTML"in e)e.innerHTML=t;else{for((nt=nt||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=nt.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return rt(e,t)}))}:rt);function at(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ot={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},st=["Webkit","ms","Moz","O"];function ut(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||ot.hasOwnProperty(e)&&ot[e]?(""+t).trim():t+"px"}function lt(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ut(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(ot).forEach((function(e){st.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ot[t]=ot[e]}))}));var ct=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ft(e,t){if(t){if(ct[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(Y(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(Y(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(Y(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(Y(62))}}function pt(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function ht(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var dt=null,vt=null,mt=null;function yt(e){if(e=zi(e)){if("function"!=typeof dt)throw Error(Y(280));var t=e.stateNode;t&&(t=Hi(t),dt(e.stateNode,e.type,t))}}function gt(e){vt?mt?mt.push(e):mt=[e]:vt=e}function _t(){if(vt){var e=vt,t=mt;if(mt=vt=null,yt(e),t)for(e=0;e<t.length;e++)yt(t[e])}}function bt(e,t){return e(t)}function Et(e,t,n,r,i){return e(t,n,r,i)}function xt(){}var St=bt,Tt=!1,At=!1;function wt(){null===vt&&null===mt||(xt(),_t())}function Ct(e,t){var n=e.stateNode;if(null===n)return null;var r=Hi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(Y(231,t,typeof n));return n}var kt=!1;if(J)try{var Ot={};Object.defineProperty(Ot,"passive",{get:function(){kt=!0}}),window.addEventListener("test",Ot,Ot),window.removeEventListener("test",Ot,Ot)}catch(rt){kt=!1}function Mt(e,t,n,r,i,a,o,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Rt=!1,Pt=null,It=!1,Lt=null,Nt={onError:function(e){Rt=!0,Pt=e}};function Dt(e,t,n,r,i,a,o,s,u){Rt=!1,Pt=null,Mt.apply(Nt,arguments)}function Ft(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function jt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ut(e){if(Ft(e)!==e)throw Error(Y(188))}function Bt(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ft(e)))throw Error(Y(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Ut(i),e;if(a===r)return Ut(i),t;a=a.sibling}throw Error(Y(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,s=i.child;s;){if(s===n){o=!0,n=i,r=a;break}if(s===r){o=!0,r=i,n=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===n){o=!0,n=a,r=i;break}if(s===r){o=!0,r=a,n=i;break}s=s.sibling}if(!o)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(3!==n.tag)throw Error(Y(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function zt(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var Vt,Ht,Gt,Wt,Xt=!1,Yt=[],qt=null,Zt=null,Kt=null,Qt=new Map,Jt=new Map,$t=[],en="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tn(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function nn(e,t){switch(e){case"focusin":case"focusout":qt=null;break;case"dragenter":case"dragleave":Zt=null;break;case"mouseover":case"mouseout":Kt=null;break;case"pointerover":case"pointerout":Qt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jt.delete(t.pointerId)}}function rn(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e=tn(t,n,r,i,a),null!==t&&(null!==(t=zi(t))&&Ht(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function an(e){var t=Bi(e.target);if(null!==t){var n=Ft(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=jt(n)))return e.blockedOn=t,void Wt(e.lanePriority,(function(){X.unstable_runWithPriority(e.priority,(function(){Gt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function on(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=zn(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=zi(n))&&Ht(t),e.blockedOn=n,!1;t.shift()}return!0}function sn(e,t,n){on(e)&&n.delete(t)}function un(){for(Xt=!1;0<Yt.length;){var e=Yt[0];if(null!==e.blockedOn){null!==(e=zi(e.blockedOn))&&Vt(e);break}for(var t=e.targetContainers;0<t.length;){var n=zn(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&Yt.shift()}null!==qt&&on(qt)&&(qt=null),null!==Zt&&on(Zt)&&(Zt=null),null!==Kt&&on(Kt)&&(Kt=null),Qt.forEach(sn),Jt.forEach(sn)}function ln(e,t){e.blockedOn===t&&(e.blockedOn=null,Xt||(Xt=!0,X.unstable_scheduleCallback(X.unstable_NormalPriority,un)))}function cn(e){function t(t){return ln(t,e)}if(0<Yt.length){ln(Yt[0],e);for(var n=1;n<Yt.length;n++){var r=Yt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==qt&&ln(qt,e),null!==Zt&&ln(Zt,e),null!==Kt&&ln(Kt,e),Qt.forEach(t),Jt.forEach(t),n=0;n<$t.length;n++)(r=$t[n]).blockedOn===e&&(r.blockedOn=null);for(;0<$t.length&&null===(n=$t[0]).blockedOn;)an(n),null===n.blockedOn&&$t.shift()}function fn(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var pn={animationend:fn("Animation","AnimationEnd"),animationiteration:fn("Animation","AnimationIteration"),animationstart:fn("Animation","AnimationStart"),transitionend:fn("Transition","TransitionEnd")},hn={},dn={};function vn(e){if(hn[e])return hn[e];if(!pn[e])return e;var t,n=pn[e];for(t in n)if(n.hasOwnProperty(t)&&t in dn)return hn[e]=n[t];return e}J&&(dn=document.createElement("div").style,"AnimationEvent"in window||(delete pn.animationend.animation,delete pn.animationiteration.animation,delete pn.animationstart.animation),"TransitionEvent"in window||delete pn.transitionend.transition);var mn=vn("animationend"),yn=vn("animationiteration"),gn=vn("animationstart"),_n=vn("transitionend"),bn=new Map,En=new Map,xn=["abort","abort",mn,"animationEnd",yn,"animationIteration",gn,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",_n,"transitionEnd","waiting","waiting"];function Sn(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),En.set(r,t),bn.set(r,i),K(i,[r])}}(0,X.unstable_now)();var Tn=8;function An(e){if(0!=(1&e))return Tn=15,1;if(0!=(2&e))return Tn=14,2;if(0!=(4&e))return Tn=13,4;var t=24&e;return 0!==t?(Tn=12,t):0!=(32&e)?(Tn=11,32):0!==(t=192&e)?(Tn=10,t):0!=(256&e)?(Tn=9,256):0!==(t=3584&e)?(Tn=8,t):0!=(4096&e)?(Tn=7,4096):0!==(t=4186112&e)?(Tn=6,t):0!==(t=62914560&e)?(Tn=5,t):67108864&e?(Tn=4,67108864):0!=(134217728&e)?(Tn=3,134217728):0!==(t=805306368&e)?(Tn=2,t):0!=(1073741824&e)?(Tn=1,1073741824):(Tn=8,e)}function wn(e,t){var n=e.pendingLanes;if(0===n)return Tn=0;var r=0,i=0,a=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==a)r=a,i=Tn=15;else if(0!==(a=134217727&n)){var u=a&~o;0!==u?(r=An(u),i=Tn):0!==(s&=a)&&(r=An(s),i=Tn)}else 0!==(a=n&~o)?(r=An(a),i=Tn):0!==s&&(r=An(s),i=Tn);if(0===r)return 0;if(r=n&((0>(r=31-Pn(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0==(t&o)){if(An(t),i<=Tn)return t;Tn=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-Pn(t)),r|=e[n],t&=~i;return r}function Cn(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function kn(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=On(24&~t))?kn(10,t):e;case 10:return 0===(e=On(192&~t))?kn(8,t):e;case 8:return 0===(e=On(3584&~t))&&(0===(e=On(4186112&~t))&&(e=512)),e;case 2:return 0===(t=On(805306368&~t))&&(t=268435456),t}throw Error(Y(358,e))}function On(e){return e&-e}function Mn(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Rn(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Pn(t)]=n}var Pn=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(In(e)/Ln|0)|0},In=Math.log,Ln=Math.LN2;var Nn=X.unstable_UserBlockingPriority,Dn=X.unstable_runWithPriority,Fn=!0;function jn(e,t,n,r){Tt||xt();var i=Bn,a=Tt;Tt=!0;try{Et(i,e,t,n,r)}finally{(Tt=a)||wt()}}function Un(e,t,n,r){Dn(Nn,Bn.bind(null,e,t,n,r))}function Bn(e,t,n,r){var i;if(Fn)if((i=0==(4&t))&&0<Yt.length&&-1<en.indexOf(e))e=tn(null,e,t,n,r),Yt.push(e);else{var a=zn(e,t,n,r);if(null===a)i&&nn(e,r);else{if(i){if(-1<en.indexOf(e))return e=tn(a,e,t,n,r),void Yt.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return qt=rn(qt,e,t,n,r,i),!0;case"dragenter":return Zt=rn(Zt,e,t,n,r,i),!0;case"mouseover":return Kt=rn(Kt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Qt.set(a,rn(Qt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Jt.set(a,rn(Jt.get(a)||null,e,t,n,r,i)),!0}return!1}(a,e,t,n,r))return;nn(e,r)}_i(e,t,r,null,n)}}}function zn(e,t,n,r){var i=ht(r);if(null!==(i=Bi(i))){var a=Ft(i);if(null===a)i=null;else{var o=a.tag;if(13===o){if(null!==(i=jt(a)))return i;i=null}else if(3===o){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return _i(e,t,r,i,n),null}var Vn=null,Hn=null,Gn=null;function Wn(){if(Gn)return Gn;var e,t,n=Hn,r=n.length,i="value"in Vn?Vn.value:Vn.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Gn=i.slice(e,1<t?1-t:void 0)}function Xn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yn(){return!0}function qn(){return!1}function Zn(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Yn:qn,this.isPropagationStopped=qn,this}return W(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yn)},persist:function(){},isPersistent:Yn}),t}var Kn,Qn,Jn,$n={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},er=Zn($n),tr=W({},$n,{view:0,detail:0}),nr=Zn(tr),rr=W({},tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jn&&(Jn&&"mousemove"===e.type?(Kn=e.screenX-Jn.screenX,Qn=e.screenY-Jn.screenY):Qn=Kn=0,Jn=e),Kn)},movementY:function(e){return"movementY"in e?e.movementY:Qn}}),ir=Zn(rr),ar=Zn(W({},rr,{dataTransfer:0})),or=Zn(W({},tr,{relatedTarget:0})),sr=Zn(W({},$n,{animationName:0,elapsedTime:0,pseudoElement:0})),ur=Zn(W({},$n,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),lr=Zn(W({},$n,{data:0})),cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=pr[e])&&!!t[e]}function dr(){return hr}var vr=Zn(W({},tr,{key:function(e){if(e.key){var t=cr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Xn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dr,charCode:function(e){return"keypress"===e.type?Xn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Xn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),mr=Zn(W({},rr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),yr=Zn(W({},tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dr})),gr=Zn(W({},$n,{propertyName:0,elapsedTime:0,pseudoElement:0})),_r=Zn(W({},rr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),br=[9,13,27,32],Er=J&&"CompositionEvent"in window,xr=null;J&&"documentMode"in document&&(xr=document.documentMode);var Sr=J&&"TextEvent"in window&&!xr,Tr=J&&(!Er||xr&&8<xr&&11>=xr),Ar=String.fromCharCode(32),wr=!1;function Cr(e,t){switch(e){case"keyup":return-1!==br.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kr(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Or=!1;var Mr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mr[e.type]:"textarea"===t}function Pr(e,t,n,r){gt(r),0<(t=Ei(t,"onChange")).length&&(n=new er("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ir=null,Lr=null;function Nr(e){hi(e,0)}function Dr(e){if(je(Vi(e)))return e}function Fr(e,t){if("change"===e)return t}var jr=!1;if(J){var Ur;if(J){var Br="oninput"in document;if(!Br){var zr=document.createElement("div");zr.setAttribute("oninput","return;"),Br="function"==typeof zr.oninput}Ur=Br}else Ur=!1;jr=Ur&&(!document.documentMode||9<document.documentMode)}function Vr(){Ir&&(Ir.detachEvent("onpropertychange",Hr),Lr=Ir=null)}function Hr(e){if("value"===e.propertyName&&Dr(Lr)){var t=[];if(Pr(t,Lr,e,ht(e)),e=Nr,Tt)e(t);else{Tt=!0;try{bt(e,t)}finally{Tt=!1,wt()}}}}function Gr(e,t,n){"focusin"===e?(Vr(),Lr=n,(Ir=t).attachEvent("onpropertychange",Hr)):"focusout"===e&&Vr()}function Wr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Dr(Lr)}function Xr(e,t){if("click"===e)return Dr(t)}function Yr(e,t){if("input"===e||"change"===e)return Dr(t)}var qr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Zr=Object.prototype.hasOwnProperty;function Kr(e,t){if(qr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Zr.call(t,n[r])||!qr(e[n[r]],t[n[r]]))return!1;return!0}function Qr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jr(e,t){var n,r=Qr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qr(r)}}function $r(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?$r(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ei(){for(var e=window,t=Ue();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Ue((e=t.contentWindow).document)}return t}function ti(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ni=J&&"documentMode"in document&&11>=document.documentMode,ri=null,ii=null,ai=null,oi=!1;function si(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;oi||null==ri||ri!==Ue(r)||("selectionStart"in(r=ri)&&ti(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ai&&Kr(ai,r)||(ai=r,0<(r=Ei(ii,"onSelect")).length&&(t=new er("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ri)))}Sn("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Sn("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Sn(xn,2);for(var ui="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),li=0;li<ui.length;li++)En.set(ui[li],0);Q("onMouseEnter",["mouseout","mouseover"]),Q("onMouseLeave",["mouseout","mouseover"]),Q("onPointerEnter",["pointerout","pointerover"]),Q("onPointerLeave",["pointerout","pointerover"]),K("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),K("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),K("onBeforeInput",["compositionend","keypress","textInput","paste"]),K("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),K("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),K("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ci="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fi=new Set("cancel close invalid load scroll toggle".split(" ").concat(ci));function pi(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,s,u){if(Dt.apply(this,arguments),Rt){if(!Rt)throw Error(Y(198));var l=Pt;Rt=!1,Pt=null,It||(It=!0,Lt=l)}}(r,t,void 0,e),e.currentTarget=null}function hi(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==a&&i.isPropagationStopped())break e;pi(i,s,l),a=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,l=s.currentTarget,s=s.listener,u!==a&&i.isPropagationStopped())break e;pi(i,s,l),a=u}}}if(It)throw e=Lt,It=!1,Lt=null,e}function di(e,t){var n=Gi(t),r=e+"__bubble";n.has(r)||(gi(t,e,2,!1),n.add(r))}var vi="_reactListening"+Math.random().toString(36).slice(2);function mi(e){e[vi]||(e[vi]=!0,q.forEach((function(t){fi.has(t)||yi(t,!1,e,null),yi(t,!0,e,null)})))}function yi(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=n;if("selectionchange"===e&&9!==n.nodeType&&(a=n.ownerDocument),null!==r&&!t&&fi.has(e)){if("scroll"!==e)return;i|=2,a=r}var o=Gi(a),s=e+"__"+(t?"capture":"bubble");o.has(s)||(t&&(i|=4),gi(a,e,i,t),o.add(s))}function gi(e,t,n,r){var i=En.get(t);switch(void 0===i?2:i){case 0:i=jn;break;case 1:i=Un;break;default:i=Bn}n=i.bind(null,t,n,e),i=void 0,!kt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function _i(e,t,n,r,i){var a=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=Bi(s)))return;if(5===(u=o.tag)||6===u){r=a=o;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(At)return e(t,n);At=!0;try{St(e,t,n)}finally{At=!1,wt()}}((function(){var r=a,i=ht(n),o=[];e:{var s=bn.get(e);if(void 0!==s){var u=er,l=e;switch(e){case"keypress":if(0===Xn(n))break e;case"keydown":case"keyup":u=vr;break;case"focusin":l="focus",u=or;break;case"focusout":l="blur",u=or;break;case"beforeblur":case"afterblur":u=or;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=ar;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=yr;break;case mn:case yn:case gn:u=sr;break;case _n:u=gr;break;case"scroll":u=nr;break;case"wheel":u=_r;break;case"copy":case"cut":case"paste":u=ur;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=mr}var c=0!=(4&t),f=!c&&"scroll"===e,p=c?null!==s?s+"Capture":null:s;c=[];for(var h,d=r;null!==d;){var v=(h=d).stateNode;if(5===h.tag&&null!==v&&(h=v,null!==p&&(null!=(v=Ct(d,p))&&c.push(bi(d,v,h)))),f)break;d=d.return}0<c.length&&(s=new u(s,l,null,n,i),o.push({event:s,listeners:c}))}}if(0==(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!=(16&t)||!(l=n.relatedTarget||n.fromElement)||!Bi(l)&&!l[ji])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?Bi(l):null)&&(l!==(f=Ft(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=ir,v="onMouseLeave",p="onMouseEnter",d="mouse","pointerout"!==e&&"pointerover"!==e||(c=mr,v="onPointerLeave",p="onPointerEnter",d="pointer"),f=null==u?s:Vi(u),h=null==l?s:Vi(l),(s=new c(v,d+"leave",u,n,i)).target=f,s.relatedTarget=h,v=null,Bi(i)===r&&((c=new c(p,d+"enter",l,n,i)).target=h,c.relatedTarget=f,v=c),f=v,u&&l)e:{for(p=l,d=0,h=c=u;h;h=xi(h))d++;for(h=0,v=p;v;v=xi(v))h++;for(;0<d-h;)c=xi(c),d--;for(;0<h-d;)p=xi(p),h--;for(;d--;){if(c===p||null!==p&&c===p.alternate)break e;c=xi(c),p=xi(p)}c=null}else c=null;null!==u&&Si(o,s,u,c,!1),null!==l&&null!==f&&Si(o,f,l,c,!0)}if("select"===(u=(s=r?Vi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Fr;else if(Rr(s))if(jr)m=Yr;else{m=Wr;var y=Gr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=Xr);switch(m&&(m=m(e,r))?Pr(o,m,n,i):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&We(s,"number",s.value)),y=r?Vi(r):window,e){case"focusin":(Rr(y)||"true"===y.contentEditable)&&(ri=y,ii=r,ai=null);break;case"focusout":ai=ii=ri=null;break;case"mousedown":oi=!0;break;case"contextmenu":case"mouseup":case"dragend":oi=!1,si(o,n,i);break;case"selectionchange":if(ni)break;case"keydown":case"keyup":si(o,n,i)}var g;if(Er)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Or?Cr(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Tr&&"ko"!==n.locale&&(Or||"onCompositionStart"!==_?"onCompositionEnd"===_&&Or&&(g=Wn()):(Hn="value"in(Vn=i)?Vn.value:Vn.textContent,Or=!0)),0<(y=Ei(r,_)).length&&(_=new lr(_,e,null,n,i),o.push({event:_,listeners:y}),g?_.data=g:null!==(g=kr(n))&&(_.data=g))),(g=Sr?function(e,t){switch(e){case"compositionend":return kr(t);case"keypress":return 32!==t.which?null:(wr=!0,Ar);case"textInput":return(e=t.data)===Ar&&wr?null:e;default:return null}}(e,n):function(e,t){if(Or)return"compositionend"===e||!Er&&Cr(e,t)?(e=Wn(),Gn=Hn=Vn=null,Or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tr&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Ei(r,"onBeforeInput")).length&&(i=new lr("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}hi(o,t)}))}function bi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ei(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ct(e,n))&&r.unshift(bi(e,a,i)),null!=(a=Ct(e,t))&&r.push(bi(e,a,i))),e=e.return}return r}function xi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Si(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=Ct(n,a))&&o.unshift(bi(n,u,s)):i||null!=(u=Ct(n,a))&&o.push(bi(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}function Ti(){}var Ai=null,wi=null;function Ci(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function ki(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Oi="function"==typeof setTimeout?setTimeout:void 0,Mi="function"==typeof clearTimeout?clearTimeout:void 0;function Ri(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Pi(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Ii(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Li=0;var Ni=Math.random().toString(36).slice(2),Di="__reactFiber$"+Ni,Fi="__reactProps$"+Ni,ji="__reactContainer$"+Ni,Ui="__reactEvents$"+Ni;function Bi(e){var t=e[Di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ji]||n[Di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ii(e);null!==e;){if(n=e[Di])return n;e=Ii(e)}return t}n=(e=n).parentNode}return null}function zi(e){return!(e=e[Di]||e[ji])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Vi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(Y(33))}function Hi(e){return e[Fi]||null}function Gi(e){var t=e[Ui];return void 0===t&&(t=e[Ui]=new Set),t}var Wi=[],Xi=-1;function Yi(e){return{current:e}}function qi(e){0>Xi||(e.current=Wi[Xi],Wi[Xi]=null,Xi--)}function Zi(e,t){Xi++,Wi[Xi]=e.current,e.current=t}var Ki={},Qi=Yi(Ki),Ji=Yi(!1),$i=Ki;function ea(e,t){var n=e.type.contextTypes;if(!n)return Ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ta(e){return null!=(e=e.childContextTypes)}function na(){qi(Ji),qi(Qi)}function ra(e,t,n){if(Qi.current!==Ki)throw Error(Y(168));Zi(Qi,t),Zi(Ji,n)}function ia(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(Y(108,Le(t)||"Unknown",i));return W({},n,r)}function aa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ki,$i=Qi.current,Zi(Qi,e),Zi(Ji,Ji.current),!0}function oa(e,t,n){var r=e.stateNode;if(!r)throw Error(Y(169));n?(e=ia(e,t,$i),r.__reactInternalMemoizedMergedChildContext=e,qi(Ji),qi(Qi),Zi(Qi,e)):qi(Ji),Zi(Ji,n)}var sa=null,ua=null,la=X.unstable_runWithPriority,ca=X.unstable_scheduleCallback,fa=X.unstable_cancelCallback,pa=X.unstable_shouldYield,ha=X.unstable_requestPaint,da=X.unstable_now,va=X.unstable_getCurrentPriorityLevel,ma=X.unstable_ImmediatePriority,ya=X.unstable_UserBlockingPriority,ga=X.unstable_NormalPriority,_a=X.unstable_LowPriority,ba=X.unstable_IdlePriority,Ea={},xa=void 0!==ha?ha:function(){},Sa=null,Ta=null,Aa=!1,wa=da(),Ca=1e4>wa?da:function(){return da()-wa};function ka(){switch(va()){case ma:return 99;case ya:return 98;case ga:return 97;case _a:return 96;case ba:return 95;default:throw Error(Y(332))}}function Oa(e){switch(e){case 99:return ma;case 98:return ya;case 97:return ga;case 96:return _a;case 95:return ba;default:throw Error(Y(332))}}function Ma(e,t){return e=Oa(e),la(e,t)}function Ra(e,t,n){return e=Oa(e),ca(e,t,n)}function Pa(){if(null!==Ta){var e=Ta;Ta=null,fa(e)}Ia()}function Ia(){if(!Aa&&null!==Sa){Aa=!0;var e=0;try{var t=Sa;Ma(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Sa=null}catch(n){throw null!==Sa&&(Sa=Sa.slice(e+1)),ca(ma,Pa),n}finally{Aa=!1}}}var La=ue.ReactCurrentBatchConfig;function Na(e,t){if(e&&e.defaultProps){for(var n in t=W({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Da=Yi(null),Fa=null,ja=null,Ua=null;function Ba(){Ua=ja=Fa=null}function za(e){var t=Da.current;qi(Da),e.type._context._currentValue=t}function Va(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function Ha(e,t){Fa=e,Ua=ja=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(Es=!0),e.firstContext=null)}function Ga(e,t){if(Ua!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Ua=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ja){if(null===Fa)throw Error(Y(308));ja=t,Fa.dependencies={lanes:0,firstContext:t,responders:null}}else ja=ja.next=t;return e._currentValue}var Wa=!1;function Xa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function Ya(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Za(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function Ka(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Qa(e,t,n,r){var i=e.updateQueue;Wa=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===o?a=l:o.next=l,o=u;var c=e.alternate;if(null!==c){var f=(c=c.updateQueue).lastBaseUpdate;f!==o&&(null===f?c.firstBaseUpdate=l:f.next=l,c.lastBaseUpdate=u)}}if(null!==a){for(f=i.baseState,o=0,c=l=u=null;;){s=a.lane;var p=a.eventTime;if((r&s)===s){null!==c&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var h=e,d=a;switch(s=t,p=n,d.tag){case 1:if("function"==typeof(h=d.payload)){f=h.call(p,f,s);break e}f=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null==(s="function"==typeof(h=d.payload)?h.call(p,f,s):h))break e;f=W({},f,s);break e;case 2:Wa=!0}}null!==a.callback&&(e.flags|=32,null===(s=i.effects)?i.effects=[a]:s.push(a))}else p={eventTime:p,lane:s,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(l=c=p,u=f):c=c.next=p,o|=s;if(null===(a=a.next)){if(null===(s=i.shared.pending))break;a=s.next,s.next=null,i.lastBaseUpdate=s,i.shared.pending=null}}null===c&&(u=f),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,Au|=o,e.lanes=o,e.memoizedState=f}}function Ja(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(Y(191,i));i.call(r)}}}var $a=(new G.Component).refs;function eo(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:W({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var to={isMounted:function(e){return!!(e=e._reactInternals)&&Ft(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ku(),i=Qu(e),a=qa(r,i);a.payload=t,null!=n&&(a.callback=n),Za(e,a),Ju(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ku(),i=Qu(e),a=qa(r,i);a.tag=1,a.payload=t,null!=n&&(a.callback=n),Za(e,a),Ju(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ku(),r=Qu(e),i=qa(n,r);i.tag=2,null!=t&&(i.callback=t),Za(e,i),Ju(e,r,n)}};function no(e,t,n,r,i,a,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!Kr(n,r)||!Kr(i,a))}function ro(e,t,n){var r=!1,i=Ki,a=t.contextType;return"object"==typeof a&&null!==a?a=Ga(a):(i=ta(t)?$i:Qi.current,a=(r=null!=(r=t.contextTypes))?ea(e,i):Ki),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=to,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function io(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&to.enqueueReplaceState(t,t.state,null)}function ao(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=$a,Xa(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=Ga(a):(a=ta(t)?$i:Qi.current,i.context=ea(e,a)),Qa(e,n,i,r),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(eo(e,t,a,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&to.enqueueReplaceState(i,i.state,null),Qa(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4)}var oo=Array.isArray;function so(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===$a&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!=typeof e)throw Error(Y(284));if(!n._owner)throw Error(Y(290,e))}return e}function uo(e,t){if("textarea"!==e.type)throw Error(Y(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function lo(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ml(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Ll(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=so(e,t,n),r.return=e,r):((r=Rl(n.type,n.key,n.props,null,e.mode,r)).ref=so(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function c(e,t,n,r,a){return null===t||7!==t.tag?((t=Pl(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case le:return(n=Rl(t.type,t.key,t.props,null,e.mode,n)).ref=so(e,null,t),n.return=e,n;case ce:return(t=Nl(t,e.mode,n)).return=e,t}if(oo(t)||Oe(t))return(t=Pl(t,e.mode,n,null)).return=e,t;uo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:s(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case le:return n.key===i?n.type===fe?c(e,t,n.props.children,r,i):u(e,t,n,r):null;case ce:return n.key===i?l(e,t,n,r):null}if(oo(n)||Oe(n))return null!==i?null:c(e,t,n,r,null);uo(e,n)}return null}function h(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case le:return e=e.get(null===r.key?n:r.key)||null,r.type===fe?c(t,e,r.props.children,i,r.key):u(t,e,r,i);case ce:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(oo(r)||Oe(r))return c(t,e=e.get(n)||null,r,i,null);uo(t,r)}return null}return function(s,u,l,c){var d="object"==typeof l&&null!==l&&l.type===fe&&null===l.key;d&&(l=l.props.children);var v="object"==typeof l&&null!==l;if(v)switch(l.$$typeof){case le:e:{for(v=l.key,d=u;null!==d;){if(d.key===v){switch(d.tag){case 7:if(l.type===fe){n(s,d.sibling),(u=i(d,l.props.children)).return=s,s=u;break e}break;default:if(d.elementType===l.type){n(s,d.sibling),(u=i(d,l.props)).ref=so(s,d,l),u.return=s,s=u;break e}}n(s,d);break}t(s,d),d=d.sibling}l.type===fe?((u=Pl(l.props.children,s.mode,c,l.key)).return=s,s=u):((c=Rl(l.type,l.key,l.props,null,s.mode,c)).ref=so(s,u,l),c.return=s,s=c)}return o(s);case ce:e:{for(d=l.key;null!==u;){if(u.key===d){if(4===u.tag&&u.stateNode.containerInfo===l.containerInfo&&u.stateNode.implementation===l.implementation){n(s,u.sibling),(u=i(u,l.children||[])).return=s,s=u;break e}n(s,u);break}t(s,u),u=u.sibling}(u=Nl(l,s.mode,c)).return=s,s=u}return o(s)}if("string"==typeof l||"number"==typeof l)return l=""+l,null!==u&&6===u.tag?(n(s,u.sibling),(u=i(u,l)).return=s,s=u):(n(s,u),(u=Ll(l,s.mode,c)).return=s,s=u),o(s);if(oo(l))return function(i,o,s,u){for(var l=null,c=null,d=o,v=o=0,m=null;null!==d&&v<s.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var y=p(i,d,s[v],u);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(i,d),o=a(y,o,v),null===c?l=y:c.sibling=y,c=y,d=m}if(v===s.length)return n(i,d),l;if(null===d){for(;v<s.length;v++)null!==(d=f(i,s[v],u))&&(o=a(d,o,v),null===c?l=d:c.sibling=d,c=d);return l}for(d=r(i,d);v<s.length;v++)null!==(m=h(d,i,v,s[v],u))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),o=a(m,o,v),null===c?l=m:c.sibling=m,c=m);return e&&d.forEach((function(e){return t(i,e)})),l}(s,u,l,c);if(Oe(l))return function(i,o,s,u){var l=Oe(s);if("function"!=typeof l)throw Error(Y(150));if(null==(s=l.call(s)))throw Error(Y(151));for(var c=l=null,d=o,v=o=0,m=null,y=s.next();null!==d&&!y.done;v++,y=s.next()){d.index>v?(m=d,d=null):m=d.sibling;var g=p(i,d,y.value,u);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(i,d),o=a(g,o,v),null===c?l=g:c.sibling=g,c=g,d=m}if(y.done)return n(i,d),l;if(null===d){for(;!y.done;v++,y=s.next())null!==(y=f(i,y.value,u))&&(o=a(y,o,v),null===c?l=y:c.sibling=y,c=y);return l}for(d=r(i,d);!y.done;v++,y=s.next())null!==(y=h(d,i,v,y.value,u))&&(e&&null!==y.alternate&&d.delete(null===y.key?v:y.key),o=a(y,o,v),null===c?l=y:c.sibling=y,c=y);return e&&d.forEach((function(e){return t(i,e)})),l}(s,u,l,c);if(v&&uo(s,l),void 0===l&&!d)switch(s.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Y(152,Le(s.type)||"Component"))}return n(s,u)}}var co=lo(!0),fo=lo(!1),po={},ho=Yi(po),vo=Yi(po),mo=Yi(po);function yo(e){if(e===po)throw Error(Y(174));return e}function go(e,t){switch(Zi(mo,t),Zi(vo,e),Zi(ho,po),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:tt(null,"");break;default:t=tt(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}qi(ho),Zi(ho,t)}function _o(){qi(ho),qi(vo),qi(mo)}function bo(e){yo(mo.current);var t=yo(ho.current),n=tt(t,e.type);t!==n&&(Zi(vo,e),Zi(ho,n))}function Eo(e){vo.current===e&&(qi(ho),qi(vo))}var xo=Yi(0);function So(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var To=null,Ao=null,wo=!1;function Co(e,t){var n=kl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function ko(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Oo(e){if(wo){var t=Ao;if(t){var n=t;if(!ko(e,t)){if(!(t=Pi(n.nextSibling))||!ko(e,t))return e.flags=-1025&e.flags|2,wo=!1,void(To=e);Co(To,n)}To=e,Ao=Pi(t.firstChild)}else e.flags=-1025&e.flags|2,wo=!1,To=e}}function Mo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;To=e}function Ro(e){if(e!==To)return!1;if(!wo)return Mo(e),wo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!ki(t,e.memoizedProps))for(t=Ao;t;)Co(e,t),t=Pi(t.nextSibling);if(Mo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(Y(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ao=Pi(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ao=null}}else Ao=To?Pi(e.stateNode.nextSibling):null;return!0}function Po(){Ao=To=null,wo=!1}var Io=[];function Lo(){for(var e=0;e<Io.length;e++)Io[e]._workInProgressVersionPrimary=null;Io.length=0}var No=ue.ReactCurrentDispatcher,Do=ue.ReactCurrentBatchConfig,Fo=0,jo=null,Uo=null,Bo=null,zo=!1,Vo=!1;function Ho(){throw Error(Y(321))}function Go(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!qr(e[n],t[n]))return!1;return!0}function Wo(e,t,n,r,i,a){if(Fo=a,jo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,No.current=null===e||null===e.memoizedState?ys:gs,e=n(r,i),Vo){a=0;do{if(Vo=!1,!(25>a))throw Error(Y(301));a+=1,Bo=Uo=null,t.updateQueue=null,No.current=_s,e=n(r,i)}while(Vo)}if(No.current=ms,t=null!==Uo&&null!==Uo.next,Fo=0,Bo=Uo=jo=null,zo=!1,t)throw Error(Y(300));return e}function Xo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Bo?jo.memoizedState=Bo=e:Bo=Bo.next=e,Bo}function Yo(){if(null===Uo){var e=jo.alternate;e=null!==e?e.memoizedState:null}else e=Uo.next;var t=null===Bo?jo.memoizedState:Bo.next;if(null!==t)Bo=t,Uo=e;else{if(null===e)throw Error(Y(310));e={memoizedState:(Uo=e).memoizedState,baseState:Uo.baseState,baseQueue:Uo.baseQueue,queue:Uo.queue,next:null},null===Bo?jo.memoizedState=Bo=e:Bo=Bo.next=e}return Bo}function qo(e,t){return"function"==typeof t?t(e):t}function Zo(e){var t=Yo(),n=t.queue;if(null===n)throw Error(Y(311));n.lastRenderedReducer=e;var r=Uo,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var s=o=a=null,u=i;do{var l=u.lane;if((Fo&l)===l)null!==s&&(s=s.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var c={lane:l,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===s?(o=s=c,a=r):s=s.next=c,jo.lanes|=l,Au|=l}u=u.next}while(null!==u&&u!==i);null===s?a=r:s.next=o,qr(r,t.memoizedState)||(Es=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=s,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Ko(e){var t=Yo(),n=t.queue;if(null===n)throw Error(Y(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);qr(a,t.memoizedState)||(Es=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Qo(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Fo&e)===e)&&(t._workInProgressVersionPrimary=r,Io.push(t))),e)return n(t._source);throw Io.push(t),Error(Y(350))}function Jo(e,t,n,r){var i=yu;if(null===i)throw Error(Y(349));var a=t._getVersion,o=a(t._source),s=No.current,u=s.useState((function(){return Qo(i,t,n)})),l=u[1],c=u[0];u=Bo;var f=e.memoizedState,p=f.refs,h=p.getSnapshot,d=f.source;f=f.subscribe;var v=jo;return e.memoizedState={refs:p,source:t,subscribe:r},s.useEffect((function(){p.getSnapshot=n,p.setSnapshot=l;var e=a(t._source);if(!qr(o,e)){e=n(t._source),qr(c,e)||(l(e),e=Qu(v),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,s=e;0<s;){var u=31-Pn(s),f=1<<u;r[u]|=e,s&=~f}}}),[n,t,r]),s.useEffect((function(){return r(t._source,(function(){var e=p.getSnapshot,n=p.setSnapshot;try{n(e(t._source));var r=Qu(v);i.mutableReadLanes|=r&i.pendingLanes}catch(a){n((function(){throw a}))}}))}),[t,r]),qr(h,n)&&qr(d,t)&&qr(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:qo,lastRenderedState:c}).dispatch=l=vs.bind(null,jo,e),u.queue=e,u.baseQueue=null,c=Qo(i,t,n),u.memoizedState=u.baseState=c),c}function $o(e,t,n){return Jo(Yo(),e,t,n)}function es(e){var t=Xo();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:qo,lastRenderedState:e}).dispatch=vs.bind(null,jo,e),[t.memoizedState,e]}function ts(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=jo.updateQueue)?(t={lastEffect:null},jo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ns(e){return e={current:e},Xo().memoizedState=e}function rs(){return Yo().memoizedState}function is(e,t,n,r){var i=Xo();jo.flags|=e,i.memoizedState=ts(1|t,n,void 0,void 0===r?null:r)}function as(e,t,n,r){var i=Yo();r=void 0===r?null:r;var a=void 0;if(null!==Uo){var o=Uo.memoizedState;if(a=o.destroy,null!==r&&Go(r,o.deps))return void ts(t,n,a,r)}jo.flags|=e,i.memoizedState=ts(1|t,n,a,r)}function os(e,t){return is(516,4,e,t)}function ss(e,t){return as(516,4,e,t)}function us(e,t){return as(4,2,e,t)}function ls(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function cs(e,t,n){return n=null!=n?n.concat([e]):null,as(4,2,ls.bind(null,t,e),n)}function fs(){}function ps(e,t){var n=Yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Go(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function hs(e,t){var n=Yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Go(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ds(e,t){var n=ka();Ma(98>n?98:n,(function(){e(!0)})),Ma(97<n?97:n,(function(){var n=Do.transition;Do.transition=1;try{e(!1),t()}finally{Do.transition=n}}))}function vs(e,t,n){var r=Ku(),i=Qu(e),a={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?a.next=a:(a.next=o.next,o.next=a),t.pending=a,o=e.alternate,e===jo||null!==o&&o===jo)Vo=zo=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=o(s,n);if(a.eagerReducer=o,a.eagerState=u,qr(u,s))return}catch(l){}Ju(e,i,r)}}var ms={readContext:Ga,useCallback:Ho,useContext:Ho,useEffect:Ho,useImperativeHandle:Ho,useLayoutEffect:Ho,useMemo:Ho,useReducer:Ho,useRef:Ho,useState:Ho,useDebugValue:Ho,useDeferredValue:Ho,useTransition:Ho,useMutableSource:Ho,useOpaqueIdentifier:Ho,unstable_isNewReconciler:!1},ys={readContext:Ga,useCallback:function(e,t){return Xo().memoizedState=[e,void 0===t?null:t],e},useContext:Ga,useEffect:os,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,is(4,2,ls.bind(null,t,e),n)},useLayoutEffect:function(e,t){return is(4,2,e,t)},useMemo:function(e,t){var n=Xo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Xo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=vs.bind(null,jo,e),[r.memoizedState,e]},useRef:ns,useState:es,useDebugValue:fs,useDeferredValue:function(e){var t=es(e),n=t[0],r=t[1];return os((function(){var t=Do.transition;Do.transition=1;try{r(e)}finally{Do.transition=t}}),[e]),n},useTransition:function(){var e=es(!1),t=e[0];return ns(e=ds.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=Xo();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},Jo(r,e,t,n)},useOpaqueIdentifier:function(){if(wo){var e=!1,t=function(e){return{$$typeof:xe,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Li++).toString(36))),Error(Y(355))})),n=es(t)[1];return 0==(2&jo.mode)&&(jo.flags|=516,ts(5,(function(){n("r:"+(Li++).toString(36))}),void 0,null)),t}return es(t="r:"+(Li++).toString(36)),t},unstable_isNewReconciler:!1},gs={readContext:Ga,useCallback:ps,useContext:Ga,useEffect:ss,useImperativeHandle:cs,useLayoutEffect:us,useMemo:hs,useReducer:Zo,useRef:rs,useState:function(){return Zo(qo)},useDebugValue:fs,useDeferredValue:function(e){var t=Zo(qo),n=t[0],r=t[1];return ss((function(){var t=Do.transition;Do.transition=1;try{r(e)}finally{Do.transition=t}}),[e]),n},useTransition:function(){var e=Zo(qo)[0];return[rs().current,e]},useMutableSource:$o,useOpaqueIdentifier:function(){return Zo(qo)[0]},unstable_isNewReconciler:!1},_s={readContext:Ga,useCallback:ps,useContext:Ga,useEffect:ss,useImperativeHandle:cs,useLayoutEffect:us,useMemo:hs,useReducer:Ko,useRef:rs,useState:function(){return Ko(qo)},useDebugValue:fs,useDeferredValue:function(e){var t=Ko(qo),n=t[0],r=t[1];return ss((function(){var t=Do.transition;Do.transition=1;try{r(e)}finally{Do.transition=t}}),[e]),n},useTransition:function(){var e=Ko(qo)[0];return[rs().current,e]},useMutableSource:$o,useOpaqueIdentifier:function(){return Ko(qo)[0]},unstable_isNewReconciler:!1},bs=ue.ReactCurrentOwner,Es=!1;function xs(e,t,n,r){t.child=null===e?fo(t,null,n,r):co(t,e.child,n,r)}function Ss(e,t,n,r,i){n=n.render;var a=t.ref;return Ha(t,i),r=Wo(e,t,n,r,a,i),null===e||Es?(t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,Hs(e,t,i))}function Ts(e,t,n,r,i,a){if(null===e){var o=n.type;return"function"!=typeof o||Ol(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rl(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,As(e,t,o,r,i,a))}return o=e.child,0==(i&a)&&(i=o.memoizedProps,(n=null!==(n=n.compare)?n:Kr)(i,r)&&e.ref===t.ref)?Hs(e,t,a):(t.flags|=1,(e=Ml(o,r)).ref=t.ref,e.return=t,t.child=e)}function As(e,t,n,r,i,a){if(null!==e&&Kr(e.memoizedProps,r)&&e.ref===t.ref){if(Es=!1,0==(a&i))return t.lanes=e.lanes,Hs(e,t,a);0!=(16384&e.flags)&&(Es=!0)}return ks(e,t,n,r,a)}function ws(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},ol(t,n);else{if(0==(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},ol(t,e),null;t.memoizedState={baseLanes:0},ol(t,null!==a?a.baseLanes:n)}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,ol(t,r);return xs(e,t,i,n),t.child}function Cs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function ks(e,t,n,r,i){var a=ta(n)?$i:Qi.current;return a=ea(t,a),Ha(t,i),n=Wo(e,t,n,r,a,i),null===e||Es?(t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,Hs(e,t,i))}function Os(e,t,n,r,i){if(ta(n)){var a=!0;aa(t)}else a=!1;if(Ha(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ro(t,n,r),ao(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,l=n.contextType;"object"==typeof l&&null!==l?l=Ga(l):l=ea(t,l=ta(n)?$i:Qi.current);var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;f||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==r||u!==l)&&io(t,o,r,l),Wa=!1;var p=t.memoizedState;o.state=p,Qa(t,r,o,i),u=t.memoizedState,s!==r||p!==u||Ji.current||Wa?("function"==typeof c&&(eo(t,n,c,r),u=t.memoizedState),(s=Wa||no(t,n,s,r,p,u,l))?(f||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4)):("function"==typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=s):("function"==typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,Ya(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Na(t.type,s),o.props=l,f=t.pendingProps,p=o.context,"object"==typeof(u=n.contextType)&&null!==u?u=Ga(u):u=ea(t,u=ta(n)?$i:Qi.current);var h=n.getDerivedStateFromProps;(c="function"==typeof h||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==f||p!==u)&&io(t,o,r,u),Wa=!1,p=t.memoizedState,o.state=p,Qa(t,r,o,i);var d=t.memoizedState;s!==f||p!==d||Ji.current||Wa?("function"==typeof h&&(eo(t,n,h,r),d=t.memoizedState),(l=Wa||no(t,n,l,r,p,d,u))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(r,d,u),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,d,u)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=d),o.props=r,o.state=d,o.context=u,r=l):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),r=!1)}return Ms(e,t,n,r,a,i)}function Ms(e,t,n,r,i,a){Cs(e,t);var o=0!=(64&t.flags);if(!r&&!o)return i&&oa(t,n,!1),Hs(e,t,a);r=t.stateNode,bs.current=t;var s=o&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=co(t,e.child,null,a),t.child=co(t,null,s,a)):xs(e,t,s,a),t.memoizedState=r.state,i&&oa(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ra(0,t.context,!1),go(e,t.containerInfo)}var Ps,Is,Ls,Ns={dehydrated:null,retryLane:0};function Ds(e,t,n){var r,i=t.pendingProps,a=xo.current,o=!1;return(r=0!=(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!=(2&a)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),Zi(xo,1&a),null===e?(void 0!==i.fallback&&Oo(t),e=i.children,a=i.fallback,o?(e=Fs(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ns,e):"number"==typeof i.unstable_expectedLoadTime?(e=Fs(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ns,t.lanes=33554432,e):((n=Il({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(i=Us(e,t,i.children,i.fallback,n),o=t.child,a=e.child.memoizedState,o.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=Ns,i):(n=js(e,t,i.children,n),t.memoizedState=null,n))}function Fs(e,t,n,r){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0==(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=Il(t,i,0,null),n=Pl(n,i,r,null),a.return=e,n.return=e,a.sibling=n,e.child=a,n}function js(e,t,n,r){var i=e.child;return e=i.sibling,n=Ml(i,{mode:"visible",children:n}),0==(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Us(e,t,n,r,i){var a=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:n};return 0==(2&a)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Ml(o,s),null!==e?r=Ml(e,r):(r=Pl(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Bs(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Va(e.return,t)}function zs(e,t,n,r,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.lastEffect=a)}function Vs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(xs(e,t,r.children,n),0!=(2&(r=xo.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n);else if(19===e.tag)Bs(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Zi(xo,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===So(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),zs(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===So(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}zs(t,!0,n,null,a,t.lastEffect);break;case"together":zs(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Au|=t.lanes,0!=(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(Y(153));if(null!==t.child){for(n=Ml(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ml(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function Gs(e,t){if(!wo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ws(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ta(t.type)&&na(),null;case 3:return _o(),qi(Ji),qi(Qi),Lo(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Ro(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Eo(t);var i=yo(mo.current);if(n=t.type,null!==e&&null!=t.stateNode)Is(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(Y(166));return null}if(e=yo(ho.current),Ro(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Di]=t,r[Fi]=a,n){case"dialog":di("cancel",r),di("close",r);break;case"iframe":case"object":case"embed":di("load",r);break;case"video":case"audio":for(e=0;e<ci.length;e++)di(ci[e],r);break;case"source":di("error",r);break;case"img":case"image":case"link":di("error",r),di("load",r);break;case"details":di("toggle",r);break;case"input":ze(r,a),di("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},di("invalid",r);break;case"textarea":Ze(r,a),di("invalid",r)}for(var o in ft(n,a),e=null,a)a.hasOwnProperty(o)&&(i=a[o],"children"===o?"string"==typeof i?r.textContent!==i&&(e=["children",i]):"number"==typeof i&&r.textContent!==""+i&&(e=["children",""+i]):Z.hasOwnProperty(o)&&null!=i&&"onScroll"===o&&di("scroll",r));switch(n){case"input":Fe(r),Ge(r,a,!0);break;case"textarea":Fe(r),Qe(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=Ti)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(o=9===i.nodeType?i:i.ownerDocument,e===Je&&(e=et(n)),e===Je?"script"===n?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),"select"===n&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Di]=t,e[Fi]=r,Ps(e,t),t.stateNode=e,o=pt(n,r),n){case"dialog":di("cancel",e),di("close",e),i=r;break;case"iframe":case"object":case"embed":di("load",e),i=r;break;case"video":case"audio":for(i=0;i<ci.length;i++)di(ci[i],e);i=r;break;case"source":di("error",e),i=r;break;case"img":case"image":case"link":di("error",e),di("load",e),i=r;break;case"details":di("toggle",e),i=r;break;case"input":ze(e,r),i=Be(e,r),di("invalid",e);break;case"option":i=Xe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=W({},r,{value:void 0}),di("invalid",e);break;case"textarea":Ze(e,r),i=qe(e,r),di("invalid",e);break;default:i=r}ft(n,i);var s=i;for(a in s)if(s.hasOwnProperty(a)){var u=s[a];"style"===a?lt(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&it(e,u):"children"===a?"string"==typeof u?("textarea"!==n||""!==u)&&at(e,u):"number"==typeof u&&at(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(Z.hasOwnProperty(a)?null!=u&&"onScroll"===a&&di("scroll",e):null!=u&&se(e,a,u,o))}switch(n){case"input":Fe(e),Ge(e,r,!1);break;case"textarea":Fe(e),Qe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Ne(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?Ye(e,!!r.multiple,a,!1):null!=r.defaultValue&&Ye(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Ti)}Ci(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Ls(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(Y(166));n=yo(mo.current),yo(ho.current),Ro(t)?(r=t.stateNode,n=t.memoizedProps,r[Di]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Di]=t,t.stateNode=r)}return null;case 13:return qi(xo),r=t.memoizedState,0!=(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Ro(t):n=null!==e.memoizedState,r&&!n&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&xo.current)?0===xu&&(xu=3):(0!==xu&&3!==xu||(xu=4),null===yu||0==(134217727&Au)&&0==(134217727&wu)||nl(yu,_u))),(r||n)&&(t.flags|=4),null);case 4:return _o(),null===e&&mi(t.stateNode.containerInfo),null;case 10:return za(t),null;case 17:return ta(t.type)&&na(),null;case 19:if(qi(xo),null===(r=t.memoizedState))return null;if(a=0!=(64&t.flags),null===(o=r.rendering))if(a)Gs(r,!1);else{if(0!==xu||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(o=So(e))){for(t.flags|=64,Gs(r,!1),null!==(a=o.updateQueue)&&(t.updateQueue=a,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(o=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Zi(xo,1&xo.current|2),t.child}e=e.sibling}null!==r.tail&&Ca()>Mu&&(t.flags|=64,a=!0,Gs(r,!1),t.lanes=33554432)}else{if(!a)if(null!==(e=So(o))){if(t.flags|=64,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!wo)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ca()-r.renderingStartTime>Mu&&1073741824!==n&&(t.flags|=64,a=!0,Gs(r,!1),t.lanes=33554432);r.isBackwards?(o.sibling=t.child,t.child=o):(null!==(n=r.last)?n.sibling=o:t.child=o,r.last=o)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ca(),n.sibling=null,t=xo.current,Zi(xo,a?1&t|2:1&t),n):null;case 23:case 24:return sl(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(Y(156,t.tag))}function Xs(e){switch(e.tag){case 1:ta(e.type)&&na();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(_o(),qi(Ji),qi(Qi),Lo(),0!=(64&(t=e.flags)))throw Error(Y(285));return e.flags=-4097&t|64,e;case 5:return Eo(e),null;case 13:return qi(xo),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return qi(xo),null;case 4:return _o(),null;case 10:return za(e),null;case 23:case 24:return sl(),null;default:return null}}function Ys(e,t){try{var n="",r=t;do{n+=Ie(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function qs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Ps=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Is=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,yo(ho.current);var a,o=null;switch(n){case"input":i=Be(e,i),r=Be(e,r),o=[];break;case"option":i=Xe(e,i),r=Xe(e,r),o=[];break;case"select":i=W({},i,{value:void 0}),r=W({},r,{value:void 0}),o=[];break;case"textarea":i=qe(e,i),r=qe(e,r),o=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Ti)}for(l in ft(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(Z.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(s=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(null!=u||null!=s))if("style"===l)if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(l,n)),n=u;else"dangerouslySetInnerHTML"===l?(u=u?u.__html:void 0,s=s?s.__html:void 0,null!=u&&s!==u&&(o=o||[]).push(l,u)):"children"===l?"string"!=typeof u&&"number"!=typeof u||(o=o||[]).push(l,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(Z.hasOwnProperty(l)?(null!=u&&"onScroll"===l&&di("scroll",e),o||s===u||(o=[])):"object"==typeof u&&null!==u&&u.$$typeof===xe?u.toString():(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ls=function(e,t,n,r){n!==r&&(t.flags|=4)};var Zs="function"==typeof WeakMap?WeakMap:Map;function Ks(e,t,n){(n=qa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Lu||(Lu=!0,Nu=r),qs(0,t)},n}function Qs(e,t,n){(n=qa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return qs(0,t),r(i)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Du?Du=new Set([this]):Du.add(this),qs(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var Js="function"==typeof WeakSet?WeakSet:Set;function $s(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(n){Tl(e,n)}else t.current=null}function eu(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Na(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Ri(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(Y(163))}function tu(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3==(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!=(4&(i=i.tag))&&0!=(1&i)&&(El(n,e),bl(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Na(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&Ja(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}Ja(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Ci(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&cn(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Y(163))}function nu(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=ut("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ru(e,t){if(ua&&"function"==typeof ua.onCommitFiberUnmount)try{ua.onCommitFiberUnmount(sa,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!=(4&r))El(t,n);else{r=t;try{i()}catch(a){Tl(r,a)}}n=n.next}while(n!==e)}break;case 1:if($s(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Tl(t,a)}break;case 5:$s(t);break;case 4:lu(e,t)}}function iu(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function au(e){return 5===e.tag||3===e.tag||4===e.tag}function ou(e){e:{for(var t=e.return;null!==t;){if(au(t))break e;t=t.return}throw Error(Y(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(Y(161))}16&n.flags&&(at(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||au(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?su(e,n,t):uu(e,n,t)}function su(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Ti));else if(4!==r&&null!==(e=e.child))for(su(e,t,n),e=e.sibling;null!==e;)su(e,t,n),e=e.sibling}function uu(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}function lu(e,t){for(var n,r,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(Y(160));switch(n=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag){e:for(var o=e,s=i,u=s;;)if(ru(o,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===s)break e;for(;null===u.sibling;){if(null===u.return||u.return===s)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(o=n,s=i.stateNode,8===o.nodeType?o.parentNode.removeChild(s):o.removeChild(s)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(ru(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function cu(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(n[Fi]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Ve(n,r),pt(e,i),t=pt(e,r),i=0;i<a.length;i+=2){var o=a[i],s=a[i+1];"style"===o?lt(n,s):"dangerouslySetInnerHTML"===o?it(n,s):"children"===o?at(n,s):se(n,o,s,t)}switch(e){case"input":He(n,r);break;case"textarea":Ke(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(a=r.value)?Ye(n,!!r.multiple,a,!1):e!==!!r.multiple&&(null!=r.defaultValue?Ye(n,!!r.multiple,r.defaultValue,!0):Ye(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(Y(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,cn(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Ou=Ca(),nu(t.child,!0)),void fu(t);case 19:return void fu(t);case 17:return;case 23:case 24:return void nu(t,null!==t.memoizedState)}throw Error(Y(163))}function fu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=wl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function pu(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var hu=Math.ceil,du=ue.ReactCurrentDispatcher,vu=ue.ReactCurrentOwner,mu=0,yu=null,gu=null,_u=0,bu=0,Eu=Yi(0),xu=0,Su=null,Tu=0,Au=0,wu=0,Cu=0,ku=null,Ou=0,Mu=1/0;function Ru(){Mu=Ca()+500}var Pu,Iu=null,Lu=!1,Nu=null,Du=null,Fu=!1,ju=null,Uu=90,Bu=[],zu=[],Vu=null,Hu=0,Gu=null,Wu=-1,Xu=0,Yu=0,qu=null,Zu=!1;function Ku(){return 0!=(48&mu)?Ca():-1!==Wu?Wu:Wu=Ca()}function Qu(e){if(0==(2&(e=e.mode)))return 1;if(0==(4&e))return 99===ka()?1:2;if(0===Xu&&(Xu=Tu),0!==La.transition){0!==Yu&&(Yu=null!==ku?ku.pendingLanes:0),e=Xu;var t=4186112&~Yu;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=ka(),0!=(4&mu)&&98===e?e=kn(12,Xu):e=kn(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Xu),e}function Ju(e,t,n){if(50<Hu)throw Hu=0,Gu=null,Error(Y(185));if(null===(e=$u(e,t)))return null;Rn(e,t,n),e===yu&&(wu|=t,4===xu&&nl(e,_u));var r=ka();1===t?0!=(8&mu)&&0==(48&mu)?rl(e):(el(e,n),0===mu&&(Ru(),Pa())):(0==(4&mu)||98!==r&&99!==r||(null===Vu?Vu=new Set([e]):Vu.add(e)),el(e,n)),ku=e}function $u(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function el(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Pn(o),u=1<<s,l=a[s];if(-1===l){if(0==(u&r)||0!=(u&i)){l=t,An(u);var c=Tn;a[s]=10<=c?l+250:6<=c?l+5e3:-1}}else l<=t&&(e.expiredLanes|=u);o&=~u}if(r=wn(e,e===yu?_u:0),t=Tn,0===r)null!==n&&(n!==Ea&&fa(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Ea&&fa(n)}15===t?(n=rl.bind(null,e),null===Sa?(Sa=[n],Ta=ca(ma,Ia)):Sa.push(n),n=Ea):14===t?n=Ra(99,rl.bind(null,e)):n=Ra(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Y(358,e))}}(t),tl.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function tl(e){if(Wu=-1,Yu=Xu=0,0!=(48&mu))throw Error(Y(327));var t=e.callbackNode;if(_l()&&e.callbackNode!==t)return null;var n=wn(e,e===yu?_u:0);if(0===n)return null;var r=n,i=mu;mu|=16;var a=cl();for(yu===e&&_u===r||(Ru(),ul(e,r));;)try{hl();break}catch(s){ll(e,s)}if(Ba(),du.current=a,mu=i,null!==gu?r=0:(yu=null,_u=0,r=xu),0!=(Tu&wu))ul(e,0);else if(0!==r){if(2===r&&(mu|=64,e.hydrate&&(e.hydrate=!1,Ri(e.containerInfo)),0!==(n=Cn(e))&&(r=fl(e,n))),1===r)throw t=Su,ul(e,0),nl(e,n),el(e,Ca()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(Y(345));case 2:ml(e);break;case 3:if(nl(e,n),(62914560&n)===n&&10<(r=Ou+500-Ca())){if(0!==wn(e,0))break;if(((i=e.suspendedLanes)&n)!==n){Ku(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Oi(ml.bind(null,e),r);break}ml(e);break;case 4:if(nl(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var o=31-Pn(n);a=1<<o,(o=r[o])>i&&(i=o),n&=~a}if(n=i,10<(n=(120>(n=Ca()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hu(n/1960))-n)){e.timeoutHandle=Oi(ml.bind(null,e),n);break}ml(e);break;case 5:ml(e);break;default:throw Error(Y(329))}}return el(e,Ca()),e.callbackNode===t?tl.bind(null,e):null}function nl(e,t){for(t&=~Cu,t&=~wu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Pn(t),r=1<<n;e[n]=-1,t&=~r}}function rl(e){if(0!=(48&mu))throw Error(Y(327));if(_l(),e===yu&&0!=(e.expiredLanes&_u)){var t=_u,n=fl(e,t);0!=(Tu&wu)&&(n=fl(e,t=wn(e,t)))}else n=fl(e,t=wn(e,0));if(0!==e.tag&&2===n&&(mu|=64,e.hydrate&&(e.hydrate=!1,Ri(e.containerInfo)),0!==(t=Cn(e))&&(n=fl(e,t))),1===n)throw n=Su,ul(e,0),nl(e,t),el(e,Ca()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,ml(e),el(e,Ca()),null}function il(e,t){var n=mu;mu|=1;try{return e(t)}finally{0===(mu=n)&&(Ru(),Pa())}}function al(e,t){var n=mu;mu&=-2,mu|=8;try{return e(t)}finally{0===(mu=n)&&(Ru(),Pa())}}function ol(e,t){Zi(Eu,bu),bu|=t,Tu|=t}function sl(){bu=Eu.current,qi(Eu)}function ul(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Mi(n)),null!==gu)for(n=gu.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&na();break;case 3:_o(),qi(Ji),qi(Qi),Lo();break;case 5:Eo(r);break;case 4:_o();break;case 13:case 19:qi(xo);break;case 10:za(r);break;case 23:case 24:sl()}n=n.return}yu=e,gu=Ml(e.current,null),_u=bu=Tu=t,xu=0,Su=null,Cu=wu=Au=0}function ll(e,t){for(;;){var n=gu;try{if(Ba(),No.current=ms,zo){for(var r=jo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}zo=!1}if(Fo=0,Bo=Uo=jo=null,Vo=!1,vu.current=null,null===n||null===n.return){xu=1,Su=t,gu=null;break}e:{var a=e,o=n.return,s=n,u=t;if(t=_u,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var l=u;if(0==(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var f=0!=(1&xo.current),p=o;do{var h;if(h=13===p.tag){var d=p.memoizedState;if(null!==d)h=null!==d.dehydrated;else{var v=p.memoizedProps;h=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!f)}}if(h){var m=p.updateQueue;if(null===m){var y=new Set;y.add(l),p.updateQueue=y}else m.add(l);if(0==(2&p.mode)){if(p.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var g=qa(-1,1);g.tag=2,Za(s,g)}s.lanes|=1;break e}u=void 0,s=t;var _=a.pingCache;if(null===_?(_=a.pingCache=new Zs,u=new Set,_.set(l,u)):void 0===(u=_.get(l))&&(u=new Set,_.set(l,u)),!u.has(s)){u.add(s);var b=Al.bind(null,a,l,s);l.then(b,b)}p.flags|=4096,p.lanes=t;break e}p=p.return}while(null!==p);u=Error((Le(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==xu&&(xu=2),u=Ys(u,s),p=o;do{switch(p.tag){case 3:a=u,p.flags|=4096,t&=-t,p.lanes|=t,Ka(p,Ks(0,a,t));break e;case 1:a=u;var E=p.type,x=p.stateNode;if(0==(64&p.flags)&&("function"==typeof E.getDerivedStateFromError||null!==x&&"function"==typeof x.componentDidCatch&&(null===Du||!Du.has(x)))){p.flags|=4096,t&=-t,p.lanes|=t,Ka(p,Qs(p,a,t));break e}}p=p.return}while(null!==p)}vl(n)}catch(S){t=S,gu===n&&null!==n&&(gu=n=n.return);continue}break}}function cl(){var e=du.current;return du.current=ms,null===e?ms:e}function fl(e,t){var n=mu;mu|=16;var r=cl();for(yu===e&&_u===t||ul(e,t);;)try{pl();break}catch(i){ll(e,i)}if(Ba(),mu=n,du.current=r,null!==gu)throw Error(Y(261));return yu=null,_u=0,xu}function pl(){for(;null!==gu;)dl(gu)}function hl(){for(;null!==gu&&!pa();)dl(gu)}function dl(e){var t=Pu(e.alternate,e,bu);e.memoizedProps=e.pendingProps,null===t?vl(e):gu=t,vu.current=null}function vl(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(n=Ws(n,t,bu)))return void(gu=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&bu)||0==(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=Xs(t)))return n.flags&=2047,void(gu=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(gu=t);gu=t=e}while(null!==t);0===xu&&(xu=5)}function ml(e){var t=ka();return Ma(99,yl.bind(null,e,t)),null}function yl(e,t){do{_l()}while(null!==ju);if(0!=(48&mu))throw Error(Y(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Y(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var o=e.eventTimes,s=e.expirationTimes;0<a;){var u=31-Pn(a),l=1<<u;i[u]=0,o[u]=-1,s[u]=-1,a&=~l}if(null!==Vu&&0==(24&r)&&Vu.has(e)&&Vu.delete(e),e===yu&&(gu=yu=null,_u=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=mu,mu|=32,vu.current=null,Ai=Fn,ti(o=ei())){if("selectionStart"in o)s={start:o.selectionStart,end:o.selectionEnd};else e:if(s=(s=o.ownerDocument)&&s.defaultView||window,(l=s.getSelection&&s.getSelection())&&0!==l.rangeCount){s=l.anchorNode,a=l.anchorOffset,u=l.focusNode,l=l.focusOffset;try{s.nodeType,u.nodeType}catch(A){s=null;break e}var c=0,f=-1,p=-1,h=0,d=0,v=o,m=null;t:for(;;){for(var y;v!==s||0!==a&&3!==v.nodeType||(f=c+a),v!==u||0!==l&&3!==v.nodeType||(p=c+l),3===v.nodeType&&(c+=v.nodeValue.length),null!==(y=v.firstChild);)m=v,v=y;for(;;){if(v===o)break t;if(m===s&&++h===a&&(f=c),m===u&&++d===l&&(p=c),null!==(y=v.nextSibling))break;m=(v=m).parentNode}v=y}s=-1===f||-1===p?null:{start:f,end:p}}else s=null;s=s||{start:0,end:0}}else s=null;wi={focusedElem:o,selectionRange:s},Fn=!1,qu=null,Zu=!1,Iu=r;do{try{gl()}catch(A){if(null===Iu)throw Error(Y(330));Tl(Iu,A),Iu=Iu.nextEffect}}while(null!==Iu);qu=null,Iu=r;do{try{for(o=e;null!==Iu;){var g=Iu.flags;if(16&g&&at(Iu.stateNode,""),128&g){var _=Iu.alternate;if(null!==_){var b=_.ref;null!==b&&("function"==typeof b?b(null):b.current=null)}}switch(1038&g){case 2:ou(Iu),Iu.flags&=-3;break;case 6:ou(Iu),Iu.flags&=-3,cu(Iu.alternate,Iu);break;case 1024:Iu.flags&=-1025;break;case 1028:Iu.flags&=-1025,cu(Iu.alternate,Iu);break;case 4:cu(Iu.alternate,Iu);break;case 8:lu(o,s=Iu);var E=s.alternate;iu(s),null!==E&&iu(E)}Iu=Iu.nextEffect}}catch(A){if(null===Iu)throw Error(Y(330));Tl(Iu,A),Iu=Iu.nextEffect}}while(null!==Iu);if(b=wi,_=ei(),g=b.focusedElem,o=b.selectionRange,_!==g&&g&&g.ownerDocument&&$r(g.ownerDocument.documentElement,g)){null!==o&&ti(g)&&(_=o.start,void 0===(b=o.end)&&(b=_),"selectionStart"in g?(g.selectionStart=_,g.selectionEnd=Math.min(b,g.value.length)):(b=(_=g.ownerDocument||document)&&_.defaultView||window).getSelection&&(b=b.getSelection(),s=g.textContent.length,E=Math.min(o.start,s),o=void 0===o.end?E:Math.min(o.end,s),!b.extend&&E>o&&(s=o,o=E,E=s),s=Jr(g,E),a=Jr(g,o),s&&a&&(1!==b.rangeCount||b.anchorNode!==s.node||b.anchorOffset!==s.offset||b.focusNode!==a.node||b.focusOffset!==a.offset)&&((_=_.createRange()).setStart(s.node,s.offset),b.removeAllRanges(),E>o?(b.addRange(_),b.extend(a.node,a.offset)):(_.setEnd(a.node,a.offset),b.addRange(_))))),_=[];for(b=g;b=b.parentNode;)1===b.nodeType&&_.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"==typeof g.focus&&g.focus(),g=0;g<_.length;g++)(b=_[g]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Fn=!!Ai,wi=Ai=null,e.current=n,Iu=r;do{try{for(g=e;null!==Iu;){var x=Iu.flags;if(36&x&&tu(g,Iu.alternate,Iu),128&x){_=void 0;var S=Iu.ref;if(null!==S){var T=Iu.stateNode;switch(Iu.tag){case 5:_=T;break;default:_=T}"function"==typeof S?S(_):S.current=_}}Iu=Iu.nextEffect}}catch(A){if(null===Iu)throw Error(Y(330));Tl(Iu,A),Iu=Iu.nextEffect}}while(null!==Iu);Iu=null,xa(),mu=i}else e.current=n;if(Fu)Fu=!1,ju=e,Uu=t;else for(Iu=r;null!==Iu;)t=Iu.nextEffect,Iu.nextEffect=null,8&Iu.flags&&((x=Iu).sibling=null,x.stateNode=null),Iu=t;if(0===(r=e.pendingLanes)&&(Du=null),1===r?e===Gu?Hu++:(Hu=0,Gu=e):Hu=0,n=n.stateNode,ua&&"function"==typeof ua.onCommitFiberRoot)try{ua.onCommitFiberRoot(sa,n,void 0,64==(64&n.current.flags))}catch(A){}if(el(e,Ca()),Lu)throw Lu=!1,e=Nu,Nu=null,e;return 0!=(8&mu)||Pa(),null}function gl(){for(;null!==Iu;){var e=Iu.alternate;Zu||null===qu||(0!=(8&Iu.flags)?zt(Iu,qu)&&(Zu=!0):13===Iu.tag&&pu(e,Iu)&&zt(Iu,qu)&&(Zu=!0));var t=Iu.flags;0!=(256&t)&&eu(e,Iu),0==(512&t)||Fu||(Fu=!0,Ra(97,(function(){return _l(),null}))),Iu=Iu.nextEffect}}function _l(){if(90!==Uu){var e=97<Uu?97:Uu;return Uu=90,Ma(e,xl)}return!1}function bl(e,t){Bu.push(t,e),Fu||(Fu=!0,Ra(97,(function(){return _l(),null})))}function El(e,t){zu.push(t,e),Fu||(Fu=!0,Ra(97,(function(){return _l(),null})))}function xl(){if(null===ju)return!1;var e=ju;if(ju=null,0!=(48&mu))throw Error(Y(331));var t=mu;mu|=32;var n=zu;zu=[];for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1],o=i.destroy;if(i.destroy=void 0,"function"==typeof o)try{o()}catch(u){if(null===a)throw Error(Y(330));Tl(a,u)}}for(n=Bu,Bu=[],r=0;r<n.length;r+=2){i=n[r],a=n[r+1];try{var s=i.create;i.destroy=s()}catch(u){if(null===a)throw Error(Y(330));Tl(a,u)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return mu=t,Pa(),!0}function Sl(e,t,n){Za(e,t=Ks(0,t=Ys(n,t),1)),t=Ku(),null!==(e=$u(e,1))&&(Rn(e,1,t),el(e,t))}function Tl(e,t){if(3===e.tag)Sl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Sl(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Du||!Du.has(r))){var i=Qs(n,e=Ys(t,e),1);if(Za(n,i),i=Ku(),null!==(n=$u(n,1)))Rn(n,1,i),el(n,i);else if("function"==typeof r.componentDidCatch&&(null===Du||!Du.has(r)))try{r.componentDidCatch(t,e)}catch(a){}break}}n=n.return}}function Al(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ku(),e.pingedLanes|=e.suspendedLanes&n,yu===e&&(_u&n)===n&&(4===xu||3===xu&&(62914560&_u)===_u&&500>Ca()-Ou?ul(e,0):Cu|=n),el(e,t)}function wl(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===ka()?1:2:(0===Xu&&(Xu=Tu),0===(t=On(62914560&~Xu))&&(t=4194304))),n=Ku(),null!==(e=$u(e,t))&&(Rn(e,t,n),el(e,n))}function Cl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function kl(e,t,n,r){return new Cl(e,t,n,r)}function Ol(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ml(e,t){var n=e.alternate;return null===n?((n=kl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,r,i,a){var o=2;if(r=e,"function"==typeof e)Ol(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case fe:return Pl(n.children,i,a,t);case Se:o=8,i|=16;break;case pe:o=8,i|=1;break;case he:return(e=kl(12,n,t,8|i)).elementType=he,e.type=he,e.lanes=a,e;case ye:return(e=kl(13,n,t,i)).type=ye,e.elementType=ye,e.lanes=a,e;case ge:return(e=kl(19,n,t,i)).elementType=ge,e.lanes=a,e;case Te:return Il(n,i,a,t);case Ae:return(e=kl(24,n,t,i)).elementType=Ae,e.lanes=a,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case de:o=10;break e;case ve:o=9;break e;case me:o=11;break e;case _e:o=14;break e;case be:o=16,r=null;break e;case Ee:o=22;break e}throw Error(Y(130,null==e?e:typeof e,""))}return(t=kl(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Pl(e,t,n,r){return(e=kl(7,e,r,t)).lanes=n,e}function Il(e,t,n,r){return(e=kl(23,e,r,t)).elementType=Te,e.lanes=n,e}function Ll(e,t,n){return(e=kl(6,e,null,t)).lanes=n,e}function Nl(e,t,n){return(t=kl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Dl(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Mn(0),this.expirationTimes=Mn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mn(0),this.mutableSourceEagerHydrationData=null}function Fl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ce,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function jl(e,t,n,r){var i=t.current,a=Ku(),o=Qu(i);e:if(n){t:{if(Ft(n=n._reactInternals)!==n||1!==n.tag)throw Error(Y(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(ta(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(Y(171))}if(1===n.tag){var u=n.type;if(ta(u)){n=ia(n,u,s);break e}}n=s}else n=Ki;return null===t.context?t.context=n:t.pendingContext=n,(t=qa(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),Za(i,t),Ju(i,o,a),o}function Ul(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Bl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zl(e,t){Bl(e,t),(e=e.alternate)&&Bl(e,t)}function Vl(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Dl(e,t,null!=n&&!0===n.hydrate),t=kl(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,Xa(t),e[ji]=n.current,mi(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function Hl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Gl(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"==typeof i){var s=i;i=function(){var e=Ul(o);s.call(e)}}jl(t,o,e,i)}else{if(a=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Vl(e,0,t?{hydrate:!0}:void 0)}(n,r),o=a._internalRoot,"function"==typeof i){var u=i;i=function(){var e=Ul(o);u.call(e)}}al((function(){jl(t,o,e,i)}))}return Ul(o)}function Wl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Hl(t))throw Error(Y(200));return Fl(e,t,null,n)}Pu=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||Ji.current)Es=!0;else{if(0==(n&r)){switch(Es=!1,t.tag){case 3:Rs(t),Po();break;case 5:bo(t);break;case 1:ta(t.type)&&aa(t);break;case 4:go(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;Zi(Da,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!=(n&t.child.childLanes)?Ds(e,t,n):(Zi(xo,1&xo.current),null!==(t=Hs(e,t,n))?t.sibling:null);Zi(xo,1&xo.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(64&e.flags)){if(r)return Vs(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Zi(xo,xo.current),r)break;return null;case 23:case 24:return t.lanes=0,ws(e,t,n)}return Hs(e,t,n)}Es=0!=(16384&e.flags)}else Es=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=ea(t,Qi.current),Ha(t,n),i=Wo(null,t,r,e,i,n),t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,ta(r)){var a=!0;aa(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Xa(t);var o=r.getDerivedStateFromProps;"function"==typeof o&&eo(t,r,o,e),i.updater=to,t.stateNode=i,i._reactInternals=t,ao(t,r,e,n),t=Ms(null,t,r,!0,a,n)}else t.tag=0,xs(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"==typeof e)return Ol(e)?1:0;if(null!=e){if((e=e.$$typeof)===me)return 11;if(e===_e)return 14}return 2}(i),e=Na(i,e),a){case 0:t=ks(null,t,i,e,n);break e;case 1:t=Os(null,t,i,e,n);break e;case 11:t=Ss(null,t,i,e,n);break e;case 14:t=Ts(null,t,i,Na(i.type,e),r,n);break e}throw Error(Y(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,ks(e,t,r,i=t.elementType===r?i:Na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Os(e,t,r,i=t.elementType===r?i:Na(r,i),n);case 3:if(Rs(t),r=t.updateQueue,null===e||null===r)throw Error(Y(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,Ya(e,t),Qa(t,r,null,n),(r=t.memoizedState.element)===i)Po(),t=Hs(e,t,n);else{if((a=(i=t.stateNode).hydrate)&&(Ao=Pi(t.stateNode.containerInfo.firstChild),To=t,a=wo=!0),a){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(a=e[i])._workInProgressVersionPrimary=e[i+1],Io.push(a);for(n=fo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else xs(e,t,r,n),Po();t=t.child}return t;case 5:return bo(t),null===e&&Oo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ki(r,i)?o=null:null!==a&&ki(r,a)&&(t.flags|=16),Cs(e,t),xs(e,t,o,n),t.child;case 6:return null===e&&Oo(t),null;case 13:return Ds(e,t,n);case 4:return go(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=co(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ss(e,t,r,i=t.elementType===r?i:Na(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value;var s=t.type._context;if(Zi(Da,s._currentValue),s._currentValue=a,null!==o)if(s=o.value,0===(a=qr(s,a)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(s,a):1073741823))){if(o.children===i.children&&!Ji.current){t=Hs(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var u=s.dependencies;if(null!==u){o=s.child;for(var l=u.firstContext;null!==l;){if(l.context===r&&0!=(l.observedBits&a)){1===s.tag&&((l=qa(-1,n&-n)).tag=2,Za(s,l)),s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Va(s.return,n),u.lanes|=n;break}l=l.next}}else o=10===s.tag&&s.type===t.type?null:s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(a=t.pendingProps).children,Ha(t,n),r=r(i=Ga(i,a.unstable_observedBits)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return a=Na(i=t.type,t.pendingProps),Ts(e,t,i,a=Na(i.type,a),r,n);case 15:return As(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Na(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ta(r)?(e=!0,aa(t)):e=!1,Ha(t,n),ro(t,r,i),ao(t,r,i,n),Ms(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 23:case 24:return ws(e,t,n)}throw Error(Y(156,t.tag))},Vl.prototype.render=function(e){jl(e,this._internalRoot,null,null)},Vl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;jl(null,e,null,(function(){t[ji]=null}))},Vt=function(e){13===e.tag&&(Ju(e,4,Ku()),zl(e,4))},Ht=function(e){13===e.tag&&(Ju(e,67108864,Ku()),zl(e,67108864))},Gt=function(e){if(13===e.tag){var t=Ku(),n=Qu(e);Ju(e,n,t),zl(e,n)}},Wt=function(e,t){return t()},dt=function(e,t,n){switch(t){case"input":if(He(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Hi(r);if(!i)throw Error(Y(90));je(r),He(r,i)}}}break;case"textarea":Ke(e,n);break;case"select":null!=(t=n.value)&&Ye(e,!!n.multiple,t,!1)}},bt=il,Et=function(e,t,n,r,i){var a=mu;mu|=4;try{return Ma(98,e.bind(null,t,n,r,i))}finally{0===(mu=a)&&(Ru(),Pa())}},xt=function(){0==(49&mu)&&(function(){if(null!==Vu){var e=Vu;Vu=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,el(e,Ca())}))}Pa()}(),_l())},St=function(e,t){var n=mu;mu|=2;try{return e(t)}finally{0===(mu=n)&&(Ru(),Pa())}};var Xl={Events:[zi,Vi,Hi,gt,_t,_l,{current:!1}]},Yl={findFiberByHostInstance:Bi,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},ql={bundleType:Yl.bundleType,version:Yl.version,rendererPackageName:Yl.rendererPackageName,rendererConfig:Yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ue.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Bt(e))?null:e.stateNode},findFiberByHostInstance:Yl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zl.isDisabled&&Zl.supportsFiber)try{sa=Zl.inject(ql),ua=Zl}catch(rt){}}z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xl,z.createPortal=Wl,z.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(Y(188));throw Error(Y(268,Object.keys(e)))}return e=null===(e=Bt(t))?null:e.stateNode},z.flushSync=function(e,t){var n=mu;if(0!=(48&n))return e(t);mu|=1;try{if(e)return Ma(99,e.bind(null,t))}finally{mu=n,Pa()}},z.hydrate=function(e,t,n){if(!Hl(t))throw Error(Y(200));return Gl(null,e,t,!0,n)},z.render=function(e,t,n){if(!Hl(t))throw Error(Y(200));return Gl(null,e,t,!1,n)},z.unmountComponentAtNode=function(e){if(!Hl(e))throw Error(Y(40));return!!e._reactRootContainer&&(al((function(){Gl(null,null,e,!1,(function(){e._reactRootContainer=null,e[ji]=null}))})),!0)},z.unstable_batchedUpdates=il,z.unstable_createPortal=function(e,t){return Wl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},z.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Hl(n))throw Error(Y(200));if(null==e||void 0===e._reactInternals)throw Error(Y(38));return Gl(e,t,n,!1,r)},z.version="17.0.2",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),B.exports=z;var Kl=B.exports,Ql={},Jl={},$l=function(e){return Jl[e]},ec=function(e,t){Jl[e]=t},tc=function(e,t){Ql[e]=t},nc={},rc={};function ic(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function ac(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function oc(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function sc(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+oc(-t,6):t>9999?"+"+oc(t,6):oc(t,4))+"-"+oc(e.getUTCMonth()+1,2)+"-"+oc(e.getUTCDate(),2)+(a?"T"+oc(n,2)+":"+oc(r,2)+":"+oc(i,2)+"."+oc(a,3)+"Z":i?"T"+oc(n,2)+":"+oc(r,2)+":"+oc(i,2)+"Z":r||n?"T"+oc(n,2)+":"+oc(r,2)+"Z":"")}var uc=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],a=e.length,o=0,s=0,u=a<=0,l=!1;function c(){if(u)return rc;if(l)return l=!1,nc;var t,r,i=o;if(34===e.charCodeAt(i)){for(;o++<a&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=a?u=!0:10===(r=e.charCodeAt(o++))?l=!0:13===r&&(l=!0,10===e.charCodeAt(o)&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<a;){if(10===(r=e.charCodeAt(t=o++)))l=!0;else if(13===r)l=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,a)}for(10===e.charCodeAt(a-1)&&--a,13===e.charCodeAt(a-1)&&--a;(r=c())!==rc;){for(var f=[];r!==nc&&r!==rc;)f.push(r),r=c();t&&null==(f=t(f,s++))||i.push(f)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function a(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?sc(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,a=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=ic(e);return function(r,i){return t(n(r),i,e)}}(e,t):ic(e)}));return a.columns=i||[],a},parseRows:r,format:function(t,n){return null==n&&(n=ac(t)),[n.map(o).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=ac(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(a).join("\n")},formatRow:a,formatValue:o}}(",").parse;function lc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fc(e,t){if(e){if("string"==typeof e)return cc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cc(e,t):void 0}}function pc(e){return function(e){if(Array.isArray(e))return cc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var hc={},dc={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142},vc=dc;function mc(e){var t=0;if(e&&e.length>0){t+=Math.abs(yc(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(yc(e[n]))}return t}function yc(e){var t,n,r,i,a,o,s=0,u=e.length;if(u>2){for(o=0;o<u;o++)o===u-2?(r=u-2,i=u-1,a=0):o===u-1?(r=u-1,i=0,a=1):(r=o,i=o+1,a=o+2),t=e[r],n=e[i],s+=(gc(e[a][0])-gc(t[0]))*Math.sin(gc(n[1]));s=s*vc.RADIUS*vc.RADIUS/2}return s}function gc(e){return e*Math.PI/180}hc.geometry=function e(t){var n,r=0;switch(t.type){case"Polygon":return mc(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)r+=mc(t.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<t.geometries.length;n++)r+=e(t.geometries[n]);return r}},hc.ring=yc;var _c=hc,bc=function e(t,n){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(Ec(e,n)),t;case"GeometryCollection":return t.geometries=t.geometries.map(Ec(e,n)),t;case"Feature":return t.geometry=e(t.geometry,n),t;case"Polygon":case"MultiPolygon":return function(e,t){"Polygon"===e.type?e.coordinates=xc(e.coordinates,t):"MultiPolygon"===e.type&&(e.coordinates=e.coordinates.map(Ec(xc,t)));return e}(t,n);default:return t}};function Ec(e,t){return function(n){return e(n,t)}}function xc(e,t){t=!!t,e[0]=Sc(e[0],t);for(var n=1;n<e.length;n++)e[n]=Sc(e[n],!t);return e}function Sc(e,t){return function(e){return _c.ring(e)>=0}(e)===t?e:e.reverse()}function Tc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ac(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tc(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wc(e,t){var n=t.x,r=t.y,i=t.x1,a=t.y1,o=t.coordinates,s=[];return e.forEach((function(e,t){var u=[];(n&&r&&(u=[parseFloat(e[n]),parseFloat(e[r])]),n&&r&&i&&a)&&(u=[[parseFloat(e[n]),parseFloat(e[r])],[parseFloat(e[i]),parseFloat(e[a])]]);if(o){var l="Polygon";Array.isArray(o[0])||(l="Point"),Array.isArray(o[0])&&!Array.isArray(o[0][0])&&(l="LineString");var c={type:l,coordinates:pc(e[o])};bc(c,!0),u=c.coordinates}var f=Ac(Ac({},e),{},{_id:t,coordinates:u});s.push(f)})),{dataArray:s}}var Cc={centimeters:637100880,centimetres:637100880,degrees:6371008.8/111325,feet:20902260.511392,inches:6371008.8*39.37,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:6371008.8/1852,radians:1,yards:6371008.8*1.0936};function kc(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function Oc(e){return e%360*Math.PI/180}function Mc(e,t){!function(e,t){var n,r,i,a,o,s,u,l,c,f,p=0,h="FeatureCollection"===e.type,d="Feature"===e.type,v=h?e.features.length:1;for(n=0;n<v;n++){for(s=h?e.features[n].geometry:d?e.geometry:e,l=h?e.features[n].properties:d?e.properties:{},c=h?e.features[n].bbox:d?e.bbox:void 0,f=h?e.features[n].id:d?e.id:void 0,o=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<o;i++)if(null!==(a=u?s.geometries[i]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(a,p,l,c,f))return!1;break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===t(a.geometries[r],p,l,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,p,l,c,f))return!1;p++}}(e,(function(e,n,r,i,a){var o,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(kc(e,r,{bbox:i,id:a}),n,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var u=0;u<e.coordinates.length;u++){var l=e.coordinates[u];if(!1===t(kc({type:o,coordinates:l},r),n,u))return!1}}))}function Rc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rc(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ic(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||fc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Lc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Nc(e){this.message=e}function Dc(e){for(var t,n,r,i,a="",o=0,s=(e=String(e)).length%3;o<e.length;){if((n=e.charCodeAt(o++))>255||(r=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");a+=Lc.charAt((t=n<<16|r<<8|i)>>18&63)+Lc.charAt(t>>12&63)+Lc.charAt(t>>6&63)+Lc.charAt(63&t)}return s?a.slice(0,s-3)+"===".substring(s):a}function Fc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uc(e,t,n){return t&&jc(e.prototype,t),n&&jc(e,n),e}Nc.prototype=new Error,Nc.prototype.name="InvalidCharacterError";var Bc,zc=function(){function e(t,n){Fc(this,e),this.buffers=t,this.type=n}return Uc(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(e,t,n){throw new Error("not implemented")}}]),e}();Bc="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(e){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(e){return null},clearMeasures:function(e){return null},clearMarks:function(e){return null},measure:function(e,t,n){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(e){return!0},Event:function(e,t){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window;var Vc="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast?my.getSystemInfoSync().pixelRatio:Bc.devicePixelRatio;function Hc(e,t){return(Hc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hc(e,t)}function Wc(e){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yc(e,t){if(t&&("object"===Wc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Xc(e)}function qc(e){return(qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zc=function e(t,n){Fc(this,e),lc(this,"cancelBubble",void 0),lc(this,"cancelable",void 0),lc(this,"target",void 0),lc(this,"currentTarget",void 0),lc(this,"preventDefault",void 0),lc(this,"stopPropagation",void 0),lc(this,"type",void 0),lc(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=t,this.timeStamp=Date.now()};function Kc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Qc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qc(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Qc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jc=new WeakMap,$c=function(){function e(){Fc(this,e),Jc.set(this,{})}return Uc(e,[{key:"addEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Jc.get(this);r||(r={}),r[e]||(r[e]=[]),r[e].push(t),Jc.set(this,r),n.capture,n.once,n.passive}},{key:"removeEventListener",value:function(e,t){var n=Jc.get(this);if(n){var r=n[e];if(r&&r.length>0)for(var i=r.length;i--;i>0)if(r[i]===t){r.splice(i,1);break}}}},{key:"dispatchEvent",value:function(e){var t=Jc.get(this)[e.type];if(t){var n,r=Kc(t);try{for(r.s();!(n=r.n()).done;){(0,n.value)(e)}}catch(i){r.e(i)}finally{r.f()}}}}]),e}();function ef(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var tf=function(e){Gc(n,$c);var t=ef(n);function n(){var e;return Fc(this,n),lc(Xc(e=t.call(this)),"childNodes",void 0),e.childNodes=[],e}return Uc(n,[{key:"appendChild",value:function(e){this.childNodes.push(e)}},{key:"cloneNode",value:function(){var e=Object.create(this);return Object.assign(e,this),e}},{key:"removeChild",value:function(e){var t=this.childNodes.findIndex((function(t){return t===e}));return t>-1?this.childNodes.splice(t,1):null}}]),n}();function nf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var rf,af,of,sf,uf=function(e){Gc(n,tf);var t=nf(n);function n(){var e;return Fc(this,n),lc(Xc(e=t.call(this)),"className",void 0),lc(Xc(e),"children",void 0),e.className="",e.children=[],e}return Uc(n,[{key:"setAttribute",value:function(e,t){this[e]=t}},{key:"getAttribute",value:function(e){return this[e]}},{key:"setAttributeNS",value:function(e,t){this[e]=t}},{key:"getAttributeNS",value:function(e){return this[e]}}]),n}();if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast){var lf=my.getSystemInfoSync();rf=lf.screenWidth,af=lf.screenHeight,of=lf.windowWidth,sf=lf.windowHeight}else{var cf=Bc.innerWidth,ff=Bc.innerHeight;rf=cf,af=ff,of=cf,sf=ff}var pf={width:rf,height:af,availWidth:of,availHeight:sf,availLeft:0,availTop:0},hf=pf.availWidth,df=pf.availHeight,vf={style:[]};function mf(e,t){var n,r;"parentNode"in e||(n=0===t?function(){return null}:1===t?function(){return vf}:function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:n}));"parentElement"in e||(r=0===t?function(){return null}:1===t?function(){return vf}:function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:r}))}function yf(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:hf+"px",height:df+"px",margin:"0px",padding:"0px"})}function gf(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=hf,e.clientHeight=df),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function _f(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=hf,e.offsetHeight=df)}function bf(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=hf,e.scrollHeight=df)}function Ef(e){var t=function(){return!0};e.classList=[],e.classList.add=t,e.classList.remove=t,e.classList.contains=t,e.classList.toggle=t}function xf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function Sf(){}var Tf=function(e){Gc(n,uf);var t=xf(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;return Fc(this,n),lc(Xc(e=t.call(this)),"className",void 0),lc(Xc(e),"children",void 0),lc(Xc(e),"focus",void 0),lc(Xc(e),"blur",void 0),lc(Xc(e),"insertBefore",void 0),lc(Xc(e),"appendChild",void 0),lc(Xc(e),"removeChild",void 0),lc(Xc(e),"remove",void 0),lc(Xc(e),"innerHTML",void 0),lc(Xc(e),"tagName",void 0),e.className="",e.children=[],e.focus=Sf,e.blur=Sf,e.insertBefore=Sf,e.appendChild=Sf,e.removeChild=Sf,e.remove=Sf,e.innerHTML="",e.tagName=r.toUpperCase(),mf(Xc(e),i),yf(Xc(e)),Ef(Xc(e)),gf(Xc(e)),_f(Xc(e)),bf(Xc(e)),e}return n}();function Af(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var wf=function(e){Gc(n,Tf);var t=Af(n);function n(e){return Fc(this,n),t.call(this,e)}return Uc(n,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),n}();function Cf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var kf=function(e){Gc(n,wf);var t=Cf(n);function n(){return Fc(this,n),t.call(this,"video")}return n}(),Of={};function Mf(){return Of}var Rf=function e(){Fc(this,e);var t=Mf(),n=t.createImage&&t.createImage()||{};return"tagName"in n||(n.tagName="IMG",n.__proto__=e.prototype),mf(n),Ef(n),Object.assign(n,{addEventListener:function(e,t){n["on".concat(e)]=t.bind(n)},removeEventListener:function(e){n["on".concat(e)]=null}}),n},Pf={href:"",protocol:"",host:""};function If(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Lf=function(e){Gc(n,Tf);var t=If(n);function n(){return Fc(this,n),t.call(this,"body",0)}return Uc(n,[{key:"addEventListener",value:function(e,t){}},{key:"removeEventListener",value:function(e,t,n){}},{key:"dispatchEvent",value:function(e){}}]),n}(),Nf=function(e){Gc(n,Tf);var t=If(n);function n(){return Fc(this,n),t.call(this,"html",0)}return Uc(n,[{key:"addEventListener",value:function(e,t){}},{key:"removeEventListener",value:function(e,t){}},{key:"dispatchEvent",value:function(e){}}]),n}(),Df={},Ff={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Pf,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(e){return"canvas"===(e=e.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===e?new Rf:"video"===e?new kf:new Tf(e)},createElementNS:function(e,t){return this.createElement(t)},createTextNode:function(e){return e},getElementById:function(e){return null},getElementsByTagName:function(e){return e=e.toLowerCase(),[]},getElementsByTagNameNS:function(e,t){return this.getElementsByTagName(t)},getElementsByName:function(e){return[]},querySelector:function(e){return null},querySelectorAll:function(e){return[]},addEventListener:function(e,t,n){Df[e]||(Df[e]=[]),Df[e].push(t)},removeEventListener:function(e,t){var n=Df[e];if(n&&n.length>0)for(var r=n.length;r--;r>0)if(n[r]===t){n.splice(r,1);break}},dispatchEvent:function(e){var t=e.type,n=Df[t];if(n)for(var r=0;r<n.length;r++)n[r](e);e.target&&"function"==typeof e.target["on"+t]&&e.target["on"+t](e)},createEvent:function(e){return new Zc(e)}};Ff.documentElement=new Nf,Ff.head=new Tf("head"),Ff.body=new Lf;var jf,Uf,Bf,zf,Vf=Object,Hf=function(){function e(){Fc(this,e),lc(this,"_w",void 0),lc(this,"_h",void 0),lc(this,"_data",void 0);var t=arguments.length;if(2===t){if("number"==typeof arguments[0]&&"number"==typeof arguments[1])return this._w=arguments[0],this._h=arguments[1],void(this._data=new Uint8ClampedArray(this._w*this._h*4))}else 3===t&&"object"===Wc(arguments[0])&&"number"==typeof arguments[1]&&"number"==typeof arguments[2]&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return Uc(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}();if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast){var Gf=my.getSystemInfoSync();jf=Gf.system,Uf=Gf.platform,Bf=Gf.language}else{var Wf={versions:(zf=Bc.navigator.userAgent,{trident:zf.indexOf("Trident")>-1,presto:zf.indexOf("Presto")>-1,webKit:zf.indexOf("AppleWebKit")>-1,gecko:zf.indexOf("Gecko")>-1&&-1===zf.indexOf("KHTML"),mobile:!!zf.match(/AppleWebKit.*Mobile.*/),ios:!!zf.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:zf.indexOf("Android")>-1||zf.indexOf("Linux")>-1,iPhone:zf.indexOf("iPhone")>-1,iPad:zf.indexOf("iPad")>-1,webApp:-1===zf.indexOf("Safari"),weixin:zf.indexOf("MicroMessenger")>-1,qq:" qq"===zf.match(/\sQQ/i)}),language:(Bc.navigator.browserLanguage||Bc.navigator.language).toLowerCase()};Wf.versions.android?Uf="android":Wf.versions.trident?Uf="IE":Wf.versions.presto?Uf="Opera":Wf.versions.webKit?Uf="webKit":Wf.versions.gecko?Uf="Firefox":Wf.versions.mobile?Uf="mobile":Wf.versions.ios?Uf="ios":Wf.versions.iPhone?Uf="iPhone":Wf.versions.iPad?Uf="ipad":Wf.versions.webApp?Uf="webApp":Wf.versions.weixin?Uf="weixin":Wf.versions.qq&&(Uf="qq"),jf=Bc.navigator.userAgent,Bf=Wf.language}var Xf=-1!==jf.toLowerCase().indexOf("android")?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",Yf="Mozilla/5.0 (".concat(Xf,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(Bf),qf={platform:Uf,language:Bf,appVersion:"5.0 (".concat(Xf,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:Yf},Zf=0;var Kf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Fc(this,e),lc(this,"href",void 0),0!=t.indexOf("http://")&&0!=t.indexOf("https://")?this.href=n+t:this.href=t}return Uc(e,null,[{key:"createObjectURL",value:function(e){var t=e.buffers[0],n=e.type,r=function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return Dc(t)}(t);return"data:".concat(n,";base64, ")+r}}]),e}();function Qf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Jf=new Map,$f=new Map,ep=new Map,tp=function(e){Gc(n,$c);var t=Qf(n);function n(){var e;return Fc(this,n),lc(Xc(e=t.call(this)),"onabort",void 0),lc(Xc(e),"onerror",void 0),lc(Xc(e),"onload",void 0),lc(Xc(e),"onloadstart",void 0),lc(Xc(e),"onprogress",void 0),lc(Xc(e),"ontimeout",void 0),lc(Xc(e),"onloadend",void 0),lc(Xc(e),"onreadystatechange",void 0),lc(Xc(e),"readyState",void 0),lc(Xc(e),"response",void 0),lc(Xc(e),"responseText",void 0),lc(Xc(e),"_responseType",void 0),lc(Xc(e),"responseXML",void 0),lc(Xc(e),"status",void 0),lc(Xc(e),"statusText",void 0),lc(Xc(e),"upload",void 0),lc(Xc(e),"withCredentials",void 0),lc(Xc(e),"timeout",void 0),lc(Xc(e),"_url",void 0),lc(Xc(e),"_method",void 0),e.onabort=null,e.onerror=null,e.onload=null,e.onloadstart=null,e.onprogress=null,e.ontimeout=null,e.onloadend=null,e.onreadystatechange=null,e.readyState=0,e.response=null,e.responseText=null,e._responseType="text",e.responseXML=null,e.status=0,e.statusText="",e.upload={},e.withCredentials=!1,Jf.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),e}return Uc(n,[{key:"responseType",set:function(e){this._responseType=e}},{key:"abort",value:function(){var e=ep.get("requestTask");e&&e.abort()}},{key:"getAllResponseHeaders",value:function(){var e=$f.get("responseHeader");return Object.keys(e).map((function(t){return"".concat(t,": ").concat(e[t])})).join("\n")}},{key:"getResponseHeader",value:function(e){return $f.get("responseHeader")[e]}},{key:"open",value:function(e,t,n){this._method=e,this._url=t}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(e,t){var n=Jf.get("requestHeader");n[e]=t,Jf.set("requestHeader",n)}},{key:"addEventListener",value:function(e,t){var n=this;"function"==typeof t&&(this["on"+e]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.target=e.target||n,t.call(n,e)})}},{key:"removeEventListener",value:function(e,t){this["on"+e]===t&&(this["on"+e]=null)}}]),n}();function np(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function rp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function ip(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}lc(tp,"UNSEND",void 0),lc(tp,"OPENED",void 0),lc(tp,"HEADERS_RECEIVED",void 0),lc(tp,"LOADING",void 0),lc(tp,"DONE",void 0),tp.UNSEND=0,tp.OPENED=1,tp.HEADERS_RECEIVED=2,tp.LOADING=3,tp.DONE=4,function(e){Gc(n,Zc);var t=np(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this,e)),"touches",void 0),lc(Xc(r),"targetTouches",void 0),lc(Xc(r),"changedTouches",void 0),r.touches=[],r.targetTouches=[],r.changedTouches=[],r.target=Mf(),r.currentTarget=Mf(),r}}(),function(e){Gc(n,Zc);var t=rp(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this,e)),"buttons",void 0),lc(Xc(r),"which",void 0),lc(Xc(r),"pointerId",void 0),lc(Xc(r),"bubbles",void 0),lc(Xc(r),"button",void 0),lc(Xc(r),"width",void 0),lc(Xc(r),"height",void 0),lc(Xc(r),"pressure",void 0),lc(Xc(r),"isPrimary",void 0),lc(Xc(r),"pointerType",void 0),lc(Xc(r),"altKey",void 0),lc(Xc(r),"ctrlKey",void 0),lc(Xc(r),"metaKey",void 0),lc(Xc(r),"shiftKey",void 0),r.target=Mf(),r.currentTarget=Mf(),r}}(),function(e){Gc(n,Zc);var t=ip(n);function n(e){return Fc(this,n),t.call(this,e)}}();var ap="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast,op="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),sp=ap||op,up={atob:function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Nc("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i="",a=0,o=0;r=t.charAt(o++);~r&&(n=a%4?64*n+r:r,a++%4)?i+=String.fromCharCode(255&n>>(-2*a&6)):0)r=Lc.indexOf(r);return i},btoa:Dc,devicePixelRatio:Vc,Blob:zc,document:Ff,Element:uf,Event:Zc,EventTarget:$c,HTMLCanvasElement:Vf,HTMLElement:Tf,HTMLMediaElement:wf,HTMLVideoElement:kf,Image:Rf,ImageData:Hf,navigator:qf,Node:tf,requestAnimationFrame:function(e){var t=Mf();return t.requestAnimationFrame?t.requestAnimationFrame(e):function(e){var t=Date.now(),n=Math.max(Zf+23,t);return setTimeout((function(){e(Zf=n)}),n-t)}(e)},cancelAnimationFrame:function(e){var t=Mf();return t.cancelAnimationFrame?t.cancelAnimationFrame(e):clearTimeout(e)},screen:pf,XMLHttpRequest:tp,performance:{mark:function(e){return null},clearMeasures:function(e){return null},clearMarks:function(e){return null},measure:function(e,t,n){return{duration:0}},now:function(){}},URL:Kf,WebGLRenderingContext:{GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:0x10000000000000000,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},WebGL2RenderingContext:{},addEventListener:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ff.addEventListener(e,t,n)},removeEventListener:function(e,t,n){Ff.removeEventListener(e,t)},dispatchEvent:function(e){Ff.dispatchEvent(e)},innerWidth:pf.availWidth,innerHeight:pf.availHeight,setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval},lp=sp?up:Bc,cp=sp?tp:Bc.XMLHttpRequest;function fp(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function pp(e,t,n){var r=lp.document.createElement(e);return r.className=t||"",n&&n.appendChild(r),r}function hp(e){var t=e.parentNode;t&&t.removeChild(e)}function dp(e,t){if(void 0!==e.classList)for(var n=fp(t).split(/\s+/),r=0,i=n.length;r<i;r++)e.classList.add(n[r]);else if(!function(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=yp(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}(e,t)){var a=yp(e);mp(e,(a?a+" ":"")+t)}}function vp(e,t){void 0!==e.classList?e.classList.remove(t):mp(e,fp((" "+yp(e)+" ").replace(" "+t+" "," ")))}function mp(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function yp(e){return e instanceof SVGElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function gp(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}sp||Bc.location;var _p=function(e){var t,n,r=null==lp||null===(t=lp.document)||void 0===t||null===(n=t.documentElement)||void 0===n?void 0:n.style;if(!r)return e[0];for(var i in e)if(e[i]&&e[i]in r)return e[i];return e[0]}(["transform","WebkitTransform"]);function bp(e,t){e.style[_p]=t}var Ep=function(){var e,t=lp.document.querySelector('meta[name="viewport"]');if(!t)return 1;var n=(null===(e=t.content)||void 0===e?void 0:e.split(",")).find((function(e){var t=Ic(e.split("="),2),n=t[0];return t[1],"initial-scale"===n}));return n?1*n.split("=")[1]:1}()<1?1:lp.devicePixelRatio;function xp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Sp(e,t,n){return(Sp=xp()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Hc(i,n.prototype),i}).apply(null,arguments)}function Tp(e){var t="function"==typeof Map?new Map:void 0;return(Tp=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Sp(e,arguments,qc(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Hc(r,e)})(e)}function Ap(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var wp=function(e){Gc(n,Tp(Error));var t=Ap(n);function n(e,r,i){var a;return Fc(this,n),lc(Xc(a=t.call(this,e)),"status",void 0),lc(Xc(a),"url",void 0),a.status=r,a.url=i,a.name=a.constructor.name,a.message=e,a}return Uc(n,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),n}();var Cp=function(e,t){var n=function(e){var t=new cp;for(var n in t.open("GET",e.url,!0),e.headers)e.headers.hasOwnProperty(n)&&t.setRequestHeader(n,e.headers[n]);return t.withCredentials="include"===e.credentials,t}(e);return n.responseType="arraybuffer",n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){var r=n.response;if(0===r.byteLength&&200===n.status)return t(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?t(null,{data:r,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):t(new wp(n.statusText,n.status,e.url))},n.send(),n},kp=function(e,t){return Cp(e,(function(e,n){if(e)t(e);else if(n){var r=new lp.Image;r.crossOrigin="anonymous";var i=lp.URL||lp.webkitURL;r.onload=function(){t(null,r),i.revokeObjectURL(r.src)};var a=new lp.Blob([new Uint8Array(n.data)],{type:"image/png"});r.src=n.data.byteLength?i.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}}))},Op=2*Math.PI*6378137/2;function Mp(e){var t=[1/0,1/0,-1/0,-1/0];return e.forEach((function(e){var n=e.coordinates;Rp(t,n)})),t}function Rp(e,t){return Array.isArray(t[0])?t.forEach((function(t){Rp(e,t)})):(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])),e}function Pp(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},r=(e=Ip(e,t))[0],i=e[1],a=r*Op/180,o=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return o=o*Op/180,n.enable&&(a=Number(a.toFixed(n.decimal)),o=Number(o.toFixed(n.decimal))),3===e.length?[a,o,e[2]]:[a,o]}function Ip(e,t){if(!1===t)return e;var n=function(e){if(null==e)throw new Error("lng is required");return(e>180||e<-180)&&((e%=360)>180&&(e=-360+e),e<-180&&(e=360+e),0===e&&(e=0)),e}(e[0]),r=function(e){if(null==e)throw new Error("lat is required");return(e>90||e<-90)&&((e%=180)>90&&(e=-180+e),e<-90&&(e=180+e),0===e&&(e=0)),e}(e[1]);return r>85&&(r=85),r<-85&&(r=-85),3===e.length?[n,r,e[2]]:[n,r]}function Lp(e){var t=85.0511287798,n=Math.max(Math.min(t,e[1]),-t),r=256<<20,i=Math.PI/180,a=e[0]*i,o=n*i;o=Math.log(Math.tan(Math.PI/4+o/2));return a=r*(.5/Math.PI*a+.5),o=r*(-.5/Math.PI*o+(i=.5)),[Math.floor(a),Math.floor(o)]}function Np(e,t,n){var r=Oc(t[1]-e[1]),i=Oc(t[0]-e[0]),a=Oc(e[1]),o=Oc(t[1]),s=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(o);return function(e,t){void 0===t&&(t="kilometers");var n=Cc[t];if(!n)throw new Error(t+" units is invalid");return e*n}(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),"meters")}function Dp(e,t){var n=Math.abs(e[1][1]-e[0][1])*t,r=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-r,e[0][1]-n],[e[1][0]+r,e[1][1]+n]]}function Fp(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}var jp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0;Fc(this,e),lc(this,"limit",void 0),lc(this,"cache",void 0),lc(this,"destroy",void 0),lc(this,"order",void 0),this.limit=t,this.destroy=n||this.defaultDestroy,this.order=[],this.clear()}return Uc(e,[{key:"clear",value:function(){var e=this;this.order.forEach((function(t){e.delete(t)})),this.cache={},this.order=[]}},{key:"get",value:function(e){var t=this.cache[e];return t&&(this.deleteOrder(e),this.appendOrder(e)),t}},{key:"set",value:function(e,t){this.cache[e]?(this.delete(e),this.cache[e]=t,this.appendOrder(e)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[e]=t,this.appendOrder(e))}},{key:"delete",value:function(e){var t=this.cache[e];t&&(this.deleteCache(e),this.deleteOrder(e),this.destroy(t,e))}},{key:"deleteCache",value:function(e){delete this.cache[e]}},{key:"deleteOrder",value:function(e){var t=this.order.findIndex((function(t){return t===e}));t>=0&&this.order.splice(t,1)}},{key:"appendOrder",value:function(e){this.order.push(e)}},{key:"defaultDestroy",value:function(e,t){return null}}]),e}();function Up(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function Bp(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function zp(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Vp(){}var Hp,Gp,Wp=1/.7,Xp="\\s*([+-]?\\d+)\\s*",Yp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",qp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zp=/^#([0-9a-f]{3,8})$/,Kp=new RegExp("^rgb\\("+[Xp,Xp,Xp]+"\\)$"),Qp=new RegExp("^rgb\\("+[qp,qp,qp]+"\\)$"),Jp=new RegExp("^rgba\\("+[Xp,Xp,Xp,Yp]+"\\)$"),$p=new RegExp("^rgba\\("+[qp,qp,qp,Yp]+"\\)$"),eh=new RegExp("^hsl\\("+[Yp,qp,qp]+"\\)$"),th=new RegExp("^hsla\\("+[Yp,qp,qp,Yp]+"\\)$"),nh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function rh(){return this.rgb().formatHex()}function ih(){return this.rgb().formatRgb()}function ah(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Zp.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?oh(t):3===n?new ch(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?sh(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?sh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Kp.exec(e))?new ch(t[1],t[2],t[3],1):(t=Qp.exec(e))?new ch(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Jp.exec(e))?sh(t[1],t[2],t[3],t[4]):(t=$p.exec(e))?sh(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=eh.exec(e))?dh(t[1],t[2]/100,t[3]/100,1):(t=th.exec(e))?dh(t[1],t[2]/100,t[3]/100,t[4]):nh.hasOwnProperty(e)?oh(nh[e]):"transparent"===e?new ch(NaN,NaN,NaN,0):null}function oh(e){return new ch(e>>16&255,e>>8&255,255&e,1)}function sh(e,t,n,r){return r<=0&&(e=t=n=NaN),new ch(e,t,n,r)}function uh(e){return e instanceof Vp||(e=ah(e)),e?new ch((e=e.rgb()).r,e.g,e.b,e.opacity):new ch}function lh(e,t,n,r){return 1===arguments.length?uh(e):new ch(e,t,n,null==r?1:r)}function ch(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function fh(){return"#"+hh(this.r)+hh(this.g)+hh(this.b)}function ph(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function hh(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function dh(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new mh(e,t,n,r)}function vh(e){if(e instanceof mh)return new mh(e.h,e.s,e.l,e.opacity);if(e instanceof Vp||(e=ah(e)),!e)return new mh;if(e instanceof mh)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new mh(o,s,u,e.opacity)}function mh(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function yh(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function gh(e){var t=ah(e),n=[0,0,0,0];return null!=t&&(n[0]=t.r/255,n[1]=t.g/255,n[2]=t.b/255,n[3]=t.opacity),n}function _h(e){return(e&&e[0])+256*(e&&e[1])+65536*(e&&e[2])-1}function bh(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}Bp(Vp,ah,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:rh,formatHex:rh,formatHsl:function(){return vh(this).formatHsl()},formatRgb:ih,toString:ih}),Bp(ch,lh,zp(Vp,{brighter:function(e){return e=null==e?Wp:Math.pow(Wp,e),new ch(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ch(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fh,formatHex:fh,formatRgb:ph,toString:ph})),Bp(mh,(function(e,t,n,r){return 1===arguments.length?vh(e):new mh(e,t,n,null==r?1:r)}),zp(Vp,{brighter:function(e){return e=null==e?Wp:Math.pow(Wp,e),new mh(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new mh(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ch(yh(e>=240?e-240:e+120,i,r),yh(e,i,r),yh(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}})),(Gp=Hp||(Hp={})).CENTER="center",Gp.TOP="top",Gp["TOP-LEFT"]="top-left",Gp["TOP-RIGHT"]="top-right",Gp.BOTTOM="bottom",Gp["BOTTOM-LEFT"]="bottom-left",Gp.LEFT="left",Gp.RIGHT="right";var Eh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xh(e,t,n){var r=e.classList;for(var i in Eh)Eh.hasOwnProperty(i)&&r.remove("l7-".concat(n,"-anchor-").concat(i));r.add("l7-".concat(n,"-anchor-").concat(t))}function Sh(e){if(0===e.length)return 0;for(var t=1*e[0],n=1;n<e.length;n++)t+=1*e[n];return t}var Th={min:function(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return 1*t},max:function(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return 1*t},mean:function(e){if(0===e.length)throw new Error("mean requires at least one data point");return Sh(e)/e.length},sum:Sh,mode:function(e){if(0===e.length)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var t=e[0],n=NaN,r=0,i=1,a=1;a<e.length+1;a++)e[a]!==t?(i>r&&(r=i,n=t),i=1,t=e[a]):i++;return 1*n}};function Ah(e,t){return e.map((function(e){return e[t]}))}function wh(e,t){var n=t.extent,r=void 0===n?[121.168,30.2828,121.384,30.4219]:n,i=new Promise((function(t){!function(e,t){var n=e,r=[];if("string"==typeof n)kp({url:n},(function(e,n){r.push(n),t(r)}));else{var i=n.length,a=0;n.forEach((function(e){kp({url:e},(function(e,n){a++,r.push(n),a===i&&t(r)}))}))}}(e,(function(e){t(e)}))}));return{originData:e,images:i,_id:1,dataArray:[{_id:0,coordinates:[[r[0],r[1]],[r[2],r[3]]]}]}}var Ch=function(){this.__data__=[],this.size=0};var kh=function(e,t){return e===t||e!=e&&t!=t},Oh=kh;var Mh=function(e,t){for(var n=e.length;n--;)if(Oh(e[n][0],t))return n;return-1},Rh=Mh,Ph=Array.prototype.splice;var Ih=Mh;var Lh=Mh;var Nh=Mh;var Dh=Ch,Fh=function(e){var t=this.__data__,n=Rh(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ph.call(t,n,1),--this.size,!0)},jh=function(e){var t=this.__data__,n=Ih(t,e);return n<0?void 0:t[n][1]},Uh=function(e){return Lh(this.__data__,e)>-1},Bh=function(e,t){var n=this.__data__,r=Nh(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function zh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}zh.prototype.clear=Dh,zh.prototype.delete=Fh,zh.prototype.get=jh,zh.prototype.has=Uh,zh.prototype.set=Bh;var Vh=zh,Hh=Vh;var Gh=function(){this.__data__=new Hh,this.size=0};var Wh=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var Xh=function(e){return this.__data__.get(e)};var Yh=function(e){return this.__data__.has(e)},qh="object"==typeof e&&e&&e.Object===Object&&e,Zh=qh,Kh="object"==typeof self&&self&&self.Object===Object&&self,Qh=Zh||Kh||Function("return this")(),Jh=Qh.Symbol,$h=Jh,ed=Object.prototype,td=ed.hasOwnProperty,nd=ed.toString,rd=$h?$h.toStringTag:void 0;var id=function(e){var t=td.call(e,rd),n=e[rd];try{e[rd]=void 0;var r=!0}catch(a){}var i=nd.call(e);return r&&(t?e[rd]=n:delete e[rd]),i},ad=Object.prototype.toString;var od=id,sd=function(e){return ad.call(e)},ud=Jh?Jh.toStringTag:void 0;var ld=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ud&&ud in Object(e)?od(e):sd(e)};var cd=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},fd=ld,pd=cd;var hd,dd=function(e){if(!pd(e))return!1;var t=fd(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},vd=Qh["__core-js_shared__"],md=(hd=/[^.]+$/.exec(vd&&vd.keys&&vd.keys.IE_PROTO||""))?"Symbol(src)_1."+hd:"";var yd=function(e){return!!md&&md in e},gd=Function.prototype.toString;var _d=function(e){if(null!=e){try{return gd.call(e)}catch(t){}try{return e+""}catch(t){}}return""},bd=dd,Ed=yd,xd=cd,Sd=_d,Td=/^\[object .+?Constructor\]$/,Ad=Function.prototype,wd=Object.prototype,Cd=Ad.toString,kd=wd.hasOwnProperty,Od=RegExp("^"+Cd.call(kd).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Md=function(e){return!(!xd(e)||Ed(e))&&(bd(e)?Od:Td).test(Sd(e))},Rd=function(e,t){return null==e?void 0:e[t]};var Pd=function(e,t){var n=Rd(e,t);return Md(n)?n:void 0},Id=Pd(Qh,"Map"),Ld=Pd(Object,"create"),Nd=Ld;var Dd=function(){this.__data__=Nd?Nd(null):{},this.size=0};var Fd=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},jd=Ld,Ud=Object.prototype.hasOwnProperty;var Bd=function(e){var t=this.__data__;if(jd){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ud.call(t,e)?t[e]:void 0},zd=Ld,Vd=Object.prototype.hasOwnProperty;var Hd=Ld;var Gd=Dd,Wd=Fd,Xd=Bd,Yd=function(e){var t=this.__data__;return zd?void 0!==t[e]:Vd.call(t,e)},qd=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Hd&&void 0===t?"__lodash_hash_undefined__":t,this};function Zd(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Zd.prototype.clear=Gd,Zd.prototype.delete=Wd,Zd.prototype.get=Xd,Zd.prototype.has=Yd,Zd.prototype.set=qd;var Kd=Zd,Qd=Vh,Jd=Id;var $d=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var ev=function(e,t){var n=e.__data__;return $d(t)?n["string"==typeof t?"string":"hash"]:n.map},tv=ev;var nv=ev;var rv=ev;var iv=ev;var av=function(){this.size=0,this.__data__={hash:new Kd,map:new(Jd||Qd),string:new Kd}},ov=function(e){var t=tv(this,e).delete(e);return this.size-=t?1:0,t},sv=function(e){return nv(this,e).get(e)},uv=function(e){return rv(this,e).has(e)},lv=function(e,t){var n=iv(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function cv(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}cv.prototype.clear=av,cv.prototype.delete=ov,cv.prototype.get=sv,cv.prototype.has=uv,cv.prototype.set=lv;var fv=cv,pv=Vh,hv=Id,dv=fv;var vv=Vh,mv=Gh,yv=Wh,gv=Xh,_v=Yh,bv=function(e,t){var n=this.__data__;if(n instanceof pv){var r=n.__data__;if(!hv||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new dv(r)}return n.set(e,t),this.size=n.size,this};function Ev(e){var t=this.__data__=new vv(e);this.size=t.size}Ev.prototype.clear=mv,Ev.prototype.delete=yv,Ev.prototype.get=gv,Ev.prototype.has=_v,Ev.prototype.set=bv;var xv=Ev,Sv=Pd,Tv=function(){try{var e=Sv(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Av=Tv;var wv=function(e,t,n){"__proto__"==t&&Av?Av(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Cv=wv,kv=kh;var Ov=function(e,t,n){(void 0!==n&&!kv(e[t],n)||void 0===n&&!(t in e))&&Cv(e,t,n)};var Mv,Rv,Pv,Iv,Lv,Nv,Dv,Fv=function(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var u=o[e?s:++i];if(!1===n(a[u],u,a))break}return t}}(),jv={exports:{}};Mv=jv,Pv=Qh,Iv=(Rv=jv.exports)&&!Rv.nodeType&&Rv,Lv=Iv&&Mv&&!Mv.nodeType&&Mv,Nv=Lv&&Lv.exports===Iv?Pv.Buffer:void 0,Dv=Nv?Nv.allocUnsafe:void 0,Mv.exports=function(e,t){if(t)return e.slice();var n=e.length,r=Dv?Dv(n):new e.constructor(n);return e.copy(r),r};var Uv=Qh.Uint8Array,Bv=Uv;var zv=function(e){var t=new e.constructor(e.byteLength);return new Bv(t).set(new Bv(e)),t},Vv=zv;var Hv=function(e,t){var n=t?Vv(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Gv=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},Wv=cd,Xv=Object.create,Yv=function(){function e(){}return function(t){if(!Wv(t))return{};if(Xv)return Xv(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var qv=function(e,t){return function(n){return e(t(n))}},Zv=qv(Object.getPrototypeOf,Object),Kv=Object.prototype;var Qv=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Kv)},Jv=Yv,$v=Zv,em=Qv;var tm=function(e){return"function"!=typeof e.constructor||em(e)?{}:Jv($v(e))};var nm=function(e){return null!=e&&"object"==typeof e},rm=ld,im=nm;var am=function(e){return im(e)&&"[object Arguments]"==rm(e)},om=nm,sm=Object.prototype,um=sm.hasOwnProperty,lm=sm.propertyIsEnumerable,cm=am(function(){return arguments}())?am:function(e){return om(e)&&um.call(e,"callee")&&!lm.call(e,"callee")},fm=Array.isArray;var pm=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},hm=dd,dm=pm;var vm=function(e){return null!=e&&dm(e.length)&&!hm(e)},mm=vm,ym=nm;var gm=function(e){return ym(e)&&mm(e)},_m={exports:{}};var bm=function(){return!1};!function(e,t){var n=Qh,r=bm,i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,o=a&&a.exports===i?n.Buffer:void 0,s=(o?o.isBuffer:void 0)||r;e.exports=s}(_m,_m.exports);var Em=ld,xm=Zv,Sm=nm,Tm=Function.prototype,Am=Object.prototype,wm=Tm.toString,Cm=Am.hasOwnProperty,km=wm.call(Object);var Om=function(e){if(!Sm(e)||"[object Object]"!=Em(e))return!1;var t=xm(e);if(null===t)return!0;var n=Cm.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&wm.call(n)==km},Mm=ld,Rm=pm,Pm=nm,Im={};Im["[object Float32Array]"]=Im["[object Float64Array]"]=Im["[object Int8Array]"]=Im["[object Int16Array]"]=Im["[object Int32Array]"]=Im["[object Uint8Array]"]=Im["[object Uint8ClampedArray]"]=Im["[object Uint16Array]"]=Im["[object Uint32Array]"]=!0,Im["[object Arguments]"]=Im["[object Array]"]=Im["[object ArrayBuffer]"]=Im["[object Boolean]"]=Im["[object DataView]"]=Im["[object Date]"]=Im["[object Error]"]=Im["[object Function]"]=Im["[object Map]"]=Im["[object Number]"]=Im["[object Object]"]=Im["[object RegExp]"]=Im["[object Set]"]=Im["[object String]"]=Im["[object WeakMap]"]=!1;var Lm=function(e){return Pm(e)&&Rm(e.length)&&!!Im[Mm(e)]};var Nm=function(e){return function(t){return e(t)}},Dm={exports:{}};!function(e,t){var n=qh,r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,a=i&&i.exports===r&&n.process,o=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=o}(Dm,Dm.exports);var Fm=Lm,jm=Nm,Um=Dm.exports,Bm=Um&&Um.isTypedArray,zm=Bm?jm(Bm):Fm;var Vm=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},Hm=wv,Gm=kh,Wm=Object.prototype.hasOwnProperty;var Xm=function(e,t,n){var r=e[t];Wm.call(e,t)&&Gm(r,n)&&(void 0!==n||t in e)||Hm(e,t,n)},Ym=Xm,qm=wv;var Zm=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),i?qm(n,s,u):Ym(n,s,u)}return n};var Km=/^(?:0|[1-9]\d*)$/;var Qm=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Km.test(e))&&e>-1&&e%1==0&&e<t},Jm=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},$m=cm,ey=fm,ty=_m.exports,ny=Qm,ry=zm,iy=Object.prototype.hasOwnProperty;var ay=function(e,t){var n=ey(e),r=!n&&$m(e),i=!n&&!r&&ty(e),a=!n&&!r&&!i&&ry(e),o=n||r||i||a,s=o?Jm(e.length,String):[],u=s.length;for(var l in e)!t&&!iy.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ny(l,u))||s.push(l);return s};var oy=cd,sy=Qv,uy=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},ly=Object.prototype.hasOwnProperty;var cy=ay,fy=function(e){if(!oy(e))return uy(e);var t=sy(e),n=[];for(var r in e)("constructor"!=r||!t&&ly.call(e,r))&&n.push(r);return n},py=vm;var hy=function(e){return py(e)?cy(e,!0):fy(e)},dy=Zm,vy=hy;var yy=Ov,gy=jv.exports,_y=Hv,by=Gv,Ey=tm,xy=cm,Sy=fm,Ty=gm,Ay=_m.exports,wy=dd,Cy=cd,ky=Om,Oy=zm,My=Vm,Ry=function(e){return dy(e,vy(e))};var Py=xv,Iy=Ov,Ly=Fv,Ny=function(e,t,n,r,i,a,o){var s=My(e,n),u=My(t,n),l=o.get(u);if(l)yy(e,n,l);else{var c=a?a(s,u,n+"",e,t,o):void 0,f=void 0===c;if(f){var p=Sy(u),h=!p&&Ay(u),d=!p&&!h&&Oy(u);c=u,p||h||d?Sy(s)?c=s:Ty(s)?c=by(s):h?(f=!1,c=gy(u,!0)):d?(f=!1,c=_y(u,!0)):c=[]:ky(u)||xy(u)?(c=s,xy(s)?c=Ry(s):Cy(s)&&!wy(s)||(c=Ey(u))):f=!1}f&&(o.set(u,c),i(c,u,r,a,o),o.delete(u)),yy(e,n,c)}},Dy=cd,Fy=hy,jy=Vm;var Uy=function e(t,n,r,i,a){t!==n&&Ly(n,(function(o,s){if(a||(a=new Py),Dy(o))Ny(t,n,s,r,e,i,a);else{var u=i?i(jy(t,s),o,s+"",t,n,a):void 0;void 0===u&&(u=o),Iy(t,s,u)}}),Fy)};var By=function(e){return e};var zy=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Vy=Math.max;var Hy=function(e,t,n){return t=Vy(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Vy(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),zy(e,this,s)}};var Gy=function(e){return function(){return e}},Wy=Tv,Xy=Wy?function(e,t){return Wy(e,"toString",{configurable:!0,enumerable:!1,value:Gy(t),writable:!0})}:By,Yy=Date.now;var qy=function(e){var t=0,n=0;return function(){var r=Yy(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Xy),Zy=By,Ky=Hy,Qy=qy;var Jy=kh,$y=vm,eg=Qm,tg=cd;var ng=function(e,t){return Qy(Ky(e,t,Zy),e+"")},rg=function(e,t,n){if(!tg(n))return!1;var r=typeof t;return!!("number"==r?$y(n)&&eg(t,n.length):"string"==r&&t in n)&&Jy(n[t],e)};var ig=function(e){return ng((function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,o&&rg(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t}))},ag=Uy,og=ig((function(e,t,n,r){ag(e,t,n,r)})),sg=ld,ug=fm,lg=nm;var cg=function(e){return"string"==typeof e||!ug(e)&&lg(e)&&"[object String]"==sg(e)};var fg=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},pg=qv(Object.keys,Object),hg=Qv,dg=pg,vg=Object.prototype.hasOwnProperty;var mg=ay,yg=function(e){if(!hg(e))return dg(e);var t=[];for(var n in Object(e))vg.call(e,n)&&"constructor"!=n&&t.push(n);return t},gg=vm;var _g=function(e){return gg(e)?mg(e):yg(e)},bg=Zm,Eg=_g;var xg=function(e,t){return e&&bg(t,Eg(t),e)},Sg=Zm,Tg=hy;var Ag=function(e,t){return e&&Sg(t,Tg(t),e)};var wg=function(){return[]},Cg=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a},kg=wg,Og=Object.prototype.propertyIsEnumerable,Mg=Object.getOwnPropertySymbols,Rg=Mg?function(e){return null==e?[]:(e=Object(e),Cg(Mg(e),(function(t){return Og.call(e,t)})))}:kg,Pg=Zm,Ig=Rg;var Lg=function(e,t){return Pg(e,Ig(e),t)};var Ng=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},Dg=Ng,Fg=Zv,jg=Rg,Ug=wg,Bg=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Dg(t,jg(e)),e=Fg(e);return t}:Ug,zg=Zm,Vg=Bg;var Hg=function(e,t){return zg(e,Vg(e),t)},Gg=Ng,Wg=fm;var Xg=function(e,t,n){var r=t(e);return Wg(e)?r:Gg(r,n(e))},Yg=Xg,qg=Rg,Zg=_g;var Kg=function(e){return Yg(e,Zg,qg)},Qg=Xg,Jg=Bg,$g=hy;var e_=function(e){return Qg(e,$g,Jg)},t_=Pd(Qh,"DataView"),n_=Pd(Qh,"Promise"),r_=Pd(Qh,"Set"),i_=t_,a_=Id,o_=n_,s_=r_,u_=Pd(Qh,"WeakMap"),l_=ld,c_=_d,f_=c_(i_),p_=c_(a_),h_=c_(o_),d_=c_(s_),v_=c_(u_),m_=l_;(i_&&"[object DataView]"!=m_(new i_(new ArrayBuffer(1)))||a_&&"[object Map]"!=m_(new a_)||o_&&"[object Promise]"!=m_(o_.resolve())||s_&&"[object Set]"!=m_(new s_)||u_&&"[object WeakMap]"!=m_(new u_))&&(m_=function(e){var t=l_(e),n="[object Object]"==t?e.constructor:void 0,r=n?c_(n):"";if(r)switch(r){case f_:return"[object DataView]";case p_:return"[object Map]";case h_:return"[object Promise]";case d_:return"[object Set]";case v_:return"[object WeakMap]"}return t});var y_=m_,g_=Object.prototype.hasOwnProperty;var __=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&g_.call(e,"index")&&(n.index=e.index,n.input=e.input),n},b_=zv;var E_=function(e,t){var n=t?b_(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},x_=/\w*$/;var S_=function(e){var t=new e.constructor(e.source,x_.exec(e));return t.lastIndex=e.lastIndex,t},T_=Jh?Jh.prototype:void 0,A_=T_?T_.valueOf:void 0;var w_=zv,C_=E_,k_=S_,O_=function(e){return A_?Object(A_.call(e)):{}},M_=Hv;var R_=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return w_(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return C_(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return M_(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return k_(e);case"[object Set]":return new r;case"[object Symbol]":return O_(e)}},P_=y_,I_=nm;var L_=function(e){return I_(e)&&"[object Map]"==P_(e)},N_=Nm,D_=Dm.exports,F_=D_&&D_.isMap,j_=F_?N_(F_):L_,U_=y_,B_=nm;var z_=function(e){return B_(e)&&"[object Set]"==U_(e)},V_=Nm,H_=Dm.exports,G_=H_&&H_.isSet,W_=G_?V_(G_):z_,X_=xv,Y_=fg,q_=Xm,Z_=xg,K_=Ag,Q_=jv.exports,J_=Gv,$_=Lg,eb=Hg,tb=Kg,nb=e_,rb=y_,ib=__,ab=R_,ob=tm,sb=fm,ub=_m.exports,lb=j_,cb=cd,fb=W_,pb=_g,hb=hy,db={};db["[object Arguments]"]=db["[object Array]"]=db["[object ArrayBuffer]"]=db["[object DataView]"]=db["[object Boolean]"]=db["[object Date]"]=db["[object Float32Array]"]=db["[object Float64Array]"]=db["[object Int8Array]"]=db["[object Int16Array]"]=db["[object Int32Array]"]=db["[object Map]"]=db["[object Number]"]=db["[object Object]"]=db["[object RegExp]"]=db["[object Set]"]=db["[object String]"]=db["[object Symbol]"]=db["[object Uint8Array]"]=db["[object Uint8ClampedArray]"]=db["[object Uint16Array]"]=db["[object Uint32Array]"]=!0,db["[object Error]"]=db["[object Function]"]=db["[object WeakMap]"]=!1;var vb=function e(t,n,r,i,a,o){var s,u=1&n,l=2&n,c=4&n;if(r&&(s=a?r(t,i,a,o):r(t)),void 0!==s)return s;if(!cb(t))return t;var f=sb(t);if(f){if(s=ib(t),!u)return J_(t,s)}else{var p=rb(t),h="[object Function]"==p||"[object GeneratorFunction]"==p;if(ub(t))return Q_(t,u);if("[object Object]"==p||"[object Arguments]"==p||h&&!a){if(s=l||h?{}:ob(t),!u)return l?eb(t,K_(s,t)):$_(t,Z_(s,t))}else{if(!db[p])return a?t:{};s=ab(t,p,u)}}o||(o=new X_);var d=o.get(t);if(d)return d;o.set(t,s),fb(t)?t.forEach((function(i){s.add(e(i,n,r,i,t,o))})):lb(t)&&t.forEach((function(i,a){s.set(a,e(i,n,r,a,t,o))}));var v=f?void 0:(c?l?nb:tb:l?hb:pb)(t);return Y_(v||t,(function(i,a){v&&(i=t[a=i]),q_(s,a,e(i,n,r,a,t,o))})),s};var mb=function(e){return vb(e,5)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function yb(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function gb(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function _b(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function bb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Eb(e,t){return e(t={exports:{}},t.exports),t.exports}var xb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0},e.exports=t.default}));bb(xb);var Sb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=t.pop();return e.call(this,t,r)}},e.exports=t.default}));bb(Sb);var Tb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fallback=a,t.wrap=o;var n,r=t.hasSetImmediate="function"==typeof setImmediate&&setImmediate,i=t.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function a(e){setTimeout(e,0)}function o(e){return function(t){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return e((function(){return t.apply(void 0,n)}))}}n=r?setImmediate:i?process.nextTick:a,t.default=o(n)}));bb(Tb),Tb.fallback,Tb.wrap,Tb.hasSetImmediate,Tb.hasNextTick;var Ab=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,wb.isAsync)(e))return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=t.pop(),i=e.apply(this,t);return a(i,r)};return(0,n.default)((function(t,n){var r;try{r=e.apply(this,t)}catch(i){return n(i)}if(r&&"function"==typeof r.then)return a(r,n);n(null,r)}))};var n=i(Sb),r=i(Tb);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return e.then((function(e){o(t,null,e)}),(function(e){o(t,e&&e.message?e:new Error(e))}))}function o(e,t,n){try{e(t,n)}catch(i){(0,r.default)((function(e){throw e}),i)}}e.exports=t.default}));bb(Ab);var wb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=t.isAsyncGenerator=t.isAsync=void 0;var n,r=(n=Ab)&&n.__esModule?n:{default:n};function i(e){return"AsyncFunction"===e[Symbol.toStringTag]}t.default=function(e){if("function"!=typeof e)throw new Error("expected a function");return i(e)?(0,r.default)(e):e},t.isAsync=i,t.isAsyncGenerator=function(e){return"AsyncGenerator"===e[Symbol.toStringTag]},t.isAsyncIterable=function(e){return"function"==typeof e[Symbol.asyncIterator]}}));bb(wb),wb.isAsyncIterable,wb.isAsyncGenerator,wb.isAsync;var Cb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){void 0===t&&(t=e.length);if(!t)throw new Error("arity is undefined");function n(){for(var n=this,r=[],i=arguments.length;i--;)r[i]=arguments[i];return"function"==typeof r[t-1]?e.apply(this,r):new Promise((function(i,a){r[t-1]=function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(e)return a(e);i(t.length>1?t:t[0])},e.apply(n,r)}))}return Object.defineProperty(n,"name",{configurable:!0,value:"awaitable("+e.name+")"}),n},e.exports=t.default}));bb(Cb);var kb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(xb),r=a(wb),i=a(Cb);function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)((function(e,t,i){var a=(0,n.default)(t)?[]:{};e(t,(function(e,t,n){(0,r.default)(e)((function(e){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];r.length<2&&(r=r[0]),a[t]=r,n(e)}))}),(function(e){return i(e,a)}))}),3),e.exports=t.default}));bb(kb);var Ob=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(null!==e){var r=e;e=null,r.apply(this,t)}}return Object.assign(t,e),t},e.exports=t.default}));bb(Ob);var Mb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()},e.exports=t.default}));bb(Mb);var Rb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,n.default)(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t=(0,r.default)(e);return t?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(t):(i=e,a=i?Object.keys(i):[],o=-1,s=a.length,function(){var e=a[++o];return o<s?{value:i[e],key:e}:null});var i,a,o,s};var n=i(xb),r=i(Mb);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}));bb(Rb);var Pb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(null===e)throw new Error("Callback was already called.");var r=e;e=null,r.apply(this,t)}},e.exports=t.default}));bb(Pb);var Ib=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default={},e.exports=t.default}));bb(Ib);var Lb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){var a=!1,o=!1,s=!1,u=0,l=0;function c(){u>=t||s||a||(s=!0,e.next().then((function(e){var t=e.value,r=e.done;if(!o&&!a){if(s=!1,r)return a=!0,void(u<=0&&i(null));u++,n(t,l,f),l++,c()}})).catch(p))}function f(e,t){if(u-=1,!o)return e?p(e):!1===e?(a=!0,void(o=!0)):t===r.default||a&&u<=0?(a=!0,i(null)):void c()}function p(e){o||(s=!1,a=!0,i(e))}c()};var n,r=(n=Ib)&&n.__esModule?n:{default:n};e.exports=t.default}));bb(Lb);var Nb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(Ob),r=s(Rb),i=s(Pb),a=s(Lb),o=s(Ib);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(t,s,u){if(u=(0,n.default)(u),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return u(null);if((0,wb.isAsyncGenerator)(t))return(0,a.default)(t,e,s,u);if((0,wb.isAsyncIterable)(t))return(0,a.default)(t[Symbol.asyncIterator](),e,s,u);var l=(0,r.default)(t),c=!1,f=!1,p=0,h=!1;function d(e,t){if(!f)if(p-=1,e)c=!0,u(e);else if(!1===e)c=!0,f=!0;else{if(t===o.default||c&&p<=0)return c=!0,u(null);h||v()}}function v(){for(h=!0;p<e&&!c;){var t=l();if(null===t)return c=!0,void(p<=0&&u(null));p+=1,s(t.value,t.key,(0,i.default)(d))}h=!1}v()}},e.exports=t.default}));bb(Nb);var Db=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(Nb),r=a(wb),i=a(Cb);function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)((function(e,t,i,a){return(0,n.default)(t)(e,(0,r.default)(i),a)}),4),e.exports=t.default}));bb(Db);var Fb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Db),r=i(Cb);function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,r.default)((function(e,t,r){return(0,n.default)(e,1,t,r)}),3),e.exports=t.default}));bb(Fb);var jb=bb(Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,n.default)(r.default,e,t)};var n=i(kb),r=i(Fb);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}))),Ub=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return this.args=t,jb(this.tasks)},e.prototype.tap=function(e,t){var n=this;this.tasks.push((function(r){t.apply(void 0,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_b(arguments[t]));return e}(n.args)),r(null,e)}))},e}(),Bb=Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(xb),r=l(Ib),i=l(Db),a=l(Ob),o=l(Pb),s=l(wb),u=l(Cb);function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){n=(0,a.default)(n);var i=0,s=0,u=e.length,l=!1;function c(e,t){!1===e&&(l=!0),!0!==l&&(e?n(e):++s!==u&&t!==r.default||n(null))}for(0===u&&n(null);i<u;i++)t(e[i],i,(0,o.default)(c))}function f(e,t,n){return(0,i.default)(e,1/0,t,n)}t.default=(0,u.default)((function(e,t,r){return((0,n.default)(e)?c:f)(e,(0,s.default)(t),r)}),3),e.exports=t.default}));bb(Bb);var zb=bb(Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(n.default,e,t)};var n=i(Bb),r=i(kb);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}))),Vb=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.promise=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return zb(this.tasks)},e.prototype.tapPromise=function(e,t){var n=this;this.tasks.push((function(r){return yb(n,void 0,void 0,(function(){return gb(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return n.sent(),r(null,e),[2]}}))}))}))},e}(),Hb=bb(Eb((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(Ob),r=o(Pb),i=o(wb),a=o(Cb);function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,a.default)((function(e,t){if(t=(0,n.default)(t),!Array.isArray(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var a=0;function o(t){(0,i.default)(e[a++]).apply(void 0,t.concat([(0,r.default)(s)]))}function s(n){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];if(!1!==n)return n||a===e.length?t.apply(void 0,[n].concat(r)):void o(r)}o([])})),e.exports=t.default}))),Gb=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return Hb(this.tasks)},e.prototype.tap=function(e,t){0===this.tasks.length?this.tasks.push((function(e){var n=t();e(!!n&&null,n)})):this.tasks.push((function(n,r){r(!!t()&&null,e)}))},e}(),Wb=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return jb(this.tasks)},e.prototype.tap=function(e,t){this.tasks.push((function(n){n(t(),e)}))},e}(),Xb={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,a||e,o),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,a),!0;case 6:return c.fn.call(c.context,t,r,i,a,o),!0}for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var p,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),f){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,r);break;case 4:c[l].fn.call(c[l].context,t,r,i);break;default:if(!u)for(p=1,u=new Array(f-1);p<f;p++)u[p-1]=arguments[p];c[l].fn.apply(c[l].context,u)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||o(this,a);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&l.push(s[u]);l.length?this._events[a]=1===l.length?l[0]:l:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(Xb);var Yb=Xb.exports,qb={exports:{}},Zb=qb.exports=function(){function e(n,r,i,a,o,s){if(!(o-a<=i)){var u=a+o>>1;t(n,r,u,a,o,s%2),e(n,r,i,a,u-1,s+1),e(n,r,i,u+1,o,s+1)}}function t(e,r,i,a,o,s){for(;o>a;){if(o-a>600){var u=o-a+1,l=i-a+1,c=Math.log(u),f=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1);t(e,r,i,Math.max(a,Math.floor(i-l*f/u+p)),Math.min(o,Math.floor(i+(u-l)*f/u+p)),s)}var h=r[2*i+s],d=a,v=o;for(n(e,r,a,i),r[2*o+s]>h&&n(e,r,a,o);d<v;){for(n(e,r,d,v),d++,v--;r[2*d+s]<h;)d++;for(;r[2*v+s]>h;)v--}r[2*a+s]===h?n(e,r,a,v):n(e,r,++v,o),v<=i&&(a=v+1),i<=v&&(o=v-1)}}function n(e,t,n,i){r(e,n,i),r(t,2*n,2*i),r(t,2*n+1,2*i+1)}function r(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function i(e,t,n,r,i,a,o){for(var s,u,l=[0,e.length-1,0],c=[];l.length;){var f=l.pop(),p=l.pop(),h=l.pop();if(p-h<=o)for(var d=h;d<=p;d++)s=t[2*d],u=t[2*d+1],s>=n&&s<=i&&u>=r&&u<=a&&c.push(e[d]);else{var v=Math.floor((h+p)/2);s=t[2*v],u=t[2*v+1],s>=n&&s<=i&&u>=r&&u<=a&&c.push(e[v]);var m=(f+1)%2;(0===f?n<=s:r<=u)&&(l.push(h),l.push(v-1),l.push(m)),(0===f?i>=s:a>=u)&&(l.push(v+1),l.push(p),l.push(m))}}return c}function a(e,t,n,r,i,a){for(var s=[0,e.length-1,0],u=[],l=i*i;s.length;){var c=s.pop(),f=s.pop(),p=s.pop();if(f-p<=a)for(var h=p;h<=f;h++)o(t[2*h],t[2*h+1],n,r)<=l&&u.push(e[h]);else{var d=Math.floor((p+f)/2),v=t[2*d],m=t[2*d+1];o(v,m,n,r)<=l&&u.push(e[d]);var y=(c+1)%2;(0===c?n-i<=v:r-i<=m)&&(s.push(p),s.push(d-1),s.push(y)),(0===c?n+i>=v:r+i>=m)&&(s.push(d+1),s.push(f),s.push(y))}}return u}function o(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}var s=function(e){return e[0]},u=function(e){return e[1]},l=function(t,n,r,i,a){void 0===n&&(n=s),void 0===r&&(r=u),void 0===i&&(i=64),void 0===a&&(a=Float64Array),this.nodeSize=i,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,l=this.ids=new o(t.length),c=this.coords=new a(2*t.length),f=0;f<t.length;f++)l[f]=f,c[2*f]=n(t[f]),c[2*f+1]=r(t[f]);e(l,c,i,0,l.length-1,0)};l.prototype.range=function(e,t,n,r){return i(this.ids,this.coords,e,t,n,r,this.nodeSize)},l.prototype.within=function(e,t,n){return a(this.ids,this.coords,e,t,n,this.nodeSize)};var c,f={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},p=Math.fround||(c=new Float32Array(1),function(e){return c[0]=+e,c[0]}),h=function(e){this.options=x(Object.create(f),e),this.trees=new Array(this.options.maxZoom+1)};function d(e,t,n,r,i){return{x:p(e),y:p(t),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function v(e,t){var n=e.geometry.coordinates,r=n[0],i=n[1];return{x:p(g(r)),y:p(_(i)),zoom:1/0,index:t,parentId:-1}}function m(e){return{type:"Feature",id:e.id,properties:y(e),geometry:{type:"Point",coordinates:[b(e.x),E(e.y)]}}}function y(e){var t=e.numPoints,n=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return x(x({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:n})}function g(e){return e/360+.5}function _(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function b(e){return 360*(e-.5)}function E(e){var t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function x(e,t){for(var n in t)e[n]=t[n];return e}function S(e){return e.x}function T(e){return e.y}return h.prototype.load=function(e){var t=this.options,n=t.log,r=t.minZoom,i=t.maxZoom,a=t.nodeSize;n&&console.time("total time");var o="prepare "+e.length+" points";n&&console.time(o),this.points=e;for(var s=[],u=0;u<e.length;u++)e[u].geometry&&s.push(v(e[u],u));this.trees[i+1]=new l(s,S,T,a,Float32Array),n&&console.timeEnd(o);for(var c=i;c>=r;c--){var f=+Date.now();s=this._cluster(s,c),this.trees[c]=new l(s,S,T,a,Float32Array),n&&console.log("z%d: %d clusters in %dms",c,s.length,+Date.now()-f)}return n&&console.timeEnd("total time"),this},h.prototype.getClusters=function(e,t){var n=((e[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){var o=this.getClusters([n,r,180,a],t),s=this.getClusters([-180,r,i,a],t);return o.concat(s)}for(var u=this.trees[this._limitZoom(t)],l=[],c=0,f=u.range(g(n),_(a),g(i),_(r));c<f.length;c+=1){var p=f[c],h=u.points[p];l.push(h.numPoints?m(h):this.points[h.index])}return l},h.prototype.getChildren=function(e){var t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var a=i.points[t];if(!a)throw new Error(r);for(var o=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],u=0,l=i.within(a.x,a.y,o);u<l.length;u+=1){var c=l[u],f=i.points[c];f.parentId===e&&s.push(f.numPoints?m(f):this.points[f.index])}if(0===s.length)throw new Error(r);return s},h.prototype.getLeaves=function(e,t,n){t=t||10,n=n||0;var r=[];return this._appendLeaves(r,e,t,n,0),r},h.prototype.getTile=function(e,t,n){var r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),a=this.options,o=a.extent,s=a.radius/o,u=(n-s)/i,l=(n+1+s)/i,c={features:[]};return this._addTileFeatures(r.range((t-s)/i,u,(t+1+s)/i,l),r.points,t,n,i,c),0===t&&this._addTileFeatures(r.range(1-s/i,u,1,l),r.points,i,n,i,c),t===i-1&&this._addTileFeatures(r.range(0,u,s/i,l),r.points,-1,n,i,c),c.features.length?c:null},h.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t},h.prototype._appendLeaves=function(e,t,n,r,i){for(var a=0,o=this.getChildren(t);a<o.length;a+=1){var s=o[a],u=s.properties;if(u&&u.cluster?i+u.point_count<=r?i+=u.point_count:i=this._appendLeaves(e,u.cluster_id,n,r,i):i<r?i++:e.push(s),e.length===n)break}return i},h.prototype._addTileFeatures=function(e,t,n,r,i,a){for(var o=0,s=e;o<s.length;o+=1){var u=t[s[o]],l=u.numPoints,c=void 0,f=void 0,p=void 0;if(l)c=y(u),f=u.x,p=u.y;else{var h=this.points[u.index];c=h.properties,f=g(h.geometry.coordinates[0]),p=_(h.geometry.coordinates[1])}var d={type:1,geometry:[[Math.round(this.options.extent*(f*i-n)),Math.round(this.options.extent*(p*i-r))]],tags:c},v=void 0;l?v=u.id:this.options.generateId?v=u.index:this.points[u.index].id&&(v=this.points[u.index].id),void 0!==v&&(d.id=v),a.features.push(d)}},h.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))},h.prototype._cluster=function(e,t){for(var n=[],r=this.options,i=r.radius,a=r.extent,o=r.reduce,s=r.minPoints,u=i/(a*Math.pow(2,t)),l=0;l<e.length;l++){var c=e[l];if(!(c.zoom<=t)){c.zoom=t;for(var f=this.trees[t+1],p=f.within(c.x,c.y,u),h=c.numPoints||1,v=h,m=0,y=p;m<y.length;m+=1){var g=y[m],_=f.points[g];_.zoom>t&&(v+=_.numPoints||1)}if(v>h&&v>=s){for(var b=c.x*h,E=c.y*h,x=o&&h>1?this._map(c,!0):null,S=(l<<5)+(t+1)+this.points.length,T=0,A=p;T<A.length;T+=1){var w=A[T],C=f.points[w];if(!(C.zoom<=t)){C.zoom=t;var k=C.numPoints||1;b+=C.x*k,E+=C.y*k,C.parentId=S,o&&(x||(x=this._map(c,!0)),o(x,this._map(C)))}}c.parentId=S,n.push(d(b/v,E/v,S,v,x))}else if(n.push(c),v>1)for(var O=0,M=p;O<M.length;O+=1){var R=M[O],P=f.points[R];P.zoom<=t||(P.zoom=t,n.push(P))}}}return n},h.prototype._getOriginId=function(e){return e-this.points.length>>5},h.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},h.prototype._map=function(e,t){if(e.numPoints)return t?x({},e.properties):e.properties;var n=this.points[e.index].properties,r=this.options.map(n);return t&&r===n?x({},r):r},h}();function Kb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kb(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jb(e,t){var n=t.radius,r=void 0===n?40:n,i=t.maxZoom,a=void 0===i?18:i,o=t.minZoom,s=void 0===o?0:o,u=t.zoom,l=void 0===u?2:u;if(e.pointIndex){var c=e.pointIndex.getClusters(e.extent,Math.floor(l));return e.dataArray=c.map((function(e,t){return Qb({coordinates:e.geometry.coordinates,_id:t+1},e.properties)})),e}var f=new Zb({radius:r,minZoom:s,maxZoom:a}),p={type:"FeatureCollection",features:[]};return p.features=e.dataArray.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e.coordinates},properties:Qb({},e)}})),f.load(p.features),f}function $b(e){if(0===e.length)return 0;for(var t,n=e[0],r=0,i=1;i<e.length;i++)t=n+1*e[i],Math.abs(n)>=Math.abs(e[i])?r+=n-t+e[i]:r+=e[i]-t+n,n=t;return n+1*r}var eE={min:function(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t},max:function(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t},mean:function(e){if(0===e.length)throw new Error("mean requires at least one data point");return $b(e)/e.length},sum:$b};function tE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tE(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function iE(e,t){if(Array.isArray(t))return t}var aE=function(e){Gc(n,Xb.exports.EventEmitter);var t=rE(n);function n(e,r){var i;return Fc(this,n),lc(Xc(i=t.call(this)),"data",void 0),lc(Xc(i),"extent",void 0),lc(Xc(i),"hooks",{init:new Ub}),lc(Xc(i),"parser",{type:"geojson"}),lc(Xc(i),"transforms",[]),lc(Xc(i),"cluster",!1),lc(Xc(i),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),lc(Xc(i),"mapService",void 0),lc(Xc(i),"invalidExtent",!1),lc(Xc(i),"originData",void 0),lc(Xc(i),"rawData",void 0),lc(Xc(i),"cfg",{}),lc(Xc(i),"clusterIndex",void 0),i.originData=e,i.initCfg(r),i.hooks.init.tap("parser",(function(){i.excuteParser()})),i.hooks.init.tap("cluster",(function(){i.initCluster()})),i.hooks.init.tap("transform",(function(){i.executeTrans()})),i.init(),i}return Uc(n,[{key:"setData",value:function(e,t){this.rawData=e,this.originData=e,this.initCfg(t),this.init(),this.emit("update")}},{key:"getClusters",value:function(e){return this.clusterIndex.getClusters(this.caculClusterExtent(2),e)}},{key:"getClustersLeaves",value:function(e){return this.clusterIndex.getLeaves(e,1/0)}},{key:"updateClusterData",value:function(e){var t=this,n=this.clusterOptions,r=n.method,i=void 0===r?"sum":r,a=n.field,o=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(e));this.clusterOptions.zoom=e,o.forEach((function(e){e.id||(e.properties.point_count=1)})),(a||dd(i))&&(o=o.map((function(e){var n=e.id;if(n){var r,o=t.clusterIndex.getLeaves(n,1/0).map((function(e){return e.properties}));if(cg(i)&&a){var s=function(e,t){return e.map((function(e){return 1*e[t]}))}(o,a);r=eE[i](s)}dd(i)&&(r=i(o)),e.properties.stat=r}else e.properties.point_count=1;return e}))),this.data=$l("geojson")({type:"FeatureCollection",features:o}),this.executeTrans()}},{key:"getFeatureById",value:function(e){var t=this.parser.type;if("geojson"!==(void 0===t?"geojson":t)||this.cluster)return e<this.data.dataArray.length?this.data.dataArray[e]:"null";var n=e<this.originData.features.length?this.originData.features[e]:"null",r=mb(n);if(0!==this.transforms.length){var i=this.data.dataArray.find((function(t){return t._id===e}));r.properties=i}return r}},{key:"getFeatureId",value:function(e,t){var n=this.data.dataArray.find((function(t){return t[e]===name}));return null==n?void 0:n._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(e){var t,n=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(n=Dp([[(t=this.extent)[0],t[1]],[t[2],t[3]]],e)),n[0].concat(n[1])}},{key:"initCfg",value:function(e){this.cfg=og(this.cfg,e,iE);var t=this.cfg;t&&(t.parser&&(this.parser=t.parser),t.transforms&&(this.transforms=t.transforms),this.cluster=t.cluster||!1,t.clusterOptions&&(this.cluster=!0,this.clusterOptions=nE(nE({},this.clusterOptions),t.clusterOptions)))}},{key:"excuteParser",value:function(){var e=this.parser,t=e.type||"geojson";if("imagetile"!==t){var n=$l(t);this.data=n(this.originData,e),this.extent=Mp(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}else this.data={tileurl:this.originData,dataArray:[]}}},{key:"executeTrans",value:function(){var e=this;this.transforms.forEach((function(t){var n=function(e){return Ql[e]}(t.type)(e.data,t);Object.assign(e.data,n)}))}},{key:"initCluster",value:function(){if(this.cluster){var e=this.clusterOptions||{};this.clusterIndex=Jb(this.data,e)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),n}();function oE(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return sE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function sE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var uE=Math.PI/3,lE=[0,uE,2*uE,3*uE,4*uE,5*uE];function cE(e){return e[0]}function fE(e){return e[1]}function pE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pE(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dE(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ec("geojson",(function(e,t){var n=[],r={};return e.features=e.features.filter((function(e){var t=e.geometry;return null!=e&&t&&t.type&&t.coordinates&&t.coordinates.length>0})),bc(e,!0),0===e.features.length?{dataArray:[],featureKeys:r}:(Mc(e,(function(e,t){var r=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(e),i=t,a=Pc(Pc({},e.properties),{},{coordinates:r,_id:i});n.push(a)})),{dataArray:n,featureKeys:r})})),ec("image",wh),ec("csv",(function(e,t){return wc(uc(e),t)})),ec("json",wc),ec("raster",(function(e,t){var n=t.extent,r=t.width,i=t.height,a=t.min,o=t.max;return{_id:1,dataArray:[{_id:1,data:Array.from(e),width:r,height:i,min:a,max:o,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]}})),tc("cluster",Jb),tc("filter",(function(e,t){var n=t.callback;return n&&(e.dataArray=e.dataArray.filter(n)),e})),tc("join",(function(e,t){var n=t.sourceField,r=t.targetField,i=t.data,a={};return i.forEach((function(e){a[e[n]]=e})),e.dataArray=e.dataArray.map((function(e){var t=e[r];return vE(vE({},e),a[t])})),e})),tc("map",(function(e,t){var n=t.callback;return n&&(e.dataArray=e.dataArray.map(n)),e})),tc("grid",(function(e,t){var n=e.dataArray,r=t.size,i=void 0===r?10:r,a=i/(2*Math.PI*6378e3)*(256<<20)/2,o=function(e,t){var n,r,i=1/0,a=-1/0,o=oE(e);try{for(o.s();!(r=o.n()).done;){n=r.value.coordinates[1],Number.isFinite(n)&&(i=n<i?n:i,a=n>a?n:a)}}catch(x){o.e(x)}finally{o.f()}var s=(u=t,l=(i+a)/2,p=u,c=p/6378e3*(180/Math.PI),f=function(e,t){return t/6378e3*(180/Math.PI)/Math.cos(e*Math.PI/180)}(l,u),{yOffset:c,xOffset:f});var u,l,c,f,p;if(s.xOffset<=0||s.yOffset<=0)return{gridHash:{},gridOffset:s};var h,d={},v=oE(e);try{for(v.s();!(h=v.n()).done;){var m=h.value,y=m.coordinates[1],g=m.coordinates[0];if(Number.isFinite(y)&&Number.isFinite(g)){var _=Math.floor((y+90)/s.yOffset),b=Math.floor((g+180)/s.xOffset),E="".concat(_,"-").concat(b);d[E]=d[E]||{count:0,points:[]},d[E].count+=1,d[E].points.push(m)}}}catch(x){v.e(x)}finally{v.f()}return{gridHash:d,gridOffset:s}}(n,i);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:function(e,t,n){return Object.keys(e).reduce((function(r,i,a){var o=i.split("-"),s=parseInt(o[0],10),u=parseInt(o[1],10),l={};if(n.field&&n.method){var c=Ah(e[i].points,n.field);l[n.method]=Th[n.method](c)}return Object.assign(l,{_id:a,coordinates:Lp([t.xOffset*(u+.5)-180,t.yOffset*(s+.5)-90]),rawData:e[i].points,count:e[i].count}),r.push(l),r}),[])}(o.gridHash,o.gridOffset,t)}})),tc("hexagon",(function(e,t){var n=e.dataArray,r=t.size,i=void 0===r?10:r,a=t.method,o=void 0===a?"sum":a,s=i/(2*Math.PI*6378e3)*(256<<20)/2,u=n.map((function(e){var t=Ic(Lp(e.coordinates),2),n=t[0],r=t[1];return hE(hE({},e),{},{coordinates:[n,r]})}));return{dataArray:function(){var e,t,n,r=0,i=0,a=1,o=1,s=cE,u=fE;function l(e){var r,i={},a=[],o=e.length;for(r=0;r<o;++r)if(!isNaN(c=+s.call(null,l=e[r],r,e))&&!isNaN(f=+u.call(null,l,r,e))){var l,c,f,p=Math.round(f/=n),h=Math.round(c=c/t-(1&p)/2),d=f-p;if(3*Math.abs(d)>1){var v=c-h,m=h+(c<h?-1:1)/2,y=p+(f<p?-1:1),g=c-m,_=f-y;v*v+d*d>g*g+_*_&&(h=m+(1&p?1:-1)/2,p=y)}var b=h+"-"+p,E=i[b];E?E.push(l):(a.push(E=i[b]=[l]),E.x=(h+(1&p)/2)*t,E.y=p*n)}return a}function c(e){var t=0,n=0;return lE.map((function(r){var i=Math.sin(r)*e,a=-Math.cos(r)*e,o=i-t,s=a-n;return t=i,n=a,[o,s]}))}return l.hexagon=function(t){return"m"+c(null==t?e:+t).join("l")+"z"},l.centers=function(){for(var s=[],u=Math.round(i/n),l=Math.round(r/t),c=u*n;c<o+e;c+=n,++u)for(var f=l*t+(1&u)*t/2;f<a+t/2;f+=t)s.push([f,c]);return s},l.mesh=function(){var t=c(e).slice(0,4).join("l");return l.centers().map((function(e){return"M"+e+"m"+t})).join("")},l.x=function(e){return arguments.length?(s=e,l):s},l.y=function(e){return arguments.length?(u=e,l):u},l.radius=function(r){return arguments.length?(t=2*(e=+r)*Math.sin(uE),n=1.5*e,l):e},l.size=function(e){return arguments.length?(r=i=0,a=+e[0],o=+e[1],l):[a-r,o-i]},l.extent=function(e){return arguments.length?(r=+e[0][0],i=+e[0][1],a=+e[1][0],o=+e[1][1],l):[[r,i],[a,o]]},l.radius(1)}().radius(s).x((function(e){return e.coordinates[0]})).y((function(e){return e.coordinates[1]}))(u).map((function(e,n){var r;if(t.field&&o){var i=Ah(e,t.field);e[o]=Th[o](i)}return lc(r={},t.method,e[o]),lc(r,"count",e.length),lc(r,"rawData",e),lc(r,"coordinates",[e.x,e.y]),lc(r,"_id",n),r})),radius:s,xOffset:s,yOffset:s,type:"hexagon"}}));var mE,yE,gE=[{lng1:100,lat1:30,lng2:130,lat2:30}],_E={parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}};yE=mE||(mE={}),function(t){var n="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=i(yE);function i(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===n.Reflect?n.Reflect=yE:r=i(n.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,o={__proto__:[]}instanceof Array,s=!a&&!o,u={create:a?function(){return re(Object.create(null))}:o?function(){return re({__proto__:null})}:function(){return re({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),c="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=c||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,p=c||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,h=new(c||"function"!=typeof WeakMap?ne():WeakMap);function d(e,t,n,r){if(N(n)){if(!G(e))throw new TypeError;if(!X(t))throw new TypeError;return T(e,t)}if(!G(e))throw new TypeError;if(!j(t))throw new TypeError;if(!j(r)&&!N(r)&&!D(r))throw new TypeError;return D(r)&&(r=void 0),A(e,t,n=H(n),r)}function v(e,t){function n(n,r){if(!j(n))throw new TypeError;if(!N(r)&&!Y(r))throw new TypeError;R(e,t,n,r)}return n}function m(e,t,n,r){if(!j(n))throw new TypeError;return N(r)||(r=H(r)),R(e,t,n,r)}function y(e,t,n){if(!j(t))throw new TypeError;return N(n)||(n=H(n)),C(e,t,n)}function g(e,t,n){if(!j(t))throw new TypeError;return N(n)||(n=H(n)),k(e,t,n)}function _(e,t,n){if(!j(t))throw new TypeError;return N(n)||(n=H(n)),O(e,t,n)}function b(e,t,n){if(!j(t))throw new TypeError;return N(n)||(n=H(n)),M(e,t,n)}function E(e,t){if(!j(e))throw new TypeError;return N(t)||(t=H(t)),P(e,t)}function x(e,t){if(!j(e))throw new TypeError;return N(t)||(t=H(t)),I(e,t)}function S(e,t,n){if(!j(t))throw new TypeError;N(n)||(n=H(n));var r=w(t,n,!1);if(N(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=h.get(t);return i.delete(n),i.size>0||h.delete(t),!0}function T(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!N(r)&&!D(r)){if(!X(r))throw new TypeError;t=r}}return t}function A(e,t,n,r){for(var i=e.length-1;i>=0;--i){var a=(0,e[i])(t,n,r);if(!N(a)&&!D(a)){if(!j(a))throw new TypeError;r=a}}return r}function w(e,t,n){var r=h.get(e);if(N(r)){if(!n)return;r=new f,h.set(e,r)}var i=r.get(t);if(N(i)){if(!n)return;i=new f,r.set(t,i)}return i}function C(e,t,n){if(k(e,t,n))return!0;var r=$(t);return!D(r)&&C(e,r,n)}function k(e,t,n){var r=w(t,n,!1);return!N(r)&&z(r.has(e))}function O(e,t,n){if(k(e,t,n))return M(e,t,n);var r=$(t);return D(r)?void 0:O(e,r,n)}function M(e,t,n){var r=w(t,n,!1);if(!N(r))return r.get(e)}function R(e,t,n,r){w(n,r,!0).set(e,t)}function P(e,t){var n=I(e,t),r=$(e);if(null===r)return n;var i=P(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var a=new p,o=[],s=0,u=n;s<u.length;s++){var l=u[s];a.has(l)||(a.add(l),o.push(l))}for(var c=0,f=i;c<f.length;c++)l=f[c],a.has(l)||(a.add(l),o.push(l));return o}function I(e,t){var n=[],r=w(e,t,!1);if(N(r))return n;for(var i=Z(r.keys()),a=0;;){var o=Q(i);if(!o)return n.length=a,n;var s=K(o);try{n[a]=s}catch(u){try{J(i)}finally{throw u}}a++}}function L(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function N(e){return void 0===e}function D(e){return null===e}function F(e){return"symbol"==typeof e}function j(e){return"object"==typeof e?null!==e:"function"==typeof e}function U(e,t){switch(L(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=q(e,r);if(void 0!==i){var a=i.call(e,n);if(j(a))throw new TypeError;return a}return B(e,"default"===n?"number":n)}function B(e,t){if("string"===t){var n=e.toString;if(W(n)&&!j(i=n.call(e)))return i;if(W(r=e.valueOf)&&!j(i=r.call(e)))return i}else{var r;if(W(r=e.valueOf)&&!j(i=r.call(e)))return i;var i,a=e.toString;if(W(a)&&!j(i=a.call(e)))return i}throw new TypeError}function z(e){return!!e}function V(e){return""+e}function H(e){var t=U(e,3);return F(t)?t:V(t)}function G(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function X(e){return"function"==typeof e}function Y(e){switch(L(e)){case 3:case 4:return!0;default:return!1}}function q(e,t){var n=e[t];if(null!=n){if(!W(n))throw new TypeError;return n}}function Z(e){var t=q(e,i);if(!W(t))throw new TypeError;var n=t.call(e);if(!j(n))throw new TypeError;return n}function K(e){return e.value}function Q(e){var t=e.next();return!t.done&&t}function J(e){var t=e.return;t&&t.call(e)}function $(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,a)},t.prototype.entries=function(){return new n(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function a(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function ne(){var e=16,n=u.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=a(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=a(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return a(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=a(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+l()}while(u.has(n,e));return n[e]=!0,e}function a(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:u.create()})}return e[r]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function l(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",d),e("metadata",v),e("defineMetadata",m),e("hasMetadata",y),e("hasOwnMetadata",g),e("getMetadata",_),e("getOwnMetadata",b),e("getMetadataKeys",E),e("getOwnMetadataKeys",x),e("deleteMetadata",S)}(r)}();var bE=["inject","multi_inject","name","unmanaged","named","optional"],EE="Request",xE="Singleton",SE="Transient",TE="ConstantValue",AE="Constructor",wE="DynamicValue",CE="Factory",kE="Function",OE="Instance",ME="Invalid",RE="Provider",PE="ClassProperty",IE="ConstructorArgument",LE="Variable",NE=0;function DE(){return NE++}var FE=function(){function e(e,t){this.id=DE(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=ME,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===xE&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}(),jE="No matching bindings found for serviceIdentifier:",UE=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata("inversify:paramtypes",e),userGeneratedMetadata:Reflect.getMetadata("inversify:tagged",e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata("inversify:tagged_props",e)||[]},e}(),BE=2,zE=0,VE=1;function HE(e){return e instanceof RangeError||"Maximum call stack size exceeded"===e.message}function GE(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function WE(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=qE(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r}function XE(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||XE(e.parentRequest,t))}function YE(e){e.childRequests.forEach((function(e){if(XE(e,e.serviceIdentifier)){var t=function(e){return function e(t,n){void 0===n&&(n=[]);var r=GE(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(e);throw new Error("Circular dependency found: "+t)}YE(e)}))}function qE(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var ZE=function(){function e(e){this.id=DE(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),KE=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return"named"===this.key?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}(),QE=function(e,t){this.parentContext=e,this.rootRequest=t};function JE(e,t,n,r,i){var a={},o="number"==typeof i,s=void 0!==i&&o?i.toString():n;if(o&&void 0!==n)throw new Error("The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.");Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var u=a[s];if(Array.isArray(u))for(var l=0,c=u;l<c.length;l++){var f=c[l];if(f.key===r.key)throw new Error("Metadata key was used more than once in a parameter: "+f.key.toString())}else u=[];u.push(r),a[s]=u,Reflect.defineMetadata(e,a,t)}function $E(e,t){Reflect.decorate(e,t)}function ex(e,t){return function(n,r){t(n,r,e)}}var tx=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();function nx(e){return function(t,n,r){if(void 0===e)throw new Error("@inject called with undefined this could mean that the class "+t.name+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation.");var i=new KE("inject",e);"number"==typeof r?function(e,t,n,r){JE("inversify:tagged",e,t,r,n)}(t,n,r,i):function(e,t,n){JE("inversify:tagged_props",e.constructor,t,n)}(t,n,i)}}var rx=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),ix=function(){function e(e,t,n,r){this.id=DE(),this.type=e,this.serviceIdentifier=n,this.name=new rx(t||""),this.metadata=new Array;var i=null;"string"==typeof r?i=new KE("named",r):r instanceof KE&&(i=r),null!==i&&this.metadata.push(i)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag("multi_inject")},e.prototype.matchesArray=function(e){return this.matchesTag("multi_inject")(e)},e.prototype.isNamed=function(){return this.hasTag("named")},e.prototype.isTagged=function(){return this.metadata.some((function(e){return bE.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag("optional")(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return"named"===e.key}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return bE.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag("named")(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var a=i[r];if(a.key===e&&a.value===n)return!0}return!1}},e}(),ax=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};function ox(e,t,n,r){var i=e.getConstructorMetadata(n),a=i.compilerGeneratedMetadata;if(void 0===a)throw new Error("Missing required @injectable annotation in: "+t+".");var o=i.userGeneratedMetadata,s=Object.keys(o),u=0===n.length&&s.length>0,l=s.length>n.length,c=function(e,t,n,r,i){for(var a=[],o=0;o<i;o++){var s=sx(o,e,t,n,r);null!==s&&a.push(s)}return a}(r,t,a,o,u||l?s.length:n.length),f=ux(e,n);return ax(ax([],c),f)}function sx(e,t,n,r,i){var a=i[e.toString()]||[],o=cx(a),s=!0!==o.unmanaged,u=r[e],l=o.inject||o.multiInject;if((u=l||u)instanceof tx&&(u=u.unwrap()),s){if(!t&&(u===Object||u===Function||void 0===u))throw new Error("Missing required @inject or @multiInject annotation in: argument "+e+" in class "+n+".");var c=new ix(IE,o.targetName,u);return c.metadata=a,c}return null}function ux(e,t){for(var n=e.getPropertiesMetadata(t),r=[],i=0,a=Object.keys(n);i<a.length;i++){var o=a[i],s=n[o],u=cx(n[o]),l=u.targetName||o,c=u.inject||u.multiInject,f=new ix(PE,l,c);f.metadata=s,r.push(f)}var p=Object.getPrototypeOf(t.prototype).constructor;if(p!==Object){var h=ux(e,p);r=ax(ax([],r),h)}return r}function lx(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var r=ox(e,qE(n),n,!0),i=r.map((function(e){return e.metadata.filter((function(e){return"unmanaged"===e.key}))})),a=[].concat.apply([],i).length,o=r.length-a;return o>0?o:lx(e,n)}return 0}function cx(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t.inject,multiInject:t.multi_inject,targetName:t.name,unmanaged:t.unmanaged}}var fx=function(){function e(e,t,n,r,i){this.id=DE(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();function px(e){return e._bindingDictionary}function hx(e,t,n,r,i){var a=vx(n.container,i.serviceIdentifier),o=[];return a.length===zE&&n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),a=vx(n.container,i.serviceIdentifier)),o=t?a:a.filter((function(e){var t=new fx(e.serviceIdentifier,n,r,e,i);return e.constraint(t)})),function(e,t,n,r){switch(t.length){case zE:if(n.isOptional())return t;var i=GE(e),a=jE;throw a+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(i,n),a+=WE(r,i,vx),new Error(a);case VE:if(!n.isArray())return t;case BE:default:if(n.isArray())return t;a="Ambiguous match found for serviceIdentifier: "+(i=GE(e));throw a+=WE(r,i,vx),new Error(a)}}(i.serviceIdentifier,o,i,n.container),o}function dx(e,t,n,r,i,a){var o,s;if(null===i){o=hx(e,t,r,null,a),s=new fx(n,r,null,o,a);var u=new QE(r,s);r.addPlan(u)}else o=hx(e,t,r,i,a),s=i.addChildRequest(a.serviceIdentifier,o,a);o.forEach((function(t){var n=null;if(a.isArray())n=s.addChildRequest(t.serviceIdentifier,t,a);else{if(t.cache)return;n=s}if(t.type===OE&&null!==t.implementationType){var i=function(e,t){return ox(e,qE(t),t,!1)}(e,t.implementationType);if(!r.container.options.skipBaseClassChecks){var o=lx(e,t.implementationType);if(i.length<o){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."}(qE(t.implementationType));throw new Error(u)}}i.forEach((function(t){dx(e,!1,t.serviceIdentifier,r,n,t)}))}}))}function vx(e,t){var n=[],r=px(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=vx(e.parent,t)),n}function mx(e,t,n,r,i,a,o,s){void 0===s&&(s=!1);var u=new ZE(t),l=function(e,t,n,r,i,a){var o=new KE(e?"multi_inject":"inject",n),s=new ix(t,r,n,o);if(void 0!==i){var u=new KE(i,a);s.metadata.push(u)}return s}(n,r,i,"",a,o);try{return dx(e,s,i,u,null,l),u}catch(c){throw HE(c)&&u.plan&&YE(u.plan.rootRequest),c}}function yx(e,t,n){var r,i,a=null;if(t.length>0){var o=t.filter((function(e){return null!==e.target&&e.target.type===IE})).map(n);i=o,a=function(e,t,n){var r=t.filter((function(e){return null!==e.target&&e.target.type===PE})),i=r.map(n);return r.forEach((function(t,n){var r;r=t.target.name.value();var a=i[n];e[r]=a})),e}(a=new((r=e).bind.apply(r,function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}([void 0],i))),t,n)}else a=new e;return function(e,t){if(Reflect.hasMetadata("post_construct",e)){var n=Reflect.getMetadata("post_construct",e);try{t[n.value]()}catch(r){throw new Error(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]}(e.name,r.message))}}}(e,a),a}var gx=function(e,t,n){try{return n()}catch(r){throw HE(r)?new Error(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."}(e,t.toString())):r}},_x=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),a=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&a)return r.map((function(t){return _x(e)(t)}));var o=null;if(!t.target.isOptional()||0!==n.length){var s=n[0],u=s.scope===xE,l=s.scope===EE;if(u&&s.activated)return s.cache;if(l&&null!==e&&e.has(s.id))return e.get(s.id);if(s.type===TE)o=s.cache,s.activated=!0;else if(s.type===kE)o=s.cache,s.activated=!0;else if(s.type===AE)o=s.implementationType;else if(s.type===wE&&null!==s.dynamicValue)o=gx("toDynamicValue",s.serviceIdentifier,(function(){return s.dynamicValue(t.parentContext)}));else if(s.type===CE&&null!==s.factory)o=gx("toFactory",s.serviceIdentifier,(function(){return s.factory(t.parentContext)}));else if(s.type===RE&&null!==s.provider)o=gx("toProvider",s.serviceIdentifier,(function(){return s.provider(t.parentContext)}));else{if(s.type!==OE||null===s.implementationType){var c=GE(t.serviceIdentifier);throw new Error("Invalid binding type: "+c)}o=yx(s.implementationType,r,_x(e))}return"function"==typeof s.onActivation&&(o=s.onActivation(t.parentContext,o)),u&&(s.cache=o,s.activated=!0),l&&null!==e&&!e.has(s.id)&&e.set(s.id,o),o}}};var bx=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||bx(n,t))},Ex=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new KE(e,t),n}},xx=Ex("named"),Sx=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}},Tx=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new Ax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=xx(e),new Ax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new Ax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Ex(e)(t),new Ax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return Sx(e)(t.parentRequest)},new Ax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return xx(e)(t.parentRequest)},new Ax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return Ex(e)(t)(n.parentRequest)},new Ax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return bx(t,Sx(e))},new Ax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!bx(t,Sx(e))},new Ax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return bx(t,xx(e))},new Ax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!bx(t,xx(e))},new Ax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return bx(n,Ex(e)(t))},new Ax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!bx(n,Ex(e)(t))},new Ax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return bx(t,e)},new Ax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!bx(t,e)},new Ax(this._binding)},e}(),Ax=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new Tx(this._binding)},e}(),Cx=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new Tx(this._binding),this._bindingOnSyntax=new Ax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),kx=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=EE,new Cx(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=xE,new Cx(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=SE,new Cx(this._binding)},e}(),Ox=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new Tx(this._binding),this._bindingOnSyntax=new Ax(this._binding),this._bindingInSyntax=new kx(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),Mx=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=OE,this._binding.implementationType=e,new Ox(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=TE,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=xE,new Cx(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=wE,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Ox(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=AE,this._binding.implementationType=e,this._binding.scope=xE,new Cx(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=CE,this._binding.factory=e,this._binding.scope=xE,new Cx(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error("Value provided to function binding must be a function!");var t=this.toConstantValue(e);return this._binding.type=kE,this._binding.scope=xE,t},e.prototype.toAutoFactory=function(e){return this._binding.type=CE,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=xE,new Cx(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=RE,this._binding.provider=e,this._binding.scope=xE,new Cx(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),Rx=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}(),Px=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error("NULL argument");if(null==t)throw new Error("NULL argument");var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error("NULL argument");var t=this._map.get(e);if(void 0!==t)return t;throw new Error("Key Not Found")},e.prototype.remove=function(e){if(null==e)throw new Error("NULL argument");if(!this._map.delete(e))throw new Error("Key Not Found")},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,r){var i=n.filter((function(t){return!e(t)}));i.length>0?t._map.set(r,i):t._map.delete(r)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error("NULL argument");return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}(),Ix=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},Lx=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Nx=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},Dx=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===t.defaultScope)t.defaultScope=SE;else if(t.defaultScope!==xE&&t.defaultScope!==SE&&t.defaultScope!==EE)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=DE(),this._bindingDictionary=new Px,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new UE}return e.merge=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=new e,o=Nx([t,n],r).map((function(e){return px(e)})),s=px(a);function u(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return o.forEach((function(e){u(e,s)})),a},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var a=i[r],o=n(a.id);a.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ix(this,void 0,void 0,(function(){var t,n,r,i,a;return Lx(this,(function(o){switch(o.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,o.label=1;case 1:return n<r.length?(i=r[n],a=t(i.id),[4,i.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||SE,n=new FE(e,t);return this._bindingDictionary.add(e,n),new Mx(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error("Could not unbind serviceIdentifier: "+GE(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new Px},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,"named",t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),a=function(e,t,n,r){var i=new ix(LE,"",t,new KE(n,r)),a=new ZE(e);return new fx(t,a,null,[],i)}(this,e,t,n);r=i.some((function(e){return e.constraint(a)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(Rx.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,LE,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,LE,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,"named",t)},e.prototype.getAll=function(e){return this._get(!0,!0,LE,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,LE,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,"named",t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind.bind(e)(r);return t(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=e.bind.bind(e)(n);return t(r,i),r}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(r),unbindFunction:function(t){e.unbind.bind(e)(t)}};var i}},e.prototype._get=function(e,t,n,r,i,a){var o=null,s={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:a};if(this._middleware){if(null==(o=this._middleware(s)))throw new Error("Invalid return type in middleware. Middleware must return!")}else o=this._planAndResolve()(s);return o},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=mx(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return _x(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e}();function Fx(){return function(e){if(Reflect.hasOwnMetadata("inversify:paramtypes",e))throw new Error("Cannot apply @injectable decorator multiple times.");var t=Reflect.getMetadata("design:paramtypes",e)||[];return Reflect.defineMetadata("inversify:paramtypes",t,e),e}}var jx=Symbol.for("INJECTION");function Ux(e,t,n,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return r&&!Reflect.hasMetadata(jx,this,t)&&Reflect.defineMetadata(jx,n(),this,t),Reflect.hasMetadata(jx,this,t)?Reflect.getMetadata(jx,this,t):n()},set:function(e){Reflect.defineMetadata(jx,e,this,t)}})}var Bx={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},zx={exports:{}};zx.exports=Hx,zx.exports.default=Hx;var Vx=1e20;function Hx(e,t,n,r,i,a){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=n||8;var o=this.size=this.fontSize+2*this.buffer,s=o+2*this.buffer,u="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast;u?this.canvas=my.createOffscreenCanvas(o,o,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o),this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=u?Math.round(o/2*1):Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Gx(e,t,n,r,i,a){for(var o=0;o<t;o++)Wx(e,o,t,n,r,i,a);for(var s=0;s<n;s++)Wx(e,s*t,1,t,r,i,a)}function Wx(e,t,n,r,i,a,o){var s,u,l,c;for(a[0]=0,o[0]=-Vx,o[1]=Vx,s=0;s<r;s++)i[s]=e[t+s*n];for(s=1,u=0,l=0;s<r;s++){do{c=a[u],l=(i[s]-i[c]+s*s-c*c)/(s-c)/2}while(l<=o[u]&&--u>-1);a[++u]=s,o[u]=l,o[u+1]=Vx}for(s=0,u=0;s<r;s++){for(;o[u+1]<s;)u++;c=a[u],e[t+s*n]=i[c]+(s-c)*(s-c)}}Hx.prototype._draw=function(e,t){var n,r,i,a,o,s,u,l,c,f=this.ctx.measureText(e),p=f.width,h=2*this.buffer;t&&this.useMetrics?(o=Math.floor(f.actualBoundingBoxAscent),l=this.buffer+Math.ceil(f.actualBoundingBoxAscent),s=this.buffer,u=this.buffer,n=(r=Math.min(this.size,Math.ceil(f.actualBoundingBoxRight-f.actualBoundingBoxLeft)))+h,i=(a=Math.min(this.size-s,Math.ceil(f.actualBoundingBoxAscent+f.actualBoundingBoxDescent)))+h,this.ctx.textBaseline="alphabetic"):(n=r=this.size,i=a=this.size,o=19*this.fontSize/24,s=u=0,l=this.middle,this.ctx.textBaseline="middle"),r&&a&&(this.ctx.clearRect(u,s,r,a),this.ctx.fillText(e,this.buffer,l),c=this.ctx.getImageData(u,s,r,a));var d=new Uint8ClampedArray(n*i);return function(e,t,n,r,i,a,o){a.fill(Vx,0,t*n),o.fill(0,0,t*n);for(var s=(t-r)/2,u=0;u<i;u++)for(var l=0;l<r;l++){var c=(u+s)*t+l+s,f=e.data[4*(u*r+l)+3]/255;if(1===f)a[c]=0,o[c]=Vx;else if(0===f)a[c]=Vx,o[c]=0;else{var p=Math.max(0,.5-f),h=Math.max(0,f-.5);a[c]=p*p,o[c]=h*h}}}(c,n,i,r,a,this.gridOuter,this.gridInner),Gx(this.gridOuter,n,i,this.f,this.v,this.z),Gx(this.gridInner,n,i,this.f,this.v,this.z),function(e,t,n,r,i,a,o){for(var s=0;s<t*n;s++){var u=Math.sqrt(r[s])-Math.sqrt(i[s]);e[s]=Math.round(255-255*(u/a+o))}}(d,n,i,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:d,metrics:{width:r,height:a,sdfWidth:n,sdfHeight:i,top:o,left:0,advance:p}}},Hx.prototype.draw=function(e){return this._draw(e,!1).data},Hx.prototype.drawWithMetrics=function(e){return this._draw(e,!0)};var Xx=zx.exports;function Yx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yx(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zx(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Kx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kx(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Kx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qx;function Jx(e,t,n){var r,i=Zx(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.icon,s=a.xOffset;e[o.id]=qx(qx({},o),{},{x:s,y:n,image:o.image,width:o.width,height:o.height})}}catch(u){i.e(u)}finally{i.f()}}function $x(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function eS(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tS(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function tS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nS(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var iS=function(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}();function aS(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="black",e.textBaseline="middle"}function oS(e,t){for(var n=0;n<e.length;n++)t.data[4*n+3]=e[n]}var sS,uS=Fx()(Qx=function(){function e(){Fc(this,e),lc(this,"fontAtlas",void 0),lc(this,"iconFontMap",void 0),lc(this,"iconFontGlyphs",{}),lc(this,"fontOptions",void 0),lc(this,"key",void 0),lc(this,"cache",new jp(3))}return Uc(e,[{key:"scale",get:function(){return 1}},{key:"canvas",get:function(){var e=this.cache.get(this.key);return e&&e.data}},{key:"mapping",get:function(){var e=this.cache.get(this.key);return e&&e.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:iS,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(e){var t=this;e.forEach((function(e){t.iconFontGlyphs[e.name]=e.unicode}))}},{key:"addIconFont",value:function(e,t){this.iconFontMap.set(e,t)}},{key:"getIconFontKey",value:function(e){return this.iconFontMap.get(e)||e}},{key:"getGlyph",value:function(e){return this.iconFontGlyphs[e]?String.fromCharCode(parseInt(this.iconFontGlyphs[e],16)):""}},{key:"setFontOptions",value:function(e){this.fontOptions=rS(rS({},this.fontOptions),e),this.key=this.getKey();var t=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(!n||0!==t.length){var r=this.generateFontAtlas(this.key,t,n);this.fontAtlas=r,this.cache.set(this.key,r)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(e,t,n){var r=this.fontOptions,i=r.fontFamily,a=r.fontWeight,o=r.fontSize,s=r.buffer,u=r.sdf,l=r.radius,c=r.cutoff,f=r.iconfont,p=n&&n.data;p||((p=lp.document.createElement("canvas")).width=1024);var h=p.getContext("2d");aS(h,i,o,a);var d=function(e){var t=e.characterSet,n=e.getFontWidth,r=e.fontHeight,i=e.buffer,a=e.maxCanvasWidth,o=e.mapping,s=void 0===o?{}:o,u=e.xOffset,l=void 0===u?0:u,c=e.yOffset,f=void 0===c?0:c,p=0,h=l;Array.from(t).forEach((function(e,t){if(!s[e]){var r=n(e,t);h+30>a&&(h=0,p++),s[e]={x:h,y:f+30*p,width:30,height:30,advance:r},h+=30}}));var d=r+2*i;return{mapping:s,xOffset:h,yOffset:f+p*d,canvasHeight:$x(f+(p+1)*d)}}(rS({getFontWidth:function(e){return h.measureText(e).width},fontHeight:1*o,buffer:s,characterSet:t,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),v=d.mapping,m=d.canvasHeight,y=d.xOffset,g=d.yOffset,_=h.getImageData(0,0,p.width,p.height);if(p.height=m,h.putImageData(_,0,0),aS(h,i,o,a),u){var b,E=new Xx(o,s,l,c,i,a),x=h.getImageData(0,0,E.size,E.size),S=eS(t);try{for(S.s();!(b=S.n()).done;){var T=b.value;if(f){var A=String.fromCharCode(parseInt(T.replace("&#x","").replace(";",""),16));oS(E.draw(A),x)}else oS(E.draw(T),x);h.putImageData(x,v[T].x,v[T].y)}}catch(O){S.e(O)}finally{S.f()}}else{var w,C=eS(t);try{for(C.s();!(w=C.n()).done;){var k=w.value;h.fillText(k,v[k].x,v[k].y+1*o)}}catch(O){C.e(O)}finally{C.f()}}return{xOffset:y,yOffset:g,mapping:v,data:p,width:p.width,height:p.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(e,t){var n=this.cache.get(e);if(!n)return t;var r=[],i=n.mapping,a=new Set(Object.keys(i));return new Set(t).forEach((function(e){a.has(e)||r.push(e)})),r}}]),e}())||Qx;function lS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var cS=Fx()(sS=function(e){Gc(n,Xb.exports.EventEmitter);var t=lS(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"canvasHeight",128),lc(Xc(e),"texture",void 0),lc(Xc(e),"canvas",void 0),lc(Xc(e),"iconData",void 0),lc(Xc(e),"iconMap",void 0),lc(Xc(e),"ctx",void 0),lc(Xc(e),"loadingImageCount",0),e}return Uc(n,[{key:"isLoading",value:function(){return 0===this.loadingImageCount}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=lp.document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(e,t){var n=this,r=new Image;if(this.loadingImageCount++,this.hasImage(e))throw new Error("Image Id already exists");this.iconData.push({id:e,size:64}),this.updateIconMap(),this.loadImage(t).then((function(t){r=t;var i=n.iconData.find((function(t){return t.id===e}));i&&(i.image=r,i.width=r.width,i.height=r.height),n.update()}))}},{key:"addImageMini",value:function(e,t,n){var r=this,i=n.getSceneConfig().canvas,a=i.createImage();if(this.loadingImageCount++,this.hasImage(e))throw new Error("Image Id already exists");this.iconData.push({id:e,size:64}),this.updateIconMap(),this.loadImageMini(t,i).then((function(t){a=t;var n=r.iconData.find((function(t){return t.id===e}));n&&(n.image=a,n.width=a.width,n.height=a.height),r.update()}))}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(e){return this.iconMap.hasOwnProperty(e)}},{key:"removeImage",value:function(e){this.hasImage(e)&&(this.iconData=this.iconData.filter((function(t){return t.id!==e})),delete this.iconMap[e],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var e=this;this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach((function(t){var n=e.iconMap[t],r=n.x,i=n.y,a=n.image,o=n.width,s=void 0===o?64:o,u=n.height,l=void 0===u?64:u,c=Math.max(s,l)/64,f=l/c,p=s/c;a&&e.ctx.drawImage(a,r+(64-p)/2,i+(64-f)/2,p,f)}))}},{key:"updateIconMap",value:function(){var e=function(e,t,n){var r,i=0,a=0,o=0,s=[],u={},l=Zx(e);try{for(l.s();!(r=l.n()).done;){var c=r.value;if(!u[c.id]){var f=c.size;i+f+t>n&&(Jx(u,s,a),i=0,a=o+a+t,o=0,s=[]),s.push({icon:c,xOffset:i}),i=i+f+t,o=Math.max(o,f)}}}catch(p){l.e(p)}finally{l.f()}return s.length>0&&Jx(u,s,a),{mapping:u,canvasHeight:$x(o+a+t)}}(this.iconData,3,1024),t=e.mapping,n=e.canvasHeight;this.iconMap=t,this.canvasHeight=n}},{key:"loadImage",value:function(e){return new Promise((function(t,n){if(e instanceof HTMLImageElement)t(e);else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){t(r)},r.onerror=function(){n(new Error("Could not load image at "+e))},r.src=e instanceof File?URL.createObjectURL(e):e}}))}},{key:"loadImageMini",value:function(e,t){return new Promise((function(n,r){var i=t.createImage();i.crossOrigin="anonymous",i.onload=function(){n(i)},i.onerror=function(){r(new Error("Could not load image at "+e))},i.src=e}))}}]),n}())||sS,fS=1e-6,pS="undefined"!=typeof Float32Array?Float32Array:Array,hS=Math.random;function dS(){var e=new pS(16);return pS!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function vS(e){var t=new pS(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function mS(e,t,n,r,i,a,o,s,u,l,c,f,p,h,d,v){var m=new pS(16);return m[0]=e,m[1]=t,m[2]=n,m[3]=r,m[4]=i,m[5]=a,m[6]=o,m[7]=s,m[8]=u,m[9]=l,m[10]=c,m[11]=f,m[12]=p,m[13]=h,m[14]=d,m[15]=v,m}function yS(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gS(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],p=t[10],h=t[11],d=t[12],v=t[13],m=t[14],y=t[15],g=n*s-r*o,_=n*u-i*o,b=n*l-a*o,E=r*u-i*s,x=r*l-a*s,S=i*l-a*u,T=c*v-f*d,A=c*m-p*d,w=c*y-h*d,C=f*m-p*v,k=f*y-h*v,O=p*y-h*m,M=g*O-_*k+b*C+E*w-x*A+S*T;return M?(M=1/M,e[0]=(s*O-u*k+l*C)*M,e[1]=(i*k-r*O-a*C)*M,e[2]=(v*S-m*x+y*E)*M,e[3]=(p*x-f*S-h*E)*M,e[4]=(u*w-o*O-l*A)*M,e[5]=(n*O-i*w+a*A)*M,e[6]=(m*b-d*S-y*_)*M,e[7]=(c*S-p*b+h*_)*M,e[8]=(o*k-s*w+l*T)*M,e[9]=(r*w-n*k-a*T)*M,e[10]=(d*x-v*b+y*g)*M,e[11]=(f*b-c*x-h*g)*M,e[12]=(s*A-o*C-u*T)*M,e[13]=(n*C-r*A+i*T)*M,e[14]=(v*_-d*E-m*g)*M,e[15]=(c*E-f*_+p*g)*M,e):null}function _S(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],p=t[9],h=t[10],d=t[11],v=t[12],m=t[13],y=t[14],g=t[15],_=n[0],b=n[1],E=n[2],x=n[3];return e[0]=_*r+b*s+E*f+x*v,e[1]=_*i+b*u+E*p+x*m,e[2]=_*a+b*l+E*h+x*y,e[3]=_*o+b*c+E*d+x*g,_=n[4],b=n[5],E=n[6],x=n[7],e[4]=_*r+b*s+E*f+x*v,e[5]=_*i+b*u+E*p+x*m,e[6]=_*a+b*l+E*h+x*y,e[7]=_*o+b*c+E*d+x*g,_=n[8],b=n[9],E=n[10],x=n[11],e[8]=_*r+b*s+E*f+x*v,e[9]=_*i+b*u+E*p+x*m,e[10]=_*a+b*l+E*h+x*y,e[11]=_*o+b*c+E*d+x*g,_=n[12],b=n[13],E=n[14],x=n[15],e[12]=_*r+b*s+E*f+x*v,e[13]=_*i+b*u+E*p+x*m,e[14]=_*a+b*l+E*h+x*y,e[15]=_*o+b*c+E*d+x*g,e}function bS(e,t,n){var r,i,a,o,s,u,l,c,f,p,h,d,v=n[0],m=n[1],y=n[2];return t===e?(e[12]=t[0]*v+t[4]*m+t[8]*y+t[12],e[13]=t[1]*v+t[5]*m+t[9]*y+t[13],e[14]=t[2]*v+t[6]*m+t[10]*y+t[14],e[15]=t[3]*v+t[7]*m+t[11]*y+t[15]):(r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],p=t[9],h=t[10],d=t[11],e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=f,e[9]=p,e[10]=h,e[11]=d,e[12]=r*v+s*m+f*y+t[12],e[13]=i*v+u*m+p*y+t[13],e[14]=a*v+l*m+h*y+t[14],e[15]=o*v+c*m+d*y+t[15]),e}function ES(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function xS(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*r,e[5]=o*i+c*r,e[6]=s*i+f*r,e[7]=u*i+p*r,e[8]=l*i-a*r,e[9]=c*i-o*r,e[10]=f*i-s*r,e[11]=p*i-u*r,e}function SS(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*r,e[1]=o*i-c*r,e[2]=s*i-f*r,e[3]=u*i-p*r,e[8]=a*r+l*i,e[9]=o*r+c*i,e[10]=s*r+f*i,e[11]=u*r+p*i,e}function TS(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*r,e[1]=o*i+c*r,e[2]=s*i+f*r,e[3]=u*i+p*r,e[4]=l*i-a*r,e[5]=c*i-o*r,e[6]=f*i-s*r,e[7]=p*i-u*r,e}function AS(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function wS(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,u=i+i,l=a+a,c=r*s,f=r*u,p=r*l,h=i*u,d=i*l,v=a*l,m=o*s,y=o*u,g=o*l;return e[0]=1-(h+v),e[1]=f+g,e[2]=p-y,e[3]=0,e[4]=f-g,e[5]=1-(c+v),e[6]=d+m,e[7]=0,e[8]=p+y,e[9]=d-m,e[10]=1-(c+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function CS(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(u,l,c),e}function kS(e,t,n,r,i){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var OS=kS;function MS(e,t,n,r,i,a,o){var s=1/(t-n),u=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(o+a)*l,e[15]=1,e}var RS=MS;function PS(e,t,n,r){var i,a,o,s,u,l,c,f,p,h,d=t[0],v=t[1],m=t[2],y=r[0],g=r[1],_=r[2],b=n[0],E=n[1],x=n[2];return Math.abs(d-b)<fS&&Math.abs(v-E)<fS&&Math.abs(m-x)<fS?yS(e):(c=d-b,f=v-E,p=m-x,i=g*(p*=h=1/Math.hypot(c,f,p))-_*(f*=h),a=_*(c*=h)-y*p,o=y*f-g*c,(h=Math.hypot(i,a,o))?(i*=h=1/h,a*=h,o*=h):(i=0,a=0,o=0),s=f*o-p*a,u=p*i-c*o,l=c*a-f*i,(h=Math.hypot(s,u,l))?(s*=h=1/h,u*=h,l*=h):(s=0,u=0,l=0),e[0]=i,e[1]=s,e[2]=c,e[3]=0,e[4]=a,e[5]=u,e[6]=f,e[7]=0,e[8]=o,e[9]=l,e[10]=p,e[11]=0,e[12]=-(i*d+a*v+o*m),e[13]=-(s*d+u*v+l*m),e[14]=-(c*d+f*v+p*m),e[15]=1,e)}function IS(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}var LS=_S,NS=IS,DS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:dS,clone:vS,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:mS,set:function(e,t,n,r,i,a,o,s,u,l,c,f,p,h,d,v,m){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=f,e[11]=p,e[12]=h,e[13]=d,e[14]=v,e[15]=m,e},identity:yS,transpose:function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},invert:gS,adjoint:function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],p=t[10],h=t[11],d=t[12],v=t[13],m=t[14],y=t[15];return e[0]=s*(p*y-h*m)-f*(u*y-l*m)+v*(u*h-l*p),e[1]=-(r*(p*y-h*m)-f*(i*y-a*m)+v*(i*h-a*p)),e[2]=r*(u*y-l*m)-s*(i*y-a*m)+v*(i*l-a*u),e[3]=-(r*(u*h-l*p)-s*(i*h-a*p)+f*(i*l-a*u)),e[4]=-(o*(p*y-h*m)-c*(u*y-l*m)+d*(u*h-l*p)),e[5]=n*(p*y-h*m)-c*(i*y-a*m)+d*(i*h-a*p),e[6]=-(n*(u*y-l*m)-o*(i*y-a*m)+d*(i*l-a*u)),e[7]=n*(u*h-l*p)-o*(i*h-a*p)+c*(i*l-a*u),e[8]=o*(f*y-h*v)-c*(s*y-l*v)+d*(s*h-l*f),e[9]=-(n*(f*y-h*v)-c*(r*y-a*v)+d*(r*h-a*f)),e[10]=n*(s*y-l*v)-o*(r*y-a*v)+d*(r*l-a*s),e[11]=-(n*(s*h-l*f)-o*(r*h-a*f)+c*(r*l-a*s)),e[12]=-(o*(f*m-p*v)-c*(s*m-u*v)+d*(s*p-u*f)),e[13]=n*(f*m-p*v)-c*(r*m-i*v)+d*(r*p-i*f),e[14]=-(n*(s*m-u*v)-o*(r*m-i*v)+d*(r*u-i*s)),e[15]=n*(s*p-u*f)-o*(r*p-i*f)+c*(r*u-i*s),e},determinant:function(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],p=e[11],h=e[12],d=e[13],v=e[14],m=e[15];return(t*o-n*a)*(f*m-p*v)-(t*s-r*a)*(c*m-p*d)+(t*u-i*a)*(c*v-f*d)+(n*s-r*o)*(l*m-p*h)-(n*u-i*o)*(l*v-f*h)+(r*u-i*s)*(l*d-c*h)},multiply:_S,translate:bS,scale:ES,rotate:function(e,t,n,r){var i,a,o,s,u,l,c,f,p,h,d,v,m,y,g,_,b,E,x,S,T,A,w,C,k=r[0],O=r[1],M=r[2],R=Math.hypot(k,O,M);return R<fS?null:(k*=R=1/R,O*=R,M*=R,i=Math.sin(n),o=1-(a=Math.cos(n)),s=t[0],u=t[1],l=t[2],c=t[3],f=t[4],p=t[5],h=t[6],d=t[7],v=t[8],m=t[9],y=t[10],g=t[11],_=k*k*o+a,b=O*k*o+M*i,E=M*k*o-O*i,x=k*O*o-M*i,S=O*O*o+a,T=M*O*o+k*i,A=k*M*o+O*i,w=O*M*o-k*i,C=M*M*o+a,e[0]=s*_+f*b+v*E,e[1]=u*_+p*b+m*E,e[2]=l*_+h*b+y*E,e[3]=c*_+d*b+g*E,e[4]=s*x+f*S+v*T,e[5]=u*x+p*S+m*T,e[6]=l*x+h*S+y*T,e[7]=c*x+d*S+g*T,e[8]=s*A+f*w+v*C,e[9]=u*A+p*w+m*C,e[10]=l*A+h*w+y*C,e[11]=c*A+d*w+g*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},rotateX:xS,rotateY:SS,rotateZ:TS,fromTranslation:AS,fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotation:function(e,t,n){var r,i,a,o=n[0],s=n[1],u=n[2],l=Math.hypot(o,s,u);return l<fS?null:(o*=l=1/l,s*=l,u*=l,r=Math.sin(t),a=1-(i=Math.cos(t)),e[0]=o*o*a+i,e[1]=s*o*a+u*r,e[2]=u*o*a-s*r,e[3]=0,e[4]=o*s*a-u*r,e[5]=s*s*a+i,e[6]=u*s*a+o*r,e[7]=0,e[8]=o*u*a+s*r,e[9]=s*u*a-o*r,e[10]=u*u*a+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromXRotation:function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromYRotation:function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotationTranslation:wS,fromQuat2:function(e,t){var n=new pS(3),r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=r*r+i*i+a*a+o*o;return f>0?(n[0]=2*(s*o+c*r+u*a-l*i)/f,n[1]=2*(u*o+c*i+l*r-s*a)/f,n[2]=2*(l*o+c*a+s*i-u*r)/f):(n[0]=2*(s*o+c*r+u*a-l*i),n[1]=2*(u*o+c*i+l*r-s*a),n[2]=2*(l*o+c*a+s*i-u*r)),wS(e,t,n),e},getTranslation:function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},getScaling:CS,getRotation:function(e,t){var n=new pS(3);CS(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],o=t[0]*r,s=t[1]*i,u=t[2]*a,l=t[4]*r,c=t[5]*i,f=t[6]*a,p=t[8]*r,h=t[9]*i,d=t[10]*a,v=o+c+d,m=0;return v>0?(m=2*Math.sqrt(v+1),e[3]=.25*m,e[0]=(f-h)/m,e[1]=(p-u)/m,e[2]=(s-l)/m):o>c&&o>d?(m=2*Math.sqrt(1+o-c-d),e[3]=(f-h)/m,e[0]=.25*m,e[1]=(s+l)/m,e[2]=(p+u)/m):c>d?(m=2*Math.sqrt(1+c-o-d),e[3]=(p-u)/m,e[0]=(s+l)/m,e[1]=.25*m,e[2]=(f+h)/m):(m=2*Math.sqrt(1+d-o-c),e[3]=(s-l)/m,e[0]=(p+u)/m,e[1]=(f+h)/m,e[2]=.25*m),e},fromRotationTranslationScale:function(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,l=a+a,c=o+o,f=i*u,p=i*l,h=i*c,d=a*l,v=a*c,m=o*c,y=s*u,g=s*l,_=s*c,b=r[0],E=r[1],x=r[2];return e[0]=(1-(d+m))*b,e[1]=(p+_)*b,e[2]=(h-g)*b,e[3]=0,e[4]=(p-_)*E,e[5]=(1-(f+m))*E,e[6]=(v+y)*E,e[7]=0,e[8]=(h+g)*x,e[9]=(v-y)*x,e[10]=(1-(f+d))*x,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,t,n,r,i){var a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,c=o+o,f=s+s,p=a*l,h=a*c,d=a*f,v=o*c,m=o*f,y=s*f,g=u*l,_=u*c,b=u*f,E=r[0],x=r[1],S=r[2],T=i[0],A=i[1],w=i[2],C=(1-(v+y))*E,k=(h+b)*E,O=(d-_)*E,M=(h-b)*x,R=(1-(p+y))*x,P=(m+g)*x,I=(d+_)*S,L=(m-g)*S,N=(1-(p+v))*S;return e[0]=C,e[1]=k,e[2]=O,e[3]=0,e[4]=M,e[5]=R,e[6]=P,e[7]=0,e[8]=I,e[9]=L,e[10]=N,e[11]=0,e[12]=n[0]+T-(C*T+M*A+I*w),e[13]=n[1]+A-(k*T+R*A+L*w),e[14]=n[2]+w-(O*T+P*A+N*w),e[15]=1,e},fromQuat:function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,u=i+i,l=n*o,c=r*o,f=r*s,p=i*o,h=i*s,d=i*u,v=a*o,m=a*s,y=a*u;return e[0]=1-f-d,e[1]=c+y,e[2]=p-m,e[3]=0,e[4]=c-y,e[5]=1-l-d,e[6]=h+v,e[7]=0,e[8]=p+m,e[9]=h-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},frustum:function(e,t,n,r,i,a,o){var s=1/(n-t),u=1/(i-r),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e},perspectiveNO:kS,perspective:OS,perspectiveZO:function(e,t,n,r,i){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=i*a,e[14]=i*r*a):(e[10]=-1,e[14]=-r),e},perspectiveFromFieldOfView:function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},orthoNO:MS,ortho:RS,orthoZO:function(e,t,n,r,i,a,o){var s=1/(t-n),u=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=a*l,e[15]=1,e},lookAt:PS,targetTo:function(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=r[0],u=r[1],l=r[2],c=i-n[0],f=a-n[1],p=o-n[2],h=c*c+f*f+p*p;h>0&&(c*=h=1/Math.sqrt(h),f*=h,p*=h);var d=u*p-l*f,v=l*c-s*p,m=s*f-u*c;return(h=d*d+v*v+m*m)>0&&(d*=h=1/Math.sqrt(h),v*=h,m*=h),e[0]=d,e[1]=v,e[2]=m,e[3]=0,e[4]=f*m-p*v,e[5]=p*d-c*m,e[6]=c*v-f*d,e[7]=0,e[8]=c,e[9]=f,e[10]=p,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},subtract:IS,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},multiplyScalarAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},equals:function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],f=e[9],p=e[10],h=e[11],d=e[12],v=e[13],m=e[14],y=e[15],g=t[0],_=t[1],b=t[2],E=t[3],x=t[4],S=t[5],T=t[6],A=t[7],w=t[8],C=t[9],k=t[10],O=t[11],M=t[12],R=t[13],P=t[14],I=t[15];return Math.abs(n-g)<=fS*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-_)<=fS*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-b)<=fS*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-E)<=fS*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(o-x)<=fS*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-S)<=fS*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-T)<=fS*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(l-A)<=fS*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-w)<=fS*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(f-C)<=fS*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-k)<=fS*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(h-O)<=fS*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(d-M)<=fS*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(v-R)<=fS*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(m-P)<=fS*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(y-I)<=fS*Math.max(1,Math.abs(y),Math.abs(I))},mul:LS,sub:NS});function FS(){var e=new pS(3);return pS!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function jS(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function US(e,t,n){var r=new pS(3);return r[0]=e,r[1]=t,r[2]=n,r}function BS(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function zS(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function VS(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function HS(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function GS(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function WS(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function XS(e,t){var n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function YS(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qS(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],u=n[2];return e[0]=i*u-a*s,e[1]=a*o-r*u,e[2]=r*s-i*o,e}function ZS(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,e}function KS(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(a*a+o*o+s*s),l=u&&YS(e,t)/u;return Math.acos(Math.min(Math.max(l,-1),1))}var QS,JS=BS,$S=zS,eT=VS,tT=HS,nT=GS,rT=jS,iT=WS,aT=(QS=FS(),function(e,t,n,r,i,a){var o,s;for(t||(t=3),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,o=n;o<s;o+=t)QS[0]=e[o],QS[1]=e[o+1],QS[2]=e[o+2],i(QS,QS,a),e[o]=QS[0],e[o+1]=QS[1],e[o+2]=QS[2];return e}),oT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:FS,clone:function(e){var t=new pS(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},length:jS,fromValues:US,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},subtract:BS,multiply:zS,divide:VS,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},min:function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},max:function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},scale:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},scaleAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},distance:HS,squaredDistance:GS,squaredLength:WS,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},normalize:XS,dot:YS,cross:qS,lerp:function(e,t,n,r){var i=t[0],a=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e},hermite:function(e,t,n,r,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+n[0]*u+r[0]*l+i[0]*c,e[1]=t[1]*s+n[1]*u+r[1]*l+i[1]*c,e[2]=t[2]*s+n[2]*u+r[2]*l+i[2]*c,e},bezier:function(e,t,n,r,i,a){var o=1-a,s=o*o,u=a*a,l=s*o,c=3*a*s,f=3*u*o,p=u*a;return e[0]=t[0]*l+n[0]*c+r[0]*f+i[0]*p,e[1]=t[1]*l+n[1]*c+r[1]*f+i[1]*p,e[2]=t[2]*l+n[2]*c+r[2]*f+i[2]*p,e},random:function(e,t){t=t||1;var n=2*hS()*Math.PI,r=2*hS()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e},transformMat4:ZS,transformMat3:function(e,t,n){var r=t[0],i=t[1],a=t[2];return e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8],e},transformQuat:function(e,t,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],u=t[1],l=t[2],c=i*l-a*u,f=a*s-r*l,p=r*u-i*s,h=i*p-a*f,d=a*c-r*p,v=r*f-i*c,m=2*o;return c*=m,f*=m,p*=m,h*=2,d*=2,v*=2,e[0]=s+c+h,e[1]=u+f+d,e[2]=l+p+v,e},rotateX:function(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e},rotateY:function(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e},rotateZ:function(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e},angle:KS,zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e},str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},equals:function(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(n-a)<=fS*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=fS*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=fS*Math.max(1,Math.abs(i),Math.abs(s))},sub:JS,mul:$S,div:eT,dist:tT,sqrDist:nT,len:rT,sqrLen:iT,forEach:aT});function sT(){var e=new pS(4);return pS!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function uT(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}function lT(){var e=new pS(2);return pS!=Float32Array&&(e[0]=0,e[1]=0),e}function cT(e,t){var n=new pS(2);return n[0]=e,n[1]=t,n}function fT(e,t){return e[0]=t[0],e[1]=t[1],e}function pT(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function hT(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function dT(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function vT(e,t){return e[0]*t[0]+e[1]*t[1]}!function(){var e=sT()}();var mT,yT=hT;!function(){var e=lT()}();var gT,_T=Fx()(mT=function(){function e(){Fc(this,e),lc(this,"viewport",void 0),lc(this,"overridedViewProjectionMatrix",void 0),lc(this,"jitteredViewProjectionMatrix",void 0),lc(this,"jitteredProjectionMatrix",void 0),lc(this,"viewMatrixInverse",void 0),lc(this,"cameraPosition",void 0)}return Uc(e,[{key:"init",value:function(){}},{key:"update",value:function(e){this.viewport=e,this.viewMatrixInverse=dS(),gS(this.viewMatrixInverse,e.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var e=Ic(this.viewport.getCenter(),2);return[e[0],e[1]]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(e,t){return this.viewport.projectFlat(e,t)}},{key:"setViewProjectionMatrix",value:function(e){this.overridedViewProjectionMatrix=e}},{key:"jitterProjectionMatrix",value:function(e,t){var n=AS(dS(),[e,t,0]);this.jitteredProjectionMatrix=_S(dS(),n,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=_S(dS(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||mT;function bT(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ET(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ET(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ET(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xT,ST,TT,AT=Fx()(gT=function(){function e(){Fc(this,e),lc(this,"container",void 0),lc(this,"controlCorners",void 0),lc(this,"controlContainer",void 0),lc(this,"scene",void 0),lc(this,"mapsService",void 0),lc(this,"controls",[]),lc(this,"unAddControls",[])}return Uc(e,[{key:"init",value:function(e,t){this.container=e.container,this.scene=t,this.mapsService=t.get(Bx.IMapService),this.initControlPos()}},{key:"addControl",value:function(e,t){t.get(Bx.IMapService).map?(e.addTo(this.scene),this.controls.push(e)):this.unAddControls.push(e)}},{key:"getControlByName",value:function(e){return this.controls.find((function(t){return t.controlOption.name===e}))}},{key:"removeControl",value:function(e){var t=this.controls.indexOf(e);return t>-1&&this.controls.splice(t,1),e.remove(),this}},{key:"addControls",value:function(){var e=this;this.unAddControls.forEach((function(t){t.addTo(e.scene),e.controls.push(t)})),this.unAddControls=[]}},{key:"destroy",value:function(){var e,t=bT(this.controls);try{for(t.s();!(e=t.n()).done;){e.value.remove()}}catch(n){t.e(n)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var e=this.controlCorners={},t="l7-",n=this.controlContainer=pp("div","l7-control-container",this.container);function r(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=r.map((function(e){return t+e})).join(" ");e[r.join("")]=pp("div",i,n)}r(["top","left"]),r(["top","right"]),r(["bottom","left"]),r(["bottom","right"]),r(["top","center"]),r(["right","center"]),r(["left","center"]),r(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var e in this.controlCorners)this.controlCorners[e]&&hp(this.controlCorners[e]);this.controlContainer&&hp(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),e}())||gT,wT=Fx()(xT=function(){function e(){Fc(this,e),lc(this,"container",void 0),lc(this,"scene",void 0),lc(this,"mapsService",void 0),lc(this,"markers",[]),lc(this,"markerLayers",[]),lc(this,"unAddMarkers",[]),lc(this,"unAddMarkerLayers",[])}return Uc(e,[{key:"addMarkerLayer",value:function(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(e),e.addTo(this.scene)):this.unAddMarkerLayers.push(e)}},{key:"removeMarkerLayer",value:function(e){e.destroy(),this.markerLayers.indexOf(e);var t=this.markerLayers.indexOf(e);t>-1&&this.markerLayers.splice(t,1)}},{key:"addMarker",value:function(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(e),e.addTo(this.scene)):this.unAddMarkers.push(e)}},{key:"addMarkers",value:function(){var e=this;this.unAddMarkers.forEach((function(t){t.addTo(e.scene),e.markers.push(t)})),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var e=this;this.unAddMarkerLayers.forEach((function(t){e.markerLayers.push(t),t.addTo(e.scene)})),this.unAddMarkers=[]}},{key:"removeMarker",value:function(e){e.remove(),this.markers.indexOf(e);var t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(e){this.scene=e,this.mapsService=e.get(Bx.IMapService)}},{key:"destroy",value:function(){this.markers.forEach((function(e){e.remove()})),this.markers=[],this.markerLayers.forEach((function(e){e.destroy()})),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(e){e.destroy()}}]),e}())||xT,CT=Fx()(ST=function(){function e(){Fc(this,e),lc(this,"scene",void 0),lc(this,"popup",void 0),lc(this,"mapsService",void 0),lc(this,"unAddPopup",void 0)}return Uc(e,[{key:"removePopup",value:function(e){e.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(e){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(e.addTo(this.scene),this.popup=e):this.unAddPopup=e}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(e){this.scene=e,this.mapsService=e.get(Bx.IMapService)}}]),e}())||ST,kT=Uy,OT=ig((function(e,t,n){kT(e,t,n)})),MT={MapToken:"您正在使用 Demo测试地图token，如果生产环境中使用去对应地图请注册Token",SDK:"请确认引入了mapbox-gl api且在L7之前引入"};function RT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RT(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var IT={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},LT={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},NT=Fx()(TT=function(){function e(){Fc(this,e),lc(this,"sceneConfigCache",{}),lc(this,"layerConfigCache",{})}return Uc(e,[{key:"getSceneConfig",value:function(e){return this.sceneConfigCache[e]}},{key:"getSceneWarninfo",value:function(e){return MT[e]}},{key:"setSceneConfig",value:function(e,t){this.sceneConfigCache[e]=PT(PT({},IT),t)}},{key:"getLayerConfig",value:function(e){return this.layerConfigCache[e]}},{key:"setLayerConfig",value:function(e,t,n){this.layerConfigCache[t]=PT({},OT({},this.sceneConfigCache[e],LT,n))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||TT;function DT(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function FT(e,t,n,r,i){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var jT,UT,BT=Math.PI/180;function zT(e){var t=e.latitude,n=void 0===t?0:t,r=e.zoom,i=void 0===r?0:r,a=e.scale,o=e.highPrecision,s=void 0!==o&&o,u=e.flipY,l=void 0!==u&&u,c={},f=512*(a=void 0!==a?a:Math.pow(2,i)),p=Math.cos(n*BT),h=f/360,d=h/p,v=f/4003e4/p;if(c.pixelsPerMeter=[v,-v,v],c.metersPerPixel=[1/v,-1/v,1/v],c.pixelsPerDegree=[h,-d,v],c.degreesPerPixel=[1/h,-1/d,1/v],s){var m=BT*Math.tan(n*BT)/p,y=h*m/2,g=f/4003e4*m,_=g/d*v;c.pixelsPerDegree2=[0,-y,g],c.pixelsPerMeter2=[_,0,_],l&&(c.pixelsPerDegree2[1]=-c.pixelsPerDegree2[1],c.pixelsPerMeter2[1]=-c.pixelsPerMeter2[1])}return l&&(c.pixelsPerMeter[1]=-c.pixelsPerMeter[1],c.metersPerPixel[1]=-c.metersPerPixel[1],c.pixelsPerDegree[1]=-c.pixelsPerDegree[1],c.degreesPerPixel[1]=-c.degreesPerPixel[1]),c}(UT=jT||(jT={}))[UT.LNGLAT=1]="LNGLAT",UT[UT.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",UT[UT.VECTOR_TILE=3]="VECTOR_TILE",UT[UT.IDENTITY=4]="IDENTITY",UT[UT.P20=5]="P20",UT[UT.P20_OFFSET=6]="P20_OFFSET",UT[UT.METER_OFFSET=7]="METER_OFFSET",UT[UT.P20_2=8]="P20_2";var VT,HT,GT,WT,XT,YT="u_CoordinateSystem",qT="u_ViewportCenter",ZT="u_ViewportCenterProjection",KT="u_PixelsPerDegree",QT="u_PixelsPerDegree2",JT="u_PixelsPerMeter",$T="u_Mvp",eA=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],tA=(VT=Fx(),HT=nx(Bx.ICameraService),VT((WT=function(){function e(){Fc(this,e),lc(this,"needRefresh",!0),DT(this,"cameraService",XT,this),lc(this,"coordinateSystem",void 0),lc(this,"viewportCenter",void 0),lc(this,"viewportCenterProjection",void 0),lc(this,"pixelsPerDegree",void 0),lc(this,"pixelsPerDegree2",void 0),lc(this,"pixelsPerMeter",void 0)}return Uc(e,[{key:"refresh",value:function(){var e=this.cameraService.getZoom(),t=this.cameraService.getZoomScale(),n=this.cameraService.getCenter(),r=zT({latitude:n[1],zoom:e}),i=r.pixelsPerMeter,a=r.pixelsPerDegree;this.viewportCenter=n,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=i,this.pixelsPerDegree=a,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===jT.LNGLAT||this.coordinateSystem===jT.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===jT.LNGLAT_OFFSET?this.calculateLnglatOffset(n,e):this.coordinateSystem===jT.P20_OFFSET&&this.calculateLnglatOffset(n,e,t,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(e){this.coordinateSystem=e}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(e,t,n,r){var i=zT({latitude:e[1],zoom:t,scale:n,flipY:r,highPrecision:!0}),a=i.pixelsPerMeter,o=i.pixelsPerDegree,s=i.pixelsPerDegree2,u=this.cameraService.getViewMatrix(),l=this.cameraService.getProjectionMatrix(),c=_S([],l,u),f=this.cameraService.projectFlat([Math.fround(e[0]),Math.fround(e[1])],Math.pow(2,t));this.viewportCenterProjection=uT([],[f[0],f[1],0,1],c),c=_S([],l,u=this.cameraService.getViewMatrixUncentered()||u),c=_S([],c,eA),this.cameraService.setViewProjectionMatrix(c),this.pixelsPerMeter=a,this.pixelsPerDegree=o,this.pixelsPerDegree2=s}}]),e}(),XT=FT(WT.prototype,"cameraService",[HT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GT=WT))||GT),nA={exports:{}};
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(e){!function(t,n,r,i){var a,o="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast,s="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),u=o||s,l=["","webkit","Moz","MS","ms","o"],c=u?"":n.createElement("div"),f=Math.round,p=Math.abs,h=Date.now;function d(e,t,n){return setTimeout(E(e,n),t)}function v(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==i)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=t.console&&(t.console.warn||t.console.log);return a&&a.call(t.console,i,r),e.apply(this,arguments)}}a="function"!=typeof Object.assign?function(e){if(e===i||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])}return t}:Object.assign;var g=y((function(e,t,n){for(var r=Object.keys(t),a=0;a<r.length;)(!n||n&&e[r[a]]===i)&&(e[r[a]]=t[r[a]]),a++;return e}),"extend","Use `assign`."),_=y((function(e,t){return g(e,t,!0)}),"merge","Use `assign`.");function b(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&a(r,n)}function E(e,t){return function(){return e.apply(t,arguments)}}function x(e,t){return"function"==typeof e?e.apply(t&&t[0]||i,t):e}function S(e,t){return e===i?t:e}function T(e,t,n){m(k(t),(function(t){e.addEventListener(t,n,!1)}))}function A(e,t,n){m(k(t),(function(t){e.removeEventListener(t,n,!1)}))}function w(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function C(e,t){return e.indexOf(t)>-1}function k(e){return e.trim().split(/\s+/g)}function O(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function M(e){return Array.prototype.slice.call(e,0)}function R(e,t,n){for(var r=[],i=[],a=0;a<e.length;){var o=t?e[a][t]:e[a];O(i,o)<0&&r.push(e[a]),i[a]=o,a++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function P(e,t){for(var n,r,a=t[0].toUpperCase()+t.slice(1),o=0;o<l.length;){if((r=(n=l[o])?n+a:t)in e)return r;o++}return i}var I=1;function L(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}var N="ontouchstart"in t,D=P(t,"PointerEvent")!==i,F=N&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),j="touch",U="mouse",B=24,z=["x","y"],V=["clientX","clientY"];function H(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){x(e.options.enable,[e])&&n.handler(t)},this.init()}function G(e,t,n){var r=n.pointers.length,a=n.changedPointers.length,o=1&t&&r-a==0,s=12&t&&r-a==0;n.isFirst=!!o,n.isFinal=!!s,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,a=r.length;n.firstInput||(n.firstInput=W(t));a>1&&!n.firstMultiple?n.firstMultiple=W(t):1===a&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,u=s?s.center:o.center,l=t.center=X(r);t.timeStamp=h(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=K(u,l),t.distance=Z(u,l),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(i=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y});t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=q(t.deltaX,t.deltaY);var c=Y(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=p(c.x)>p(c.y)?c.x:c.y,t.scale=s?(f=s.pointers,d=r,Z(d[0],d[1],V)/Z(f[0],f[1],V)):1,t.rotation=s?function(e,t){return K(t[1],t[0],V)+K(e[1],e[0],V)}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,a,o,s=e.lastInterval||t,u=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(u>25||s.velocity===i)){var l=t.deltaX-s.deltaX,c=t.deltaY-s.deltaY,f=Y(u,l,c);r=f.x,a=f.y,n=p(f.x)>p(f.y)?f.x:f.y,o=q(l,c),e.lastInterval=t}else n=s.velocity,r=s.velocityX,a=s.velocityY,o=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=a,t.direction=o}(n,t);var f,d;var v=e.element;w(t.srcEvent.target,v)&&(v=t.srcEvent.target);t.target=v}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function W(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:f(e.pointers[n].clientX),clientY:f(e.pointers[n].clientY)},n++;return{timeStamp:h(),pointers:t,center:X(t),deltaX:e.deltaX,deltaY:e.deltaY}}function X(e){var t=e.length;if(1===t)return{x:f(e[0].clientX),y:f(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:f(n/t),y:f(r/t)}}function Y(e,t,n){return{x:t/e||0,y:n/e||0}}function q(e,t){return e===t?1:p(e)>=p(t)?e<0?2:4:t<0?8:16}function Z(e,t,n){n||(n=z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function K(e,t,n){n||(n=z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}H.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(L(this.element),this.evWin,this.domHandler)}};var Q={mousedown:1,mousemove:2,mouseup:4},J="mousedown",$="mousemove mouseup";function ee(){this.evEl=J,this.evWin=$,this.pressed=!1,H.apply(this,arguments)}b(ee,H,{handler:function(e){var t=Q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:U,srcEvent:e}))}});var te={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ne={2:j,3:"pen",4:U,5:"kinect"},re="pointerdown",ie="pointermove pointerup pointercancel";function ae(){this.evEl=re,this.evWin=ie,H.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}u||!t.MSPointerEvent||t.PointerEvent||(re="MSPointerDown",ie="MSPointerMove MSPointerUp MSPointerCancel"),b(ae,H,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=te[r],a=ne[e.pointerType]||e.pointerType,o=a==j,s=O(t,e.pointerId,"pointerId");1&i&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&i&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),n&&t.splice(s,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart",ue="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.evWin=ue,this.started=!1,H.apply(this,arguments)}function ce(e,t){var n=M(e.touches),r=M(e.changedTouches);return 12&t&&(n=R(n.concat(r),"identifier",!0)),[n,r]}b(le,H,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var n=ce.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:j,srcEvent:e})}}});var fe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pe="touchstart touchmove touchend touchcancel";function he(){this.evTarget=pe,this.targetIds={},H.apply(this,arguments)}function de(e,t){var n=M(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,a,o=M(e.changedTouches),s=[],u=this.target;if(a=n.filter((function(e){return w(e.target,u)})),1===t)for(i=0;i<a.length;)r[a[i].identifier]=!0,i++;for(i=0;i<o.length;)r[o[i].identifier]&&s.push(o[i]),12&t&&delete r[o[i].identifier],i++;return s.length?[R(a.concat(s),"identifier",!0),s]:void 0}b(he,H,{handler:function(e){var t=fe[e.type],n=de.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:j,srcEvent:e})}});function ve(){H.apply(this,arguments);var e=E(this.handler,this);this.touch=new he(this.manager,e),this.mouse=new ee(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function me(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ye.call(this,t)):12&e&&ye.call(this,t)}function ye(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function ge(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],a=Math.abs(t-i.x),o=Math.abs(n-i.y);if(a<=25&&o<=25)return!0}return!1}b(ve,H,{handler:function(e,t,n){var r=n.pointerType==j,i=n.pointerType==U;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)me.call(this,t,n);else if(i&&ge.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _e=u?i:P(c.style,"touchAction"),be=_e!==i,Ee="compute",xe="auto",Se="manipulation",Te="none",Ae="pan-x",we="pan-y",Ce=function(){if(!be)return!1;var e={};if(u)return e;var n=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){e[r]=!n||t.CSS.supports("touch-action",r)})),e}();function ke(e,t){this.manager=e,this.set(t)}ke.prototype={set:function(e){e==Ee&&(e=this.compute()),be&&this.manager.element.style&&Ce[e]&&(this.manager.element.style[_e]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,(function(t){x(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(C(e,Te))return Te;var t=C(e,Ae),n=C(e,we);if(t&&n)return Te;if(t||n)return t?Ae:we;if(C(e,Se))return Se;return xe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=C(r,Te)&&!Ce.none,a=C(r,we)&&!Ce["pan-y"],o=C(r,Ae)&&!Ce["pan-x"];if(i){var s=1===e.pointers.length,u=e.distance<2,l=e.deltaTime<250;if(s&&u&&l)return}if(!o||!a)return i||a&&6&n||o&&n&B?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Oe=32;function Me(e){this.options=a({},this.defaults,e||{}),this.id=I++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Re(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Pe(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ie(e,t){var n=t.manager;return n?n.get(e):e}function Le(){Me.apply(this,arguments)}function Ne(){Le.apply(this,arguments),this.pX=null,this.pY=null}function De(){Le.apply(this,arguments)}function Fe(){Me.apply(this,arguments),this._timer=null,this._input=null}function je(){Le.apply(this,arguments)}function Ue(){Le.apply(this,arguments)}function Be(){Me.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ze(e,t){return(t=t||{}).recognizers=S(t.recognizers,ze.defaults.preset),new Ve(e,t)}Me.prototype={defaults:{},set:function(e){return a(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ie(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return v(e,"dropRecognizeWith",this)||(e=Ie(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;return-1===O(t,e=Ie(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=Ie(e,this);var t=O(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Re(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Re(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Oe},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=a({},e);if(!x(this.options.enable,[this,t]))return this.reset(),void(this.state=Oe);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(Le,Me,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:Oe}}),b(Ne,Le,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(we),e&B&&t.push(Ae),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,a=e.deltaX,o=e.deltaY;return i&t.direction||(6&t.direction?(i=0===a?1:a<0?2:4,n=a!=this.pX,r=Math.abs(e.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Le.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Pe(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(De,Le,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Te]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(Fe,Me,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Oe},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}}),b(je,Le,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Te]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(Ue,Le,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ne.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:n&B&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&p(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Pe(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(Be,Me,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Z(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&a?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Oe},failTimeout:function(){return this._timer=d((function(){this.state=Oe}),this.options.interval,this),Oe},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ze.VERSION="2.0.7",ze.defaults={domEvents:!1,touchAction:Ee,enable:!0,inputTarget:null,inputClass:null,preset:[[je,{enable:!1}],[De,{enable:!1},["rotate"]],[Ue,{direction:6}],[Ne,{direction:6},["swipe"]],[Be],[Be,{event:"doubletap",taps:2},["tap"]],[Fe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ve(e,t){var n;this.options=a({},ze.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(D?ae:F?he:N?ve:ee))(n,G),this.touchAction=new ke(this,this.options.touchAction),He(this,!0),m(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function He(e,t){var n,r=e.element;r.style&&(m(e.options.cssProps,(function(i,a){n=P(r.style,a),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}(Ve.prototype={set:function(e){return a(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var a=0;a<r.length;)n=r[a],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),a++}},get:function(e){if(e instanceof Me)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=O(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==i&&t!==i){var n=this.handlers;return m(k(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==i){var n=this.handlers;return m(k(e),(function(e){t?n[e]&&n[e].splice(O(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){if(u)return;var r=n.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](t),i++}},destroy:function(){this.element&&He(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u)||(a(ze,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Oe,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:B,DIRECTION_ALL:30,Manager:Ve,Input:H,TouchAction:ke,TouchInput:he,MouseInput:ee,PointerEventInput:ae,TouchMouseInput:ve,SingleTouchInput:le,Recognizer:Me,AttrRecognizer:Le,Tap:Be,Pan:Ne,Swipe:Ue,Pinch:De,Rotate:je,Press:Fe,on:T,off:A,each:m,merge:_,extend:g,assign:a,inherit:b,bindFn:E,prefixed:P}),("undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Hammer=ze,e.exports?e.exports=ze:t.Hammer=ze)}("undefined"!=typeof window?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document)}(nA);var rA,iA,aA,oA,sA,uA,lA,cA=nA.exports;function fA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}(iA=rA||(rA={})).Hover="hover",iA.Click="click",iA.Select="select",iA.Active="active",iA.Drag="drag";var pA={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},hA=(aA=Fx(),oA=nx(Bx.IMapService),aA((uA=function(e){Gc(n,Yb);var t=fA(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return DT(Xc(e=t.call.apply(t,[this].concat(i))),"mapService",lA,Xc(e)),lc(Xc(e),"hammertime",void 0),lc(Xc(e),"lastClickTime",0),lc(Xc(e),"lastClickXY",[-1,-1]),lc(Xc(e),"clickTimer",void 0),lc(Xc(e),"$containter",void 0),lc(Xc(e),"onDrag",(function(t){var n=e.interactionEvent(t);n.type=pA[n.type],e.emit(rA.Drag,n)})),lc(Xc(e),"onHammer",(function(t){t.srcEvent.stopPropagation();var n=e.interactionEvent(t);e.emit(rA.Hover,n)})),lc(Xc(e),"onTouch",(function(t){var n=t.touches[0];e.onHover({x:n.pageX,y:n.pageY,type:"touch"})})),lc(Xc(e),"onHover",(function(t){var n=t.clientX,r=t.clientY,i=t.type,a=e.mapService.getMapContainer();if(a)if(sp)n=n-a.left-0,r=r-a.top-0;else{var o=a.getBoundingClientRect(),s=o.top;n=n-o.left-a.clientLeft,r=r-s-a.clientTop}var u=e.mapService.containerToLngLat([n,r]);if("click"!==i)"touch"!==i?"click"!==i&&"dblclick"!==i&&e.emit(rA.Hover,{x:n,y:r,lngLat:u,type:i,target:t}):e.isDoubleTap(n,r,u);else{if(!sp&&"ontouchstart"in document.documentElement==!0)return;e.isDoubleTap(n,r,u)}})),e}return Uc(n,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(rA.Hover)}},{key:"triggerHover",value:function(e){var t=e.x,n=e.y;this.emit(rA.Hover,{x:t,y:n})}},{key:"triggerSelect",value:function(e){this.emit(rA.Select,{featureId:e})}},{key:"triggerActive",value:function(e){this.emit(rA.Active,{featureId:e})}},{key:"handleMiniEvent",value:function(e){this.onHover({clientX:e.touches[0].pageX,clientY:e.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var e=this.mapService.getMapContainer();if(e)if(sp)lp.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var t=new cA.Manager(e);t.add(new cA.Tap({event:"dblclick",taps:2})),t.add(new cA.Tap({event:"click"})),t.add(new cA.Pan({threshold:0,pointers:0})),t.add(new cA.Press({})),t.on("dblclick click",this.onHammer),t.on("panstart panmove panend pancancel",this.onDrag),e.addEventListener("mousemove",this.onHover),e.addEventListener("mousedown",this.onHover,!0),e.addEventListener("mouseup",this.onHover),e.addEventListener("contextmenu",this.onHover),this.hammertime=t}}},{key:"removeEventListenerOnMap",value:function(){if(sp)lp.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var e=this.mapService.getMapContainer();e&&(e.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),e.removeEventListener("mousedown",this.onHover),e.removeEventListener("mouseup",this.onHover),e.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(e){var t,n,r=e.type;"touch"===e.pointerType?(n=Math.floor(e.pointers[0].clientY),t=Math.floor(e.pointers[0].clientX)):(n=Math.floor(e.srcEvent.y),t=Math.floor(e.srcEvent.x));var i=this.mapService.getMapContainer();if(i){var a=i.getBoundingClientRect(),o=a.top;t-=a.left,n-=o}return{x:t,y:n,lngLat:this.mapService.containerToLngLat([t,n]),type:r,target:e.srcEvent}}},{key:"isDoubleTap",value:function(e,t,n){var r=this,i=(new Date).getTime(),a="click";i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-e)<10&&Math.abs(this.lastClickXY[1]-t)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),a="dblclick",this.emit(rA.Hover,{x:e,y:t,lngLat:n,type:a})):(this.lastClickTime=i,this.lastClickXY=[e,t],this.clickTimer=setTimeout((function(){a="click",r.emit(rA.Hover,{x:e,y:t,lngLat:n,type:a})}),400))}}]),n}(),lA=FT(uA.prototype,"mapService",[oA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sA=uA))||sA);function dA(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function vA(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){dA(a,r,i,o,s,"next",e)}function s(e){dA(a,r,i,o,s,"throw",e)}o(void 0)}))}}var mA={exports:{}};!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(R){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),o=new k(r||[]);return a._invoke=function(e,t,n){var r=f;return function(i,a){if(r===h)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw a;return M()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=A(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=c(e,t,n);if("normal"===u.type){if(r=n.done?d:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(R){return{type:"throw",arg:R}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",d="completed",v={};function m(){}function y(){}function g(){}var _={};u(_,a,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(O([])));E&&E!==n&&r.call(E,a)&&(_=E);var x=g.prototype=m.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,a,o,s){var u=c(e[i],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(f).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function A(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function O(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:M}}function M(){return{value:t,done:!0}}return y.prototype=g,u(x,"constructor",g),u(g,"constructor",y),y.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},S(T.prototype),u(T.prototype,o,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new T(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(x),u(x,s,"Generator"),u(x,a,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(mA.exports);try{regeneratorRuntime=t}catch(n){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}();var yA,gA,_A,bA,EA,xA,SA,TA,AA,wA,CA,kA,OA,MA=mA.exports,RA=0;function PA(e){if(sp)return null;var t=e;if("string"==typeof e&&(t=document.getElementById(e)),t){var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",n.id="l7-scene-".concat(RA++),n.classList.add("l7-scene"),t.appendChild(n),n}return null}function IA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function LA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?IA(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(gA=yA||(yA={}))[gA.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",gA[gA.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",gA[gA.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",gA[gA.POINTS=0]="POINTS",gA[gA.LINES=1]="LINES",gA[gA.LINE_LOOP=2]="LINE_LOOP",gA[gA.LINE_STRIP=3]="LINE_STRIP",gA[gA.TRIANGLES=4]="TRIANGLES",gA[gA.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",gA[gA.TRIANGLE_FAN=6]="TRIANGLE_FAN",gA[gA.ZERO=0]="ZERO",gA[gA.ONE=1]="ONE",gA[gA.SRC_COLOR=768]="SRC_COLOR",gA[gA.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",gA[gA.SRC_ALPHA=770]="SRC_ALPHA",gA[gA.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",gA[gA.DST_ALPHA=772]="DST_ALPHA",gA[gA.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",gA[gA.DST_COLOR=774]="DST_COLOR",gA[gA.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",gA[gA.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",gA[gA.FUNC_ADD=32774]="FUNC_ADD",gA[gA.BLEND_EQUATION=32777]="BLEND_EQUATION",gA[gA.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",gA[gA.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",gA[gA.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",gA[gA.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",gA[gA.MAX_EXT=32776]="MAX_EXT",gA[gA.MIN_EXT=32775]="MIN_EXT",gA[gA.BLEND_DST_RGB=32968]="BLEND_DST_RGB",gA[gA.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",gA[gA.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",gA[gA.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",gA[gA.CONSTANT_COLOR=32769]="CONSTANT_COLOR",gA[gA.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",gA[gA.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",gA[gA.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",gA[gA.BLEND_COLOR=32773]="BLEND_COLOR",gA[gA.ARRAY_BUFFER=34962]="ARRAY_BUFFER",gA[gA.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",gA[gA.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",gA[gA.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",gA[gA.STREAM_DRAW=35040]="STREAM_DRAW",gA[gA.STATIC_DRAW=35044]="STATIC_DRAW",gA[gA.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",gA[gA.BUFFER_SIZE=34660]="BUFFER_SIZE",gA[gA.BUFFER_USAGE=34661]="BUFFER_USAGE",gA[gA.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",gA[gA.FRONT=1028]="FRONT",gA[gA.BACK=1029]="BACK",gA[gA.FRONT_AND_BACK=1032]="FRONT_AND_BACK",gA[gA.CULL_FACE=2884]="CULL_FACE",gA[gA.BLEND=3042]="BLEND",gA[gA.DITHER=3024]="DITHER",gA[gA.STENCIL_TEST=2960]="STENCIL_TEST",gA[gA.DEPTH_TEST=2929]="DEPTH_TEST",gA[gA.SCISSOR_TEST=3089]="SCISSOR_TEST",gA[gA.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",gA[gA.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",gA[gA.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",gA[gA.NO_ERROR=0]="NO_ERROR",gA[gA.INVALID_ENUM=1280]="INVALID_ENUM",gA[gA.INVALID_VALUE=1281]="INVALID_VALUE",gA[gA.INVALID_OPERATION=1282]="INVALID_OPERATION",gA[gA.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",gA[gA.CW=2304]="CW",gA[gA.CCW=2305]="CCW",gA[gA.LINE_WIDTH=2849]="LINE_WIDTH",gA[gA.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",gA[gA.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",gA[gA.CULL_FACE_MODE=2885]="CULL_FACE_MODE",gA[gA.FRONT_FACE=2886]="FRONT_FACE",gA[gA.DEPTH_RANGE=2928]="DEPTH_RANGE",gA[gA.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",gA[gA.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",gA[gA.DEPTH_FUNC=2932]="DEPTH_FUNC",gA[gA.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",gA[gA.STENCIL_FUNC=2962]="STENCIL_FUNC",gA[gA.STENCIL_FAIL=2964]="STENCIL_FAIL",gA[gA.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",gA[gA.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",gA[gA.STENCIL_REF=2967]="STENCIL_REF",gA[gA.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",gA[gA.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",gA[gA.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",gA[gA.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",gA[gA.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",gA[gA.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",gA[gA.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",gA[gA.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",gA[gA.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",gA[gA.VIEWPORT=2978]="VIEWPORT",gA[gA.SCISSOR_BOX=3088]="SCISSOR_BOX",gA[gA.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",gA[gA.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",gA[gA.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",gA[gA.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",gA[gA.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",gA[gA.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",gA[gA.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",gA[gA.RED_BITS=3410]="RED_BITS",gA[gA.GREEN_BITS=3411]="GREEN_BITS",gA[gA.BLUE_BITS=3412]="BLUE_BITS",gA[gA.ALPHA_BITS=3413]="ALPHA_BITS",gA[gA.DEPTH_BITS=3414]="DEPTH_BITS",gA[gA.STENCIL_BITS=3415]="STENCIL_BITS",gA[gA.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",gA[gA.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",gA[gA.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",gA[gA.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",gA[gA.SAMPLES=32937]="SAMPLES",gA[gA.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",gA[gA.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",gA[gA.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",gA[gA.DONT_CARE=4352]="DONT_CARE",gA[gA.FASTEST=4353]="FASTEST",gA[gA.NICEST=4354]="NICEST",gA[gA.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",gA[gA.BYTE=5120]="BYTE",gA[gA.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",gA[gA.SHORT=5122]="SHORT",gA[gA.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",gA[gA.INT=5124]="INT",gA[gA.UNSIGNED_INT=5125]="UNSIGNED_INT",gA[gA.FLOAT=5126]="FLOAT",gA[gA.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",gA[gA.ALPHA=6406]="ALPHA",gA[gA.RGB=6407]="RGB",gA[gA.RGBA=6408]="RGBA",gA[gA.LUMINANCE=6409]="LUMINANCE",gA[gA.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",gA[gA.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",gA[gA.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",gA[gA.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",gA[gA.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",gA[gA.VERTEX_SHADER=35633]="VERTEX_SHADER",gA[gA.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",gA[gA.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",gA[gA.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",gA[gA.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",gA[gA.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",gA[gA.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",gA[gA.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",gA[gA.SHADER_TYPE=35663]="SHADER_TYPE",gA[gA.DELETE_STATUS=35712]="DELETE_STATUS",gA[gA.LINK_STATUS=35714]="LINK_STATUS",gA[gA.VALIDATE_STATUS=35715]="VALIDATE_STATUS",gA[gA.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",gA[gA.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",gA[gA.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",gA[gA.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",gA[gA.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",gA[gA.NEVER=512]="NEVER",gA[gA.LESS=513]="LESS",gA[gA.EQUAL=514]="EQUAL",gA[gA.LEQUAL=515]="LEQUAL",gA[gA.GREATER=516]="GREATER",gA[gA.NOTEQUAL=517]="NOTEQUAL",gA[gA.GEQUAL=518]="GEQUAL",gA[gA.ALWAYS=519]="ALWAYS",gA[gA.KEEP=7680]="KEEP",gA[gA.REPLACE=7681]="REPLACE",gA[gA.INCR=7682]="INCR",gA[gA.DECR=7683]="DECR",gA[gA.INVERT=5386]="INVERT",gA[gA.INCR_WRAP=34055]="INCR_WRAP",gA[gA.DECR_WRAP=34056]="DECR_WRAP",gA[gA.VENDOR=7936]="VENDOR",gA[gA.RENDERER=7937]="RENDERER",gA[gA.VERSION=7938]="VERSION",gA[gA.NEAREST=9728]="NEAREST",gA[gA.LINEAR=9729]="LINEAR",gA[gA.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",gA[gA.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",gA[gA.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",gA[gA.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",gA[gA.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",gA[gA.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",gA[gA.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",gA[gA.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",gA[gA.TEXTURE_2D=3553]="TEXTURE_2D",gA[gA.TEXTURE=5890]="TEXTURE",gA[gA.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",gA[gA.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",gA[gA.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",gA[gA.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",gA[gA.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",gA[gA.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",gA[gA.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",gA[gA.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",gA[gA.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",gA[gA.TEXTURE0=33984]="TEXTURE0",gA[gA.TEXTURE1=33985]="TEXTURE1",gA[gA.TEXTURE2=33986]="TEXTURE2",gA[gA.TEXTURE3=33987]="TEXTURE3",gA[gA.TEXTURE4=33988]="TEXTURE4",gA[gA.TEXTURE5=33989]="TEXTURE5",gA[gA.TEXTURE6=33990]="TEXTURE6",gA[gA.TEXTURE7=33991]="TEXTURE7",gA[gA.TEXTURE8=33992]="TEXTURE8",gA[gA.TEXTURE9=33993]="TEXTURE9",gA[gA.TEXTURE10=33994]="TEXTURE10",gA[gA.TEXTURE11=33995]="TEXTURE11",gA[gA.TEXTURE12=33996]="TEXTURE12",gA[gA.TEXTURE13=33997]="TEXTURE13",gA[gA.TEXTURE14=33998]="TEXTURE14",gA[gA.TEXTURE15=33999]="TEXTURE15",gA[gA.TEXTURE16=34e3]="TEXTURE16",gA[gA.TEXTURE17=34001]="TEXTURE17",gA[gA.TEXTURE18=34002]="TEXTURE18",gA[gA.TEXTURE19=34003]="TEXTURE19",gA[gA.TEXTURE20=34004]="TEXTURE20",gA[gA.TEXTURE21=34005]="TEXTURE21",gA[gA.TEXTURE22=34006]="TEXTURE22",gA[gA.TEXTURE23=34007]="TEXTURE23",gA[gA.TEXTURE24=34008]="TEXTURE24",gA[gA.TEXTURE25=34009]="TEXTURE25",gA[gA.TEXTURE26=34010]="TEXTURE26",gA[gA.TEXTURE27=34011]="TEXTURE27",gA[gA.TEXTURE28=34012]="TEXTURE28",gA[gA.TEXTURE29=34013]="TEXTURE29",gA[gA.TEXTURE30=34014]="TEXTURE30",gA[gA.TEXTURE31=34015]="TEXTURE31",gA[gA.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",gA[gA.REPEAT=10497]="REPEAT",gA[gA.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",gA[gA.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",gA[gA.FLOAT_VEC2=35664]="FLOAT_VEC2",gA[gA.FLOAT_VEC3=35665]="FLOAT_VEC3",gA[gA.FLOAT_VEC4=35666]="FLOAT_VEC4",gA[gA.INT_VEC2=35667]="INT_VEC2",gA[gA.INT_VEC3=35668]="INT_VEC3",gA[gA.INT_VEC4=35669]="INT_VEC4",gA[gA.BOOL=35670]="BOOL",gA[gA.BOOL_VEC2=35671]="BOOL_VEC2",gA[gA.BOOL_VEC3=35672]="BOOL_VEC3",gA[gA.BOOL_VEC4=35673]="BOOL_VEC4",gA[gA.FLOAT_MAT2=35674]="FLOAT_MAT2",gA[gA.FLOAT_MAT3=35675]="FLOAT_MAT3",gA[gA.FLOAT_MAT4=35676]="FLOAT_MAT4",gA[gA.SAMPLER_2D=35678]="SAMPLER_2D",gA[gA.SAMPLER_CUBE=35680]="SAMPLER_CUBE",gA[gA.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",gA[gA.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",gA[gA.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",gA[gA.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",gA[gA.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",gA[gA.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",gA[gA.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",gA[gA.COMPILE_STATUS=35713]="COMPILE_STATUS",gA[gA.LOW_FLOAT=36336]="LOW_FLOAT",gA[gA.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",gA[gA.HIGH_FLOAT=36338]="HIGH_FLOAT",gA[gA.LOW_INT=36339]="LOW_INT",gA[gA.MEDIUM_INT=36340]="MEDIUM_INT",gA[gA.HIGH_INT=36341]="HIGH_INT",gA[gA.FRAMEBUFFER=36160]="FRAMEBUFFER",gA[gA.RENDERBUFFER=36161]="RENDERBUFFER",gA[gA.RGBA4=32854]="RGBA4",gA[gA.RGB5_A1=32855]="RGB5_A1",gA[gA.RGB565=36194]="RGB565",gA[gA.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",gA[gA.STENCIL_INDEX=6401]="STENCIL_INDEX",gA[gA.STENCIL_INDEX8=36168]="STENCIL_INDEX8",gA[gA.DEPTH_STENCIL=34041]="DEPTH_STENCIL",gA[gA.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",gA[gA.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",gA[gA.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",gA[gA.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",gA[gA.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",gA[gA.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",gA[gA.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",gA[gA.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",gA[gA.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",gA[gA.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",gA[gA.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",gA[gA.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",gA[gA.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",gA[gA.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",gA[gA.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",gA[gA.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",gA[gA.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",gA[gA.NONE=0]="NONE",gA[gA.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",gA[gA.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",gA[gA.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",gA[gA.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",gA[gA.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",gA[gA.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",gA[gA.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",gA[gA.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",gA[gA.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",gA[gA.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",gA[gA.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",gA[gA.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",gA[gA.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",gA[gA.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL";var NA,DA,FA,jA,UA,BA,zA,VA,HA,GA=(_A=Fx(),bA=nx(Bx.IRendererService),EA=nx(Bx.IGlobalConfigService),xA=nx(Bx.IInteractionService),SA=nx(Bx.ILayerService),_A((AA=function(){function e(){var t=this;Fc(this,e),DT(this,"rendererService",wA,this),DT(this,"configService",CA,this),DT(this,"interactionService",kA,this),DT(this,"layerService",OA,this),lc(this,"pickingFBO",void 0),lc(this,"width",0),lc(this,"height",0),lc(this,"alreadyInPicking",!1),lc(this,"pickBufferScale",1),lc(this,"pickFromPickingFBO",(function(e,n){var r,i=n.x,a=n.y,o=n.lngLat,s=n.type,u=n.target,l=!1,c=t.rendererService;c.getViewportSize;var f=c.readPixels,p=c.getContainer,h=t.getContainerSize(p()),d=h.width,v=h.height;d*=Ep,v*=Ep;var m,y=e.getLayerConfig(),g=y.enableHighlight,_=y.enableSelect,b=i*Ep,E=a*Ep;if(b>d-1*Ep||b<0||E>v-1*Ep||E<0)return!1;if(0!==(m=f({x:Math.floor(b/t.pickBufferScale),y:Math.floor((v-(a+1)*Ep)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}))[0]||0!==m[1]||0!==m[2]){var x=_h(m),S=e.getSource().getFeatureById(x);x!==e.getCurrentPickId()&&"mousemove"===s&&(s="mouseenter");var T={x:i,y:a,type:s,lngLat:o,featureId:x,feature:S,target:u};S&&(l=!0,e.setCurrentPickId(x),t.triggerHoverOnLayer(e,T))}else{var A={x:i,y:a,lngLat:o,type:null!==e.getCurrentPickId()&&"mousemove"===s?"mouseout":"un"+s,featureId:null,target:u,feature:null};t.triggerHoverOnLayer(e,LA(LA({},A),{},{type:"unpick"})),t.triggerHoverOnLayer(e,A),e.setCurrentPickId(null)}if(g&&t.highlightPickedFeature(e,m),_&&"click"===s&&(null===(r=m)||void 0===r?void 0:r.toString())!==[0,0,0,0].toString()){var w=_h(m);null===e.getCurrentSelectedId()||w!==e.getCurrentSelectedId()?(t.selectFeature(e,m),e.setCurrentSelectedId(w)):(t.selectFeature(e,new Uint8Array([0,0,0,0])),e.setCurrentSelectedId(null))}return l}))}var t,n,r;return Uc(e,[{key:"init",value:function(e){var t=this.rendererService,n=t.createTexture2D,r=t.createFramebuffer;t.getViewportSize;var i=t.getContainer,a=this.getContainerSize(i()),o=a.width,s=a.height;o*=Ep,s*=Ep,this.pickBufferScale=this.configService.getSceneConfig(e).pickBufferScale||1,this.pickingFBO=r({color:n({width:Math.round(o/this.pickBufferScale),height:Math.round(s/this.pickBufferScale),wrapS:yA.CLAMP_TO_EDGE,wrapT:yA.CLAMP_TO_EDGE})}),this.interactionService.on(rA.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:(r=vA(MA.mark((function e(t,n,r){var i,a,o,s=this;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.rendererService,a=i.useFramebuffer,o=i.clear,this.resizePickingFBO(),a(this.pickingFBO,(function(){o({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.hooks.beforePickingEncode.call(),t.renderModels(),t.hooks.afterPickingEncode.call();var e=s.pickBox(t,n);r(e)}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"pickBox",value:function(e,t){var n=this,r=Ic(t.map((function(e){var t=e<0?0:e;return Math.floor(t*Ep/n.pickBufferScale)})),4),i=r[0],a=r[1],o=r[2],s=r[3],u=this.rendererService;u.getViewportSize;var l,c=u.readPixels,f=u.getContainer,p=this.getContainerSize(f()),h=p.width,d=p.height;if(d*=Ep,i>((h*=Ep)-1)*Ep/this.pickBufferScale||o<0||a>(d-1)*Ep/this.pickBufferScale||s<0)return[];var v=Math.min(h/this.pickBufferScale,o)-i,m=Math.min(d/this.pickBufferScale,s)-a;l=c({x:i,y:Math.floor(d/this.pickBufferScale-(s+1)),width:v,height:m,data:new Uint8Array(v*m*4),framebuffer:this.pickingFBO});for(var y=[],g={},_=0;_<l.length/4;_+=1){var b=_h(l.slice(4*_,4*_+4));if(-1!==b&&!g[b]){var E=e.getSource().getFeatureById(b);y.push(E),g[b]=!0}}return y}},{key:"getContainerSize",value:function(e){return e.getContext?{width:e.width/Ep,height:e.height/Ep}:e.getBoundingClientRect()}},{key:"pickingAllLayer",value:(n=vA(MA.mark((function e(t){return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.layerService.isMapDragging())){e.next=2;break}return e.abrupt("return");case 2:return this.alreadyInPicking=!0,e.next=5,this.pickingLayers(t);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"resizePickingFBO",value:function(){var e=this.rendererService.getContainer,t=this.getContainerSize(e()),n=t.width,r=t.height;n*=Ep,r*=Ep,this.width===n&&this.height===r||(this.pickingFBO.resize({width:Math.round(n/this.pickBufferScale),height:Math.round(r/this.pickBufferScale)}),this.width=n,this.height=r)}},{key:"pickingLayers",value:(t=vA(MA.mark((function e(t){var n,r,i,a=this;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.rendererService,r=n.useFramebuffer,i=n.clear,this.resizePickingFBO(),r(this.pickingFBO,(function(){a.layerService.getLayers().filter((function(e){return e.needPick(t.type)})).reverse().some((function(e){return i({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),e.hooks.beforePickingEncode.call(),e.renderModels(),e.hooks.afterPickingEncode.call(),a.pickFromPickingFBO(e,t)&&!e.getLayerConfig().enablePropagation}))}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"triggerHoverOnLayer",value:function(e,t){var n,r,i,a;a=!0,null==(n=t)||null===(r=n.target)||void 0===r||null===(i=r.path)||void 0===i||i.map((function(e){var t;null!=e&&e.classList&&(null==e||null===(t=e.classList)||void 0===t||t.forEach((function(e){"l7-marker"!==e&&"l7-popup"!==e||(a=!1)})))})),a&&e.emit(t.type,t)}},{key:"highlightPickedFeature",value:function(e,t){var n=Ic(t,3),r=n[0],i=n[1],a=n[2];e.hooks.beforeHighlight.call([r,i,a])}},{key:"selectFeature",value:function(e,t){var n=Ic(t,3),r=n[0],i=n[1],a=n[2];e.hooks.beforeSelect.call([r,i,a])}}]),e}(),wA=FT(AA.prototype,"rendererService",[bA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CA=FT(AA.prototype,"configService",[EA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kA=FT(AA.prototype,"interactionService",[xA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OA=FT(AA.prototype,"layerService",[SA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TA=AA))||TA),WA=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Fc(this,e),lc(this,"autoStart",void 0),lc(this,"startTime",0),lc(this,"oldTime",0),lc(this,"running",!1),lc(this,"elapsedTime",0),this.autoStart=t}return Uc(e,[{key:"start",value:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}(),XA=(NA=Fx(),DA=nx(Bx.IRendererService),FA=nx(Bx.IMapService),jA=nx(Bx.IGlobalConfigService),NA((BA=function(){function e(){Fc(this,e),lc(this,"clock",new WA),lc(this,"alreadyInRendering",!1),lc(this,"layers",[]),lc(this,"layerList",[]),lc(this,"layerRenderID",void 0),lc(this,"sceneInited",!1),lc(this,"animateInstanceCount",0),DT(this,"renderService",zA,this),DT(this,"mapService",VA,this),DT(this,"configService",HA,this)}return Uc(e,[{key:"add",value:function(e){this.sceneInited&&e.init(),this.layers.push(e),this.updateLayerRenderList()}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach((function(e){e.inited||e.init()})),this.updateLayerRenderList()}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(e){return this.layers.find((function(t){return t.id===e}))}},{key:"getLayerByName",value:function(e){return this.layers.find((function(t){return t.name===e}))}},{key:"remove",value:function(e,t){if(t){var n=t.layerChildren.indexOf(e);n>-1&&t.layerChildren.splice(n,1)}else{var r=this.layers.indexOf(e);r>-1&&this.layers.splice(r,1)}this.updateLayerRenderList(),e.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.layerList.forEach((function(e){e.hooks.beforeRenderData.call(),e.hooks.beforeRender.call(),e.render(),e.hooks.afterRender.call()})),this.alreadyInRendering=!1)}},{key:"updateLayerRenderList",value:function(){var e=this;this.layerList=[],this.layers.filter((function(e){return e.inited})).filter((function(e){return e.isVisible()})).forEach((function(t){e.layerList.push(t),t.layerChildren.filter((function(e){return e.inited})).filter((function(e){return e.isVisible()})).forEach((function(t){e.layerList.push(t)}))})),this.layerList.sort((function(e,t){return e.zIndex-t.zIndex}))}},{key:"destroy",value:function(){this.layers.forEach((function(e){e.layerChildren&&(e.layerChildren.forEach((function(e){return e.destroy()})),e.layerChildren=[]),e.destroy()})),this.layers=[],this.layerList=[],this.renderLayers()}},{key:"startAnimate",value:function(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"isMapDragging",value:function(){return this.mapService.dragging}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=lp.requestAnimationFrame(this.runRender.bind(this))}},{key:"clear",value:function(){var e=gh(this.mapService.bgColor);this.renderService.clear({color:e,depth:1,stencil:0,framebuffer:null})}},{key:"stopRender",value:function(){lp.cancelAnimationFrame(this.layerRenderID)}}]),e}(),zA=FT(BA.prototype,"renderService",[DA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VA=FT(BA.prototype,"mapService",[FA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HA=FT(BA.prototype,"configService",[jA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UA=BA))||UA);function YA(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var qA,ZA,KA,QA,JA,$A,ew=function(e){return null==e},tw=function(){function e(t){var n=this;Fc(this,e),lc(this,"name",void 0),lc(this,"type",void 0),lc(this,"scale",void 0),lc(this,"descriptor",void 0),lc(this,"featureBufferLayout",[]),lc(this,"needRescale",!1),lc(this,"needRemapping",!1),lc(this,"needRegenerateVertices",!1),lc(this,"featureRange",{startIndex:0,endIndex:1/0}),lc(this,"vertexAttribute",void 0),lc(this,"defaultCallback",(function(e){var t;return 0===e.length?(null===(t=n.scale)||void 0===t?void 0:t.defaultValues)||[]:e.map((function(e,t){var r;return(null===(r=n.scale)||void 0===r?void 0:r.scalers[t].func)(e)}))})),this.setProps(t)}return Uc(e,[{key:"setProps",value:function(e){Object.assign(this,e)}},{key:"mapping",value:function(e){var t;if(null!==(t=this.scale)&&void 0!==t&&t.callback){var n,r=null===(n=this.scale)||void 0===n?void 0:n.callback.apply(n,pc(e));if(!ew(r))return[r]}return this.defaultCallback(e)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),nw=["buffer","update","name"];function rw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rw(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var aw=(lc(qA={},yA.FLOAT,4),lc(qA,yA.UNSIGNED_BYTE,1),lc(qA,yA.UNSIGNED_SHORT,2),qA),ow=(ZA=Fx(),KA=nx(Bx.IRendererService),ZA((JA=function(){function e(){Fc(this,e),lc(this,"attributesAndIndices",void 0),DT(this,"rendererService",$A,this),lc(this,"attributes",[]),lc(this,"triangulation",void 0),lc(this,"featureLayout",{sizePerElement:0,elements:[]})}return Uc(e,[{key:"registerStyleAttribute",value:function(e){var t=this.getLayerStyleAttribute(e.name||"");return t?t.setProps(e):(t=new tw(e),this.attributes.push(t)),t}},{key:"updateStyleAttribute",value:function(e,t,n){var r=this.getLayerStyleAttribute(e);r||(r=this.registerStyleAttribute(iw(iw({},t),{},{name:e})));var i=t.scale;i&&r&&(r.scale=i,r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0,n&&n.featureRange&&(r.featureRange=n.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(e){return this.attributes.find((function(t){return t.name===e}))}},{key:"getLayerAttributeScale",value:function(e){var t,n=this.getLayerStyleAttribute(e),r=null==n||null===(t=n.scale)||void 0===t?void 0:t.scalers;return r&&r[0]?r[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=this.attributes.find((function(t){return t.name===e}));if(i&&i.descriptor){var a=i.descriptor,o=a.update,s=a.buffer,u=a.size,l=void 0===u?0:u,c=aw[s.type||yA.FLOAT];if(o){var f=this.featureLayout,p=f.elements,h=f.sizePerElement,d=p.slice(n,r);if(!d.length)return;var v=d[0].offset,m=v*l*c,y=d.map((function(e,n){for(var r=e.featureIdx,i=e.vertices,a=e.normals,s=i.length/h,u=[],l=0;l<s;l++){var c=a?a.slice(3*l,3*l+3):[];u.push.apply(u,pc(o(t[r],r,i.slice(l*h,l*h+h),n,c)))}return u})).reduce((function(e,t){return e.push.apply(e,pc(t)),e}),[]);i.vertexAttribute.updateBuffer({data:y,offset:m})}}}},{key:"createAttributesAndIndices",value:function(e,t,n){var r=this;this.featureLayout={sizePerElement:0,elements:[]},t&&(this.triangulation=t);var i=this.attributes.map((function(e){return e.resetDescriptor(),e.descriptor})),a=0,o=[],s=3;e.forEach((function(e,t){var u=r.triangulation(e,n),l=u.indices,c=u.vertices,f=u.normals,p=u.size;l.forEach((function(e){o.push(e+a)})),s=p;var h=c.length/p;r.featureLayout.sizePerElement=s,r.featureLayout.elements.push({featureIdx:t,vertices:c,normals:f,offset:a}),a+=h;for(var d=function(n){var r=(null==f?void 0:f.slice(3*n,3*n+3))||[],a=c.slice(n*p,n*p+p);i.forEach((function(i,o){var s;i&&i.update&&(s=i.buffer.data).push.apply(s,pc(i.update(e,t,a,n,r)))}))},v=0;v<h;v++)d(v)}));var u=this.rendererService,l=u.createAttribute,c=u.createBuffer,f=u.createElements,p={};i.forEach((function(e,t){if(e){var n=e.buffer;e.update,e.name;var i=YA(e,nw),a=l(iw({buffer:c(n)},i));p[e.name||""]=a,r.attributes[t].vertexAttribute=a}}));var h=f({data:o,type:yA.UNSIGNED_INT,count:o.length});return this.attributesAndIndices={attributes:p,elements:h},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var e;this.attributes.forEach((function(e){e.vertexAttribute&&e.vertexAttribute.destroy()})),null===(e=this.attributesAndIndices)||void 0===e||e.elements.destroy(),this.attributes=[]}}]),e}(),$A=FT(JA.prototype,"rendererService",[KA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QA=JA))||QA),sw={exports:{}};function uw(e){var t=e.target||e.srcElement;t.__resizeRAF__&&cancelAnimationFrame(t.__resizeRAF__),t.__resizeRAF__=requestAnimationFrame((function(){var n=t.__resizeTrigger__,r=n&&n.__resizeListeners__;r&&r.forEach((function(t){t.call(n,e)}))}))}var lw=function(e,t){var n,r=this.document,i=r.attachEvent;if("undefined"!=typeof navigator&&(n=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!e.__resizeListeners__)if(e.__resizeListeners__=[],i)e.__resizeTrigger__=e,e.attachEvent("onresize",uw);else{"static"===getComputedStyle(e).position&&(e.style.position="relative");var a=e.__resizeTrigger__=r.createElement("object");a.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),a.setAttribute("class","resize-sensor"),a.setAttribute("tabindex","-1"),a.setAttribute("title",""),a.__resizeElement__=e,a.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",uw)},a.type="text/html",n&&e.appendChild(a),a.data="about:blank",n||e.appendChild(a)}e.__resizeListeners__.push(t)};sw.exports="undefined"==typeof window?lw:lw.bind(window);var cw,fw,pw,hw,dw,vw,mw,yw,gw,_w,bw,Ew,xw,Sw,Tw,Aw,ww,Cw,kw,Ow,Mw,Rw,Pw,Iw,Lw,Nw,Dw,Fw,jw,Uw,Bw,zw,Vw,Hw=sw.exports.unbind=function(e,t){var n=document.attachEvent,r=e.__resizeListeners__||[];if(t){var i=r.indexOf(t);-1!==i&&r.splice(i,1)}else r=e.__resizeListeners__=[];if(!r.length){if(n)e.detachEvent("onresize",uw);else if(e.__resizeTrigger__){var a=e.__resizeTrigger__.contentDocument,o=a&&a.defaultView;o&&(o.removeEventListener("resize",uw),delete o.__resizeTrigger__),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)}delete e.__resizeListeners__}},Gw=sw.exports;function Ww(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Xw=(cw=Fx(),fw=nx(Bx.SceneID),pw=nx(Bx.IIconService),hw=nx(Bx.IFontService),dw=nx(Bx.IControlService),vw=nx(Bx.IGlobalConfigService),mw=nx(Bx.IMapService),yw=nx(Bx.ICoordinateSystemService),gw=nx(Bx.IRendererService),_w=nx(Bx.ILayerService),bw=nx(Bx.ICameraService),Ew=nx(Bx.IInteractionService),xw=nx(Bx.IPickingService),Sw=nx(Bx.IShaderModuleService),Tw=nx(Bx.IMarkerService),Aw=nx(Bx.IPopupService),cw((Cw=function(e){Gc(r,Xb.exports.EventEmitter);var t,n=Ww(r);function r(){var e;return Fc(this,r),lc(Xc(e=n.call(this)),"destroyed",!1),lc(Xc(e),"loaded",!1),lc(Xc(e),"loadFont",!1),lc(Xc(e),"fontFamily",""),DT(Xc(e),"id",kw,Xc(e)),DT(Xc(e),"iconService",Ow,Xc(e)),DT(Xc(e),"fontService",Mw,Xc(e)),DT(Xc(e),"controlService",Rw,Xc(e)),DT(Xc(e),"configService",Pw,Xc(e)),DT(Xc(e),"map",Iw,Xc(e)),DT(Xc(e),"coordinateSystemService",Lw,Xc(e)),DT(Xc(e),"rendererService",Nw,Xc(e)),DT(Xc(e),"layerService",Dw,Xc(e)),DT(Xc(e),"cameraService",Fw,Xc(e)),DT(Xc(e),"interactionService",jw,Xc(e)),DT(Xc(e),"pickingService",Uw,Xc(e)),DT(Xc(e),"shaderModuleService",Bw,Xc(e)),DT(Xc(e),"markerService",zw,Xc(e)),DT(Xc(e),"popupService",Vw,Xc(e)),lc(Xc(e),"inited",!1),lc(Xc(e),"initPromise",void 0),lc(Xc(e),"rendering",!1),lc(Xc(e),"$container",void 0),lc(Xc(e),"canvas",void 0),lc(Xc(e),"markerContainer",void 0),lc(Xc(e),"hooks",void 0),lc(Xc(e),"handleWindowResized",(function(){e.emit("resize"),e.$container&&(e.initContainer(),function(){if("function"==typeof Event)lp.dispatchEvent(new Event("resize"));else{var e=lp.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,lp,0),lp.dispatchEvent(e)}}(),e.coordinateSystemService.needRefresh=!0,e.render())})),lc(Xc(e),"handleMapCameraChanged",(function(t){e.cameraService.update(t),e.render()})),e.hooks={init:new Vb},e}return Uc(r,[{key:"init",value:function(e){var t=this;this.configService.setSceneConfig(this.id,e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",vA(MA.mark((function e(){return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.map.onCameraChanged((function(n){t.cameraService.init(),t.cameraService.update(n),"GAODE2.x"!==t.map.version&&e()})),"GAODE2.x"!==t.map.version?t.map.init():e()}));case 2:if("GAODE2.x"!==t.map.version||!t.map.initViewPort){e.next=6;break}return e.next=5,t.map.init();case 5:t.map.initViewPort();case 6:t.map.onCameraChanged(t.handleMapCameraChanged),t.map.addMarkerContainer(),t.markerService.addMarkers(),t.markerService.addMarkerLayers(),t.popupService.initPopup(),t.interactionService.init(),t.interactionService.on(rA.Drag,t.addSceneEvent.bind(t));case 13:case"end":return e.stop()}}),e)})))),this.hooks.init.tapPromise("initRenderer",vA(MA.mark((function e(){var n,r;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=PA(t.configService.getSceneConfig(t.id).id||""),t.$container=n,!n){e.next=11;break}return t.canvas=pp("canvas","",n),t.setCanvas(),e.next=7,t.rendererService.init(t.canvas,t.configService.getSceneConfig(t.id));case 7:Gw(t.$container,t.handleWindowResized),lp.matchMedia&&(null===(r=lp.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))||void 0===r||r.addListener(t.handleWindowResized)),e.next=12;break;case 11:console.error("容器 id 不存在");case 12:t.pickingService.init(t.id);case 13:case"end":return e.stop()}}),e)})))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"initMiniScene",value:function(e){var t=this;this.configService.setSceneConfig(this.id,e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",vA(MA.mark((function e(){return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.map.onCameraChanged((function(n){t.cameraService.init(),t.cameraService.update(n),"GAODE2.x"!==t.map.version&&e()})),t.map.initMiniMap()}));case 2:t.map.onCameraChanged(t.handleMapCameraChanged),t.interactionService.init(),t.interactionService.on(rA.Drag,t.addSceneEvent.bind(t));case 5:case"end":return e.stop()}}),e)})))),this.hooks.init.tapPromise("initRenderer",vA(MA.mark((function n(){var r;return MA.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.canvas,t.$container=r||null,!t.$container){n.next=7;break}return n.next=5,t.rendererService.init(e.canvas,t.configService.getSceneConfig(t.id));case 5:n.next=8;break;case 7:console.error("容器 id 不存在");case 8:t.pickingService.init(t.id);case 9:case"end":return n.stop()}}),n)})))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(e){this.layerService.sceneService=this,this.layerService.add(e),this.render()}},{key:"render",value:(t=vA(MA.mark((function e(){return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rendering&&!this.destroyed){e.next=2;break}return e.abrupt("return");case 2:if(this.rendering=!0,this.inited){e.next=15;break}return e.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!this.loadFont||!document.fonts){e.next=10;break}return e.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 15:this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this.rendering=!1;case 18:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addFontFace",value:function(e,t){this.fontFamily=e;var n=document.createElement("style");n.type="text/css",n.innerText="\n        @font-face{\n            font-family: '".concat(e,"';\n            src: url('").concat(t,"') format('woff2'),\n            url('").concat(t,"') format('woff'),\n            url('").concat(t,"') format('truetype');\n        }"),document.getElementsByTagName("head")[0].appendChild(n),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(e){var t,n=null===(t=this.$container)||void 0===t?void 0:t.getElementsByTagName("canvas")[0];return this.render(),"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png")}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var e=this.$container.parentElement;null!==e&&(this.markerContainer=pp("div","l7-marker-container",e))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var e,t,n;this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),null===(e=this.$container)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,Hw(this.$container,this.handleWindowResized),lp.matchMedia&&(null===(n=lp.matchMedia("screen and (min-resolution: 2dppx)"))||void 0===n||n.removeListener(this.handleWindowResized))):this.destroyed=!0}},{key:"initContainer",value:function(){var e,t,n=Ep,r=(null===(e=this.$container)||void 0===e?void 0:e.clientWidth)||400,i=(null===(t=this.$container)||void 0===t?void 0:t.clientHeight)||300,a=this.canvas;a&&(a.width=r*n,a.height=i*n),this.rendererService.viewport({x:0,y:0,width:n*r,height:n*i})}},{key:"setCanvas",value:function(){var e,t,n=Ep,r=(null===(e=this.$container)||void 0===e?void 0:e.clientWidth)||400,i=(null===(t=this.$container)||void 0===t?void 0:t.clientHeight)||300,a=this.canvas;a.width=r*n,a.height=i*n,a.style.width="100%",a.style.height="100%"}},{key:"addSceneEvent",value:function(e){this.emit(e.type,e)}}]),r}(),kw=FT(Cw.prototype,"id",[fw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ow=FT(Cw.prototype,"iconService",[pw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mw=FT(Cw.prototype,"fontService",[hw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rw=FT(Cw.prototype,"controlService",[dw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pw=FT(Cw.prototype,"configService",[vw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iw=FT(Cw.prototype,"map",[mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lw=FT(Cw.prototype,"coordinateSystemService",[yw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nw=FT(Cw.prototype,"rendererService",[gw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dw=FT(Cw.prototype,"layerService",[_w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fw=FT(Cw.prototype,"cameraService",[bw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jw=FT(Cw.prototype,"interactionService",[Ew],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uw=FT(Cw.prototype,"pickingService",[xw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bw=FT(Cw.prototype,"shaderModuleService",[Sw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zw=FT(Cw.prototype,"markerService",[Tw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vw=FT(Cw.prototype,"popupService",[Aw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ww=Cw))||ww);var Yw=fv,qw=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Zw=function(e){return this.__data__.has(e)};function Kw(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Yw;++t<n;)this.add(e[t])}Kw.prototype.add=Kw.prototype.push=qw,Kw.prototype.has=Zw;var Qw=Kw;var Jw=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1},$w=function(e){return e!=e},eC=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1};var tC=function(e,t,n){return t==t?eC(e,t,n):Jw(e,$w,n)};var nC=function(e,t){return!!(null==e?0:e.length)&&tC(e,t,0)>-1};var rC=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1};var iC=function(e,t){return e.has(t)};var aC=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},oC=r_,sC=function(){},uC=oC&&1/aC(new oC([,-0]))[1]==1/0?function(e){return new oC(e)}:sC,lC=Qw,cC=nC,fC=rC,pC=iC,hC=uC,dC=aC;var vC=function(e,t,n){var r=-1,i=cC,a=e.length,o=!0,s=[],u=s;if(n)o=!1,i=fC;else if(a>=200){var l=t?null:hC(e);if(l)return dC(l);o=!1,i=pC,u=new lC}else u=t?[]:s;e:for(;++r<a;){var c=e[r],f=t?t(c):c;if(c=n||0!==c?c:0,o&&f==f){for(var p=u.length;p--;)if(u[p]===f)continue e;t&&u.push(f),s.push(c)}else i(u,f,n)||(u!==s&&u.push(f),s.push(c))}return s};var mC=function(e){return e&&e.length?vC(e):[]};var yC,gC=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function _C(e){var t={};return{content:e=e.replace(gC,(function(e,n,r){var i=r.split(":"),a=i[0].trim(),o="";switch(i.length>1&&(o=i[1].trim()),n){case"bool":o="true"===o;break;case"float":case"int":o=Number(o);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":o=o?o.replace("[","").replace("]","").split(",").reduce((function(e,t){return e.push(Number(t.trim())),e}),[]):new Array(function(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16}return t}(n)).fill(0)}return t[a]=o,"uniform ".concat(n," ").concat(a,";\n")})),uniforms:t}}function bC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function EC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bC(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xC,SC,TC,AC,wC,CC,kC,OC="#define PI 3.14159265359",MC=/precision\s+(high|low|medium)p\s+float/,RC=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,PC=Fx()(yC=function(){function e(){Fc(this,e),lc(this,"moduleCache",{}),lc(this,"rawContentCache",{})}return Uc(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:OC,fs:OC}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("projection",{vs:"#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\n#define COORDINATE_SYSTEM_P20_2 8.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// uniform mat4 u_Mvp;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0\n    return vector;\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // return vec4(\n    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), \n    //   project_scale(position.z), \n    //   position.w);\n\n     return vec4(\n      position.xy, \n      project_scale(position.z), \n      position.w);\n  }\n  return position;\n\n  // TODO: 瓦片坐标系 & 常规世界坐标系\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel_allmap(float pixel) {\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    return pixel * pow(2.0, u_Zoom);\n  }\n  return pixel;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}",fs:""}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n\n// gaode2.0\nvec2 customProject(vec2 lnglat) { // 经纬度 => 平面坐标\n  float t = lnglat.x;\n  float e = lnglat.y;\n  float Sm = 180.0 / PI;\n  float Tm = 6378137.0;\n  float Rm = PI / 180.0;\n  float r = 85.0511287798;\n  e = max(min(r, e), -r);\n  t *= Rm;\n  e *= Rm;\n  e = log(tan(PI / 4.0 + e / 2.0));\n  return vec2(t * Tm, e * Tm);\n}\n\nvec2 unProjCustomCoord(vec2 point) { // 平面坐标 => 经纬度\n  float Sm = 57.29577951308232; //180 / Math.PI\n  float Tm = 6378137.0;\n  float t = point.x;\n  float e = point.y;\n  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);\n}\n\n\nfloat customPixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n\nfloat setPickingOrder(float z) {\n   bool selected = bool(v_PickingResult.a);\n   return selected ? z + 1. : 0.;\n}\n",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_Dragging;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  // TODO: 过滤多余的 shader 计算\n  // if(u_Dragging > 0.0) return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("styleMapping",{vs:"attribute float a_vertexId;\n\nuniform mat4 u_cellTypeLayout;      // 描述数据纹理 cell 结构的矩阵\nuniform sampler2D u_dataTexture;    // 数据纹理\n\nbool hasOpacity() { // 判断 cell 中是否存在 opacity 的数据\n  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeOpacity() { // 判断 cell 中是否存在 strokeOpacity 的数据\n  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeWidth() { // 判断 cell 中是否存在 strokeWidth 的数据\n  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStroke() { // 判断 cell 中是否存在 stroke 的数据\n  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasOffsets() { // 判断 cell 中是否存在 offsets 的数据\n  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\n// 根据坐标位置先是计算 uv ，然后根据 uv 从数据纹理中取值\nfloat pos2value(vec2 pos, float columnWidth, float rowHeight) {\n  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;\n  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);\n  return texture2D(u_dataTexture, vec2(u, v)).r;\n}\n\n/*\n  currentRow 当前行\n  currentColumn 当前列\n  columnCount 有多少列\n  nextStep 需要计算当前 cell 后的第几个 cell （当前 cell 则 nextStep = 0）\n*/\nvec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {\n  float nextColumn = currentColumn;\n  float nextRow = currentRow;\n  if(currentColumn + nextStep <= columnCount){\n    nextColumn = currentColumn + nextStep;\n  } else {\n    nextColumn = mod(currentColumn + nextStep, columnCount); // 不会出现跨两行\n    nextRow = currentRow + 1.0;\n  }\n  return vec2(nextColumn, nextRow);\n}\n\n// 计算当前单个 cell 的大小\nfloat calCellCount() { \n  //   u_cellTypeLayout\n  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - 几行几列\n  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 表示有数据映射、0.0 表示没有\n  //   1.0, 0.0, 0.0, 0.0, // offsets\n  //   0.0, 0.0, 0.0, 0.0\n  \n  return  u_cellTypeLayout[1][0] +        // opacity\n          u_cellTypeLayout[1][1] +        // strokeOpacity\n          u_cellTypeLayout[1][2] +        // strokeWidth\n          u_cellTypeLayout[1][3] * 4.0 +  // stroke\n          u_cellTypeLayout[2][0] * 2.0;   // offsets\n}",fs:""}),this.registerModule("styleMappingCalOpacity",{vs:"\n// 计算 opacity 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasOpacity()) { // 数据纹理中不存在 opacity 的时候取默认值（用户在 style 中传入的是常量）\n    return vec2(u_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:"\n// 计算 strokeOpaicty 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeOpacity()) {\n    return vec2(u_stroke_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:"\n// 计算 strokeWidth 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeWidth()) {\n    return vec2(u_stroke_width, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeWidth, textureOffset + 1.0);\n  }\n}\n",fs:""})}},{key:"registerModule",value:function(e,t){if(!this.rawContentCache[e]){var n=t.vs,r=t.fs,i=t.uniforms,a=_C(n),o=a.content,s=a.uniforms,u=_C(r),l=u.content,c=u.uniforms;this.rawContentCache[e]={fs:l,uniforms:EC(EC(EC({},s),c),i),vs:o}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(e){var t=this;if(this.moduleCache[e])return this.moduleCache[e];var n=this.rawContentCache[e].vs,r=this.rawContentCache[e].fs,i=this.processModule(n,[],"vs"),a=i.content,o=i.includeList,s=this.processModule(r,[],"fs"),u=s.content,l=s.includeList,c=u,f=mC(o.concat(l).concat(e)).reduce((function(e,n){return EC(EC({},e),t.rawContentCache[n].uniforms)}),{});return MC.test(u)||(c="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+u),this.moduleCache[e]={fs:c.trim(),uniforms:f,vs:a.trim()},this.moduleCache[e]}},{key:"processModule",value:function(e,t,n){var r=this;return{content:e.replace(RC,(function(e,i){var a=i.split(" ")[0].replace(/"/g,"");if(t.indexOf(a)>-1)return"";var o=r.rawContentCache[a][n];return t.push(a),r.processModule(o,t,n).content})),includeList:t}}}]),e}())||yC;function IC(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qc(e)););return e}function LC(){return(LC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=IC(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}(SC=xC||(xC={})).Normal="normal",SC.PostProcessing="post-processing";var NC,DC=(TC=Fx(),AC=nx(Bx.IShaderModuleService),TC((CC=function(){function e(){Fc(this,e),DT(this,"shaderModuleService",kC,this),lc(this,"rendererService",void 0),lc(this,"cameraService",void 0),lc(this,"mapService",void 0),lc(this,"interactionService",void 0),lc(this,"layerService",void 0),lc(this,"config",void 0)}return Uc(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return xC.Normal}},{key:"init",value:function(e,t){this.config=t,this.rendererService=e.getContainer().get(Bx.IRendererService),this.cameraService=e.getContainer().get(Bx.ICameraService),this.mapService=e.getContainer().get(Bx.IMapService),this.interactionService=e.getContainer().get(Bx.IInteractionService),this.layerService=e.getContainer().get(Bx.ILayerService)}},{key:"render",value:function(e){}}]),e}(),kC=FT(CC.prototype,"shaderModuleService",[AC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wC=CC))||wC);function FC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var jC,UC,BC,zC,VC,HC=Fx()(NC=function(e){Gc(n,DC);var t=FC(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(e,t){LC(qc(n.prototype),"init",this).call(this,e,t)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),n}())||NC;function GC(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return WC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WC(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function WC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var XC,YC=(jC=Fx(),UC=nx(Bx.IPostProcessor),jC((zC=function(){function e(){Fc(this,e),lc(this,"passes",[]),DT(this,"postProcessor",VC,this),lc(this,"layer",void 0),lc(this,"renderFlag",void 0),lc(this,"width",0),lc(this,"height",0)}var t;return Uc(e,[{key:"setLayer",value:function(e){this.layer=e}},{key:"setRenderFlag",value:function(e){this.renderFlag=e}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:(t=vA(MA.mark((function e(){var t,n,r;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=GC(this.passes),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r.render(this.layer);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:this.layer.renderModels();case 18:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))),function(){return t.apply(this,arguments)})},{key:"resize",value:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t)}},{key:"add",value:function(e,t){e.getType()===xC.PostProcessing?this.postProcessor.add(e,this.layer,t):(e.init(this.layer,t),this.passes.push(e))}},{key:"insert",value:function(e,t,n){e.init(this.layer,t),this.passes.splice(n,0,e)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),VC=FT(zC.prototype,"postProcessor",[UC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BC=zC))||BC);function qC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ZC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qC(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function KC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var QC=Fx()(XC=function(e){Gc(n,DC);var t=KC(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"pickingFBO",void 0),lc(Xc(e),"layer",void 0),lc(Xc(e),"width",0),lc(Xc(e),"height",0),lc(Xc(e),"alreadyInRendering",!1),lc(Xc(e),"pickFromPickingFBO",(function(t){var n=t.x,r=t.y,i=t.lngLat,a=t.type;if(e.layer.isVisible()&&e.layer.needPick(a)){var o,s=e.rendererService,u=s.getViewportSize,l=s.readPixels,c=s.useFramebuffer,f=u(),p=f.width,h=f.height,d=e.layer.getLayerConfig(),v=d.enableHighlight,m=d.enableSelect,y=n*Ep,g=r*Ep;if(!(y>p||y<0||g>h||g<0))c(e.pickingFBO,(function(){var t;if(0!==(o=l({x:Math.round(y),y:Math.round(h-(r+1)*Ep),width:1,height:1,data:new Uint8Array(4),framebuffer:e.pickingFBO}))[0]||0!==o[1]||0!==o[2]){var s=_h(o),u=e.layer.getSource().getFeatureById(s),c={x:n,y:r,type:a,lngLat:i,featureId:s,feature:u};u&&(e.layer.setCurrentPickId(s),e.triggerHoverOnLayer(c))}else{var f={x:n,y:r,lngLat:i,type:null===e.layer.getCurrentPickId()?"un"+a:"mouseout",featureId:null,feature:null};e.triggerHoverOnLayer(ZC(ZC({},f),{},{type:"unpick"})),e.triggerHoverOnLayer(f),e.layer.setCurrentPickId(null)}v&&e.highlightPickedFeature(o),m&&"click"===a&&(null===(t=o)||void 0===t?void 0:t.toString())!==[0,0,0,0].toString()&&e.selectFeature(o)}))}})),e}return Uc(n,[{key:"getType",value:function(){return xC.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(e,t){LC(qc(n.prototype),"init",this).call(this,e,t),this.layer=e;var r=this.rendererService,i=r.createTexture2D,a=r.createFramebuffer,o=(0,r.getViewportSize)(),s=o.width,u=o.height;this.pickingFBO=a({color:i({width:s,height:u,wrapS:yA.CLAMP_TO_EDGE,wrapT:yA.CLAMP_TO_EDGE})}),this.interactionService.on(rA.Hover,this.pickFromPickingFBO),this.interactionService.on(rA.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(rA.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(e){var t=this;if(!this.alreadyInRendering){var n=this.rendererService,r=n.getViewportSize,i=n.useFramebuffer,a=n.clear,o=r(),s=o.width,u=o.height;this.alreadyInRendering=!0,this.width===s&&this.height===u||(this.pickingFBO.resize({width:s,height:u}),this.width=s,this.height=u),i(this.pickingFBO,(function(){a({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n=t.layer.multiPassRenderer.getRenderFlag();t.layer.multiPassRenderer.setRenderFlag(!1),e.hooks.beforePickingEncode.call(),e.render(),e.hooks.afterPickingEncode.call(),t.layer.multiPassRenderer.setRenderFlag(n),t.alreadyInRendering=!1}))}}},{key:"triggerHoverOnLayer",value:function(e){this.layer.emit(e.type,e)}},{key:"highlightPickedFeature",value:function(e){var t=Ic(e,3),n=t[0],r=t[1],i=t[2];this.layer.hooks.beforeHighlight.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(e){var t=Ic(e,3),n=t[0],r=t[1],i=t[2];this.layer.hooks.beforeSelect.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(e){var t=bh(e.featureId);this.selectFeature(new Uint8Array(t))}},{key:"highlightFeatureHandle",value:function(e){var t=bh(e.featureId);this.highlightPickedFeature(new Uint8Array(t))}}]),n}())||XC;var JC=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=e[r+t];return a};var $C=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:JC(e,t,n)},ek=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var tk=function(e){return ek.test(e)};var nk=function(e){return e.split("")},rk="[\\ud800-\\udfff]",ik="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ak="\\ud83c[\\udffb-\\udfff]",ok="[^\\ud800-\\udfff]",sk="(?:\\ud83c[\\udde6-\\uddff]){2}",uk="[\\ud800-\\udbff][\\udc00-\\udfff]",lk="(?:"+ik+"|"+ak+")"+"?",ck="[\\ufe0e\\ufe0f]?"+lk+("(?:\\u200d(?:"+[ok,sk,uk].join("|")+")[\\ufe0e\\ufe0f]?"+lk+")*"),fk="(?:"+[ok+ik+"?",ik,sk,uk,rk].join("|")+")",pk=RegExp(ak+"(?="+ak+")|"+fk+ck,"g");var hk=nk,dk=tk,vk=function(e){return e.match(pk)||[]};var mk=function(e){return dk(e)?vk(e):hk(e)};var yk=ld,gk=nm;var _k=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},bk=fm,Ek=function(e){return"symbol"==typeof e||gk(e)&&"[object Symbol]"==yk(e)},xk=Jh?Jh.prototype:void 0,Sk=xk?xk.toString:void 0;var Tk=function e(t){if("string"==typeof t)return t;if(bk(t))return _k(t,e)+"";if(Ek(t))return Sk?Sk.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var Ak=function(e){return null==e?"":Tk(e)},wk=$C,Ck=tk,kk=mk,Ok=Ak;var Mk=function(e){return function(t){t=Ok(t);var n=Ck(t)?kk(t):void 0,r=n?n[0]:t.charAt(0),i=n?wk(n,1).join(""):t.slice(1);return r[e]()+i}}("toUpperCase"),Rk=Ak,Pk=Mk;var Ik=function(e){return Pk(Rk(e).toLowerCase())};var Lk=function(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n};var Nk=function(e){return function(t){return null==e?void 0:e[t]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Dk=Ak,Fk=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jk=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var Uk=function(e){return(e=Dk(e))&&e.replace(Fk,Nk).replace(jk,"")},Bk=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var zk=function(e){return e.match(Bk)||[]},Vk=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Hk=function(e){return Vk.test(e)},Gk="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Wk="["+Gk+"]",Xk="\\d+",Yk="[\\u2700-\\u27bf]",qk="[a-z\\xdf-\\xf6\\xf8-\\xff]",Zk="[^\\ud800-\\udfff"+Gk+Xk+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Kk="(?:\\ud83c[\\udde6-\\uddff]){2}",Qk="[\\ud800-\\udbff][\\udc00-\\udfff]",Jk="[A-Z\\xc0-\\xd6\\xd8-\\xde]",$k="(?:"+qk+"|"+Zk+")",eO="(?:"+Jk+"|"+Zk+")",tO="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",nO="[\\ufe0e\\ufe0f]?"+tO+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Kk,Qk].join("|")+")[\\ufe0e\\ufe0f]?"+tO+")*"),rO="(?:"+[Yk,Kk,Qk].join("|")+")"+nO,iO=RegExp([Jk+"?"+qk+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[Wk,Jk,"$"].join("|")+")",eO+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[Wk,Jk+$k,"$"].join("|")+")",Jk+"?"+$k+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Jk+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xk,rO].join("|"),"g");var aO=zk,oO=Hk,sO=Ak,uO=function(e){return e.match(iO)||[]};var lO=Lk,cO=Uk,fO=function(e,t,n){return e=sO(e),void 0===(t=n?void 0:t)?oO(e)?uO(e):aO(e):e.match(t)||[]},pO=RegExp("['’]","g");var hO,dO,vO,mO,yO,gO=Ik,_O=function(e){return function(t){return lO(fO(cO(t).replace(pO,"")),e,"")}}((function(e,t,n){return t=t.toLowerCase(),e+(n?gO(t):t)}));function bO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function EO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bO(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xO,SO=(hO=Fx(),dO=nx(Bx.IShaderModuleService),hO((mO=function(){function e(){Fc(this,e),DT(this,"shaderModuleService",yO,this),lc(this,"rendererService",void 0),lc(this,"config",void 0),lc(this,"quad","attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}"),lc(this,"enabled",!0),lc(this,"renderToScreen",!1),lc(this,"model",void 0),lc(this,"name",void 0),lc(this,"optionsToUpdate",{})}return Uc(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getType",value:function(){return xC.PostProcessing}},{key:"init",value:function(e,t){this.config=t,this.rendererService=e.getContainer().get(Bx.IRendererService);var n=this.rendererService,r=n.createAttribute,i=n.createBuffer,a=n.createModel,o=this.setupShaders(),s=o.vs,u=o.fs,l=o.uniforms;this.model=a({vs:s,fs:u,attributes:{a_Position:r({buffer:i({data:[-4,-4,4,-4,0,4],type:yA.FLOAT}),size:2})},uniforms:EO(EO({u_Texture:null},l),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(e){var t=this,n=e.multiPassRenderer.getPostProcessor(),r=this.rendererService,i=r.useFramebuffer,a=r.getViewportSize,o=r.clear,s=a(),u=s.width,l=s.height;i(this.renderToScreen?null:n.getWriteFBO(),(function(){o({framebuffer:n.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:EO({u_Texture:n.getReadFBO(),u_ViewportSize:[u,l]},t.convertOptionsToUniforms(t.optionsToUpdate))})}))}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(e){this.enabled=e}},{key:"setRenderToScreen",value:function(e){this.renderToScreen=e}},{key:"updateOptions",value:function(e){this.optionsToUpdate=EO(EO({},this.optionsToUpdate),e)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(e){var t={};return Object.keys(e).forEach((function(n){ew(e[n])||(t["u_".concat(Mk(_O(n)))]=e[n])})),t}}]),e}(),yO=FT(mO.prototype,"shaderModuleService",[dO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vO=mO))||vO);function TO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function AO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TO(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var CO,kO=Fx()(xO=function(e){Gc(n,SO);var t=wO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var e=this.shaderModuleService.getModule("blur-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),a=i.width,o=i.height;return{vs:t,fs:n,uniforms:AO(AO({},r),{},{u_ViewportSize:[a,o]})}}},{key:"convertOptionsToUniforms",value:function(e){var t={};return ew(e.blurRadius)||(t.u_BlurDir=[e.blurRadius,0]),t}}]),n}())||xO;function OO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?OO(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function RO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var PO,IO=Fx()(CO=function(e){Gc(n,SO);var t=RO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var e=this.shaderModuleService.getModule("blur-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),a=i.width,o=i.height;return{vs:t,fs:n,uniforms:MO(MO({},r),{},{u_ViewportSize:[a,o]})}}},{key:"convertOptionsToUniforms",value:function(e){var t={};return ew(e.blurRadius)||(t.u_BlurDir=[0,e.blurRadius]),t}}]),n}())||CO;function LO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function NO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?LO(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function DO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var FO,jO=Fx()(PO=function(e){Gc(n,SO);var t=DO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});var e=this.shaderModuleService.getModule("colorhalftone-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),a=i.width,o=i.height;return{vs:t,fs:n,uniforms:NO(NO({},r),{},{u_ViewportSize:[a,o]})}}}]),n}())||PO;function UO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var BO,zO=Fx()(FO=function(e){Gc(n,SO);var t=UO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}]),n}())||FO;function VO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VO(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function GO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var WO,XO=Fx()(BO=function(e){Gc(n,SO);var t=GO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var e=this.shaderModuleService.getModule("hexagonalpixelate-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),a=i.width,o=i.height;return{vs:t,fs:n,uniforms:HO(HO({},r),{},{u_ViewportSize:[a,o]})}}}]),n}())||BO;function YO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YO(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ZO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var KO,QO=Fx()(WO=function(e){Gc(n,SO);var t=ZO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var e=this.shaderModuleService.getModule("ink-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),a=i.width,o=i.height;return{vs:t,fs:n,uniforms:qO(qO({},r),{},{u_ViewportSize:[a,o]})}}}]),n}())||WO;function JO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var $O,eM=Fx()(KO=function(e){Gc(n,SO);var t=JO(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}]),n}())||KO;function tM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var nM,rM,iM,aM,oM,sM,uM,lM=Fx()($O=function(e){Gc(n,SO);var t=tM(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}]),n}())||$O,cM=(nM=Fx(),rM=nx(Bx.IRendererService),iM=function(e,t,n){var r=new KE("post_construct",t);if(Reflect.hasOwnMetadata("post_construct",e.constructor))throw new Error("Cannot apply @postConstruct decorator multiple times in the same class");Reflect.defineMetadata("post_construct",r,e.constructor)},nM((oM=function(){function e(){Fc(this,e),DT(this,"rendererService",sM,this),lc(this,"passes",[]),lc(this,"readFBO",void 0),lc(this,"writeFBO",void 0)}var t;return Uc(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:(t=vA(MA.mark((function e(t){var n,r;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.passes.length)){e.next=10;break}return(r=this.passes[n]).setRenderToScreen(this.isLastEnabledPass(n)),e.next=6,r.render(t);case 6:n!==this.passes.length-1&&this.swap();case 7:n++,e.next=1;break;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"resize",value:function(e,t){this.readFBO.resize({width:e,height:t}),this.writeFBO.resize({width:e,height:t})}},{key:"add",value:function(e,t,n){e.init(t,n),this.passes.push(e)}},{key:"insert",value:function(e,t,n,r){e.init(n,r),this.passes.splice(t,0,e)}},{key:"getPostProcessingPassByName",value:function(e){return this.passes.find((function(t){return t.getName()===e}))}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].isEnabled())return!1;return!0}},{key:"swap",value:function(){var e=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=e}}]),e}(),sM=FT(oM.prototype,"rendererService",[rM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FT(oM.prototype,"init",[iM],Object.getOwnPropertyDescriptor(oM.prototype,"init"),oM.prototype),aM=oM))||aM);function fM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var pM,hM,dM,vM,mM,yM=Fx()(uM=function(e){Gc(n,DC);var t=fM(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getType",value:function(){return xC.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(e,t){LC(qc(n.prototype),"init",this).call(this,e,t)}},{key:"render",value:function(e){var t=this.rendererService,n=t.useFramebuffer,r=t.clear;n(null,(function(){r({color:[0,0,0,0],depth:1,stencil:0}),e.multiPassRenderer.setRenderFlag(!1),e.render(),e.multiPassRenderer.setRenderFlag(!0)}))}}]),n}())||uM;function gM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gM(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var EM="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}";function xM(e,t){for(var n=0,r=1/t,i=e;i>0;)n+=r*(i%t),i=Math.floor(i/t),r/=t;return n}var SM,TM,AM,wM=1,CM=(pM=Fx(),hM=nx(Bx.IShaderModuleService),pM((vM=function(e){Gc(n,DC);var t=bM(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return DT(Xc(e=t.call.apply(t,[this].concat(i))),"shaderModuleService",mM,Xc(e)),lc(Xc(e),"haltonSequence",[]),lc(Xc(e),"accumulatingId",0),lc(Xc(e),"frame",0),lc(Xc(e),"timer",void 0),lc(Xc(e),"sampleRenderTarget",void 0),lc(Xc(e),"prevRenderTarget",void 0),lc(Xc(e),"outputRenderTarget",void 0),lc(Xc(e),"copyRenderTarget",void 0),lc(Xc(e),"blendModel",void 0),lc(Xc(e),"outputModel",void 0),lc(Xc(e),"copyModel",void 0),e}return Uc(n,[{key:"getType",value:function(){return xC.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(e,t){LC(qc(n.prototype),"init",this).call(this,e,t);var r=this.rendererService,i=r.createFramebuffer,a=r.createTexture2D;this.sampleRenderTarget=i({color:a({width:1,height:1,wrapS:yA.CLAMP_TO_EDGE,wrapT:yA.CLAMP_TO_EDGE})}),this.prevRenderTarget=i({color:a({width:1,height:1,wrapS:yA.CLAMP_TO_EDGE,wrapT:yA.CLAMP_TO_EDGE})}),this.outputRenderTarget=i({color:a({width:1,height:1,wrapS:yA.CLAMP_TO_EDGE,wrapT:yA.CLAMP_TO_EDGE})}),this.copyRenderTarget=i({color:a({width:1,height:1,wrapS:yA.CLAMP_TO_EDGE,wrapT:yA.CLAMP_TO_EDGE})});for(var o=0;o<30;o++)this.haltonSequence.push([xM(o,2),xM(o,3)]);this.blendModel=this.createTriangleModel("blend-pass","uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n"),this.outputModel=this.createTriangleModel("copy-pass",EM,{blend:{enable:!0,func:{srcRGB:yA.ONE,dstRGB:yA.ONE_MINUS_SRC_ALPHA,srcAlpha:yA.ONE,dstAlpha:yA.ONE_MINUS_SRC_ALPHA},equation:{rgb:yA.FUNC_ADD,alpha:yA.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",EM)}},{key:"render",value:function(e){var t=this,n=this.rendererService,r=n.clear,i=n.getViewportSize,a=n.useFramebuffer,o=i(),s=o.width,u=o.height;this.sampleRenderTarget.resize({width:s,height:u}),this.prevRenderTarget.resize({width:s,height:u}),this.outputRenderTarget.resize({width:s,height:u}),this.copyRenderTarget.resize({width:s,height:u}),this.resetFrame(),this.stopAccumulating();var l=e.multiPassRenderer.getPostProcessor().getReadFBO();a(l,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:l}),e.multiPassRenderer.setRenderFlag(!1),e.render(),e.multiPassRenderer.setRenderFlag(!0)}));var c=function n(r){t.accumulatingId&&r===t.accumulatingId&&(t.isFinished()||(t.doRender(e),lp.requestAnimationFrame((function(){n(r)}))))};this.accumulatingId=wM++,this.timer=lp.setTimeout((function(){c(t.accumulatingId)}),50)}},{key:"doRender",value:function(e){var t=this,n=this.rendererService,r=n.clear,i=n.getViewportSize,a=n.useFramebuffer,o=i(),s=o.width,u=o.height,l=e.getLayerConfig().jitterScale,c=void 0===l?1:l,f=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*f[0]-1)/s*c,(2*f[1]-1)/u*c),e.multiPassRenderer.setRenderFlag(!1),e.hooks.beforeRender.call(),a(this.sampleRenderTarget,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:t.sampleRenderTarget}),e.render()})),e.hooks.afterRender.call(),e.multiPassRenderer.setRenderFlag(!0);var p=e.getLayerConfig();a(this.outputRenderTarget,(function(){t.blendModel.draw({uniforms:{u_opacity:p.opacity||1,u_MixRatio:0===t.frame?1:.9,u_Diffuse1:t.sampleRenderTarget,u_Diffuse2:0===t.frame?e.multiPassRenderer.getPostProcessor().getReadFBO():t.prevRenderTarget}})})),0===this.frame&&r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(a(this.copyRenderTarget,(function(){t.outputModel.draw({uniforms:{u_Texture:t.outputRenderTarget}})})),a(e.multiPassRenderer.getPostProcessor().getReadFBO(),(function(){t.copyModel.draw({uniforms:{u_Texture:t.copyRenderTarget}})})),e.multiPassRenderer.getPostProcessor().render(e));var h=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=h,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,lp.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(e,t,n){this.shaderModuleService.registerModule(e,{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:t});var r=this.shaderModuleService.getModule(e),i=r.vs,a=r.fs,o=r.uniforms,s=this.rendererService,u=s.createAttribute,l=s.createBuffer;return(0,s.createModel)(_M({vs:i,fs:a,attributes:{a_Position:u({buffer:l({data:[-4,-4,4,-4,0,4],type:yA.FLOAT}),size:2})},uniforms:_M({},o),depth:{enable:!1},count:3},n))}}]),n}(),mM=FT(vM.prototype,"shaderModuleService",[hM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dM=vM))||dM),kM=new Dx;kM.bind(Bx.IGlobalConfigService).to(NT).inSingletonScope(),kM.bind(Bx.IShaderModuleService).to(PC).inSingletonScope(),SM=Fx(),TM=Xb.exports.EventEmitter,"number"==typeof AM?$E([ex(AM,SM)],TM):"string"==typeof AM?Reflect.decorate([SM],TM,AM):$E([SM],TM),kM.bind(Bx.IEventEmitter).to(Xb.exports.EventEmitter);var OM,MM,RM,PM,IM,LM,NM,DM,FM,jM,UM=(void 0===(MM=!1)&&(MM=!0),{lazyInject:function(e,t){return function(n){return function(r,i){Ux(r,i,(function(){return e.get(n)}),t)}}}(OM=kM,MM),lazyInjectNamed:function(e,t){return function(n,r){return function(i,a){Ux(i,a,(function(){return e.getNamed(n,r)}),t)}}}(OM,MM),lazyInjectTagged:function(e,t){return function(n,r,i){return function(a,o){Ux(a,o,(function(){return e.getTagged(n,r,i)}),t)}}}(OM,MM),lazyMultiInject:function(e,t){return function(n){return function(r,i){Ux(r,i,(function(){return e.getAll(n)}),t)}}}(OM,MM)}),BM=function(e){var t=UM.lazyInject(e);return function(e,n,r){t.call(this,e,n),r&&(r.initializer=function(){return e[n]})}},zM=0;(PM=RM||(RM={})).normal="normal",PM.additive="additive",PM.subtractive="subtractive",PM.min="min",PM.max="max",PM.none="none",(LM=IM||(IM={})).LINEAR="linear",LM.POWER="power",LM.LOG="log",LM.IDENTITY="identity",LM.TIME="time",LM.QUANTILE="quantile",LM.QUANTIZE="quantize",LM.THRESHOLD="threshold",LM.CAT="cat",(DM=NM||(NM={})).CONSTANT="constant",DM.VARIABLE="variable",(jM=FM||(FM={}))[jM.Attribute=0]="Attribute",jM[jM.InstancedAttribute=1]="InstancedAttribute",jM[jM.Uniform=2]="Uniform";var VM,HM,GM=["mapload","mapchange"],WM="u_ProjectionMatrix",XM="u_ViewMatrix",YM="u_ViewProjectionMatrix",qM="u_Zoom",ZM="u_ZoomScale",KM="u_FocalDistance",QM="u_CameraPosition",JM=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];function $M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$M(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}(HM=VM||(VM={})).TOPRIGHT="topright",HM.TOPLEFT="topleft",HM.BOTTOMRIGHT="bottomright",HM.BOTTOMLEFT="bottomleft",HM.TOPCENTER="topcenter",HM.BOTTOMCENTER="bottomcenter",HM.LEFTCENTER="leftcenter",HM.RIGHTCENTER="rightcenter";var nR=0,rR=function(e){Gc(n,Xb.exports.EventEmitter);var t=tR(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this)),"controlOption",void 0),lc(Xc(r),"container",void 0),lc(Xc(r),"sceneContainer",void 0),lc(Xc(r),"mapsService",void 0),lc(Xc(r),"renderService",void 0),lc(Xc(r),"layerService",void 0),lc(Xc(r),"controlService",void 0),lc(Xc(r),"isShow",void 0),r.controlOption=eR(eR({},r.getDefault()),e||{}),r}return Uc(n,[{key:"getDefault",value:function(){return{position:VM.TOPRIGHT,name:"".concat(nR++)}}},{key:"setPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VM.BOTTOMRIGHT,t=this.controlService;return t&&t.removeControl(this),this.controlOption.position=e,t&&t.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(e){this.mapsService=e.get(Bx.IMapService),this.renderService=e.get(Bx.IRendererService),this.layerService=e.get(Bx.ILayerService),this.controlService=e.get(Bx.IControlService),this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd();var t=this.container,n=this.controlOption.position,r=this.controlService.controlCorners[n];return dp(t,"l7-control"),-1!==n.indexOf("bottom")?r.insertBefore(t,r.firstChild):r.appendChild(t),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){dp(this.container,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){vp(this.container,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;hp(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(e){if(this.mapsService&&e&&e.screenX>0&&e.screenY>0){var t=this.mapsService.getContainer();null!==t&&t.focus()}}}]),n}();function iR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function aR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}!function(e){Gc(n,rR);var t=iR(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this,e)),"layerControlInputs",void 0),lc(Xc(r),"layers",void 0),lc(Xc(r),"lastZIndex",void 0),lc(Xc(r),"handlingClick",void 0),lc(Xc(r),"layersLink",void 0),lc(Xc(r),"baseLayersList",void 0),lc(Xc(r),"separator",void 0),lc(Xc(r),"overlaysList",void 0),lc(Xc(r),"form",void 0),r.layerControlInputs=[],r.layers=[],r.lastZIndex=0,r.handlingClick=!1,r.initLayers(),Up(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Xc(r)),r}Uc(n,[{key:"getDefault",value:function(){return{collapsed:!0,position:VM.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var e=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach((function(t){t.layer.on("remove",e.onLayerChange),t.layer.on("add",e.onLayerChange)})),this.container}},{key:"addVisualLayer",value:function(e,t){return this.addLayer(e,t,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var e=this.renderService.getViewportSize().height;dp(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var t=e-(this.container.offsetTop+50);return t<this.form.clientHeight?(dp(this.form,"l7-control-layers-scrollbar"),this.form.style.height=t+"px"):vp(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return vp(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var e=this;this.mapsService&&(this.mapsService.off("click",this.collapse),this.layers.forEach((function(t){t.layer.off("remove",e.onLayerChange),t.layer.off("add",e.onLayerChange)})))}},{key:"initLayout",value:function(){var e="l7-control-layers",t=this.container=pp("div",e),n=this.controlOption.collapsed;t.setAttribute("aria-haspopup","true");var r=this.form=pp("form",e+"-list");n&&(this.mapsService.on("click",this.collapse),t.addEventListener("mouseenter",this.expand),t.addEventListener("mouseleave",this.collapse)),this.layersLink=pp("a",e+"-toggle",t),this.layersLink.title="Layers",n||this.expand(),this.baseLayersList=pp("div",e+"-base",r),this.separator=pp("div",e+"-separator",r),this.overlaysList=pp("div",e+"-overlays",r),t.appendChild(r)}},{key:"initLayers",value:function(){var e=this,t=this.controlOption,n=t.baseLayers,r=void 0===n?{}:n,i=t.overlayers,a=void 0===i?{}:i;Object.keys(r).forEach((function(t,n){e.addLayer(r[t],t,!1)})),Object.keys(a).forEach((function(t,n){e.addLayer(a[t],t,!0)}))}},{key:"update",value:function(){if(!this.container)return this;var e,t,n,r;gp(this.baseLayersList),gp(this.overlaysList),this.layerControlInputs=[];var i=0;for(n=0;n<this.layers.length;n++)r=this.layers[n],this.addItem(r),t=t||r.overlay,e=e||!r.overlay,i+=r.overlay?0:1;return this.controlOption.hideSingleBase&&(e=e&&i>1,this.baseLayersList.style.display=e?"":"none"),this.separator.style.display=t&&e?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var e,t,n=this.layerControlInputs,r=this.mapsService.getZoom(),i=n.length-1;i>=0;i--)if(e=n[i],(t=this.layerService.getLayer(e.layerId))&&t.inited){var a=t.getMinZoom(),o=t.getMaxZoom();e.disabled=r<a||r>o}}},{key:"addLayer",value:function(e,t,n){this.mapsService&&(e.on("add",this.onLayerChange),e.on("remove",this.onLayerChange)),this.layers.push({layer:e,name:t,overlay:n});var r=this.controlOption,i=r.sortLayers,a=r.sortFunction,o=r.autoZIndex;i&&this.layers.sort((function(e,t){return a(e.layer,t.layer,e.name,t.name)})),o&&e.setZIndex&&(this.lastZIndex++,e.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(e){this.handlingClick||this.update();var t=this.layerService.getLayer(e.target.layerId),n=null!=t&&t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this.emit(n,t)}},{key:"createRadioElement",value:function(e,t){var n='<input type="radio" class="l7-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild}},{key:"addItem",value:function(e){var t,n=document.createElement("label"),r=this.layerService.getLayer(e.layer.id),i=r&&r.inited&&e.layer.isVisible();e.overlay?((t=document.createElement("input")).type="checkbox",t.className="l7-control-layers-selector",t.defaultChecked=i):t=this.createRadioElement("l7-base-layers",i),this.layerControlInputs.push(t),t.layerId=e.layer.id,t.addEventListener("click",this.onInputClick);var a=document.createElement("span");a.innerHTML=" "+e.name;var o=document.createElement("div");return n.appendChild(o),o.appendChild(t),o.appendChild(a),(e.overlay?this.overlaysList:this.baseLayersList).appendChild(n),this.checkDisabledLayers(),n}},{key:"onInputClick",value:function(){var e,t,n=this.layerControlInputs,r=[],i=[];this.handlingClick=!0;for(var a=n.length-1;a>=0;a--)e=n[a],t=this.layerService.getLayer(e.layerId),e.checked?r.push(t):e.checked||i.push(t);i.forEach((function(e){e.hide()})),r.forEach((function(e){e.show()})),this.handlingClick=!1}}])}();var oR=function(e){Gc(n,rR);var t=aR(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getDefault",value:function(){return{position:VM.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var e=pp("div","l7-control-logo"),t=pp("a","l7-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://antv.alipay.com/l7",t.setAttribute("aria-label","AntV logo"),t.setAttribute("rel","noopener nofollow"),e.appendChild(t),e}},{key:"onRemove",value:function(){return null}}]),n}();function sR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function uR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function lR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lR(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}!function(e){Gc(n,rR);var t=sR(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this,e)),"mScale",void 0),lc(Xc(r),"iScale",void 0),Up(["update"],Xc(r)),r}Uc(n,[{key:"getDefault",value:function(){return{position:VM.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var e="l7-control-scale",t=pp("div",e);this.addScales(e+"-line",t);var n=this.controlOption.updateWhenIdle;return this.mapsService.on(n?"moveend":"mapmove",this.update),this.mapsService.on(n?"zoomend":"zoomchange",this.update),this.update(),t}},{key:"onRemove",value:function(){var e=this.controlOption.updateWhenIdle;this.mapsService.off(e?"zoomend":"zoomchange",this.update),this.mapsService.off(e?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var e=this.mapsService,t=this.controlOption.maxWidth,n=e.getSize()[1]/2,r=e.containerToLngLat([0,n]),i=e.containerToLngLat([t,n]),a=Np([r.lng,r.lat],[i.lng,i.lat]);this.updateScales(a)}},{key:"updateScales",value:function(e){var t=this.controlOption,n=t.metric,r=t.imperial;n&&e&&this.updateMetric(e),r&&e&&this.updateImperial(e)}},{key:"updateMetric",value:function(e){var t=this.getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this.updateScale(this.mScale,n,t/e)}},{key:"updateImperial",value:function(e){var t,n,r,i=3.2808399*e;i>5280?(t=i/5280,n=this.getRoundNum(t),this.updateScale(this.iScale,n+" mi",n/t)):(r=this.getRoundNum(i),this.updateScale(this.iScale,r+" ft",r/i))}},{key:"updateScale",value:function(e,t,n){var r=this.controlOption.maxWidth;e.style.width=Math.round(r*n)+"px",e.innerHTML=t}},{key:"getRoundNum",value:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}},{key:"addScales",value:function(e,t){var n=this.controlOption,r=n.metric,i=n.imperial;r&&(this.mScale=pp("div",e,t)),i&&(this.iScale=pp("div",e,t))}}])}(),function(e){Gc(n,rR);var t=uR(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this,e)),"disabled",void 0),lc(Xc(r),"zoomInButton",void 0),lc(Xc(r),"zoomOutButton",void 0),Up(["updateDisabled","zoomIn","zoomOut"],Xc(r)),r}Uc(n,[{key:"getDefault",value:function(){return{position:VM.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var e="l7-control-zoom",t=pp("div",e+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,e+"-in",t,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,e+"-out",t,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),t}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(e,t,n,r,i){var a=pp("a",n,r);return a.innerHTML=e,a.title=t,a.href="javascript:void(0)",a.addEventListener("click",i),a}},{key:"updateDisabled",value:function(){var e=this.mapsService,t="l7-disabled";vp(this.zoomInButton,t),vp(this.zoomOutButton,t),(this.disabled||e.getZoom()<=e.getMinZoom())&&dp(this.zoomOutButton,t),(this.disabled||e.getZoom()>=e.getMaxZoom())&&dp(this.zoomInButton,t)}}])}();var pR=function(e){Gc(n,Xb.exports.EventEmitter);var t=fR(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this)),"markerOption",void 0),lc(Xc(r),"defaultMarker",void 0),lc(Xc(r),"popup",void 0),lc(Xc(r),"mapsService",void 0),lc(Xc(r),"sceneSerive",void 0),lc(Xc(r),"lngLat",void 0),lc(Xc(r),"scene",void 0),lc(Xc(r),"added",!1),lc(Xc(r),"eventHandle",(function(e){r.emit(e.type,{target:e,data:r.markerOption.extData,lngLat:r.lngLat})})),r.markerOption=cR(cR({},r.getDefault()),e),Up(["update","onMove","onUp","addDragHandler","onMapClick"],Xc(r)),r.init(),r}return Uc(n,[{key:"getDefault",value:function(){return{element:void 0,anchor:Hp.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(e){this.scene=e,this.mapsService=e.get(Bx.IMapService),this.sceneSerive=e.get(Bx.ISceneService);var t=this.markerOption,n=t.element;return t.draggable,this.mapsService.getMarkerContainer().appendChild(n),this.registerMarkerEvent(n),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var e=this.markerOption.element;return e&&hp(e),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(e){var t=this;if(!this.added)return this.once("added",(function(){t.setElement(e)})),this;var n=this.markerOption.element;return n&&hp(n),this.markerOption.element=e,this.init(),this.mapsService.getMarkerContainer().appendChild(e),this.registerMarkerEvent(e),this.update(),this}},{key:"openPopup",value:function(){var e=this;if(!this.added)return this.once("added",(function(){e.openPopup()})),this;var t=this.popup;return t?(t.isOpen()||t.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var e=this;this.added||this.once("added",(function(){e.closePopup()}));var t=this.popup;return t&&t.remove(),this}},{key:"setPopup",value:function(e){return this.popup=e,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var e=this.popup;return e?(e.isOpen()?e.remove():e.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(e){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(e){this.markerOption.extData=e}},{key:"update",value:function(){if(this.mapsService){var e=this.markerOption,t=e.element,n=e.anchor;this.updatePosition(),bp(t,"".concat(Eh[n]))}}},{key:"onMapClick",value:function(e){var t=this.markerOption.element;this.popup&&t&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var e=this.markerOption,t=e.element,n=e.offsets,r=this.lngLat,i=r.lng,a=r.lat,o=this.mapsService.getBounds(),s=this.mapsService.lngLatToContainer([i,a]);if(t){t.style.display="block";var u=this.mapsService.getContainer(),l=0,c=0;if(u&&(l=u.scrollWidth,c=u.scrollHeight),Math.abs(o[0][0])>180||Math.abs(o[1][0])>180){if(s.x>l){var f=this.mapsService.lngLatToContainer([i-360,a]);s.x=f.x}if(s.x<0){var p=this.mapsService.lngLatToContainer([i+360,a]);s.x=p.x}}(s.x>l||s.x<0||s.y>c||s.y<0)&&(t.style.display="none"),t.style.left=s.x+n[0]+"px",t.style.top=s.y-n[1]+"px"}}}},{key:"init",value:function(){var e=this,t=this.markerOption.element,n=this.markerOption,r=n.color,i=n.anchor;if(!t){this.defaultMarker=!0,t=pp("div"),this.markerOption.element=t;var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height","48px"),a.setAttributeNS(null,"width","48px"),a.setAttributeNS(null,"viewBox","0 0 1024 1024");var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),o.setAttributeNS(null,"fill",r),a.appendChild(o),t.appendChild(a)}dp(t,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach((function(n){var r,i,a=(null===(r=e.markerOption)||void 0===r?void 0:r.style)&&(null===(i=e.markerOption)||void 0===i?void 0:i.style[n]);t&&(t.style[n]=a)})),t.addEventListener("click",(function(t){e.onMapClick(t)})),t.addEventListener("click",this.eventHandle),xh(t,i,"marker")}},{key:"registerMarkerEvent",value:function(e){e.addEventListener("mousemove",this.eventHandle),e.addEventListener("click",this.eventHandle),e.addEventListener("mousedown",this.eventHandle),e.addEventListener("mouseup",this.eventHandle),e.addEventListener("dblclick",this.eventHandle),e.addEventListener("contextmenu",this.eventHandle),e.addEventListener("mouseover",this.eventHandle),e.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var e=this.getElement();e.removeEventListener("mousemove",this.eventHandle),e.removeEventListener("click",this.eventHandle),e.removeEventListener("mousedown",this.eventHandle),e.removeEventListener("mouseup",this.eventHandle),e.removeEventListener("dblclick",this.eventHandle),e.removeEventListener("contextmenu",this.eventHandle),e.removeEventListener("mouseover",this.eventHandle),e.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(e){throw new Error("Method not implemented.")}},{key:"onUp",value:function(e){throw new Error("Method not implemented.")}}]),n}();function hR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hR(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function mR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mR(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}!function(e){Gc(n,Xb.exports.EventEmitter);var t=vR(n);function n(e){var r,i;return Fc(this,n),lc(Xc(i=t.call(this)),"markers",[]),lc(Xc(i),"markerLayerOption",void 0),lc(Xc(i),"clusterIndex",void 0),lc(Xc(i),"points",[]),lc(Xc(i),"clusterMarkers",[]),lc(Xc(i),"mapsService",void 0),lc(Xc(i),"scene",void 0),lc(Xc(i),"zoom",void 0),lc(Xc(i),"bbox",void 0),i.markerLayerOption=OT(i.getDefault(),e),Up(["update"],Xc(i)),i.zoom=(null===(r=i.markerLayerOption.clusterOption)||void 0===r?void 0:r.zoom)||-99,i}Uc(n,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(e){return this.scene=e,this.mapsService=e.get(Bx.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(e){this.markerLayerOption.cluster&&this.addPoint(e,this.markers.length),this.markers.push(e)}},{key:"removeMarker",value:function(e){this.markers.indexOf(e);var t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}},{key:"hide",value:function(){this.markers.map((function(e){e.getElement().style.opacity="0"}))}},{key:"show",value:function(){this.markers.map((function(e){e.getElement().style.opacity="1"}))}},{key:"getMarkers",value:function(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var e=this;this.getMarkers().forEach((function(t){t.addTo(e.scene)}))}},{key:"clear",value:function(){this.markers.forEach((function(e){e.remove()})),this.clusterMarkers.forEach((function(e){e.remove()})),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(e,t){var n=e.getLnglat(),r={geometry:{type:"Point",coordinates:[n.lng,n.lat]},properties:dR(dR({},e.getExtData()),{},{marker_id:t})};this.points.push(r)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var e=this.markerLayerOption.clusterOption,t=e.radius,n=e.minZoom,r=void 0===n?0:n,i=e.maxZoom;this.clusterIndex=new Zb({radius:t,minZoom:r,maxZoom:i}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(e,t){var n=this,r=e[0].concat(e[1]),i=this.clusterIndex.getClusters(r,t);this.clusterMarkers.forEach((function(e){e.remove()})),this.clusterMarkers=[],i.forEach((function(e){var t,r=n.markerLayerOption.clusterOption,i=r.field,a=r.method;if(e.properties&&null!==(t=e.properties)&&void 0!==t&&t.cluster_id){var o,s=n.getLeaves(null===(o=e.properties)||void 0===o?void 0:o.cluster_id);if(e.properties.clusterData=s,i&&a){var u=function(e,t){return Th[e](t)}(a,Ah(null==s?void 0:s.map((function(e){return lc({},i,e.properties[i])})),i)),l="point_"+a;e.properties[l]=u.toFixed(2)}}var c=n.clusterMarker(e);n.clusterMarkers.push(c),c.addTo(n.scene)}))}},{key:"getLeaves",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e?this.clusterIndex.getLeaves(e,t,n):null}},{key:"clusterMarker",value:function(e){var t=this.markerLayerOption.clusterOption.element,n=void 0===t?this.generateElement.bind(this):t;return new pR({element:n(e)}).setLnglat({lng:e.geometry.coordinates[0],lat:e.geometry.coordinates[1]})}},{key:"normalMarker",value:function(e){var t=e.properties.marker_id;return this.markers[t]}},{key:"update",value:function(){var e=this.mapsService.getZoom(),t=this.mapsService.getBounds();(!this.bbox||Math.abs(e-this.zoom)>=1||!Fp(this.bbox,t))&&(this.bbox=Dp(t,.5),this.zoom=Math.floor(e),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(e){var t=pp("div","l7-marker-cluster"),n=pp("div","",t),r=pp("span","",n),i=this.markerLayerOption.clusterOption,a=i.field,o=i.method;e.properties.point_count=e.properties.point_count||1;var s=a&&o?e.properties["point_"+o]||e.properties[a]:e.properties.point_count;return r.textContent=s,t}}])}();var _R=function(e){Gc(n,Xb.exports.EventEmitter);var t=gR(n);function n(e){var r;return Fc(this,n),lc(Xc(r=t.call(this)),"popupOption",void 0),lc(Xc(r),"mapsService",void 0),lc(Xc(r),"sceneSerive",void 0),lc(Xc(r),"lngLat",void 0),lc(Xc(r),"content",void 0),lc(Xc(r),"closeButton",void 0),lc(Xc(r),"timeoutInstance",void 0),lc(Xc(r),"container",void 0),lc(Xc(r),"tip",void 0),lc(Xc(r),"scene",void 0),r.popupOption=yR(yR({},r.getdefault()),e),Up(["update","onClickClose","remove"],Xc(r)),r}return Uc(n,[{key:"addTo",value:function(e){var t=this;return this.mapsService=e.get(Bx.IMapService),this.sceneSerive=e.get(Bx.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=e,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout((function(){t.mapsService.on("click",t.onClickClose)}),30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(e){var t,n=window.document.createDocumentFragment(),r=window.document.createElement("body");for(r.innerHTML=e;t=r.firstChild;)n.appendChild(t);return this.setDOMContent(n)}},{key:"setLnglat",value:function(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(e){return this.setDOMContent(window.document.createTextNode(e))}},{key:"setMaxWidth",value:function(e){return this.popupOption.maxWidth=e,this.update(),this}},{key:"setDOMContent",value:function(e){return this.createContent(),this.content.appendChild(e),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&hp(this.content),this.content=pp("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=pp("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(e,t,n){var r=window.document.createElement(e);return void 0!==t&&(r.className=t),n&&n.appendChild(r),r}},{key:"removeDom",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Hp.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(e){e.stopPropagation&&e.stopPropagation(),this.remove()}},{key:"update",value:function(){var e=this,t=this.lngLat,n=this.popupOption,r=n.className,i=n.maxWidth,a=n.anchor;if(this.mapsService&&t&&this.content){var o=this.mapsService.getMarkerContainer();if(!this.container&&o)this.container=this.creatDom("div","l7-popup",o),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),r&&r.split(" ").forEach((function(t){return e.container.classList.add(t)})),this.popupOption.stopPropagation&&["mousemove","mousedown","mouseup","click","dblclick"].forEach((function(t){e.container.addEventListener(t,(function(e){e.stopPropagation()}))}));i&&this.container.style.maxWidth!==i&&(this.container.style.maxWidth=i),this.updatePosition(),bp(this.container,"".concat(Eh[a])),xh(this.container,a,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var e=this.lngLat,t=e.lng,n=e.lat,r=this.popupOption.offsets,i=this.mapsService.lngLatToContainer([t,n]);this.container.style.left=i.x+r[0]+"px",this.container.style.top=i.y-r[1]+"px"}}}]),n}();!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o)}}(".l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n}\n\n.l7-marker {\n  position: absolute !important;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 5px;\n}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-popup-anchor-left {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-top: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-top: none;\n  border-left: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-top: none;\n  border-right: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-bottom: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-bottom: none;\n  border-left: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-bottom: none;\n  border-right: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-left: none;\n  border-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-right: none;\n  border-left-color: #fff;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  padding: 0;\n  font-size: 25px;\n  line-height: 20px;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n  border-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n  border-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n  border-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n  border-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-track-pointer * {\n  pointer-events: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n  border-radius: 4px;\n}\n.l7-bar a,\n.l7-bar a:hover {\n  background-color: #fff;\n  width: 30px;\n  height: 30px;\n  font-size: 20px;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: #8e9dab;\n}\n.l7-bar a,\n.l7-control-layers-toggle {\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n  display: block;\n}\n.l7-bar a:hover {\n  background-color: #f4f4f4;\n}\n.l7-bar a:first-child {\n  border-top-left-radius: 2px;\n  border-top-right-radius: 2px;\n}\n.l7-bar a:last-child {\n  border-bottom-left-radius: 2px;\n  border-bottom-right-radius: 2px;\n  border-bottom: none;\n}\n.l7-bar a.l7-disabled {\n  cursor: default;\n  background-color: #f4f4f4;\n  color: #bbb;\n}\n\n/* control positioning */\n\n.l7-control-container {\n  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n  display: none;\n}\n.l7-control {\n  position: relative;\n  z-index: 800;\n  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\n  pointer-events: auto;\n}\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-top,\n.l7-bottom {\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-top {\n  top: 0;\n}\n.l7-right {\n  right: 0;\n}\n.l7-bottom {\n  bottom: 0;\n}\n.l7-left {\n  left: 0;\n}\n.l7-center {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.l7-bottom.l7-center,\n.l7-top.l7-center {\n  width: 100%;\n}\n.l7-right.l7-center,\n.l7-left.l7-center {\n  height: 100%;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-top.l7-center,\n.l7-left.l7-center {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n\n.l7-bottom.l7-center,\n.l7-right.l7-center {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n\n.l7-center .l7-control {\n  margin-right: 10px;\n  margin-bottom: 10px;\n}\n\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-right .l7-control {\n  float: right;\n}\n.l7-top .l7-control {\n  margin-top: 10px;\n}\n.l7-bottom .l7-control {\n  margin-bottom: 10px;\n}\n.l7-left .l7-control {\n  margin-left: 10px;\n}\n.l7-right .l7-control {\n  margin-right: 10px;\n}\n\n/* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n  background: #fff;\n  background: rgba(255, 255, 255, 0.7);\n  margin: 0;\n}\n.l7-control-attribution,\n.l7-control-scale-line {\n  padding: 0 5px;\n  color: #333;\n}\n.l7-control-attribution a {\n  text-decoration: none;\n}\n.l7-control-attribution a:hover {\n  text-decoration: underline;\n}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n}\n.l7-left .l7-control-scale {\n  margin-left: 5px;\n}\n.l7-bottom .l7-control-scale {\n  margin-bottom: 5px;\n}\n.l7-control-scale-line {\n  border: 2px solid #000;\n  border-top: none;\n  color: #000;\n  line-height: 1.1;\n  padding: 2px 5px 1px;\n  font-size: 11px;\n  white-space: nowrap;\n  overflow: hidden;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n\n  background: #fff;\n}\n.l7-control-scale-line:not(:first-child) {\n  border-top: 2px solid #777;\n  border-bottom: none;\n  margin-top: -2px;\n}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n  border-bottom: 2px solid #777;\n}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  -webkit-box-shadow: none;\n          box-shadow: none;\n}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  border: 2px solid rgba(0, 0, 0, 0.2);\n  background-clip: padding-box;\n}\n/*logo */\n\n.l7-ctrl-logo {\n  background-size: 100% 100%;\n  width: 89px;\n  height: 16px;\n  margin: 0 0 -3px -3px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  background-repeat: no-repeat;\n  cursor: pointer;\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 2px;\n}\n.l7-control-layers-toggle {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');\n  width: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n}\n\n.l7-touch .l7-control-layers-toggle {\n  width: 44px;\n  height: 44px;\n}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n  display: none;\n}\n.l7-control-layers-expanded .l7-control-layers-list {\n  display: block;\n  position: relative;\n}\n.l7-control-layers-expanded {\n  padding: 6px 10px 6px 6px;\n  color: #59626b;\n  background: #fff;\n}\n.l7-control-layers-scrollbar {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding-right: 5px;\n}\n.l7-control-layers-selector {\n  margin-top: 2px;\n  position: relative;\n  top: 1px;\n}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n}\n.l7-control-layers label input[type='radio'],\n.l7-control-layers label input[type='checkbox'] {\n  width: 14px;\n  height: 14px;\n  margin: 0;\n}\n.l7-control-layers-separator {\n  height: 0;\n  border-top: 1px solid #d8d8d8;\n  margin: 5px -10px 5px -6px;\n}\n.mapboxgl-ctrl-logo {\n  display: none !important;\n}\n.amap-logo {\n  display: none !important;\n}\n");var bR={exports:{}},ER={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},xR="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",SR={5:xR,"5module":xR+" export import",6:xR+" const class extends export import super"},TR=/^in(stanceof)?$/,AR="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࣇऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-鿼ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞿꟂ-ꟊꟵ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",wR="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿᫀᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷹᷻-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿",CR=new RegExp("["+AR+"]"),kR=new RegExp("["+AR+wR+"]");AR=wR=null;var OR=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],MR=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function RR(e,t){for(var n=65536,r=0;r<t.length;r+=2){if((n+=t[r])>e)return!1;if((n+=t[r+1])>=e)return!0}}function PR(e,t){return e<65?36===e:e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&CR.test(String.fromCharCode(e)):!1!==t&&RR(e,OR)))}function IR(e,t){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&kR.test(String.fromCharCode(e)):!1!==t&&(RR(e,OR)||RR(e,MR)))))}var LR=function(e,t){void 0===t&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function NR(e,t){return new LR(e,{beforeExpr:!0,binop:t})}var DR={beforeExpr:!0},FR={startsExpr:!0},jR={};function UR(e,t){return void 0===t&&(t={}),t.keyword=e,jR[e]=new LR(e,t)}var BR={num:new LR("num",FR),regexp:new LR("regexp",FR),string:new LR("string",FR),name:new LR("name",FR),eof:new LR("eof"),bracketL:new LR("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new LR("]"),braceL:new LR("{",{beforeExpr:!0,startsExpr:!0}),braceR:new LR("}"),parenL:new LR("(",{beforeExpr:!0,startsExpr:!0}),parenR:new LR(")"),comma:new LR(",",DR),semi:new LR(";",DR),colon:new LR(":",DR),dot:new LR("."),question:new LR("?",DR),questionDot:new LR("?."),arrow:new LR("=>",DR),template:new LR("template"),invalidTemplate:new LR("invalidTemplate"),ellipsis:new LR("...",DR),backQuote:new LR("`",FR),dollarBraceL:new LR("${",{beforeExpr:!0,startsExpr:!0}),eq:new LR("=",{beforeExpr:!0,isAssign:!0}),assign:new LR("_=",{beforeExpr:!0,isAssign:!0}),incDec:new LR("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new LR("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:NR("||",1),logicalAND:NR("&&",2),bitwiseOR:NR("|",3),bitwiseXOR:NR("^",4),bitwiseAND:NR("&",5),equality:NR("==/!=/===/!==",6),relational:NR("</>/<=/>=",7),bitShift:NR("<</>>/>>>",8),plusMin:new LR("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:NR("%",10),star:NR("*",10),slash:NR("/",10),starstar:new LR("**",{beforeExpr:!0}),coalesce:NR("??",1),_break:UR("break"),_case:UR("case",DR),_catch:UR("catch"),_continue:UR("continue"),_debugger:UR("debugger"),_default:UR("default",DR),_do:UR("do",{isLoop:!0,beforeExpr:!0}),_else:UR("else",DR),_finally:UR("finally"),_for:UR("for",{isLoop:!0}),_function:UR("function",FR),_if:UR("if"),_return:UR("return",DR),_switch:UR("switch"),_throw:UR("throw",DR),_try:UR("try"),_var:UR("var"),_const:UR("const"),_while:UR("while",{isLoop:!0}),_with:UR("with"),_new:UR("new",{beforeExpr:!0,startsExpr:!0}),_this:UR("this",FR),_super:UR("super",FR),_class:UR("class",FR),_extends:UR("extends",DR),_export:UR("export"),_import:UR("import",FR),_null:UR("null",FR),_true:UR("true",FR),_false:UR("false",FR),_in:UR("in",{beforeExpr:!0,binop:7}),_instanceof:UR("instanceof",{beforeExpr:!0,binop:7}),_typeof:UR("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:UR("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:UR("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},zR=/\r\n?|\n|\u2028|\u2029/,VR=new RegExp(zR.source,"g");function HR(e,t){return 10===e||13===e||!t&&(8232===e||8233===e)}var GR=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,WR=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,XR=Object.prototype,YR=XR.hasOwnProperty,qR=XR.toString;function ZR(e,t){return YR.call(e,t)}var KR=Array.isArray||function(e){return"[object Array]"===qR.call(e)};function QR(e){return new RegExp("^(?:"+e.replace(/ /g,"|")+")$")}var JR=function(e,t){this.line=e,this.column=t};JR.prototype.offset=function(e){return new JR(this.line,this.column+e)};var $R=function(e,t,n){this.start=t,this.end=n,null!==e.sourceFile&&(this.source=e.sourceFile)};function eP(e,t){for(var n=1,r=0;;){VR.lastIndex=r;var i=VR.exec(e);if(!(i&&i.index<t))return new JR(n,t-r);++n,r=i.index+i[0].length}}var tP={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function nP(e){var t={};for(var n in tP)t[n]=e&&ZR(e,n)?e[n]:tP[n];if(t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),null==t.allowReserved&&(t.allowReserved=t.ecmaVersion<5),KR(t.onToken)){var r=t.onToken;t.onToken=function(e){return r.push(e)}}return KR(t.onComment)&&(t.onComment=function(e,t){return function(n,r,i,a,o,s){var u={type:n?"Block":"Line",value:r,start:i,end:a};e.locations&&(u.loc=new $R(this,o,s)),e.ranges&&(u.range=[i,a]),t.push(u)}}(t,t.onComment)),t}function rP(e,t){return 2|(e?4:0)|(t?8:0)}var iP=function(e,t,n){this.options=e=nP(e),this.sourceFile=e.sourceFile,this.keywords=QR(SR[e.ecmaVersion>=6?6:"module"===e.sourceType?"5module":5]);var r="";if(!0!==e.allowReserved){for(var i=e.ecmaVersion;!(r=ER[i]);i--);"module"===e.sourceType&&(r+=" await")}this.reservedWords=QR(r);var a=(r?r+" ":"")+ER.strict;this.reservedWordsStrict=QR(a),this.reservedWordsStrictBind=QR(a+" "+ER.strictBind),this.input=String(t),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(zR).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=BR.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===e.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&e.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},aP={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};iP.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},aP.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},aP.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},aP.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},aP.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},aP.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},aP.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},iP.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},iP.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n=this,r=0;r<e.length;r++)n=e[r](n);return n},iP.parse=function(e,t){return new this(t,e).parse()},iP.parseExpressionAt=function(e,t,n){var r=new this(n,e,t);return r.nextToken(),r.parseExpression()},iP.tokenizer=function(e,t){return new this(t,e)},Object.defineProperties(iP.prototype,aP);var oP=iP.prototype,sP=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function uP(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}oP.strictDirective=function(e){for(;;){WR.lastIndex=e,e+=WR.exec(this.input)[0].length;var t=sP.exec(this.input.slice(e));if(!t)return!1;if("use strict"===(t[1]||t[2])){WR.lastIndex=e+t[0].length;var n=WR.exec(this.input),r=n.index+n[0].length,i=this.input.charAt(r);return";"===i||"}"===i||zR.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||"!"===i&&"="===this.input.charAt(r+1))}e+=t[0].length,WR.lastIndex=e,e+=WR.exec(this.input)[0].length,";"===this.input[e]&&e++}},oP.eat=function(e){return this.type===e&&(this.next(),!0)},oP.isContextual=function(e){return this.type===BR.name&&this.value===e&&!this.containsEsc},oP.eatContextual=function(e){return!!this.isContextual(e)&&(this.next(),!0)},oP.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},oP.canInsertSemicolon=function(){return this.type===BR.eof||this.type===BR.braceR||zR.test(this.input.slice(this.lastTokEnd,this.start))},oP.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},oP.semicolon=function(){this.eat(BR.semi)||this.insertSemicolon()||this.unexpected()},oP.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},oP.expect=function(e){this.eat(e)||this.unexpected()},oP.unexpected=function(e){this.raise(null!=e?e:this.start,"Unexpected token")},oP.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},oP.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,r=e.doubleProto;if(!t)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},oP.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},oP.isSimpleAssignTarget=function(e){return"ParenthesizedExpression"===e.type?this.isSimpleAssignTarget(e.expression):"Identifier"===e.type||"MemberExpression"===e.type};var lP=iP.prototype;lP.parseTopLevel=function(e){var t={};for(e.body||(e.body=[]);this.type!==BR.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var a=i[r];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var cP={kind:"loop"},fP={kind:"switch"};lP.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;WR.lastIndex=this.pos;var t=WR.exec(this.input),n=this.pos+t[0].length,r=this.input.charCodeAt(n);if(91===r)return!0;if(e)return!1;if(123===r)return!0;if(PR(r,!0)){for(var i=n+1;IR(this.input.charCodeAt(i),!0);)++i;var a=this.input.slice(n,i);if(!TR.test(a))return!0}return!1},lP.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;WR.lastIndex=this.pos;var e=WR.exec(this.input),t=this.pos+e[0].length;return!(zR.test(this.input.slice(this.pos,t))||"function"!==this.input.slice(t,t+8)||t+8!==this.input.length&&IR(this.input.charAt(t+8)))},lP.parseStatement=function(e,t,n){var r,i=this.type,a=this.startNode();switch(this.isLet(e)&&(i=BR._var,r="let"),i){case BR._break:case BR._continue:return this.parseBreakContinueStatement(a,i.keyword);case BR._debugger:return this.parseDebuggerStatement(a);case BR._do:return this.parseDoStatement(a);case BR._for:return this.parseForStatement(a);case BR._function:return e&&(this.strict||"if"!==e&&"label"!==e)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!e);case BR._class:return e&&this.unexpected(),this.parseClass(a,!0);case BR._if:return this.parseIfStatement(a);case BR._return:return this.parseReturnStatement(a);case BR._switch:return this.parseSwitchStatement(a);case BR._throw:return this.parseThrowStatement(a);case BR._try:return this.parseTryStatement(a);case BR._const:case BR._var:return r=r||this.value,e&&"var"!==r&&this.unexpected(),this.parseVarStatement(a,r);case BR._while:return this.parseWhileStatement(a);case BR._with:return this.parseWithStatement(a);case BR.braceL:return this.parseBlock(!0,a);case BR.semi:return this.parseEmptyStatement(a);case BR._export:case BR._import:if(this.options.ecmaVersion>10&&i===BR._import){WR.lastIndex=this.pos;var o=WR.exec(this.input),s=this.pos+o[0].length,u=this.input.charCodeAt(s);if(40===u||46===u)return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===BR._import?this.parseImport(a):this.parseExport(a,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!e);var l=this.value,c=this.parseExpression();return i===BR.name&&"Identifier"===c.type&&this.eat(BR.colon)?this.parseLabeledStatement(a,l,c,e):this.parseExpressionStatement(a,c)}},lP.parseBreakContinueStatement=function(e,t){var n="break"===t;this.next(),this.eat(BR.semi)||this.insertSemicolon()?e.label=null:this.type!==BR.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==e.label||i.name===e.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(e.label&&n)break}}return r===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")},lP.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},lP.parseDoStatement=function(e){return this.next(),this.labels.push(cP),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(BR._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(BR.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},lP.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(cP),this.enterScope(0),this.expect(BR.parenL),this.type===BR.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===BR._var||this.type===BR._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),(this.type===BR._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===r.declarations.length?(this.options.ecmaVersion>=9&&(this.type===BR._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,r)):(t>-1&&this.unexpected(t),this.parseFor(e,r))}var a=new uP,o=this.parseExpression(!0,a);return this.type===BR._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===BR._in?t>-1&&this.unexpected(t):e.await=t>-1),this.toAssignable(o,!1,a),this.checkLVal(o),this.parseForIn(e,o)):(this.checkExpressionErrors(a,!0),t>-1&&this.unexpected(t),this.parseFor(e,o))},lP.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,hP|(n?0:dP),!1,t)},lP.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(BR._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},lP.parseReturnStatement=function(e){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(BR.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},lP.parseSwitchStatement=function(e){var t;this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(BR.braceL),this.labels.push(fP),this.enterScope(0);for(var n=!1;this.type!==BR.braceR;)if(this.type===BR._case||this.type===BR._default){var r=this.type===BR._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),r?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(BR.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},lP.parseThrowStatement=function(e){return this.next(),zR.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var pP=[];lP.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===BR._catch){var t=this.startNode();if(this.next(),this.eat(BR.parenL)){t.param=this.parseBindingAtom();var n="Identifier"===t.param.type;this.enterScope(n?32:0),this.checkLVal(t.param,n?4:2),this.expect(BR.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0);t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(BR._finally)?this.parseBlock():null,e.handler||e.finalizer||this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},lP.parseVarStatement=function(e,t){return this.next(),this.parseVar(e,!1,t),this.semicolon(),this.finishNode(e,"VariableDeclaration")},lP.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(cP),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},lP.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},lP.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},lP.parseLabeledStatement=function(e,t,n,r){for(var i=0,a=this.labels;i<a.length;i+=1){a[i].name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===BR._switch?"switch":null,s=this.labels.length-1;s>=0;s--){var u=this.labels[s];if(u.statementStart!==e.start)break;u.statementStart=this.start,u.kind=o}return this.labels.push({name:t,kind:o,statementStart:this.start}),e.body=this.parseStatement(r?-1===r.indexOf("label")?r+"label":r:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")},lP.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},lP.parseBlock=function(e,t,n){for(void 0===e&&(e=!0),void 0===t&&(t=this.startNode()),t.body=[],this.expect(BR.braceL),e&&this.enterScope(0);this.type!==BR.braceR;){var r=this.parseStatement(null);t.body.push(r)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},lP.parseFor=function(e,t){return e.init=t,this.expect(BR.semi),e.test=this.type===BR.semi?null:this.parseExpression(),this.expect(BR.semi),e.update=this.type===BR.parenR?null:this.parseExpression(),this.expect(BR.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},lP.parseForIn=function(e,t){var n=this.type===BR._in;return this.next(),"VariableDeclaration"===t.type&&null!=t.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==t.kind||"Identifier"!==t.declarations[0].id.type)?this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===t.type&&this.raise(t.start,"Invalid left-hand side in for-loop"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(BR.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")},lP.parseVar=function(e,t,n){for(e.declarations=[],e.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(BR.eq)?r.init=this.parseMaybeAssign(t):"const"!==n||this.type===BR._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===r.id.type||t&&(this.type===BR._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),e.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(BR.comma))break}return e},lP.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLVal(e.id,"var"===t?1:2,!1)};var hP=1,dP=2;lP.parseFunction=function(e,t,n,r){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===BR.star&&t&dP&&this.unexpected(),e.generator=this.eat(BR.star)),this.options.ecmaVersion>=8&&(e.async=!!r),t&hP&&(e.id=4&t&&this.type!==BR.name?null:this.parseIdent(),!e.id||t&dP||this.checkLVal(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?1:2:3));var i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(rP(e.async,e.generator)),t&hP||(e.id=this.type===BR.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(e,t&hP?"FunctionDeclaration":"FunctionExpression")},lP.parseFunctionParams=function(e){this.expect(BR.parenL),e.params=this.parseBindingList(BR.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},lP.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var r=this.startNode(),i=!1;for(r.body=[],this.expect(BR.braceL);this.type!==BR.braceR;){var a=this.parseClassElement(null!==e.superClass);a&&(r.body.push(a),"MethodDefinition"===a.type&&"constructor"===a.kind&&(i&&this.raise(a.start,"Duplicate constructor in the same class"),i=!0))}return this.strict=n,this.next(),e.body=this.finishNode(r,"ClassBody"),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},lP.parseClassElement=function(e){var t=this;if(this.eat(BR.semi))return null;var n=this.startNode(),r=function(e,r){void 0===r&&(r=!1);var i=t.start,a=t.startLoc;return!!t.eatContextual(e)&&(!(t.type===BR.parenL||r&&t.canInsertSemicolon())||(n.key&&t.unexpected(),n.computed=!1,n.key=t.startNodeAt(i,a),n.key.name=e,t.finishNode(n.key,"Identifier"),!1))};n.kind="method",n.static=r("static");var i=this.eat(BR.star),a=!1;i||(this.options.ecmaVersion>=8&&r("async",!0)?(a=!0,i=this.options.ecmaVersion>=9&&this.eat(BR.star)):r("get")?n.kind="get":r("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var o=n.key,s=!1;return n.computed||n.static||!("Identifier"===o.type&&"constructor"===o.name||"Literal"===o.type&&"constructor"===o.value)?n.static&&"Identifier"===o.type&&"prototype"===o.name&&this.raise(o.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(o.start,"Constructor can't have get/set modifier"),i&&this.raise(o.start,"Constructor can't be a generator"),a&&this.raise(o.start,"Constructor can't be an async method"),n.kind="constructor",s=e),this.parseClassMethod(n,i,a,s),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},lP.parseClassMethod=function(e,t,n,r){return e.value=this.parseMethod(t,n,r),this.finishNode(e,"MethodDefinition")},lP.parseClassId=function(e,t){this.type===BR.name?(e.id=this.parseIdent(),t&&this.checkLVal(e.id,2,!1)):(!0===t&&this.unexpected(),e.id=null)},lP.parseClassSuper=function(e){e.superClass=this.eat(BR._extends)?this.parseExprSubscripts():null},lP.parseExport=function(e,t){if(this.next(),this.eat(BR.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseIdent(!0),this.checkExport(t,e.exported.name,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==BR.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(BR._default)){var n;if(this.checkExport(t,"default",this.lastTokStart),this.type===BR._function||(n=this.isAsyncFunction())){var r=this.startNode();this.next(),n&&this.next(),e.declaration=this.parseFunction(r,4|hP,!1,n)}else if(this.type===BR._class){var i=this.startNode();e.declaration=this.parseClass(i,"nullableID")}else e.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(null),"VariableDeclaration"===e.declaration.type?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id.name,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==BR.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var a=0,o=e.specifiers;a<o.length;a+=1){var s=o[a];this.checkUnreserved(s.local),this.checkLocalExport(s.local)}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},lP.checkExport=function(e,t,n){e&&(ZR(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)},lP.checkPatternExport=function(e,t){var n=t.type;if("Identifier"===n)this.checkExport(e,t.name,t.start);else if("ObjectPattern"===n)for(var r=0,i=t.properties;r<i.length;r+=1){var a=i[r];this.checkPatternExport(e,a)}else if("ArrayPattern"===n)for(var o=0,s=t.elements;o<s.length;o+=1){var u=s[o];u&&this.checkPatternExport(e,u)}else"Property"===n?this.checkPatternExport(e,t.value):"AssignmentPattern"===n?this.checkPatternExport(e,t.left):"RestElement"===n?this.checkPatternExport(e,t.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(e,t.expression)},lP.checkVariableExport=function(e,t){if(e)for(var n=0,r=t;n<r.length;n+=1){var i=r[n];this.checkPatternExport(e,i.id)}},lP.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},lP.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(BR.braceL);!this.eat(BR.braceR);){if(n)n=!1;else if(this.expect(BR.comma),this.afterTrailingComma(BR.braceR))break;var r=this.startNode();r.local=this.parseIdent(!0),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,this.checkExport(e,r.exported.name,r.exported.start),t.push(this.finishNode(r,"ExportSpecifier"))}return t},lP.parseImport=function(e){return this.next(),this.type===BR.string?(e.specifiers=pP,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===BR.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},lP.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===BR.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),e.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(BR.comma))return e}if(this.type===BR.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,2),e.push(this.finishNode(r,"ImportNamespaceSpecifier")),e}for(this.expect(BR.braceL);!this.eat(BR.braceR);){if(t)t=!1;else if(this.expect(BR.comma),this.afterTrailingComma(BR.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,2),e.push(this.finishNode(i,"ImportSpecifier"))}return e},lP.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},lP.isDirectiveCandidate=function(e){return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&('"'===this.input[e.start]||"'"===this.input[e.start])};var vP=iP.prototype;vP.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&"await"===e.name&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=e.properties;r<i.length;r+=1){var a=i[r];this.toAssignable(a,t),"RestElement"!==a.type||"ArrayPattern"!==a.argument.type&&"ObjectPattern"!==a.argument.type||this.raise(a.argument.start,"Unexpected token")}break;case"Property":"init"!==e.kind&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),"AssignmentPattern"===e.argument.type&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==e.operator&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e},vP.toAssignableList=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r];i&&this.toAssignable(i,t)}if(n){var a=e[n-1];6===this.options.ecmaVersion&&t&&a&&"RestElement"===a.type&&"Identifier"!==a.argument.type&&this.unexpected(a.argument.start)}return e},vP.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},vP.parseRestBinding=function(){var e=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==BR.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},vP.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case BR.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(BR.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case BR.braceL:return this.parseObj(!0)}return this.parseIdent()},vP.parseBindingList=function(e,t,n){for(var r=[],i=!0;!this.eat(e);)if(i?i=!1:this.expect(BR.comma),t&&this.type===BR.comma)r.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===BR.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),r.push(a),this.type===BR.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),r.push(o)}return r},vP.parseBindingListItem=function(e){return e},vP.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(BR.eq))return n;var r=this.startNodeAt(e,t);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},vP.checkLVal=function(e,t,n){switch(void 0===t&&(t=0),e.type){case"Identifier":2===t&&"let"===e.name&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(t?"Binding ":"Assigning to ")+e.name+" in strict mode"),n&&(ZR(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),0!==t&&5!==t&&this.declareName(e.name,t,e.start);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":t&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ObjectPattern":for(var r=0,i=e.properties;r<i.length;r+=1){var a=i[r];this.checkLVal(a,t,n)}break;case"Property":this.checkLVal(e.value,t,n);break;case"ArrayPattern":for(var o=0,s=e.elements;o<s.length;o+=1){var u=s[o];u&&this.checkLVal(u,t,n)}break;case"AssignmentPattern":this.checkLVal(e.left,t,n);break;case"RestElement":this.checkLVal(e.argument,t,n);break;case"ParenthesizedExpression":this.checkLVal(e.expression,t,n);break;default:this.raise(e.start,(t?"Binding":"Assigning to")+" rvalue")}};var mP=iP.prototype;mP.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===e.type||this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var r,i=e.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var a=e.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===a&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);else{var o=t[r="$"+r];if(o)("init"===a?this.strict&&o.init||o.get||o.set:o.init||o[a])&&this.raiseRecoverable(i.start,"Redefinition of property");else o=t[r]={init:!1,get:!1,set:!1};o[a]=!0}}},mP.parseExpression=function(e,t){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(e,t);if(this.type===BR.comma){var a=this.startNodeAt(n,r);for(a.expressions=[i];this.eat(BR.comma);)a.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(a,"SequenceExpression")}return i},mP.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var r=!1,i=-1,a=-1;t?(i=t.parenthesizedAssign,a=t.trailingComma,t.parenthesizedAssign=t.trailingComma=-1):(t=new uP,r=!0);var o=this.start,s=this.startLoc;this.type!==BR.parenL&&this.type!==BR.name||(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(e,t);if(n&&(u=n.call(this,u,o,s)),this.type.isAssign){var l=this.startNodeAt(o,s);return l.operator=this.value,l.left=this.type===BR.eq?this.toAssignable(u,!1,t):u,r||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=l.left.start&&(t.shorthandAssign=-1),this.checkLVal(u),this.next(),l.right=this.parseMaybeAssign(e),this.finishNode(l,"AssignmentExpression")}return r&&this.checkExpressionErrors(t,!0),i>-1&&(t.parenthesizedAssign=i),a>-1&&(t.trailingComma=a),u},mP.parseMaybeConditional=function(e,t){var n=this.start,r=this.startLoc,i=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return i;if(this.eat(BR.question)){var a=this.startNodeAt(n,r);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(BR.colon),a.alternate=this.parseMaybeAssign(e),this.finishNode(a,"ConditionalExpression")}return i},mP.parseExprOps=function(e,t){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(t,!1);return this.checkExpressionErrors(t)||i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,e)},mP.parseExprOp=function(e,t,n,r,i){var a=this.type.binop;if(null!=a&&(!i||this.type!==BR._in)&&a>r){var o=this.type===BR.logicalOR||this.type===BR.logicalAND,s=this.type===BR.coalesce;s&&(a=BR.logicalAND.binop);var u=this.value;this.next();var l=this.start,c=this.startLoc,f=this.parseExprOp(this.parseMaybeUnary(null,!1),l,c,a,i),p=this.buildBinary(t,n,e,f,u,o||s);return(o&&this.type===BR.coalesce||s&&(this.type===BR.logicalOR||this.type===BR.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(p,t,n,r,i)}return e},mP.buildBinary=function(e,t,n,r,i,a){var o=this.startNodeAt(e,t);return o.left=n,o.operator=i,o.right=r,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")},mP.parseMaybeUnary=function(e,t){var n,r=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),t=!0;else if(this.type.prefix){var a=this.startNode(),o=this.type===BR.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),o?this.checkLVal(a.argument):this.strict&&"delete"===a.operator&&"Identifier"===a.argument.type?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):t=!0,n=this.finishNode(a,o?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(e),this.checkExpressionErrors(e))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(r,i);s.operator=this.value,s.prefix=!1,s.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(s,"UpdateExpression")}}return!t&&this.eat(BR.starstar)?this.buildBinary(r,i,n,this.parseMaybeUnary(null,!1),"**",!1):n},mP.parseExprSubscripts=function(e){var t=this.start,n=this.startLoc,r=this.parseExprAtom(e);if("ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return r;var i=this.parseSubscripts(r,t,n);return e&&"MemberExpression"===i.type&&(e.parenthesizedAssign>=i.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=i.start&&(e.parenthesizedBind=-1)),i},mP.parseSubscripts=function(e,t,n,r){for(var i=this.options.ecmaVersion>=8&&"Identifier"===e.type&&"async"===e.name&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start==5&&this.potentialArrowAt===e.start,a=!1;;){var o=this.parseSubscript(e,t,n,r,i,a);if(o.optional&&(a=!0),o===e||"ArrowFunctionExpression"===o.type){if(a){var s=this.startNodeAt(t,n);s.expression=o,o=this.finishNode(s,"ChainExpression")}return o}e=o}},mP.parseSubscript=function(e,t,n,r,i,a){var o=this.options.ecmaVersion>=11,s=o&&this.eat(BR.questionDot);r&&s&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(BR.bracketL);if(u||s&&this.type!==BR.parenL&&this.type!==BR.backQuote||this.eat(BR.dot)){var l=this.startNodeAt(t,n);l.object=e,l.property=u?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),l.computed=!!u,u&&this.expect(BR.bracketR),o&&(l.optional=s),e=this.finishNode(l,"MemberExpression")}else if(!r&&this.eat(BR.parenL)){var c=new uP,f=this.yieldPos,p=this.awaitPos,h=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var d=this.parseExprList(BR.parenR,this.options.ecmaVersion>=8,!1,c);if(i&&!s&&!this.canInsertSemicolon()&&this.eat(BR.arrow))return this.checkPatternErrors(c,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=f,this.awaitPos=p,this.awaitIdentPos=h,this.parseArrowExpression(this.startNodeAt(t,n),d,!0);this.checkExpressionErrors(c,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=h||this.awaitIdentPos;var v=this.startNodeAt(t,n);v.callee=e,v.arguments=d,o&&(v.optional=s),e=this.finishNode(v,"CallExpression")}else if(this.type===BR.backQuote){(s||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var m=this.startNodeAt(t,n);m.tag=e,m.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(m,"TaggedTemplateExpression")}return e},mP.parseExprAtom=function(e){this.type===BR.slash&&this.readRegexp();var t,n=this.potentialArrowAt===this.start;switch(this.type){case BR._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),t=this.startNode(),this.next(),this.type!==BR.parenL||this.allowDirectSuper||this.raise(t.start,"super() call outside constructor of a subclass"),this.type!==BR.dot&&this.type!==BR.bracketL&&this.type!==BR.parenL&&this.unexpected(),this.finishNode(t,"Super");case BR._this:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case BR.name:var r=this.start,i=this.startLoc,a=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&"async"===o.name&&!this.canInsertSemicolon()&&this.eat(BR._function))return this.parseFunction(this.startNodeAt(r,i),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(BR.arrow))return this.parseArrowExpression(this.startNodeAt(r,i),[o],!1);if(this.options.ecmaVersion>=8&&"async"===o.name&&this.type===BR.name&&!a)return o=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(BR.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,i),[o],!0)}return o;case BR.regexp:var s=this.value;return(t=this.parseLiteral(s.value)).regex={pattern:s.pattern,flags:s.flags},t;case BR.num:case BR.string:return this.parseLiteral(this.value);case BR._null:case BR._true:case BR._false:return(t=this.startNode()).value=this.type===BR._null?null:this.type===BR._true,t.raw=this.type.keyword,this.next(),this.finishNode(t,"Literal");case BR.parenL:var u=this.start,l=this.parseParenAndDistinguishExpression(n);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(l)&&(e.parenthesizedAssign=u),e.parenthesizedBind<0&&(e.parenthesizedBind=u)),l;case BR.bracketL:return t=this.startNode(),this.next(),t.elements=this.parseExprList(BR.bracketR,!0,!0,e),this.finishNode(t,"ArrayExpression");case BR.braceL:return this.parseObj(!1,e);case BR._function:return t=this.startNode(),this.next(),this.parseFunction(t,0);case BR._class:return this.parseClass(this.startNode(),!1);case BR._new:return this.parseNew();case BR.backQuote:return this.parseTemplate();case BR._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},mP.parseExprImport=function(){var e=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var t=this.parseIdent(!0);switch(this.type){case BR.parenL:return this.parseDynamicImport(e);case BR.dot:return e.meta=t,this.parseImportMeta(e);default:this.unexpected()}},mP.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(BR.parenR)){var t=this.start;this.eat(BR.comma)&&this.eat(BR.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},mP.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),"meta"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},mP.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),110===t.raw.charCodeAt(t.raw.length-1)&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},mP.parseParenExpression=function(){this.expect(BR.parenL);var e=this.parseExpression();return this.expect(BR.parenR),e},mP.parseParenAndDistinguishExpression=function(e){var t,n=this.start,r=this.startLoc,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a,o=this.start,s=this.startLoc,u=[],l=!0,c=!1,f=new uP,p=this.yieldPos,h=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==BR.parenR;){if(l?l=!1:this.expect(BR.comma),i&&this.afterTrailingComma(BR.parenR,!0)){c=!0;break}if(this.type===BR.ellipsis){a=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===BR.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}u.push(this.parseMaybeAssign(!1,f,this.parseParenItem))}var d=this.start,v=this.startLoc;if(this.expect(BR.parenR),e&&!this.canInsertSemicolon()&&this.eat(BR.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=p,this.awaitPos=h,this.parseParenArrowList(n,r,u);u.length&&!c||this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(f,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=h||this.awaitPos,u.length>1?((t=this.startNodeAt(o,s)).expressions=u,this.finishNodeAt(t,"SequenceExpression",d,v)):t=u[0]}else t=this.parseParenExpression();if(this.options.preserveParens){var m=this.startNodeAt(n,r);return m.expression=t,this.finishNode(m,"ParenthesizedExpression")}return t},mP.parseParenItem=function(e){return e},mP.parseParenArrowList=function(e,t,n){return this.parseArrowExpression(this.startNodeAt(e,t),n)};var yP=[];mP.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode(),t=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(BR.dot)){e.meta=t;var n=this.containsEsc;return e.property=this.parseIdent(!0),"target"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(e.start,"'new.target' can only be used in functions"),this.finishNode(e,"MetaProperty")}var r=this.start,i=this.startLoc,a=this.type===BR._import;return e.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),a&&"ImportExpression"===e.callee.type&&this.raise(r,"Cannot use new with import()"),this.eat(BR.parenL)?e.arguments=this.parseExprList(BR.parenR,this.options.ecmaVersion>=8,!1):e.arguments=yP,this.finishNode(e,"NewExpression")},mP.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===BR.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===BR.backQuote,this.finishNode(n,"TemplateElement")},mP.parseTemplate=function(e){void 0===e&&(e={});var t=e.isTagged;void 0===t&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:t});for(n.quasis=[r];!r.tail;)this.type===BR.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(BR.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(BR.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")},mP.isAsyncProp=function(e){return!e.computed&&"Identifier"===e.key.type&&"async"===e.key.name&&(this.type===BR.name||this.type===BR.num||this.type===BR.string||this.type===BR.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===BR.star)&&!zR.test(this.input.slice(this.lastTokEnd,this.start))},mP.parseObj=function(e,t){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(BR.braceR);){if(r)r=!1;else if(this.expect(BR.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(BR.braceR))break;var a=this.parseProperty(e,t);e||this.checkPropClash(a,i,t),n.properties.push(a)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")},mP.parseProperty=function(e,t){var n,r,i,a,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(BR.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===BR.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(this.type===BR.parenL&&t&&(t.parenthesizedAssign<0&&(t.parenthesizedAssign=this.start),t.parenthesizedBind<0&&(t.parenthesizedBind=this.start)),o.argument=this.parseMaybeAssign(!1,t),this.type===BR.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(i=this.start,a=this.startLoc),e||(n=this.eat(BR.star)));var s=this.containsEsc;return this.parsePropertyName(o),!e&&!s&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(o)?(r=!0,n=this.options.ecmaVersion>=9&&this.eat(BR.star),this.parsePropertyName(o,t)):r=!1,this.parsePropertyValue(o,e,n,r,i,a,t,s),this.finishNode(o,"Property")},mP.parsePropertyValue=function(e,t,n,r,i,a,o,s){if((n||r)&&this.type===BR.colon&&this.unexpected(),this.eat(BR.colon))e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===BR.parenL)t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(n,r);else if(t||s||!(this.options.ecmaVersion>=5)||e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||this.type===BR.comma||this.type===BR.braceR||this.type===BR.eq)this.options.ecmaVersion>=6&&!e.computed&&"Identifier"===e.key.type?((n||r)&&this.unexpected(),this.checkUnreserved(e.key),"await"!==e.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),e.kind="init",t?e.value=this.parseMaybeDefault(i,a,e.key):this.type===BR.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(i,a,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected();else{(n||r)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var u="get"===e.kind?0:1;if(e.value.params.length!==u){var l=e.value.start;"get"===e.kind?this.raiseRecoverable(l,"getter should have no params"):this.raiseRecoverable(l,"setter should have exactly one param")}else"set"===e.kind&&"RestElement"===e.value.params[0].type&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")}},mP.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(BR.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(BR.bracketR),e.key;e.computed=!1}return e.key=this.type===BR.num||this.type===BR.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},mP.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},mP.parseMethod=function(e,t,n){var r=this.startNode(),i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=e),this.options.ecmaVersion>=8&&(r.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|rP(t,r.generator)|(n?128:0)),this.expect(BR.parenL),r.params=this.parseBindingList(BR.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(r,"FunctionExpression")},mP.parseArrowExpression=function(e,t,n){var r=this.yieldPos,i=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(16|rP(n,!1)),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1),this.yieldPos=r,this.awaitPos=i,this.awaitIdentPos=a,this.finishNode(e,"ArrowFunctionExpression")},mP.parseFunctionBody=function(e,t,n){var r=t&&this.type!==BR.braceL,i=this.strict,a=!1;if(r)e.body=this.parseMaybeAssign(),e.expression=!0,this.checkParams(e,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);i&&!o||(a=this.strictDirective(this.end))&&o&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list");var s=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(e,!i&&!a&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLVal(e.id,5),e.body=this.parseBlock(!1,void 0,a&&!i),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=s}this.exitScope()},mP.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){if("Identifier"!==n[t].type)return!1}return!0},mP.checkParams=function(e,t){for(var n={},r=0,i=e.params;r<i.length;r+=1){var a=i[r];this.checkLVal(a,1,t?null:n)}},mP.parseExprList=function(e,t,n,r){for(var i=[],a=!0;!this.eat(e);){if(a)a=!1;else if(this.expect(BR.comma),t&&this.afterTrailingComma(e))break;var o=void 0;n&&this.type===BR.comma?o=null:this.type===BR.ellipsis?(o=this.parseSpread(r),r&&this.type===BR.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):o=this.parseMaybeAssign(!1,r),i.push(o)}return i},mP.checkUnreserved=function(e){var t=e.start,n=e.end,r=e.name;(this.inGenerator&&"yield"===r&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(r)&&this.raise(t,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(t,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+r+"' is reserved"))},mP.parseIdent=function(e,t){var n=this.startNode();return this.type===BR.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(!!e),this.finishNode(n,"Identifier"),e||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},mP.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===BR.semi||this.canInsertSemicolon()||this.type!==BR.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(BR.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},mP.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!1),this.finishNode(e,"AwaitExpression")};var gP=iP.prototype;gP.raise=function(e,t){var n=eP(this.input,e);t+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(t);throw r.pos=e,r.loc=n,r.raisedAt=this.pos,r},gP.raiseRecoverable=gP.raise,gP.curPosition=function(){if(this.options.locations)return new JR(this.curLine,this.pos-this.lineStart)};var _P=iP.prototype,bP=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};_P.enterScope=function(e){this.scopeStack.push(new bP(e))},_P.exitScope=function(){this.scopeStack.pop()},_P.treatFunctionsAsVarInScope=function(e){return 2&e.flags||!this.inModule&&1&e.flags},_P.declareName=function(e,t,n){var r=!1;if(2===t){var i=this.currentScope();r=i.lexical.indexOf(e)>-1||i.functions.indexOf(e)>-1||i.var.indexOf(e)>-1,i.lexical.push(e),this.inModule&&1&i.flags&&delete this.undefinedExports[e]}else if(4===t){this.currentScope().lexical.push(e)}else if(3===t){var a=this.currentScope();r=this.treatFunctionsAsVar?a.lexical.indexOf(e)>-1:a.lexical.indexOf(e)>-1||a.var.indexOf(e)>-1,a.functions.push(e)}else for(var o=this.scopeStack.length-1;o>=0;--o){var s=this.scopeStack[o];if(s.lexical.indexOf(e)>-1&&!(32&s.flags&&s.lexical[0]===e)||!this.treatFunctionsAsVarInScope(s)&&s.functions.indexOf(e)>-1){r=!0;break}if(s.var.push(e),this.inModule&&1&s.flags&&delete this.undefinedExports[e],3&s.flags)break}r&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")},_P.checkLocalExport=function(e){-1===this.scopeStack[0].lexical.indexOf(e.name)&&-1===this.scopeStack[0].var.indexOf(e.name)&&(this.undefinedExports[e.name]=e)},_P.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},_P.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags)return t}},_P.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags&&!(16&t.flags))return t}};var EP=function(e,t,n){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new $R(e,n)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},xP=iP.prototype;function SP(e,t,n,r){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=r),this.options.ranges&&(e.range[1]=n),e}xP.startNode=function(){return new EP(this,this.start,this.startLoc)},xP.startNodeAt=function(e,t){return new EP(this,e,t)},xP.finishNode=function(e,t){return SP.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},xP.finishNodeAt=function(e,t,n,r){return SP.call(this,e,t,n,r)};var TP=function(e,t,n,r,i){this.token=e,this.isExpr=!!t,this.preserveSpace=!!n,this.override=r,this.generator=!!i},AP={b_stat:new TP("{",!1),b_expr:new TP("{",!0),b_tmpl:new TP("${",!1),p_stat:new TP("(",!1),p_expr:new TP("(",!0),q_tmpl:new TP("`",!0,!0,(function(e){return e.tryReadTemplateToken()})),f_stat:new TP("function",!1),f_expr:new TP("function",!0),f_expr_gen:new TP("function",!0,!1,null,!0),f_gen:new TP("function",!1,!1,null,!0)},wP=iP.prototype;wP.initialContext=function(){return[AP.b_stat]},wP.braceIsBlock=function(e){var t=this.curContext();return t===AP.f_expr||t===AP.f_stat||(e!==BR.colon||t!==AP.b_stat&&t!==AP.b_expr?e===BR._return||e===BR.name&&this.exprAllowed?zR.test(this.input.slice(this.lastTokEnd,this.start)):e===BR._else||e===BR.semi||e===BR.eof||e===BR.parenR||e===BR.arrow||(e===BR.braceL?t===AP.b_stat:e!==BR._var&&e!==BR._const&&e!==BR.name&&!this.exprAllowed):!t.isExpr)},wP.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if("function"===t.token)return t.generator}return!1},wP.updateContext=function(e){var t,n=this.type;n.keyword&&e===BR.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr},BR.parenR.updateContext=BR.braceR.updateContext=function(){if(1!==this.context.length){var e=this.context.pop();e===AP.b_stat&&"function"===this.curContext().token&&(e=this.context.pop()),this.exprAllowed=!e.isExpr}else this.exprAllowed=!0},BR.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?AP.b_stat:AP.b_expr),this.exprAllowed=!0},BR.dollarBraceL.updateContext=function(){this.context.push(AP.b_tmpl),this.exprAllowed=!0},BR.parenL.updateContext=function(e){var t=e===BR._if||e===BR._for||e===BR._with||e===BR._while;this.context.push(t?AP.p_stat:AP.p_expr),this.exprAllowed=!0},BR.incDec.updateContext=function(){},BR._function.updateContext=BR._class.updateContext=function(e){!e.beforeExpr||e===BR.semi||e===BR._else||e===BR._return&&zR.test(this.input.slice(this.lastTokEnd,this.start))||(e===BR.colon||e===BR.braceL)&&this.curContext()===AP.b_stat?this.context.push(AP.f_stat):this.context.push(AP.f_expr),this.exprAllowed=!1},BR.backQuote.updateContext=function(){this.curContext()===AP.q_tmpl?this.context.pop():this.context.push(AP.q_tmpl),this.exprAllowed=!1},BR.star.updateContext=function(e){if(e===BR._function){var t=this.context.length-1;this.context[t]===AP.f_expr?this.context[t]=AP.f_expr_gen:this.context[t]=AP.f_gen}this.exprAllowed=!0},BR.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==BR.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var CP="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",kP=CP+" Extended_Pictographic",OP={9:CP,10:kP,11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},MP="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",RP="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",PP=RP+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",IP={9:RP,10:PP,11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},LP={};function NP(e){var t=LP[e]={binary:QR(OP[e]+" "+MP),nonBinary:{General_Category:QR(MP),Script:QR(IP[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}NP(9),NP(10),NP(11);var DP=iP.prototype,FP=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":""),this.unicodeProperties=LP[e.options.ecmaVersion>=11?11:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function jP(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function UP(e){return 36===e||e>=40&&e<=43||46===e||63===e||e>=91&&e<=94||e>=123&&e<=125}function BP(e){return e>=65&&e<=90||e>=97&&e<=122}function zP(e){return BP(e)||95===e}function VP(e){return zP(e)||HP(e)}function HP(e){return e>=48&&e<=57}function GP(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function WP(e){return e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:e-48}function XP(e){return e>=48&&e<=55}FP.prototype.reset=function(e,t,n){var r=-1!==n.indexOf("u");this.start=0|e,this.source=t+"",this.flags=n,this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchN=r&&this.parser.options.ecmaVersion>=9},FP.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)},FP.prototype.at=function(e,t){void 0===t&&(t=!1);var n=this.source,r=n.length;if(e>=r)return-1;var i=n.charCodeAt(e);if(!t&&!this.switchU||i<=55295||i>=57344||e+1>=r)return i;var a=n.charCodeAt(e+1);return a>=56320&&a<=57343?(i<<10)+a-56613888:i},FP.prototype.nextIndex=function(e,t){void 0===t&&(t=!1);var n=this.source,r=n.length;if(e>=r)return r;var i,a=n.charCodeAt(e);return!t&&!this.switchU||a<=55295||a>=57344||e+1>=r||(i=n.charCodeAt(e+1))<56320||i>57343?e+1:e+2},FP.prototype.current=function(e){return void 0===e&&(e=!1),this.at(this.pos,e)},FP.prototype.lookahead=function(e){return void 0===e&&(e=!1),this.at(this.nextIndex(this.pos,e),e)},FP.prototype.advance=function(e){void 0===e&&(e=!1),this.pos=this.nextIndex(this.pos,e)},FP.prototype.eat=function(e,t){return void 0===t&&(t=!1),this.current(t)===e&&(this.advance(t),!0)},DP.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,r=0;r<n.length;r++){var i=n.charAt(r);-1===t.indexOf(i)&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(i,r+1)>-1&&this.raise(e.start,"Duplicate regular expression flag")}},DP.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&e.groupNames.length>0&&(e.switchN=!0,this.regexp_pattern(e))},DP.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames.length=0,e.backReferenceNames.length=0,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var r=n[t];-1===e.groupNames.indexOf(r)&&e.raise("Invalid named capture referenced")}},DP.regexp_disjunction=function(e){for(this.regexp_alternative(e);e.eat(124);)this.regexp_alternative(e);this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},DP.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},DP.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):!!(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))&&(this.regexp_eatQuantifier(e),!0)},DP.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1},DP.regexp_eatQuantifier=function(e,t){return void 0===t&&(t=!1),!!this.regexp_eatQuantifierPrefix(e,t)&&(e.eat(63),!0)},DP.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},DP.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue),e.eat(125)))return-1!==i&&i<r&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1},DP.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},DP.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},DP.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1},DP.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):63===e.current()&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},DP.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},DP.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},DP.regexp_eatSyntaxCharacter=function(e){var t=e.current();return!!UP(t)&&(e.lastIntValue=t,e.advance(),!0)},DP.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;-1!==(n=e.current())&&!UP(n);)e.advance();return e.pos!==t},DP.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return!(-1===t||36===t||t>=40&&t<=43||46===t||63===t||91===t||94===t||124===t)&&(e.advance(),!0)},DP.regexp_groupSpecifier=function(e){if(e.eat(63)){if(this.regexp_eatGroupName(e))return-1!==e.groupNames.indexOf(e.lastStringValue)&&e.raise("Duplicate capture group name"),void e.groupNames.push(e.lastStringValue);e.raise("Invalid group")}},DP.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},DP.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=jP(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=jP(e.lastIntValue);return!0}return!1},DP.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,r=e.current(n);return e.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(r=e.lastIntValue),function(e){return PR(e,!0)||36===e||95===e}(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)},DP.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,r=e.current(n);return e.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(r=e.lastIntValue),function(e){return IR(e,!0)||36===e||95===e||8204===e||8205===e}(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)},DP.regexp_eatAtomEscape=function(e){return!!(this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e))||(e.switchU&&(99===e.current()&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},DP.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1},DP.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},DP.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},DP.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},DP.regexp_eatZero=function(e){return 48===e.current()&&!HP(e.lookahead())&&(e.lastIntValue=0,e.advance(),!0)},DP.regexp_eatControlEscape=function(e){var t=e.current();return 116===t?(e.lastIntValue=9,e.advance(),!0):110===t?(e.lastIntValue=10,e.advance(),!0):118===t?(e.lastIntValue=11,e.advance(),!0):102===t?(e.lastIntValue=12,e.advance(),!0):114===t&&(e.lastIntValue=13,e.advance(),!0)},DP.regexp_eatControlLetter=function(e){var t=e.current();return!!BP(t)&&(e.lastIntValue=t%32,e.advance(),!0)},DP.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){void 0===t&&(t=!1);var n,r=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var a=e.lastIntValue;if(i&&a>=55296&&a<=56319){var o=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(s>=56320&&s<=57343)return e.lastIntValue=1024*(a-55296)+(s-56320)+65536,!0}e.pos=o,e.lastIntValue=a}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&((n=e.lastIntValue)>=0&&n<=1114111))return!0;i&&e.raise("Invalid unicode escape"),e.pos=r}return!1},DP.regexp_eatIdentityEscape=function(e){if(e.switchU)return!!this.regexp_eatSyntaxCharacter(e)||!!e.eat(47)&&(e.lastIntValue=47,!0);var t=e.current();return!(99===t||e.switchN&&107===t)&&(e.lastIntValue=t,e.advance(),!0)},DP.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do{e.lastIntValue=10*e.lastIntValue+(t-48),e.advance()}while((t=e.current())>=48&&t<=57);return!0}return!1},DP.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(function(e){return 100===e||68===e||115===e||83===e||119===e||87===e}(t))return e.lastIntValue=-1,e.advance(),!0;if(e.switchU&&this.options.ecmaVersion>=9&&(80===t||112===t)){if(e.lastIntValue=-1,e.advance(),e.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(e)&&e.eat(125))return!0;e.raise("Invalid property name")}return!1},DP.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,r),!0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,i),!0}return!1},DP.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){ZR(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")},DP.regexp_validateUnicodePropertyNameOrValue=function(e,t){e.unicodeProperties.binary.test(t)||e.raise("Invalid property name")},DP.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";zP(t=e.current());)e.lastStringValue+=jP(t),e.advance();return""!==e.lastStringValue},DP.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";VP(t=e.current());)e.lastStringValue+=jP(t),e.advance();return""!==e.lastStringValue},DP.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},DP.regexp_eatCharacterClass=function(e){if(e.eat(91)){if(e.eat(94),this.regexp_classRanges(e),e.eat(93))return!0;e.raise("Unterminated character class")}return!1},DP.regexp_classRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;!e.switchU||-1!==t&&-1!==n||e.raise("Invalid character class"),-1!==t&&-1!==n&&t>n&&e.raise("Range out of order in character class")}}},DP.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(99===n||XP(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var r=e.current();return 93!==r&&(e.lastIntValue=r,e.advance(),!0)},DP.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},DP.regexp_eatClassControlLetter=function(e){var t=e.current();return!(!HP(t)&&95!==t)&&(e.lastIntValue=t%32,e.advance(),!0)},DP.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},DP.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;HP(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t},DP.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;GP(n=e.current());)e.lastIntValue=16*e.lastIntValue+WP(n),e.advance();return e.pos!==t},DP.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=64*t+8*n+e.lastIntValue:e.lastIntValue=8*t+n}else e.lastIntValue=t;return!0}return!1},DP.regexp_eatOctalDigit=function(e){var t=e.current();return XP(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)},DP.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var r=0;r<t;++r){var i=e.current();if(!GP(i))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+WP(i),e.advance()}return!0};var YP=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new $R(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},qP=iP.prototype;function ZP(e){return"function"!=typeof BigInt?null:BigInt(e.replace(/_/g,""))}function KP(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}qP.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new YP(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},qP.getToken=function(){return this.next(),new YP(this)},"undefined"!=typeof Symbol&&(qP[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===BR.eof,value:t}}}}),qP.curContext=function(){return this.context[this.context.length-1]},qP.nextToken=function(){var e=this.curContext();return e&&e.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(BR.eof):e.override?e.override(this):void this.readToken(this.fullCharCodeAtPos())},qP.readToken=function(e){return PR(e,this.options.ecmaVersion>=6)||92===e?this.readWord():this.getTokenFromCode(e)},qP.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);return e<=55295||e>=57344?e:(e<<10)+this.input.charCodeAt(this.pos+1)-56613888},qP.skipBlockComment=function(){var e,t=this.options.onComment&&this.curPosition(),n=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(VR.lastIndex=n;(e=VR.exec(this.input))&&e.index<this.pos;)++this.curLine,this.lineStart=e.index+e[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,r),n,this.pos,t,this.curPosition())},qP.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!HR(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())},qP.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(e>8&&e<14||e>=5760&&GR.test(String.fromCharCode(e))))break e;++this.pos}}},qP.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)},qP.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===e&&46===t?(this.pos+=3,this.finishToken(BR.ellipsis)):(++this.pos,this.finishToken(BR.dot))},qP.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===e?this.finishOp(BR.assign,2):this.finishOp(BR.slash,1)},qP.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,r=42===e?BR.star:BR.modulo;return this.options.ecmaVersion>=7&&42===e&&42===t&&(++n,r=BR.starstar,t=this.input.charCodeAt(this.pos+2)),61===t?this.finishOp(BR.assign,n+1):this.finishOp(r,n)},qP.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(BR.assign,3);return this.finishOp(124===e?BR.logicalOR:BR.logicalAND,2)}return 61===t?this.finishOp(BR.assign,2):this.finishOp(124===e?BR.bitwiseOR:BR.bitwiseAND,1)},qP.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(BR.assign,2):this.finishOp(BR.bitwiseXOR,1)},qP.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?45!==t||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!zR.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(BR.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===t?this.finishOp(BR.assign,2):this.finishOp(BR.plusMin,1)},qP.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=62===e&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(BR.assign,n+1):this.finishOp(BR.bitShift,n)):33!==t||60!==e||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===t&&(n=2),this.finishOp(BR.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},qP.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(BR.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===e&&62===t&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(BR.arrow)):this.finishOp(61===e?BR.eq:BR.prefix,1)},qP.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(46===t){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(BR.questionDot,2)}if(63===t){if(e>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(BR.assign,3);return this.finishOp(BR.coalesce,2)}}return this.finishOp(BR.question,1)},qP.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(BR.parenL);case 41:return++this.pos,this.finishToken(BR.parenR);case 59:return++this.pos,this.finishToken(BR.semi);case 44:return++this.pos,this.finishToken(BR.comma);case 91:return++this.pos,this.finishToken(BR.bracketL);case 93:return++this.pos,this.finishToken(BR.bracketR);case 123:return++this.pos,this.finishToken(BR.braceL);case 125:return++this.pos,this.finishToken(BR.braceR);case 58:return++this.pos,this.finishToken(BR.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(BR.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(120===t||88===t)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===t||79===t)return this.readRadixNumber(8);if(98===t||66===t)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(BR.prefix,1)}this.raise(this.pos,"Unexpected character '"+KP(e)+"'")},qP.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)},qP.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(zR.test(r)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if("["===r)t=!0;else if("]"===r&&t)t=!1;else if("/"===r&&!t)break;e="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var s=this.regexpState||(this.regexpState=new FP(this));s.reset(n,i,o),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var u=null;try{u=new RegExp(i,o)}catch(l){}return this.finishToken(BR.regexp,{pattern:i,flags:o,value:u})},qP.readInt=function(e,t,n){for(var r=this.options.ecmaVersion>=12&&void 0===t,i=n&&48===this.input.charCodeAt(this.pos),a=this.pos,o=0,s=0,u=0,l=null==t?1/0:t;u<l;++u,++this.pos){var c=this.input.charCodeAt(this.pos),f=void 0;if(r&&95===c)i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===s&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===u&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),s=c;else{if((f=c>=97?c-97+10:c>=65?c-65+10:c>=48&&c<=57?c-48:1/0)>=e)break;s=c,o=o*e+f}}return r&&95===s&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||null!=t&&this.pos-a!==t?null:o},qP.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return null==n&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=ZP(this.input.slice(t,this.pos)),++this.pos):PR(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(BR.num,n)},qP.readNumber=function(e){var t=this.pos;e||null!==this.readInt(10,void 0,!0)||this.raise(t,"Invalid number");var n=this.pos-t>=2&&48===this.input.charCodeAt(t);n&&this.strict&&this.raise(t,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&110===r){var i=ZP(this.input.slice(t,this.pos));return++this.pos,PR(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(BR.num,i)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number")),PR(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a,o=(a=this.input.slice(t,this.pos),n?parseInt(a,8):parseFloat(a.replace(/_/g,"")));return this.finishToken(BR.num,o)},qP.readCodePoint=function(){var e;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e},qP.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===e)break;92===r?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):(HR(r,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(BR.string,t)};var QP={};qP.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e!==QP)throw e;this.readInvalidTemplateToken()}this.inTemplateElement=!1},qP.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw QP;this.raise(e,t)},qP.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==BR.template&&this.type!==BR.invalidTemplate?(e+=this.input.slice(t,this.pos),this.finishToken(BR.template,e)):36===n?(this.pos+=2,this.finishToken(BR.dollarBraceL)):(++this.pos,this.finishToken(BR.backQuote));if(92===n)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(HR(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},qP.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(BR.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},qP.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return KP(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(e){var n=this.pos-1;return this.invalidStringToken(n,"Invalid escape sequence in template string"),null}default:if(t>=48&&t<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(r,8);return i>255&&(r=r.slice(0,-1),i=parseInt(r,8)),this.pos+=r.length-1,t=this.input.charCodeAt(this.pos),"0"===r&&56!==t&&57!==t||!this.strict&&!e||this.invalidStringToken(this.pos-1-r.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return HR(t)?"":String.fromCharCode(t)}},qP.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return null===n&&this.invalidStringToken(t,"Bad character escape sequence"),n},qP.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(IR(i,r))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,e+=this.input.slice(n,this.pos);var a=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?PR:IR)(o,r)||this.invalidStringToken(a,"Invalid Unicode escape"),e+=KP(o),n=this.pos}t=!1}return e+this.input.slice(n,this.pos)},qP.readWord=function(){var e=this.readWord1(),t=BR.name;return this.keywords.test(e)&&(t=jR[e]),this.finishToken(t,e)};function JP(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function $P(e){var t="function"==typeof Map?new Map:void 0;return($P=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return tI(e,arguments,rI(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),nI(r,e)})(e)}function eI(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function tI(e,t,n){return(tI=eI()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&nI(i,n.prototype),i}).apply(null,arguments)}function nI(e,t){return(nI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rI(e){return(rI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}iP.acorn={Parser:iP,version:"7.4.1",defaultOptions:tP,Position:JR,SourceLocation:$R,getLineInfo:eP,Node:EP,TokenType:LR,tokTypes:BR,keywordTypes:jR,TokContext:TP,tokContexts:AP,isIdentifierChar:IR,isIdentifierStart:PR,Token:YP,isNewLine:HR,lineBreak:zR,lineBreakG:VR,nonASCIIwhitespace:GR};var iI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}($P(Error)),aI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}($P(SyntaxError)),oI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}($P(ReferenceError)),sI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}($P(TypeError)),uI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}(iI),lI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}(aI),cI=function(e){function t(){return e.apply(this,arguments)||this}return JP(t,e),t}(oI),fI={UnknownError:[3001,"%0",uI],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",uI],NodeTypeSyntaxError:[1001,"Unknown node type: %0",cI],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",cI],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",cI],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",cI],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",cI],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",cI],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",cI],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",cI],ParamTypeSyntaxError:[1009,"Unknown param type: %0",cI],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",cI],FunctionUndefinedReferenceError:[2001,"%0 is not a function",oI],VariableUndefinedReferenceError:[2002,"%0 is not defined",oI],IsNotConstructor:[2003,"%0 is not a constructor",sI]};function pI(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function hI(e,t,n){return(hI=pI()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&dI(i,n.prototype),i}).apply(null,arguments)}function dI(e,t){return(dI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vI(e,t){Object.defineProperty(e,"name",{value:t,writable:!1,enumerable:!1,configurable:!0})}var mI=Object.prototype.hasOwnProperty,yI=Symbol("Break"),gI=Symbol("Continue"),_I=Symbol("DefaultCase"),bI=Symbol("EmptyStatementReturn"),EI=Symbol("WithScopeName"),xI=Symbol("SuperScopeName"),SI=Symbol("RootScopeName"),TI=Symbol("GlobalScopeName");function AI(e){return"function"==typeof e}var wI=function(){function e(e){this.interpreter=e}return e.prototype.generator=function(){var e=this.interpreter;return{getOptions:e.getOptions.bind(e),getCurrentScope:function(){return this.getCurrentScope()}.bind(e),getGlobalScope:function(){return this.getGlobalScope()}.bind(e),getCurrentContext:function(){return this.getCurrentContext()}.bind(e),getExecStartTime:e.getExecStartTime.bind(e)}},e}();function CI(e,t,n){if(void 0===n&&(n=!0),!(e instanceof wI))throw new Error("Illegal call");if("string"!=typeof t)return t;if(t){var r=e.generator(),i={timeout:r.getOptions().timeout,_initEnv:function(){n||this.setCurrentContext(r.getCurrentContext()),this.execStartTime=r.getExecStartTime(),this.execEndTime=this.execStartTime}},a=n?r.getGlobalScope():r.getCurrentScope();return new DI(a,i).evaluate(t)}}function kI(e){if(!(e instanceof wI))throw new Error("Illegal call");for(var t=e.generator(),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=r.pop(),o=new DI(t.getGlobalScope(),t.getOptions()),s="\n\t\t    (function anonymous("+r.join(",")+"){\n\t\t        "+a+"\n\t\t    });\n\t\t    ";return o.evaluate(s)}Object.defineProperty(CI,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(kI,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var OI=function(e){this.value=e},MI=function(e){this.value=e},RI=function(e){this.value=e},PI=function(e,t,n){void 0===t&&(t=null),this.name=n,this.parent=t,this.data=e,this.labelStack=[]};function II(){}function LI(e,t){return void 0===e&&(e=null),new PI(Object.create(null),e,t)}var NI={NaN:NaN,Infinity:1/0,undefined:void 0,Object:Object,Array:Array,String:String,Boolean:Boolean,Number:Number,Date:Date,RegExp:RegExp,Error:Error,URIError:URIError,TypeError:TypeError,RangeError:RangeError,SyntaxError:SyntaxError,ReferenceError:ReferenceError,Float32Array:Float32Array,Float64Array:Float64Array,Uint32Array:Uint32Array,Math:Math,parseInt:parseInt,parseFloat:parseFloat,isNaN:isNaN,isFinite:isFinite,decodeURI:decodeURI,decodeURIComponent:decodeURIComponent,encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,escape:escape,unescape:unescape,eval:CI,Function:kI};"undefined"!=typeof JSON&&(NI.JSON=JSON),"undefined"!=typeof Promise&&(NI.Promise=Promise),"undefined"!=typeof Set&&(NI.Set=Set),"undefined"!=typeof Map&&(NI.Map=Map),"undefined"!=typeof Symbol&&(NI.Symbol=Symbol),"undefined"!=typeof Proxy&&(NI.Proxy=Proxy),"undefined"!=typeof WeakMap&&(NI.WeakMap=WeakMap),"undefined"!=typeof WeakSet&&(NI.WeakSet=WeakSet),"undefined"!=typeof Reflect&&(NI.Reflect=Reflect);var DI=function(){function e(t,n){void 0===t&&(t=e.global),void 0===n&&(n={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:n.ecmaVersion||e.ecmaVersion,timeout:n.timeout||0,rootContext:n.rootContext,globalContextInFunction:void 0===n.globalContextInFunction?e.globalContextInFunction:n.globalContextInFunction,_initEnv:n._initEnv},this.context=t||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var t=e.prototype;return t.initEnvironment=function(e){var t,n;if(e instanceof PI)t=e;else{var r=null,i=this.createSuperScope(e);this.options.rootContext&&(r=new PI((n=this.options.rootContext,Object.create(n)),i,SI)),t=new PI(e,r||i,TI)}this.globalScope=t,this.currentScope=this.globalScope,this.globalContext=t.data,this.currentContext=t.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var a=this.options._initEnv;a&&a.call(this)},t.getExecStartTime=function(){return this.execStartTime},t.getExecutionTime=function(){return this.execEndTime-this.execStartTime},t.setExecTimeout=function(e){void 0===e&&(e=0),this.options.timeout=e},t.getOptions=function(){return this.options},t.getGlobalScope=function(){return this.globalScope},t.getCurrentScope=function(){return this.currentScope},t.getCurrentContext=function(){return this.currentContext},t.isInterruptThrow=function(e){return e instanceof uI||e instanceof cI||e instanceof lI},t.createSuperScope=function(e){var t=Object.assign({},NI);return Object.keys(t).forEach((function(n){n in e&&delete t[n]})),new PI(t,null,xI)},t.setCurrentContext=function(e){this.currentContext=e},t.setCurrentScope=function(e){this.currentScope=e},t.evaluate=function(t){var n,r,i;if(void 0===t&&(t=""),t)return r=t,i={ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||e.ecmaVersion},n=iP.parse(r,i),this.evaluateNode(n,t)},t.appendCode=function(e){return this.evaluate(e)},t.evaluateNode=function(e,t){var n=this;void 0===t&&(t=""),this.value=void 0,this.source=t,this.sourceList.push(t),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var r=this.getCurrentScope(),i=this.getCurrentContext(),a=r.labelStack.concat([]),o=this.callStack.concat([]);try{var s=this.createClosure(e);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),s()}catch(u){throw u}finally{n.setCurrentScope(r),n.setCurrentContext(i),r.labelStack=a,n.callStack=o,this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},t.createErrorMessage=function(e,t,n){var r=e[1].replace("%0",String(t));return null!==n&&(r+=this.getNodePosition(n||this.lastExecNode)),r},t.createError=function(e,t){return new t(e)},t.createThrowError=function(e,t){return this.createError(e,t)},t.createInternalThrowError=function(e,t,n){return this.createError(this.createErrorMessage(e,t,n),e[2])},t.checkTimeout=function(){if(!this.isRunning)return!1;var e=this.options.timeout||0;return Date.now()-this.execStartTime>e},t.getNodePosition=function(e){if(e){return e.loc?" ["+e.loc.start.line+":"+e.loc.start.column+"]":""}return""},t.createClosure=function(e){var t,n=this;switch(e.type){case"BinaryExpression":t=this.binaryExpressionHandler(e);break;case"LogicalExpression":t=this.logicalExpressionHandler(e);break;case"UnaryExpression":t=this.unaryExpressionHandler(e);break;case"UpdateExpression":t=this.updateExpressionHandler(e);break;case"ObjectExpression":t=this.objectExpressionHandler(e);break;case"ArrayExpression":t=this.arrayExpressionHandler(e);break;case"CallExpression":t=this.callExpressionHandler(e);break;case"NewExpression":t=this.newExpressionHandler(e);break;case"MemberExpression":t=this.memberExpressionHandler(e);break;case"ThisExpression":t=this.thisExpressionHandler(e);break;case"SequenceExpression":t=this.sequenceExpressionHandler(e);break;case"Literal":t=this.literalHandler(e);break;case"Identifier":t=this.identifierHandler(e);break;case"AssignmentExpression":t=this.assignmentExpressionHandler(e);break;case"FunctionDeclaration":t=this.functionDeclarationHandler(e);break;case"VariableDeclaration":t=this.variableDeclarationHandler(e);break;case"BlockStatement":case"Program":t=this.programHandler(e);break;case"ExpressionStatement":t=this.expressionStatementHandler(e);break;case"EmptyStatement":t=this.emptyStatementHandler(e);break;case"ReturnStatement":t=this.returnStatementHandler(e);break;case"FunctionExpression":t=this.functionExpressionHandler(e);break;case"IfStatement":t=this.ifStatementHandler(e);break;case"ConditionalExpression":t=this.conditionalExpressionHandler(e);break;case"ForStatement":t=this.forStatementHandler(e);break;case"WhileStatement":t=this.whileStatementHandler(e);break;case"DoWhileStatement":t=this.doWhileStatementHandler(e);break;case"ForInStatement":t=this.forInStatementHandler(e);break;case"WithStatement":t=this.withStatementHandler(e);break;case"ThrowStatement":t=this.throwStatementHandler(e);break;case"TryStatement":t=this.tryStatementHandler(e);break;case"ContinueStatement":t=this.continueStatementHandler(e);break;case"BreakStatement":t=this.breakStatementHandler(e);break;case"SwitchStatement":t=this.switchStatementHandler(e);break;case"LabeledStatement":t=this.labeledStatementHandler(e);break;case"DebuggerStatement":t=this.debuggerStatementHandler(e);break;default:throw this.createInternalThrowError(fI.NodeTypeSyntaxError,e.type,e)}return function(){var r=n.options.timeout;if(r&&r>0&&n.checkTimeout())throw n.createInternalThrowError(fI.ExecutionTimeOutError,r,null);return n.lastExecNode=e,t.apply(void 0,arguments)}},t.binaryExpressionHandler=function(e){var t=this,n=this.createClosure(e.left),r=this.createClosure(e.right);return function(){var i=n(),a=r();switch(e.operator){case"==":return i==a;case"!=":return i!=a;case"===":return i===a;case"!==":return i!==a;case"<":return i<a;case"<=":return i<=a;case">":return i>a;case">=":return i>=a;case"<<":return i<<a;case">>":return i>>a;case">>>":return i>>>a;case"+":return i+a;case"-":return i-a;case"*":return i*a;case"**":return Math.pow(i,a);case"/":return i/a;case"%":return i%a;case"|":return i|a;case"^":return i^a;case"&":return i&a;case"in":return i in a;case"instanceof":return i instanceof a;default:throw t.createInternalThrowError(fI.BinaryOperatorSyntaxError,e.operator,e)}}},t.logicalExpressionHandler=function(e){var t=this,n=this.createClosure(e.left),r=this.createClosure(e.right);return function(){switch(e.operator){case"||":return n()||r();case"&&":return n()&&r();default:throw t.createInternalThrowError(fI.LogicalOperatorSyntaxError,e.operator,e)}}},t.unaryExpressionHandler=function(e){var t=this;switch(e.operator){case"delete":var n=this.createObjectGetter(e.argument),r=this.createNameGetter(e.argument);return function(){return delete n()[r()]};default:var i;if("typeof"===e.operator&&"Identifier"===e.argument.type){var a=this.createObjectGetter(e.argument),o=this.createNameGetter(e.argument);i=function(){return a()[o()]}}else i=this.createClosure(e.argument);return function(){var n=i();switch(e.operator){case"-":return-n;case"+":return+n;case"!":return!n;case"~":return~n;case"void":return;case"typeof":return typeof n;default:throw t.createInternalThrowError(fI.UnaryOperatorSyntaxError,e.operator,e)}}}},t.updateExpressionHandler=function(e){var t=this,n=this.createObjectGetter(e.argument),r=this.createNameGetter(e.argument);return function(){var i=n(),a=r();switch(t.assertVariable(i,a,e),e.operator){case"++":return e.prefix?++i[a]:i[a]++;case"--":return e.prefix?--i[a]:i[a]--;default:throw t.createInternalThrowError(fI.UpdateOperatorSyntaxError,e.operator,e)}}},t.objectExpressionHandler=function(e){var t=this,n=[];var r=Object.create(null);return e.properties.forEach((function(e){var i=e.kind,a=function(e){return"Identifier"===e.type?e.name:"Literal"===e.type?e.value:this.throwError(fI.ObjectStructureSyntaxError,e.type,e)}(e.key);r[a]&&"init"!==i||(r[a]={}),r[a][i]=t.createClosure(e.value),n.push({key:a,property:e})})),function(){for(var e={},t=n.length,i=0;i<t;i++){var a=n[i],o=a.key,s=r[o],u=s.init?s.init():void 0,l=s.get?s.get():function(){},c=s.set?s.set():function(e){};if("set"in s||"get"in s){var f={configurable:!0,enumerable:!0,get:l,set:c};Object.defineProperty(e,o,f)}else{var p=a.property,h=p.kind;"Identifier"!==p.key.type||"FunctionExpression"!==p.value.type||"init"!==h||p.value.id||vI(u,p.key.name),e[o]=u}}return e}},t.arrayExpressionHandler=function(e){var t=this,n=e.elements.map((function(e){return e?t.createClosure(e):e}));return function(){for(var e=n.length,t=Array(e),r=0;r<e;r++){var i=n[r];i&&(t[r]=i())}return t}},t.safeObjectGet=function(e,t,n){return e[t]},t.createCallFunctionGetter=function(e){var t=this;switch(e.type){case"MemberExpression":var n=this.createClosure(e.object),r=this.createMemberKeyGetter(e),i=this.source;return function(){var a=n(),o=r(),s=t.safeObjectGet(a,o,e);if(!s||!AI(s)){var u=i.slice(e.start,e.end);throw t.createInternalThrowError(fI.FunctionUndefinedReferenceError,u,e)}return s.__IS_EVAL_FUNC?function(e){return s(new wI(t),e,!0)}:s.__IS_FUNCTION_FUNC?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return s.apply(void 0,[new wI(t)].concat(n))}:s.bind(a)};default:var a=this.createClosure(e);return function(){var n="";"Identifier"===e.type&&(n=e.name);var r=a();if(!r||!AI(r))throw t.createInternalThrowError(fI.FunctionUndefinedReferenceError,n,e);if("Identifier"===e.type&&r.__IS_EVAL_FUNC&&"eval"===n)return function(e){var i=t.getScopeFromName(n,t.getCurrentScope()),a=i.name===xI||i.name===TI||i.name===SI;return r(new wI(t),e,!a)};if(r.__IS_EVAL_FUNC)return function(e){return r(new wI(t),e,!0)};if(r.__IS_FUNCTION_FUNC)return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return r.apply(void 0,[new wI(t)].concat(n))};var i=t.options.globalContextInFunction;if("Identifier"===e.type){var o=t.getIdentifierScope(e);o.name===EI&&(i=o.data)}return r.bind(i)}}},t.callExpressionHandler=function(e){var t=this,n=this.createCallFunctionGetter(e.callee),r=e.arguments.map((function(e){return t.createClosure(e)}));return function(){return n().apply(void 0,r.map((function(e){return e()})))}},t.functionExpressionHandler=function(e){var t=this,n=this,r=this.source,i=this.collectDeclVars,a=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var o=e.id?e.id.name:"",s=e.params.length,u=e.params.map((function(e){return t.createParamNameGetter(e)})),l=this.createClosure(e.body),c=this.collectDeclVars,f=this.collectDeclFuncs;return this.collectDeclVars=i,this.collectDeclFuncs=a,function(){var t=n.getCurrentScope(),i=function e(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];n.callStack.push(""+o);var s=n.getCurrentScope(),p=LI(t,"FunctionScope("+o+")");n.setCurrentScope(p),n.addDeclarationsToScope(c,f,p),o&&(p.data[o]=e),p.data.arguments=arguments,u.forEach((function(e,t){p.data[e()]=i[t]}));var h=n.getCurrentContext();n.setCurrentContext(this);var d=l();if(n.setCurrentContext(h),n.setCurrentScope(s),n.callStack.pop(),d instanceof OI)return d.value};return vI(i,o),Object.defineProperty(i,"length",{value:s,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(i,"toString",{value:function(){return r.slice(e.start,e.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(i,"valueOf",{value:function(){return r.slice(e.start,e.end)},writable:!0,configurable:!0,enumerable:!1}),i}},t.newExpressionHandler=function(e){var t=this,n=this.source,r=this.createClosure(e.callee),i=e.arguments.map((function(e){return t.createClosure(e)}));return function(){var a=r();if(!AI(a)||a.__IS_EVAL_FUNC){var o=e.callee,s=n.slice(o.start,o.end);throw t.createInternalThrowError(fI.IsNotConstructor,s,e)}return a.__IS_FUNCTION_FUNC?a.apply(void 0,[new wI(t)].concat(i.map((function(e){return e()})))):hI(a,i.map((function(e){return e()})))}},t.memberExpressionHandler=function(e){var t=this.createClosure(e.object),n=this.createMemberKeyGetter(e);return function(){return t()[n()]}},t.thisExpressionHandler=function(e){var t=this;return function(){return t.getCurrentContext()}},t.sequenceExpressionHandler=function(e){var t=this,n=e.expressions.map((function(e){return t.createClosure(e)}));return function(){for(var e,t=n.length,r=0;r<t;r++){e=(0,n[r])()}return e}},t.literalHandler=function(e){return function(){return e.regex?new RegExp(e.regex.pattern,e.regex.flags):e.value}},t.identifierHandler=function(e){var t=this;return function(){var n=t.getCurrentScope(),r=t.getScopeDataFromName(e.name,n);return t.assertVariable(r,e.name,e),r[e.name]}},t.getIdentifierScope=function(e){var t=this.getCurrentScope();return this.getScopeFromName(e.name,t)},t.assignmentExpressionHandler=function(e){var t=this;"Identifier"!==e.left.type||"FunctionExpression"!==e.right.type||e.right.id||(e.right.id={type:"Identifier",name:e.left.name});var n=this.createObjectGetter(e.left),r=this.createNameGetter(e.left),i=this.createClosure(e.right);return function(){var a=n(),o=r(),s=i();switch("="!==e.operator&&t.assertVariable(a,o,e),e.operator){case"=":return a[o]=s;case"+=":return a[o]+=s;case"-=":return a[o]-=s;case"*=":return a[o]*=s;case"**=":return a[o]=Math.pow(a[o],s);case"/=":return a[o]/=s;case"%=":return a[o]%=s;case"<<=":return a[o]<<=s;case">>=":return a[o]>>=s;case">>>=":return a[o]>>>=s;case"&=":return a[o]&=s;case"^=":return a[o]^=s;case"|=":return a[o]|=s;default:throw t.createInternalThrowError(fI.AssignmentExpressionSyntaxError,e.type,e)}}},t.functionDeclarationHandler=function(e){if(e.id){var t=this.functionExpressionHandler(e);Object.defineProperty(t,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(e.id.name,t)}return function(){return bI}},t.getVariableName=function(e){if("Identifier"===e.type)return e.name;throw this.createInternalThrowError(fI.VariableTypeSyntaxError,e.type,e)},t.variableDeclarationHandler=function(e){for(var t,n=this,r=[],i=0;i<e.declarations.length;i++){var a=e.declarations[i];this.varDeclaration(this.getVariableName(a.id)),a.init&&r.push({type:"AssignmentExpression",operator:"=",left:a.id,right:a.init})}return r.length&&(t=this.createClosure({type:"BlockStatement",body:r})),function(){if(t){var e=n.isVarDeclMode;n.isVarDeclMode=!0,t(),n.isVarDeclMode=e}return bI}},t.assertVariable=function(e,t,n){if(e===this.globalScope.data&&!(t in e))throw this.createInternalThrowError(fI.VariableUndefinedReferenceError,t,n)},t.programHandler=function(e){var t=this,n=e.body.map((function(e){return t.createClosure(e)}));return function(){for(var e=bI,r=0;r<n.length;r++){var i=n[r],a=t.setValue(i());if(a!==bI&&((e=a)instanceof OI||e instanceof MI||e instanceof RI||e===yI||e===gI))break}return e}},t.expressionStatementHandler=function(e){return this.createClosure(e.expression)},t.emptyStatementHandler=function(e){return function(){return bI}},t.returnStatementHandler=function(e){var t=e.argument?this.createClosure(e.argument):II;return function(){return new OI(t())}},t.ifStatementHandler=function(e){var t=this.createClosure(e.test),n=this.createClosure(e.consequent),r=e.alternate?this.createClosure(e.alternate):function(){return bI};return function(){return t()?n():r()}},t.conditionalExpressionHandler=function(e){return this.ifStatementHandler(e)},t.forStatementHandler=function(e){var t=this,n=II,r=e.test?this.createClosure(e.test):function(){return!0},i=II,a=this.createClosure(e.body);return"ForStatement"===e.type&&(n=e.init?this.createClosure(e.init):n,i=e.update?this.createClosure(e.update):II),function(o){var s,u=bI,l="DoWhileStatement"===e.type;for(o&&"LabeledStatement"===o.type&&(s=o.label.name),n();l||r();i()){l=!1;var c=t.setValue(a());if(c!==bI&&c!==gI){if(c===yI)break;if((u=c)instanceof RI&&u.value===s)u=bI;else if(u instanceof OI||u instanceof MI||u instanceof RI)break}}return u}},t.whileStatementHandler=function(e){return this.forStatementHandler(e)},t.doWhileStatementHandler=function(e){return this.forStatementHandler(e)},t.forInStatementHandler=function(e){var t=this,n=e.left,r=this.createClosure(e.right),i=this.createClosure(e.body);return"VariableDeclaration"===e.left.type&&(this.createClosure(e.left)(),n=e.left.declarations[0].id),function(e){var a,o,s=bI;e&&"LabeledStatement"===e.type&&(a=e.label.name);var u=r();for(o in u){t.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:n,right:{type:"Literal",value:o}})();var l=t.setValue(i());if(l!==bI&&l!==gI){if(l===yI)break;if((s=l)instanceof RI&&s.value===a)s=bI;else if(s instanceof OI||s instanceof MI||s instanceof RI)break}}return s}},t.withStatementHandler=function(e){var t=this,n=this.createClosure(e.object),r=this.createClosure(e.body);return function(){var e=n(),i=t.getCurrentScope(),a=new PI(e,i,EI);t.setCurrentScope(a);var o=t.setValue(r());return t.setCurrentScope(i),o}},t.throwStatementHandler=function(e){var t=this,n=this.createClosure(e.argument);return function(){throw t.setValue(void 0),n()}},t.tryStatementHandler=function(e){var t=this,n=this.createClosure(e.block),r=e.handler?this.catchClauseHandler(e.handler):null,i=e.finalizer?this.createClosure(e.finalizer):null;return function(){var e,a,o=t.getCurrentScope(),s=t.getCurrentContext(),u=o.labelStack.concat([]),l=t.callStack.concat([]),c=bI,f=function(){t.setCurrentScope(o),t.setCurrentContext(s),o.labelStack=u,t.callStack=l};try{(c=t.setValue(n()))instanceof OI&&(e=c)}catch(p){if(f(),t.isInterruptThrow(p))throw p;if(r)try{(c=t.setValue(r(p)))instanceof OI&&(e=c)}catch(h){if(f(),t.isInterruptThrow(h))throw h;a=h}}if(i)try{(c=i())instanceof OI&&(e=c)}catch(p){if(f(),t.isInterruptThrow(p))throw p;a=p}if(a)throw a;return e||c}},t.catchClauseHandler=function(e){var t=this,n=this.createParamNameGetter(e.param),r=this.createClosure(e.body);return function(e){var i,a=t.getCurrentScope().data,o=n(),s=mI.call(a,o),u=a[o];return a[o]=e,i=r(),s?a[o]=u:delete a[o],i}},t.continueStatementHandler=function(e){return function(){return e.label?new RI(e.label.name):gI}},t.breakStatementHandler=function(e){return function(){return e.label?new MI(e.label.name):yI}},t.switchStatementHandler=function(e){var t=this,n=this.createClosure(e.discriminant),r=e.cases.map((function(e){return t.switchCaseHandler(e)}));return function(){for(var e,i,a,o=n(),s=!1,u=0;u<r.length;u++){var l=r[u](),c=l.testClosure();if(c!==_I){if(s||c===o){if(s=!0,(i=t.setValue(l.bodyClosure()))===bI)continue;if(i===yI)break;if((e=i)instanceof OI||e instanceof MI||e instanceof RI||e===gI)break}}else a=l}!s&&a&&((i=t.setValue(a.bodyClosure()))===bI||i===yI||i===gI||(e=i));return e}},t.switchCaseHandler=function(e){var t=e.test?this.createClosure(e.test):function(){return _I},n=this.createClosure({type:"BlockStatement",body:e.consequent});return function(){return{testClosure:t,bodyClosure:n}}},t.labeledStatementHandler=function(e){var t=this,n=e.label.name,r=this.createClosure(e.body);return function(){var i,a=t.getCurrentScope();return a.labelStack.push(n),(i=r(e))instanceof MI&&i.value===n&&(i=bI),a.labelStack.pop(),i}},t.debuggerStatementHandler=function(e){return function(){return bI}},t.createParamNameGetter=function(e){if("Identifier"===e.type)return function(){return e.name};throw this.createInternalThrowError(fI.ParamTypeSyntaxError,e.type,e)},t.createObjectKeyGetter=function(e){var t;return t="Identifier"===e.type?function(){return e.name}:this.createClosure(e),function(){return t()}},t.createMemberKeyGetter=function(e){return e.computed?this.createClosure(e.property):this.createObjectKeyGetter(e.property)},t.createObjectGetter=function(e){var t=this;switch(e.type){case"Identifier":return function(){return t.getScopeDataFromName(e.name,t.getCurrentScope())};case"MemberExpression":return this.createClosure(e.object);default:throw this.createInternalThrowError(fI.AssignmentTypeSyntaxError,e.type,e)}},t.createNameGetter=function(e){switch(e.type){case"Identifier":return function(){return e.name};case"MemberExpression":return this.createMemberKeyGetter(e);default:throw this.createInternalThrowError(fI.AssignmentTypeSyntaxError,e.type,e)}},t.varDeclaration=function(e){this.collectDeclVars[e]=void 0},t.funcDeclaration=function(e,t){this.collectDeclFuncs[e]=t},t.addDeclarationsToScope=function(e,t,n){var r=n.data;for(var i in t){var a=t[i];r[i]=a?a():a}for(var o in e)o in r||(r[o]=void 0)},t.getScopeValue=function(e,t){return this.getScopeFromName(e,t).data[e]},t.getScopeDataFromName=function(e,t){return this.getScopeFromName(e,t).data},t.getScopeFromName=function(e,t){var n=t;do{if(e in n.data)return n}while(n=n.parent);return this.globalScope},t.setValue=function(e){var t=this.callStack.length;return this.isVarDeclMode||t||e===bI||e===yI||e===gI||e instanceof MI||e instanceof RI||(this.value=e instanceof OI?e.value:e),e},t.getValue=function(){return this.value},e}();function FI(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={});var r=n.parsingContext,i=void 0===n.timeout?0:n.timeout,a="\n    (function anonymous("+t.join(",")+"){\n         "+e+"\n    });\n    ";return new DI(r,{ecmaVersion:n.ecmaVersion,timeout:i,rootContext:n.rootContext,globalContextInFunction:n.globalContextInFunction}).evaluate(a)}function jI(e,t,n){return new DI(t,n).evaluate(e)}DI.version="0.0.3",DI.eval=CI,DI.Function=kI,DI.ecmaVersion=5,DI.globalContextInFunction=void 0,DI.global=Object.create(null);var UI=jI,BI=function(){function e(e){this._code=e}var t=e.prototype;return t.runInContext=function(e){return jI(this._code,e)},t.runInNewContext=function(e){return jI(this._code,e)},e}(),zI=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",createContext:function(e){return void 0===e&&(e=Object.create(null)),e},compileFunction:FI,runInContext:jI,runInNewContext:UI,Script:BI}),VI=function(e,t,n){return jI(e,t,n)};var HI,GI,WI,XI,YI,qI,ZI,KI,QI,JI,$I,eL,tL,nL,rL=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Interpreter:DI,vm:zI,evaluate:VI,Function:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.pop();return FI(r||"",t)},default:VI}),iL=bR.exports=function(e){var t=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},n=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},r="\n";function i(e){return"undefined"!=typeof atob?atob(e):"base64:"+e}function a(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,t){e||a(t)}function s(e){return e?": "+e:""}function u(e,t,n){e in t||a("unknown parameter ("+e+")"+s(n)+". possible values: "+Object.keys(t).join())}function l(e,n){t(e)||a("invalid parameter type"+s(n)+". must be a typed array")}function c(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function f(e,t,n){c(e,t)||a("invalid parameter type"+s(n)+". expected "+t+", got "+typeof e)}function p(e,t){e>=0&&(0|e)===e||a("invalid parameter type, ("+e+")"+s(t)+". must be a nonnegative integer")}function h(e,t,n){t.indexOf(e)<0&&a("invalid value"+s(n)+". must be one of: "+t)}var d=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function v(e){Object.keys(e).forEach((function(e){d.indexOf(e)<0&&a('invalid regl constructor argument "'+e+'". must be one of '+d)}))}function m(e,t){for(e+="";e.length<t;)e=" "+e;return e}function y(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function g(e,t){this.number=e,this.line=t,this.errors=[]}function _(e,t,n){this.file=e,this.line=t,this.message=n}function b(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function E(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function x(e,t){var n=e.split("\n"),r=1,a=0,o={unknown:new y,0:new y};o.unknown.name=o[0].name=t||b(),o.unknown.lines.push(new g(0,""));for(var s=0;s<n.length;++s){var u=n[s],l=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(l)switch(l[1]){case"line":var c=/(\d+)(\s+\d+)?/.exec(l[2]);c&&(r=0|c[1],c[2]&&((a=0|c[2])in o||(o[a]=new y)));break;case"define":var f=/SHADER_NAME(_B64)?\s+(.*)$/.exec(l[2]);f&&(o[a].name=f[1]?i(f[2]):f[2])}o[a].lines.push(new g(r++,u))}return Object.keys(o).forEach((function(e){var t=o[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),o}function S(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new _(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new _("unknown",0,e))}})),t}function T(e,t){t.forEach((function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))}function A(e,t,n,i,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(t),u=i===e.FRAGMENT_SHADER?"fragment":"vertex";P(n,"string",u+" shader source must be a string",a);var l=x(n,a),c=S(s);T(l,c),Object.keys(l).forEach((function(e){var t=l[e];if(t.hasErrors){var n=[""],i=[""];a("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){a(m(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),a(e.line+r,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(n){var i=n.message,o=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(o){var s=o[1];switch(i=o[2],s){case"assign":s="="}t=Math.max(e.line.indexOf(s,t),0)}else t=0;a(m("| ",6)),a(m("^^^",t+3)+r,"font-weight:bold"),a(m("| ",6)),a(i+r,"font-weight:bold")})),a(m("| ",6)+r)}else a(m(e.number,4)+"|  "),a(e.line+r,"color:red")})),"undefined"==typeof document||window.chrome?console.log(n.join("")):(i[0]=n.join("%c"),console.log.apply(console,i))}function a(e,t){n.push(e),i.push(t||"")}})),o.raise("Error compiling "+u+" shader, "+l[0].name)}}function w(e,t,n,i,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var s=e.getProgramInfoLog(t),u=x(n,a),l='Error linking program with vertex shader, "'+x(i,a)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+l+r+"%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(l+r+s),o.raise(l)}}function C(e){e._commandRef=b()}function k(e,t,n,r){function i(e){return e?r.id(e):0}function a(e,t){Object.keys(t).forEach((function(t){e[r.id(t)]=!0}))}C(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var o=e._uniformSet={};a(o,t.static),a(o,t.dynamic);var s=e._attributeSet={};a(s,n.static),a(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function O(e,t){var n=E();a(e+" in command "+(t||b())+("unknown"===n?"":" called from "+n))}function M(e,t,n){e||O(t,n||b())}function R(e,t,n,r){e in t||O("unknown parameter ("+e+")"+s(n)+". possible values: "+Object.keys(t).join(),r||b())}function P(e,t,n,r){c(e,t)||O("invalid parameter type"+s(n)+". expected "+t+", got "+typeof e,r||b())}function I(e){e()}function L(e,t,n){e.texture?h(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):h(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var N=33071,D=9728,F=9984,j=9985,U=9986,B=9987,z=5121,V=5122,H=5123,G=5124,W=5125,X=5126,Y=32819,q=32820,Z=33635,K=34042,Q=36193,J={};function $(e,t){return e===q||e===Y||e===Z?2:e===K?4:J[e]*t}function ee(e){return!(e&e-1||!e)}function te(e,t,n){var r,i=t.width,a=t.height,s=t.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),e.wrapS===N&&e.wrapT===N||o(ee(i)&&ee(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==i&&1!==a&&o(e.minFilter!==F&&e.minFilter!==U&&e.minFilter!==j&&e.minFilter!==B,"min filter requires mipmap"):(o(ee(i)&&ee(a),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),t.type===X&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(e.minFilter===D&&e.magFilter===D,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(r=0;r<16;++r)if(u[r]){var l=i>>r,c=a>>r;o(t.mipmask&1<<r,"missing mipmap data");var f=u[r];if(o(f.width===l&&f.height===c,"invalid shape for mip images"),o(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed);else if(f.data){var p=Math.ceil($(f.type,s)*l/f.unpackAlignment)*f.unpackAlignment;o(f.data.byteLength===p*c,"invalid data for image, buffer size is inconsistent with image format")}else f.element||f.copy}else e.genMipmaps||o(0==(t.mipmask&1<<r),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")}function ne(e,t,n,r){var i=e.width,a=e.height,s=e.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(t.wrapS===N&&t.wrapT===N,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var l=n[u];o(l.width===i&&l.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(o(!l.compressed,"can not generate mipmap for compressed textures"),o(1===l.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=l.images,f=0;f<16;++f){var p=c[f];if(p){var h=i>>f,d=a>>f;o(l.mipmask&1<<f,"missing mipmap data"),o(p.width===h&&p.height===d,"invalid shape for mip images"),o(p.format===e.format&&p.internalformat===e.internalformat&&p.type===e.type,"incompatible type for mip image"),p.compressed||(p.data?o(p.data.byteLength===h*d*Math.max($(p.type,s),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):p.element||p.copy)}}}}J[5120]=J[z]=1,J[V]=J[H]=J[Q]=J[Z]=J[Y]=J[q]=2,J[G]=J[W]=J[X]=J[K]=4;var re=n(o,{optional:I,raise:a,commandRaise:O,command:M,parameter:u,commandParameter:R,constructor:v,type:f,commandType:P,isTypedArray:l,nni:p,oneOf:h,shaderError:A,linkError:w,callSite:E,saveCommandRef:C,saveDrawInfo:k,framebufferFormat:L,guessCommand:b,texture2D:te,textureCube:ne}),ie=0,ae=0,oe=5,se=6;function ue(e,t){this.id=ie++,this.type=e,this.data=t}function le(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ce(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+le(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return ce(e.substr(0,r.index)).concat(ce(r[1])).concat(ce(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+le(e)+'"'];for(var a=[],o=0;o<i.length;++o)a=a.concat(ce(i[o]));return a}function fe(e){return"["+ce(e).join("][")+"]"}function pe(e,t){return new ue(e,fe(t+""))}function he(e){return"function"==typeof e&&!e._reglType||e instanceof ue}function de(e,t){return"function"==typeof e?new ue(ae,e):"number"==typeof e||"boolean"==typeof e?new ue(oe,e):Array.isArray(e)?new ue(se,e.map((function(e,n){return de(e,t+"["+n+"]")}))):e instanceof ue?e:void re(!1,"invalid option type in uniform "+t)}var ve={DynamicVariable:ue,define:pe,isDynamic:he,unbox:de,accessor:fe},me={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},ye="undefined"!=typeof my&&my&&"function"==typeof my.showToast?function(){return+new Date}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function ge(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function _e(e,t,r){var i,a=document.createElement("canvas");function o(){var t=window.innerWidth,n=window.innerHeight;if(e!==document.body){var i=a.getBoundingClientRect();t=i.right-i.left,n=i.bottom-i.top}a.width=r*t,a.height=r*n}function s(){i?i.disconnect():window.removeEventListener("resize",o),e.removeChild(a)}return n(a.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),e.appendChild(a),e===document.body&&(a.style.position="absolute",n(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(o)}))).observe(e):window.addEventListener("resize",o,!1),o(),{canvas:a,onDestroy:s}}function be(e,t){function n(n){try{return e.getContext(n,t)}catch(r){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function Ee(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function xe(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function Se(e){return"string"==typeof e?e.split():(re(Array.isArray(e),"invalid extension array"),e)}function Te(e){return"string"==typeof e?(re("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function Ae(e){var t,n,r,i,a=e||{},o={},s=[],u=[],l="undefined"==typeof window?1:window.devicePixelRatio,c=!1,f=function(e){e&&re.raise(e)},p=function(){};if("string"==typeof a?(re("undefined"!=typeof document,"selector queries only supported in DOM environments"),t=document.querySelector(a),re(t,"invalid query string for element")):"object"==typeof a?Ee(a)?t=a:xe(a)?r=(i=a).canvas:(re.constructor(a),"gl"in a?i=a.gl:"canvas"in a?r=Te(a.canvas):"container"in a&&(n=Te(a.container)),"attributes"in a&&(o=a.attributes,re.type(o,"object","invalid context attributes")),"extensions"in a&&(s=Se(a.extensions)),"optionalExtensions"in a&&(u=Se(a.optionalExtensions)),"onDone"in a&&(re.type(a.onDone,"function","invalid or missing onDone callback"),f=a.onDone),"profile"in a&&(c=!!a.profile),"pixelRatio"in a&&(l=+a.pixelRatio,re(l>0,"invalid pixel ratio"))):re.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!i){if(!r){re("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var h=_e(n||document.body,f,l);if(!h)return null;r=h.canvas,p=h.onDestroy}void 0===o.premultipliedAlpha&&(o.premultipliedAlpha=!0),i=be(r,o)}return i?{gl:i,canvas:r,container:n,extensions:s,optionalExtensions:u,pixelRatio:l,profile:c,onDone:f,onDestroy:p}:(p(),f("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function we(e,t){var n={};function r(e){re.type(e,"string","extension name must be string");var t,r=e.toLowerCase();try{t=n[r]=i(e)}catch(a){}return!!t}function i(t){return e.getExtension(t)?e.getExtension(t):e.getExtension(t.toLowerCase())?e.getExtension(t.toLowerCase()):null}for(var a=0;a<t.extensions.length;++a){var o=t.extensions[a];if(!r(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!r(e))throw new Error("(regl): error restoring extension "+e)}))}}}function Ce(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}var ke=5120,Oe=5121,Me=5122,Re=5123,Pe=5124,Ie=5125,Le=5126;function Ne(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function De(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function Fe(){var e=Ce(8,(function(){return[]}));function t(t){var n=Ne(t),r=e[De(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(t){e[De(t.byteLength)>>2].push(t)}function r(e,n){var r=null;switch(e){case ke:r=new Int8Array(t(n),0,n);break;case Oe:r=new Uint8Array(t(n),0,n);break;case Me:r=new Int16Array(t(2*n),0,n);break;case Re:r=new Uint16Array(t(2*n),0,n);break;case Pe:r=new Int32Array(t(4*n),0,n);break;case Ie:r=new Uint32Array(t(4*n),0,n);break;case Le:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r}function i(e){n(e.buffer)}return{alloc:t,free:n,allocType:r,freeType:i}}var je=Fe();je.zero=Fe();var Ue=3408,Be=3410,ze=3411,Ve=3412,He=3413,Ge=3414,We=3415,Xe=33901,Ye=33902,qe=3379,Ze=3386,Ke=34921,Qe=36347,Je=36348,$e=35661,et=35660,tt=34930,nt=36349,rt=34076,it=34024,at=7936,ot=7937,st=7938,ut=35724,lt=34047,ct=36063,ft=34852,pt=3553,ht=34067,dt=34069,vt=33984,mt=6408,yt=5126,gt=5121,_t=36160,bt=36053,Et=36064,xt=16384,St=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(lt));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(ft),i=e.getParameter(ct));var a=!!t.oes_texture_float;if(a){var o=e.createTexture();e.bindTexture(pt,o),e.texImage2D(pt,0,mt,1,1,0,mt,yt,null);var s=e.createFramebuffer();if(e.bindFramebuffer(_t,s),e.framebufferTexture2D(_t,Et,pt,o,0),e.bindTexture(pt,null),e.checkFramebufferStatus(_t)!==bt)a=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(xt);var u=je.allocType(yt,4);e.readPixels(0,0,1,1,mt,yt,u),e.getError()?a=!1:(e.deleteFramebuffer(s),e.deleteTexture(o),a=1===u[0]),je.freeType(u)}}var l=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var c=e.createTexture(),f=je.allocType(gt,36);e.activeTexture(vt),e.bindTexture(ht,c),e.texImage2D(dt,0,mt,3,3,0,mt,gt,f),je.freeType(f),e.bindTexture(ht,null),e.deleteTexture(c),l=!e.getError()}return{colorBits:[e.getParameter(Be),e.getParameter(ze),e.getParameter(Ve),e.getParameter(He)],depthBits:e.getParameter(Ge),stencilBits:e.getParameter(We),subpixelBits:e.getParameter(Ue),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(Xe),lineWidthDims:e.getParameter(Ye),maxViewportDims:e.getParameter(Ze),maxCombinedTextureUnits:e.getParameter($e),maxCubeMapSize:e.getParameter(rt),maxRenderbufferSize:e.getParameter(it),maxTextureUnits:e.getParameter(tt),maxTextureSize:e.getParameter(qe),maxAttributes:e.getParameter(Ke),maxVertexUniforms:e.getParameter(Qe),maxVertexTextureUnits:e.getParameter(et),maxVaryingVectors:e.getParameter(Je),maxFragmentUniforms:e.getParameter(nt),glsl:e.getParameter(ut),renderer:e.getParameter(ot),vendor:e.getParameter(at),version:e.getParameter(st),readFloat:a,npotTextureCube:l}};function Tt(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var At=function(e){return Object.keys(e).map((function(t){return e[t]}))},wt={shape:Pt,flatten:Rt};function Ct(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function kt(e,t,n,r){for(var i=0,a=0;a<t;++a)for(var o=e[a],s=0;s<n;++s)r[i++]=o[s]}function Ot(e,t,n,r,i,a){for(var o=a,s=0;s<t;++s)for(var u=e[s],l=0;l<n;++l)for(var c=u[l],f=0;f<r;++f)i[o++]=c[f]}function Mt(e,t,n,r,i){for(var a=1,o=n+1;o<t.length;++o)a*=t[o];var s=t[n];if(t.length-n==4){var u=t[n+1],l=t[n+2],c=t[n+3];for(o=0;o<s;++o)Ot(e[o],u,l,c,r,i),i+=a}else for(o=0;o<s;++o)Mt(e[o],t,n+1,r,i),i+=a}function Rt(e,t,n,r){var i=1;if(t.length)for(var a=0;a<t.length;++a)i*=t[a];else i=0;var o=r||je.allocType(n,i);switch(t.length){case 0:break;case 1:Ct(e,t[0],o);break;case 2:kt(e,t[0],t[1],o);break;case 3:Ot(e,t[0],t[1],t[2],o,0);break;default:Mt(e,t,0,o,0)}return o}function Pt(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t}var It={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Lt={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Nt={dynamic:35048,stream:35040,static:35044},Dt=wt.flatten,Ft=wt.shape,jt=35044,Ut=35040,Bt=5121,zt=5126,Vt=[];function Ht(e){return 0|It[Object.prototype.toString.call(e)]}function Gt(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function Wt(e,t,n,r,i,a,o){for(var s=0,u=0;u<n;++u)for(var l=0;l<r;++l)e[s++]=t[i*u+a*l+o]}function Xt(e,n,r,i){var a=0,o={};function s(t){this.id=a++,this.buffer=e.createBuffer(),this.type=t,this.usage=jt,this.byteLength=0,this.dimension=1,this.dtype=Bt,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){h(this)};var u=[];function l(e,t){var n=u.pop();return n||(n=new s(e)),n.bind(),p(n,t,Ut,0,1,!1),n}function c(e){u.push(e)}function f(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function p(e,n,r,i,a,o){var s,u;if(e.usage=r,Array.isArray(n)){if(e.dtype=i||zt,n.length>0)if(Array.isArray(n[0])){s=Ft(n);for(var l=1,c=1;c<s.length;++c)l*=s[c];e.dimension=l,f(e,u=Dt(n,s,e.dtype),r),o?e.persistentData=u:je.freeType(u)}else if("number"==typeof n[0]){e.dimension=a;var p=je.allocType(e.dtype,n.length);Gt(p,n),f(e,p,r),o?e.persistentData=p:je.freeType(p)}else t(n[0])?(e.dimension=n[0].length,e.dtype=i||Ht(n[0])||zt,f(e,u=Dt(n,[n.length,n[0].length],e.dtype),r),o?e.persistentData=u:je.freeType(u)):re.raise("invalid buffer data")}else if(t(n))e.dtype=i||Ht(n),e.dimension=a,f(e,n,r),o&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(Tt(n)){s=n.shape;var h=n.stride,d=n.offset,v=0,m=0,y=0,g=0;1===s.length?(v=s[0],m=1,y=h[0],g=0):2===s.length?(v=s[0],m=s[1],y=h[0],g=h[1]):re.raise("invalid shape"),e.dtype=i||Ht(n.data)||zt,e.dimension=m;var _=je.allocType(e.dtype,v*m);Wt(_,n.data,v,m,y,g,d),f(e,_,r),o?e.persistentData=_:je.freeType(_)}else n instanceof ArrayBuffer?(e.dtype=Bt,e.dimension=a,f(e,n,r),o&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):re.raise("invalid buffer data")}function h(t){n.bufferCount--,i(t);var r=t.buffer;re(r,"buffer must not be deleted already"),e.deleteBuffer(r),t.buffer=null,delete o[t.id]}function d(i,a,u,l){n.bufferCount++;var c=new s(a);function f(n){var i=jt,a=null,o=0,s=0,u=1;return Array.isArray(n)||t(n)||Tt(n)||n instanceof ArrayBuffer?a=n:"number"==typeof n?o=0|n:n&&(re.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(re(null===a||Array.isArray(a)||t(a)||Tt(a),"invalid data for buffer"),a=n.data),"usage"in n&&(re.parameter(n.usage,Nt,"invalid buffer usage"),i=Nt[n.usage]),"type"in n&&(re.parameter(n.type,Lt,"invalid buffer type"),s=Lt[n.type]),"dimension"in n&&(re.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(re.nni(o,"buffer length must be a nonnegative integer"),o=0|n.length)),c.bind(),a?p(c,a,i,s,u,l):(o&&e.bufferData(c.type,o,i),c.dtype=s||Bt,c.usage=i,c.dimension=u,c.byteLength=o),r.profile&&(c.stats.size=c.byteLength*Vt[c.dtype]),f}function d(t,n){re(n+t.byteLength<=c.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+c.byteLength),e.bufferSubData(c.type,n,t)}function v(e,n){var r,i=0|(n||0);if(c.bind(),t(e)||e instanceof ArrayBuffer)d(e,i);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var a=je.allocType(c.dtype,e.length);Gt(a,e),d(a,i),je.freeType(a)}else if(Array.isArray(e[0])||t(e[0])){r=Ft(e);var o=Dt(e,r,c.dtype);d(o,i),je.freeType(o)}else re.raise("invalid buffer data")}else if(Tt(e)){r=e.shape;var s=e.stride,u=0,l=0,p=0,h=0;1===r.length?(u=r[0],l=1,p=s[0],h=0):2===r.length?(u=r[0],l=r[1],p=s[0],h=s[1]):re.raise("invalid shape");var v=Array.isArray(e.data)?c.dtype:Ht(e.data),m=je.allocType(v,u*l);Wt(m,e.data,u,l,p,h,e.offset),d(m,i),je.freeType(m)}else re.raise("invalid data for buffer subdata");return f}return o[c.id]=c,u||f(i),f._reglType="buffer",f._buffer=c,f.subdata=v,r.profile&&(f.stats=c.stats),f.destroy=function(){h(c)},f}function v(){At(o).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return r.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(o).forEach((function(t){e+=o[t].stats.size})),e}),{create:d,createStream:l,destroyStream:c,clear:function(){At(o).forEach(h),u.forEach(h)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:v,_initBuffer:p}}Vt[5120]=1,Vt[5122]=2,Vt[5124]=4,Vt[5121]=1,Vt[5123]=2,Vt[5125]=4,Vt[5126]=4;var Yt={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},qt=0,Zt=1,Kt=4,Qt=5120,Jt=5121,$t=5122,en=5123,tn=5124,nn=5125,rn=34963,an=35040,on=35044;function sn(e,n,r,i){var a={},o=0,s={uint8:Jt,uint16:en};function u(e){this.id=o++,a[this.id]=this,this.buffer=e,this.primType=Kt,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=nn),u.prototype.bind=function(){this.buffer.bind()};var l=[];function c(e){var t=l.pop();return t||(t=new u(r.create(null,rn,!0,!1)._buffer)),p(t,e,an,-1,-1,0,0),t}function f(e){l.push(e)}function p(i,a,o,s,u,l,c){var f;if(i.buffer.bind(),a){var p=c;c||t(a)&&(!Tt(a)||t(a.data))||(p=n.oes_element_index_uint?nn:en),r._initBuffer(i.buffer,a,o,p,3)}else e.bufferData(rn,l,o),i.buffer.dtype=f||Jt,i.buffer.usage=o,i.buffer.dimension=3,i.buffer.byteLength=l;if(f=c,!c){switch(i.buffer.dtype){case Jt:case Qt:f=Jt;break;case en:case $t:f=en;break;case nn:case tn:f=nn;break;default:re.raise("unsupported type for element array")}i.buffer.dtype=f}i.type=f,re(f!==nn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var h=u;h<0&&(h=i.buffer.byteLength,f===en?h>>=1:f===nn&&(h>>=2)),i.vertCount=h;var d=s;if(s<0){d=Kt;var v=i.buffer.dimension;1===v&&(d=qt),2===v&&(d=Zt),3===v&&(d=Kt)}i.primType=d}function h(e){i.elementsCount--,re(null!==e.buffer,"must not double destroy elements"),delete a[e.id],e.buffer.destroy(),e.buffer=null}function d(e,n){var a=r.create(null,rn,!0),o=new u(a._buffer);function l(e){if(e)if("number"==typeof e)a(e),o.primType=Kt,o.vertCount=0|e,o.type=Jt;else{var n=null,r=on,i=-1,u=-1,c=0,f=0;Array.isArray(e)||t(e)||Tt(e)?n=e:(re.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,re(Array.isArray(n)||t(n)||Tt(n),"invalid data for element buffer")),"usage"in e&&(re.parameter(e.usage,Nt,"invalid element buffer usage"),r=Nt[e.usage]),"primitive"in e&&(re.parameter(e.primitive,Yt,"invalid element buffer primitive"),i=Yt[e.primitive]),"count"in e&&(re("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),u=0|e.count),"type"in e&&(re.parameter(e.type,s,"invalid buffer type"),f=s[e.type]),"length"in e?c=0|e.length:(c=u,f===en||f===$t?c*=2:f!==nn&&f!==tn||(c*=4))),p(o,n,r,i,u,c,f)}else a(),o.primType=Kt,o.vertCount=0,o.type=Jt;return l}return i.elementsCount++,l(e),l._reglType="elements",l._elements=o,l.subdata=function(e,t){return a.subdata(e,t),l},l.destroy=function(){h(o)},l}return{create:d,createStream:c,destroyStream:f,getElements:function(e){return"function"==typeof e&&e._elements instanceof u?e._elements:null},clear:function(){At(a).forEach(h)}}}var un=new Float32Array(1),ln=new Uint32Array(un.buffer),cn=5123;function fn(e){for(var t=je.allocType(cn,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{un[0]=e[n];var r=ln[0],i=r>>>31<<15,a=(r<<1>>>24)-127,o=r>>13&1023;if(a<-24)t[n]=i;else if(a<-14){var s=-14-a;t[n]=i+(o+1024>>s)}else t[n]=a>15?i+31744:i+(a+15<<10)+o}return t}function pn(e){return Array.isArray(e)||t(e)}var hn=function(e){return!(e&e-1||!e)},dn=34467,vn=3553,mn=34067,yn=34069,gn=6408,_n=6406,bn=6407,En=6409,xn=6410,Sn=32854,Tn=32855,An=36194,wn=32819,Cn=32820,kn=33635,On=34042,Mn=6402,Rn=34041,Pn=35904,In=35906,Ln=36193,Nn=33776,Dn=33777,Fn=33778,jn=33779,Un=35986,Bn=35987,zn=34798,Vn=35840,Hn=35841,Gn=35842,Wn=35843,Xn=36196,Yn=5121,qn=5123,Zn=5125,Kn=5126,Qn=10242,Jn=10243,$n=10497,er=33071,tr=33648,nr=10240,rr=10241,ir=9728,ar=9729,or=9984,sr=9985,ur=9986,lr=9987,cr=33170,fr=4352,pr=4353,hr=4354,dr=34046,vr=3317,mr=37440,yr=37441,gr=37443,_r=37444,br=33984,Er=[or,ur,sr,lr],xr=[0,En,xn,bn,gn],Sr={};function Tr(e){return"[object "+e+"]"}Sr[En]=Sr[_n]=Sr[Mn]=1,Sr[Rn]=Sr[xn]=2,Sr[bn]=Sr[Pn]=3,Sr[gn]=Sr[In]=4;var Ar=Tr("HTMLCanvasElement"),wr=Tr("OffscreenCanvas"),Cr=Tr("CanvasRenderingContext2D"),kr=Tr("ImageBitmap"),Or=Tr("HTMLImageElement"),Mr=Tr("HTMLVideoElement"),Rr=Object.keys(It).concat([Ar,wr,Cr,kr,Or,Mr]),Pr=[];Pr[Yn]=1,Pr[Kn]=4,Pr[Ln]=2,Pr[qn]=2,Pr[Zn]=4;var Ir=[];function Lr(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Nr(e){return!!Array.isArray(e)&&!(0===e.length||!pn(e[0]))}function Dr(e){return Object.prototype.toString.call(e)}function Fr(e){return Dr(e)===Ar}function jr(e){return Dr(e)===wr}function Ur(e){return Dr(e)===Cr}function Br(e){return Dr(e)===kr}function zr(e){return Dr(e)===Or}function Vr(e){return Dr(e)===Mr}function Hr(e){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&e&&e.getContext)}function Gr(e){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&e&&"src"in e&&"crossOrigin"in e)}function Wr(e){if(!e)return!1;if(Hr(e)||Gr(e))return!0;var t=Dr(e);return Rr.indexOf(t)>=0||Lr(e)||Nr(e)||Tt(e)}function Xr(e){return 0|It[Object.prototype.toString.call(e)]}function Yr(e,t){var n=t.length;switch(e.type){case Yn:case qn:case Zn:case Kn:var r=je.allocType(e.type,n);r.set(t),e.data=r;break;case Ln:e.data=fn(t);break;default:re.raise("unsupported texture type, must specify a typed array")}}function qr(e,t){return je.allocType(e.type===Ln?Kn:e.type,t)}function Zr(e,t){e.type===Ln?(e.data=fn(t),je.freeType(t)):e.data=t}function Kr(e,t,n,r,i,a){for(var o=e.width,s=e.height,u=e.channels,l=qr(e,o*s*u),c=0,f=0;f<s;++f)for(var p=0;p<o;++p)for(var h=0;h<u;++h)l[c++]=t[n*p+r*f+i*h+a];Zr(e,l)}function Qr(e,t,n,r,i,a){var o;if(o=void 0!==Ir[e]?Ir[e]:Sr[e]*Pr[t],a&&(o*=6),i){for(var s=0,u=n;u>=1;)s+=o*u*u,u/=2;return s}return o*n*r}function Jr(e,r,i,a,o,s,u){var l={"don't care":fr,"dont care":fr,nice:hr,fast:pr},c={repeat:$n,clamp:er,mirror:tr},f={nearest:ir,linear:ar},p=n({mipmap:lr,"nearest mipmap nearest":or,"linear mipmap nearest":sr,"nearest mipmap linear":ur,"linear mipmap linear":lr},f),h={none:0,browser:_r},d={uint8:Yn,rgba4:wn,rgb565:kn,"rgb5 a1":Cn},v={alpha:_n,luminance:En,"luminance alpha":xn,rgb:bn,rgba:gn,rgba4:Sn,"rgb5 a1":Tn,rgb565:An},m={};r.ext_srgb&&(v.srgb=Pn,v.srgba=In),r.oes_texture_float&&(d.float32=d.float=Kn),r.oes_texture_half_float&&(d.float16=d["half float"]=Ln),r.webgl_depth_texture&&(n(v,{depth:Mn,"depth stencil":Rn}),n(d,{uint16:qn,uint32:Zn,"depth stencil":On})),r.webgl_compressed_texture_s3tc&&n(m,{"rgb s3tc dxt1":Nn,"rgba s3tc dxt1":Dn,"rgba s3tc dxt3":Fn,"rgba s3tc dxt5":jn}),r.webgl_compressed_texture_atc&&n(m,{"rgb atc":Un,"rgba atc explicit alpha":Bn,"rgba atc interpolated alpha":zn}),r.webgl_compressed_texture_pvrtc&&n(m,{"rgb pvrtc 4bppv1":Vn,"rgb pvrtc 2bppv1":Hn,"rgba pvrtc 4bppv1":Gn,"rgba pvrtc 2bppv1":Wn}),r.webgl_compressed_texture_etc1&&(m["rgb etc1"]=Xn);var y=Array.prototype.slice.call(e.getParameter(dn)||new Uint32Array(0));Object.keys(m).forEach((function(e){var t=m[e];y.indexOf(t)>=0&&(v[e]=t)}));var g=Object.keys(v);i.textureFormats=g;var _=[];Object.keys(v).forEach((function(e){var t=v[e];_[t]=e}));var b=[];Object.keys(d).forEach((function(e){var t=d[e];b[t]=e}));var E=[];Object.keys(f).forEach((function(e){var t=f[e];E[t]=e}));var x=[];Object.keys(p).forEach((function(e){var t=p[e];x[t]=e}));var S=[];Object.keys(c).forEach((function(e){var t=c[e];S[t]=e}));var T=g.reduce((function(e,t){var n=v[t];return n===En||n===_n||n===En||n===xn||n===Mn||n===Rn||r.ext_srgb&&(n===Pn||n===In)?e[n]=n:n===Tn||t.indexOf("rgba")>=0?e[n]=gn:e[n]=bn,e}),{});function A(){this.internalformat=gn,this.format=gn,this.type=Yn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=_r,this.width=0,this.height=0,this.channels=0}function w(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function C(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(re.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(re.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(re.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(re.parameter(t.colorSpace,h,"invalid colorSpace"),e.colorSpace=h[t.colorSpace]),"type"in t){var n=t.type;re(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),re(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),re(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),re.parameter(n,d,"invalid texture type"),e.type=d[n]}var a=e.width,o=e.height,s=e.channels,u=!1;"shape"in t?(re(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),a=t.shape[0],o=t.shape[1],3===t.shape.length&&(s=t.shape[2],re(s>0&&s<=4,"invalid number of channels"),u=!0),re(a>=0&&a<=i.maxTextureSize,"invalid width"),re(o>=0&&o<=i.maxTextureSize,"invalid height")):("radius"in t&&(a=o=t.radius,re(a>=0&&a<=i.maxTextureSize,"invalid radius")),"width"in t&&(a=t.width,re(a>=0&&a<=i.maxTextureSize,"invalid width")),"height"in t&&(o=t.height,re(o>=0&&o<=i.maxTextureSize,"invalid height")),"channels"in t&&(s=t.channels,re(s>0&&s<=4,"invalid number of channels"),u=!0)),e.width=0|a,e.height=0|o,e.channels=0|s;var l=!1;if("format"in t){var c=t.format;re(r.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),re.parameter(c,v,"invalid texture format");var f=e.internalformat=v[c];e.format=T[f],c in d&&("type"in t||(e.type=d[c])),c in m&&(e.compressed=!0),l=!0}!u&&l?e.channels=Sr[e.format]:u&&!l?e.channels!==xr[e.format]&&(e.format=e.internalformat=xr[e.channels]):l&&u&&re(e.channels===Sr[e.format],"number of channels inconsistent with specified format")}}function k(t){e.pixelStorei(mr,t.flipY),e.pixelStorei(yr,t.premultiplyAlpha),e.pixelStorei(gr,t.colorSpace),e.pixelStorei(vr,t.unpackAlignment)}function O(){A.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function M(e,n){var r=null;if(Wr(n)?r=n:n&&(re.type(n,"object","invalid pixel data type"),C(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),Wr(n.data)&&(r=n.data)),re(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){re(!r,"can not specify copy and data field for the same texture");var a=o.viewportWidth,s=o.viewportHeight;e.width=e.width||a-e.xOffset,e.height=e.height||s-e.yOffset,e.needsCopy=!0,re(e.xOffset>=0&&e.xOffset<a&&e.yOffset>=0&&e.yOffset<s&&e.width>0&&e.width<=a&&e.height>0&&e.height<=s,"copy texture read out of bounds")}else if(r){if(t(r))e.channels=e.channels||4,e.data=r,"type"in n||e.type!==Yn||(e.type=Xr(r));else if(Lr(r))e.channels=e.channels||4,Yr(e,r),e.alignment=1,e.needsFree=!0;else if(Tt(r)){var u=r.data;Array.isArray(u)||e.type!==Yn||(e.type=Xr(u));var l,c,f,p,h,d,v=r.shape,m=r.stride;3===v.length?(f=v[2],d=m[2]):(re(2===v.length,"invalid ndarray pixel data, must be 2 or 3D"),f=1,d=1),l=v[0],c=v[1],p=m[0],h=m[1],e.alignment=1,e.width=l,e.height=c,e.channels=f,e.format=e.internalformat=xr[f],e.needsFree=!0,Kr(e,u,p,h,d,r.offset)}else if(Hr(r)||Fr(r)||jr(r)||Ur(r))Hr(r)||Fr(r)||jr(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(Br(r))e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(zr(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(Gr(r))e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(Vr(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(Nr(r)){var y=e.width||r[0].length,g=e.height||r.length,_=e.channels;_=pn(r[0][0])?_||r[0][0].length:_||1;for(var b=wt.shape(r),E=1,x=0;x<b.length;++x)E*=b[x];var S=qr(e,E);wt.flatten(r,b,"",S),Zr(e,S),e.alignment=1,e.width=y,e.height=g,e.channels=_,e.format=e.internalformat=xr[_],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===Kn?re(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Ln&&re(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function R(t,n,r){var i=t.element,o=t.data,s=t.internalformat,u=t.format,l=t.type,c=t.width,f=t.height;k(t),i?e.texImage2D(n,r,u,u,l,i):t.compressed?e.compressedTexImage2D(n,r,s,c,f,0,o):t.needsCopy?(a(),e.copyTexImage2D(n,r,u,t.xOffset,t.yOffset,c,f,0)):e.texImage2D(n,r,u,c,f,0,u,l,o||null)}function P(t,n,r,i,o){var s=t.element,u=t.data,l=t.internalformat,c=t.format,f=t.type,p=t.width,h=t.height;k(t),s?e.texSubImage2D(n,o,r,i,c,f,s):t.compressed?e.compressedTexSubImage2D(n,o,r,i,l,p,h,u):t.needsCopy?(a(),e.copyTexSubImage2D(n,o,r,i,t.xOffset,t.yOffset,p,h)):e.texSubImage2D(n,o,r,i,p,h,c,f,u)}var I=[];function L(){return I.pop()||new O}function N(e){e.needsFree&&je.freeType(e.data),O.call(e),I.push(e)}function D(){A.call(this),this.genMipmaps=!1,this.mipmapHint=fr,this.mipmask=0,this.images=Array(16)}function F(e,t,n){var r=e.images[0]=L();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function j(e,t){var n=null;if(Wr(t))w(n=e.images[0]=L(),e),M(n,t),e.mipmask=1;else if(C(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)w(n=e.images[i]=L(),e),n.width>>=i,n.height>>=i,M(n,r[i]),e.mipmask|=1<<i;else w(n=e.images[0]=L(),e),M(n,t),e.mipmask=1;w(e,e.images[0]),!e.compressed||e.internalformat!==Nn&&e.internalformat!==Dn&&e.internalformat!==Fn&&e.internalformat!==jn||re(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function U(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;R(n[r],t,r)}}var B=[];function z(){var e=B.pop()||new D;A.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function V(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&N(t[n]),t[n]=null;B.push(e)}function H(){this.minFilter=ir,this.magFilter=ir,this.wrapS=er,this.wrapT=er,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=fr}function G(e,t){if("min"in t){var n=t.min;re.parameter(n,p),e.minFilter=p[n],Er.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var r=t.mag;re.parameter(r,f),e.magFilter=f[r]}var a=e.wrapS,o=e.wrapT;if("wrap"in t){var s=t.wrap;"string"==typeof s?(re.parameter(s,c),a=o=c[s]):Array.isArray(s)&&(re.parameter(s[0],c),re.parameter(s[1],c),a=c[s[0]],o=c[s[1]])}else{if("wrapS"in t){var u=t.wrapS;re.parameter(u,c),a=c[u]}if("wrapT"in t){var h=t.wrapT;re.parameter(h,c),o=c[h]}}if(e.wrapS=a,e.wrapT=o,"anisotropic"in t){var d=t.anisotropic;re("number"==typeof d&&d>=1&&d<=i.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var v=!1;switch(typeof t.mipmap){case"string":re.parameter(t.mipmap,l,"invalid mipmap hint"),e.mipmapHint=l[t.mipmap],e.genMipmaps=!0,v=!0;break;case"boolean":v=e.genMipmaps=t.mipmap;break;case"object":re(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,v=!0;break;default:re.raise("invalid mipmap type")}v&&!("min"in t)&&(e.minFilter=or)}}function W(t,n){e.texParameteri(n,rr,t.minFilter),e.texParameteri(n,nr,t.magFilter),e.texParameteri(n,Qn,t.wrapS),e.texParameteri(n,Jn,t.wrapT),r.ext_texture_filter_anisotropic&&e.texParameteri(n,dr,t.anisotropic),t.genMipmaps&&(e.hint(cr,t.mipmapHint),e.generateMipmap(n))}var X=0,Y={},q=i.maxTextureUnits,Z=Array(q).map((function(){return null}));function K(t){A.call(this),this.mipmask=0,this.internalformat=gn,this.id=X++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,u.profile&&(this.stats={size:0})}function Q(t){e.activeTexture(br),e.bindTexture(t.target,t.texture)}function J(){var t=Z[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(vn,null)}function $(t){var n=t.texture;re(n,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(e.activeTexture(br+r),e.bindTexture(i,null),Z[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete Y[t.id],s.textureCount--}function ee(t,n){var r=new K(vn);function a(e,t){var n=r.texInfo;H.call(n);var o=z();return"number"==typeof e?F(o,0|e,"number"==typeof t?0|t:0|e):e?(re.type(e,"object","invalid arguments to regl.texture"),G(n,e),j(o,e)):F(o,1,1),n.genMipmaps&&(o.mipmask=(o.width<<1)-1),r.mipmask=o.mipmask,w(r,o),re.texture2D(n,o,i),r.internalformat=o.internalformat,a.width=o.width,a.height=o.height,Q(r),U(o,vn),W(n,vn),J(),V(o),u.profile&&(r.stats.size=Qr(r.internalformat,r.type,o.width,o.height,n.genMipmaps,!1)),a.format=_[r.internalformat],a.type=b[r.type],a.mag=E[n.magFilter],a.min=x[n.minFilter],a.wrapS=S[n.wrapS],a.wrapT=S[n.wrapT],a}function o(e,t,n,i){re(!!e,"must specify image data");var o=0|t,s=0|n,u=0|i,l=L();return w(l,r),l.width=0,l.height=0,M(l,e),l.width=l.width||(r.width>>u)-o,l.height=l.height||(r.height>>u)-s,re(r.type===l.type&&r.format===l.format&&r.internalformat===l.internalformat,"incompatible format for texture.subimage"),re(o>=0&&s>=0&&o+l.width<=r.width&&s+l.height<=r.height,"texture.subimage write out of bounds"),re(r.mipmask&1<<u,"missing mipmap data"),re(l.data||l.element||l.needsCopy,"missing image data"),Q(r),P(l,vn,o,s,u),J(),N(l),a}function l(t,n){var i=0|t,o=0|n||i;if(i===r.width&&o===r.height)return a;a.width=r.width=i,a.height=r.height=o,Q(r);for(var s=0;r.mipmask>>s;++s){var l=i>>s,c=o>>s;if(!l||!c)break;e.texImage2D(vn,s,r.format,l,c,0,r.format,r.type,null)}return J(),u.profile&&(r.stats.size=Qr(r.internalformat,r.type,i,o,!1,!1)),a}return Y[r.id]=r,s.textureCount++,a(t,n),a.subimage=o,a.resize=l,a._reglType="texture2d",a._texture=r,u.profile&&(a.stats=r.stats),a.destroy=function(){r.decRef()},a}function te(t,n,r,a,o,l){var c=new K(mn);Y[c.id]=c,s.cubeCount++;var f=new Array(6);function p(e,t,n,r,a,o){var s,l=c.texInfo;for(H.call(l),s=0;s<6;++s)f[s]=z();if("number"!=typeof e&&e)if("object"==typeof e)if(t)j(f[0],e),j(f[1],t),j(f[2],n),j(f[3],r),j(f[4],a),j(f[5],o);else if(G(l,e),C(c,e),"faces"in e){var h=e.faces;for(re(Array.isArray(h)&&6===h.length,"cube faces must be a length 6 array"),s=0;s<6;++s)re("object"==typeof h[s]&&!!h[s],"invalid input for cube map face"),w(f[s],c),j(f[s],h[s])}else for(s=0;s<6;++s)j(f[s],e);else re.raise("invalid arguments to cube map");else{var d=0|e||1;for(s=0;s<6;++s)F(f[s],d,d)}for(w(c,f[0]),re.optional((function(){i.npotTextureCube||re(hn(c.width)&&hn(c.height),"your browser does not support non power or two texture dimensions")})),l.genMipmaps?c.mipmask=(f[0].width<<1)-1:c.mipmask=f[0].mipmask,re.textureCube(c,l,f,i),c.internalformat=f[0].internalformat,p.width=f[0].width,p.height=f[0].height,Q(c),s=0;s<6;++s)U(f[s],yn+s);for(W(l,mn),J(),u.profile&&(c.stats.size=Qr(c.internalformat,c.type,p.width,p.height,l.genMipmaps,!0)),p.format=_[c.internalformat],p.type=b[c.type],p.mag=E[l.magFilter],p.min=x[l.minFilter],p.wrapS=S[l.wrapS],p.wrapT=S[l.wrapT],s=0;s<6;++s)V(f[s]);return p}function h(e,t,n,r,i){re(!!t,"must specify image data"),re("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var a=0|n,o=0|r,s=0|i,u=L();return w(u,c),u.width=0,u.height=0,M(u,t),u.width=u.width||(c.width>>s)-a,u.height=u.height||(c.height>>s)-o,re(c.type===u.type&&c.format===u.format&&c.internalformat===u.internalformat,"incompatible format for texture.subimage"),re(a>=0&&o>=0&&a+u.width<=c.width&&o+u.height<=c.height,"texture.subimage write out of bounds"),re(c.mipmask&1<<s,"missing mipmap data"),re(u.data||u.element||u.needsCopy,"missing image data"),Q(c),P(u,yn+e,a,o,s),J(),N(u),p}function d(t){var n=0|t;if(n!==c.width){p.width=c.width=n,p.height=c.height=n,Q(c);for(var r=0;r<6;++r)for(var i=0;c.mipmask>>i;++i)e.texImage2D(yn+r,i,c.format,n>>i,n>>i,0,c.format,c.type,null);return J(),u.profile&&(c.stats.size=Qr(c.internalformat,c.type,p.width,p.height,!1,!0)),p}}return p(t,n,r,a,o,l),p.subimage=h,p.resize=d,p._reglType="textureCube",p._texture=c,u.profile&&(p.stats=c.stats),p.destroy=function(){c.decRef()},p}function ne(){for(var t=0;t<q;++t)e.activeTexture(br+t),e.bindTexture(vn,null),Z[t]=null;At(Y).forEach($),s.cubeCount=0,s.textureCount=0}function ie(){for(var t=0;t<q;++t){var n=Z[t];n&&(n.bindCount=0,n.unit=-1,Z[t]=null)}At(Y).forEach((function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;n<32;++n)if(0!=(t.mipmask&1<<n))if(t.target===vn)e.texImage2D(vn,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)e.texImage2D(yn+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);W(t.texInfo,t.target)}))}function ae(){for(var t=0;t<q;++t){var n=Z[t];n&&(n.bindCount=0,n.unit=-1,Z[t]=null),e.activeTexture(br+t),e.bindTexture(vn,null),e.bindTexture(mn,null)}}return n(K.prototype,{bind:function(){var t=this;t.bindCount+=1;var n=t.unit;if(n<0){for(var r=0;r<q;++r){var i=Z[r];if(i){if(i.bindCount>0)continue;i.unit=-1}Z[r]=t,n=r;break}n>=q&&re.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<n+1&&(s.maxTextureUnits=n+1),t.unit=n,e.activeTexture(br+n),e.bindTexture(t.target,t.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$(this)}}),u.profile&&(s.getTotalTextureSize=function(){var e=0;return Object.keys(Y).forEach((function(t){e+=Y[t].stats.size})),e}),{create2D:ee,createCube:te,clear:ne,getTexture:function(e){return null},restore:ie,refresh:ae}}Ir[Sn]=2,Ir[Tn]=2,Ir[An]=2,Ir[Rn]=4,Ir[Nn]=.5,Ir[Dn]=.5,Ir[Fn]=1,Ir[jn]=1,Ir[Un]=.5,Ir[Bn]=1,Ir[zn]=1,Ir[Vn]=.5,Ir[Hn]=.25,Ir[Gn]=.5,Ir[Wn]=.25,Ir[Xn]=.5;var $r=36161,ei=32854,ti=32855,ni=36194,ri=33189,ii=36168,ai=34041,oi=35907,si=34836,ui=34842,li=34843,ci=[];function fi(e,t,n){return ci[e]*t*n}ci[ei]=2,ci[ti]=2,ci[ni]=2,ci[ri]=2,ci[ii]=1,ci[ai]=4,ci[oi]=4,ci[si]=16,ci[ui]=8,ci[li]=6;var pi=function(e,t,n,r,i){var a={rgba4:ei,rgb565:ni,"rgb5 a1":ti,depth:ri,stencil:ii,"depth stencil":ai};t.ext_srgb&&(a.srgba=oi),t.ext_color_buffer_half_float&&(a.rgba16f=ui,a.rgb16f=li),t.webgl_color_buffer_float&&(a.rgba32f=si);var o=[];Object.keys(a).forEach((function(e){var t=a[e];o[t]=e}));var s=0,u={};function l(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=ei,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function c(t){var n=t.renderbuffer;re(n,"must not double destroy renderbuffer"),e.bindRenderbuffer($r,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete u[t.id],r.renderbufferCount--}function f(t,s){var c=new l(e.createRenderbuffer());function f(t,r){var s=0,u=0,l=ei;if("object"==typeof t&&t){var p=t;if("shape"in p){var h=p.shape;re(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),s=0|h[0],u=0|h[1]}else"radius"in p&&(s=u=0|p.radius),"width"in p&&(s=0|p.width),"height"in p&&(u=0|p.height);"format"in p&&(re.parameter(p.format,a,"invalid renderbuffer format"),l=a[p.format])}else"number"==typeof t?(s=0|t,u="number"==typeof r?0|r:s):t?re.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(re(s>0&&u>0&&s<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==c.width||u!==c.height||l!==c.format)return f.width=c.width=s,f.height=c.height=u,c.format=l,e.bindRenderbuffer($r,c.renderbuffer),e.renderbufferStorage($r,l,s,u),re(0===e.getError(),"invalid render buffer format"),i.profile&&(c.stats.size=fi(c.format,c.width,c.height)),f.format=o[c.format],f}function p(t,r){var a=0|t,o=0|r||a;return a===c.width&&o===c.height||(re(a>0&&o>0&&a<=n.maxRenderbufferSize&&o<=n.maxRenderbufferSize,"invalid renderbuffer size"),f.width=c.width=a,f.height=c.height=o,e.bindRenderbuffer($r,c.renderbuffer),e.renderbufferStorage($r,c.format,a,o),re(0===e.getError(),"invalid render buffer format"),i.profile&&(c.stats.size=fi(c.format,c.width,c.height))),f}return u[c.id]=c,r.renderbufferCount++,f(t,s),f.resize=p,f._reglType="renderbuffer",f._renderbuffer=c,i.profile&&(f.stats=c.stats),f.destroy=function(){c.decRef()},f}function p(){At(u).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer($r,t.renderbuffer),e.renderbufferStorage($r,t.format,t.width,t.height)})),e.bindRenderbuffer($r,null)}return l.prototype.decRef=function(){--this.refCount<=0&&c(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach((function(t){e+=u[t].stats.size})),e}),{create:f,clear:function(){At(u).forEach(c)},restore:p}},hi=36160,di=36161,vi=3553,mi=34069,yi=36064,gi=36096,_i=36128,bi=33306,Ei=36053,xi=36054,Si=36055,Ti=36057,Ai=36061,wi=36193,Ci=5121,ki=5126,Oi=6407,Mi=6408,Ri=6402,Pi=[Oi,Mi],Ii=[];Ii[Mi]=4,Ii[Oi]=3;var Li=[];Li[Ci]=1,Li[ki]=4,Li[wi]=2;var Ni=33189,Di=36168,Fi=34041,ji=[32854,32855,36194,35907,34842,34843,34836],Ui={};function Bi(e,t,r,i,a,o){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],l=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&l.push("srgba"),t.ext_color_buffer_half_float&&l.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&l.push("rgba32f");var c=["uint8"];function f(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function p(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function h(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),a=Math.max(1,r.height);re(i===t&&a===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var o=e.renderbuffer._renderbuffer;re(o.width===t&&o.height===n,"inconsistent width/height for renderbuffer"),o.refCount+=1}}function d(t,n){n&&(n.texture?e.framebufferTexture2D(hi,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(hi,t,di,n.renderbuffer._renderbuffer.renderbuffer))}function v(e){var t=vi,n=null,r=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),re.type(i,"function","invalid attachment data");var a=i._reglType;return"texture2d"===a?(n=i,re(t===vi)):"textureCube"===a?(n=i,re(t>=mi&&t<mi+6,"invalid cube map target")):"renderbuffer"===a?(r=i,t=di):re.raise("invalid regl object for attachment"),new f(t,n,r)}function m(e,t,n,r,o){if(n){var s=i.create2D({width:e,height:t,format:r,type:o});return s._texture.refCount=0,new f(vi,s,null)}var u=a.create({width:e,height:t,format:r});return u._renderbuffer.refCount=0,new f(di,null,u)}function y(e){return e&&(e.texture||e.renderbuffer)}function g(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}t.oes_texture_half_float&&c.push("half float","float16"),t.oes_texture_float&&c.push("float","float32");var _=0,b={};function E(){this.id=_++,b[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function x(e){e.colorAttachments.forEach(p),p(e.depthAttachment),p(e.stencilAttachment),p(e.depthStencilAttachment)}function S(t){var n=t.framebuffer;re(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,o.framebufferCount--,delete b[t.id]}function T(t){var n;e.bindFramebuffer(hi,t.framebuffer);var i=t.colorAttachments;for(n=0;n<i.length;++n)d(yi+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(hi,yi+n,vi,null,0);e.framebufferTexture2D(hi,bi,vi,null,0),e.framebufferTexture2D(hi,gi,vi,null,0),e.framebufferTexture2D(hi,_i,vi,null,0),d(gi,t.depthAttachment),d(_i,t.stencilAttachment),d(bi,t.depthStencilAttachment);var a=e.checkFramebufferStatus(hi);e.isContextLost()||a===Ei||re.raise("framebuffer configuration not supported, status = "+Ui[a]),e.bindFramebuffer(hi,s.next?s.next.framebuffer:null),s.cur=s.next,e.getError()}function A(e,i){var a=new E;function f(e,n){var i;re(s.next!==a,"can not update framebuffer which is currently in use");var o=0,p=0,d=!0,g=!0,_=null,b=!0,E="rgba",S="uint8",A=1,w=null,C=null,k=null,O=!1;if("number"==typeof e)o=0|e,p=0|n||o;else if(e){re.type(e,"object","invalid arguments for framebuffer");var M=e;if("shape"in M){var R=M.shape;re(Array.isArray(R)&&R.length>=2,"invalid shape for framebuffer"),o=R[0],p=R[1]}else"radius"in M&&(o=p=M.radius),"width"in M&&(o=M.width),"height"in M&&(p=M.height);("color"in M||"colors"in M)&&(_=M.color||M.colors,Array.isArray(_)&&re(1===_.length||t.webgl_draw_buffers,"multiple render targets not supported")),_||("colorCount"in M&&(A=0|M.colorCount,re(A>0,"invalid color buffer count")),"colorTexture"in M&&(b=!!M.colorTexture,E="rgba4"),"colorType"in M&&(S=M.colorType,b?(re(t.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),re(t.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(re(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),E="rgba16f"):"float"!==S&&"float32"!==S||(re(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),E="rgba32f"),re.oneOf(S,c,"invalid color type")),"colorFormat"in M&&(E=M.colorFormat,u.indexOf(E)>=0?b=!0:l.indexOf(E)>=0?b=!1:re.optional((function(){b?re.oneOf(M.colorFormat,u,"invalid color format for texture"):re.oneOf(M.colorFormat,l,"invalid color format for renderbuffer")})))),("depthTexture"in M||"depthStencilTexture"in M)&&(O=!(!M.depthTexture&&!M.depthStencilTexture),re(!O||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in M&&("boolean"==typeof M.depth?d=M.depth:(w=M.depth,g=!1)),"stencil"in M&&("boolean"==typeof M.stencil?g=M.stencil:(C=M.stencil,d=!1)),"depthStencil"in M&&("boolean"==typeof M.depthStencil?d=g=M.depthStencil:(k=M.depthStencil,d=!1,g=!1))}else o=p=1;var P=null,I=null,L=null,N=null;if(Array.isArray(_))P=_.map(v);else if(_)P=[v(_)];else for(P=new Array(A),i=0;i<A;++i)P[i]=m(o,p,b,E,S);re(t.webgl_draw_buffers||P.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),re(P.length<=r.maxColorAttachments,"too many color attachments, not supported"),o=o||P[0].width,p=p||P[0].height,w?I=v(w):d&&!g&&(I=m(o,p,O,"depth","uint32")),C?L=v(C):g&&!d&&(L=m(o,p,!1,"stencil","uint8")),k?N=v(k):!w&&!C&&g&&d&&(N=m(o,p,O,"depth stencil","depth stencil")),re(!!w+!!C+!!k<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var D=null;for(i=0;i<P.length;++i)if(h(P[i],o,p),re(!P[i]||P[i].texture&&Pi.indexOf(P[i].texture._texture.format)>=0||P[i].renderbuffer&&ji.indexOf(P[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),P[i]&&P[i].texture){var F=Ii[P[i].texture._texture.format]*Li[P[i].texture._texture.type];null===D?D=F:re(D===F,"all color attachments much have the same number of bits per pixel.")}return h(I,o,p),re(!I||I.texture&&I.texture._texture.format===Ri||I.renderbuffer&&I.renderbuffer._renderbuffer.format===Ni,"invalid depth attachment for framebuffer object"),h(L,o,p),re(!L||L.renderbuffer&&L.renderbuffer._renderbuffer.format===Di,"invalid stencil attachment for framebuffer object"),h(N,o,p),re(!N||N.texture&&N.texture._texture.format===Fi||N.renderbuffer&&N.renderbuffer._renderbuffer.format===Fi,"invalid depth-stencil attachment for framebuffer object"),x(a),a.width=o,a.height=p,a.colorAttachments=P,a.depthAttachment=I,a.stencilAttachment=L,a.depthStencilAttachment=N,f.color=P.map(y),f.depth=y(I),f.stencil=y(L),f.depthStencil=y(N),f.width=a.width,f.height=a.height,T(a),f}function p(e,t){re(s.next!==a,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===a.width&&r===a.height)return f;for(var i=a.colorAttachments,o=0;o<i.length;++o)g(i[o],n,r);return g(a.depthAttachment,n,r),g(a.stencilAttachment,n,r),g(a.depthStencilAttachment,n,r),a.width=f.width=n,a.height=f.height=r,T(a),f}return o.framebufferCount++,f(e,i),n(f,{resize:p,_reglType:"framebuffer",_framebuffer:a,destroy:function(){S(a),x(a)},use:function(e){s.setFBO({framebuffer:f},e)}})}function w(e){var a=Array(6);function o(e){var r;re(a.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var l,f={color:null},p=0,h=null,d="rgba",v="uint8",m=1;if("number"==typeof e)p=0|e;else if(e){re.type(e,"object","invalid arguments for framebuffer");var y=e;if("shape"in y){var g=y.shape;re(Array.isArray(g)&&g.length>=2,"invalid shape for framebuffer"),re(g[0]===g[1],"cube framebuffer must be square"),p=g[0]}else"radius"in y&&(p=0|y.radius),"width"in y?(p=0|y.width,"height"in y&&re(y.height===p,"must be square")):"height"in y&&(p=0|y.height);("color"in y||"colors"in y)&&(h=y.color||y.colors,Array.isArray(h)&&re(1===h.length||t.webgl_draw_buffers,"multiple render targets not supported")),h||("colorCount"in y&&(m=0|y.colorCount,re(m>0,"invalid color buffer count")),"colorType"in y&&(re.oneOf(y.colorType,c,"invalid color type"),v=y.colorType),"colorFormat"in y&&(d=y.colorFormat,re.oneOf(y.colorFormat,u,"invalid color format for texture"))),"depth"in y&&(f.depth=y.depth),"stencil"in y&&(f.stencil=y.stencil),"depthStencil"in y&&(f.depthStencil=y.depthStencil)}else p=1;if(h)if(Array.isArray(h))for(l=[],r=0;r<h.length;++r)l[r]=h[r];else l=[h];else{l=Array(m);var _={radius:p,format:d,type:v};for(r=0;r<m;++r)l[r]=i.createCube(_)}for(f.color=Array(l.length),r=0;r<l.length;++r){var b=l[r];re("function"==typeof b&&"textureCube"===b._reglType,"invalid cube map"),p=p||b.width,re(b.width===p&&b.height===p,"invalid cube map shape"),f.color[r]={target:mi,data:l[r]}}for(r=0;r<6;++r){for(var E=0;E<l.length;++E)f.color[E].target=mi+r;r>0&&(f.depth=a[0].depth,f.stencil=a[0].stencil,f.depthStencil=a[0].depthStencil),a[r]?a[r](f):a[r]=A(f)}return n(o,{width:p,height:p,color:l})}function l(e){var t,n=0|e;if(re(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===o.width)return o;var i=o.color;for(t=0;t<i.length;++t)i[t].resize(n);for(t=0;t<6;++t)a[t].resize(n);return o.width=o.height=n,o}return o(e),n(o,{faces:a,resize:l,_reglType:"framebufferCube",destroy:function(){a.forEach((function(e){e.destroy()}))}})}function C(){s.cur=null,s.next=null,s.dirty=!0,At(b).forEach((function(t){t.framebuffer=e.createFramebuffer(),T(t)}))}return n(s,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof E)return t}return null},create:A,createCube:w,clear:function(){At(b).forEach(S)},restore:C})}Ui[Ei]="complete",Ui[xi]="incomplete attachment",Ui[Ti]="incomplete dimensions",Ui[Si]="incomplete, missing attachment",Ui[Ai]="unsupported";var zi=5126,Vi=34962,Hi=34963,Gi=["attributes","elements","offset","count","primitive","instances"];function Wi(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=zi,this.offset=0,this.stride=0,this.divisor=0}function Xi(e,n,r,i,a,o,s){for(var u=r.maxAttributes,l=new Array(u),c=0;c<u;++c)l[c]=new Wi;var f=0,p={},h={Record:Wi,scope:{},state:l,currentVAO:null,targetVAO:null,restore:v()?x:function(){},createVAO:S,getVAO:y,destroyBuffer:d,setVAO:v()?g:_,clear:v()?b:function(){}};function d(t){for(var n=0;n<l.length;++n){var r=l[n];r.buffer===t&&(e.disableVertexAttribArray(n),r.buffer=null)}}function v(){return n.oes_vertex_array_object}function m(){return n.angle_instanced_arrays}function y(e){return"function"==typeof e&&e._vao?e._vao:null}function g(e){if(e!==h.currentVAO){var t=v();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),h.currentVAO=e}}function _(t){if(t!==h.currentVAO){if(t)t.bindAttrs();else{for(var n=m(),r=0;r<l.length;++r){var i=l[r];i.buffer?(e.enableVertexAttribArray(r),i.buffer.bind(),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}s.elements?e.bindBuffer(Hi,s.elements.buffer.buffer):e.bindBuffer(Hi,null)}h.currentVAO=t}}function b(){At(p).forEach((function(e){e.destroy()}))}function E(){this.id=++f,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var e=v();this.vao=e?e.createVertexArrayOES():null,p[this.id]=this,this.buffers=[]}function x(){v()&&At(p).forEach((function(e){e.refresh()}))}function S(e){var r=new E;function s(e){var i;if(Array.isArray(e))i=e,r.elements&&r.ownsElements&&r.elements.destroy(),r.elements=null,r.ownsElements=!1,r.offset=0,r.count=0,r.instances=-1,r.primitive=4;else{if(re("object"==typeof e,"invalid arguments for create vao"),re("attributes"in e,"must specify attributes for vao"),e.elements){var l=e.elements;r.ownsElements?"function"==typeof l&&"elements"===l._reglType?(r.elements.destroy(),r.ownsElements=!1):(r.elements(l),r.ownsElements=!1):o.getElements(e.elements)?(r.elements=e.elements,r.ownsElements=!1):(r.elements=o.create(e.elements),r.ownsElements=!0)}else r.elements=null,r.ownsElements=!1;i=e.attributes,r.offset=0,r.count=-1,r.instances=-1,r.primitive=4,r.elements&&(r.count=r.elements._elements.vertCount,r.primitive=r.elements._elements.primType),"offset"in e&&(r.offset=0|e.offset),"count"in e&&(r.count=0|e.count),"instances"in e&&(r.instances=0|e.instances),"primitive"in e&&(re(e.primitive in Yt,"bad primitive type: "+e.primitive),r.primitive=Yt[e.primitive]),re.optional((()=>{for(var t=Object.keys(e),n=0;n<t.length;++n)re(Gi.indexOf(t[n])>=0,'invalid option for vao: "'+t[n]+'" valid options are '+Gi)})),re(Array.isArray(i),"attributes must be an array")}re(i.length<u,"too many attributes"),re(i.length>0,"must specify at least one attribute");var c={},f=r.attributes;f.length=i.length;for(var p=0;p<i.length;++p){var h,d=i[p],v=f[p]=new Wi,m=d.data||d;Array.isArray(m)||t(m)||Tt(m)?(r.buffers[p]&&(h=r.buffers[p],t(m)&&h._buffer.byteLength>=m.byteLength?h.subdata(m):(h.destroy(),r.buffers[p]=null)),r.buffers[p]||(h=r.buffers[p]=a.create(d,Vi,!1,!0)),v.buffer=a.getBuffer(h),v.size=0|v.buffer.dimension,v.normalized=!1,v.type=v.buffer.dtype,v.offset=0,v.stride=0,v.divisor=0,v.state=1,c[p]=1):a.getBuffer(d)?(v.buffer=a.getBuffer(d),v.size=0|v.buffer.dimension,v.normalized=!1,v.type=v.buffer.dtype,v.offset=0,v.stride=0,v.divisor=0,v.state=1):a.getBuffer(d.buffer)?(v.buffer=a.getBuffer(d.buffer),v.size=0|(+d.size||v.buffer.dimension),v.normalized=!!d.normalized||!1,"type"in d?(re.parameter(d.type,Lt,"invalid buffer type"),v.type=Lt[d.type]):v.type=v.buffer.dtype,v.offset=0|(d.offset||0),v.stride=0|(d.stride||0),v.divisor=0|(d.divisor||0),v.state=1,re(v.size>=1&&v.size<=4,"size must be between 1 and 4"),re(v.offset>=0,"invalid offset"),re(v.stride>=0&&v.stride<=255,"stride must be between 0 and 255"),re(v.divisor>=0,"divisor must be positive"),re(!v.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in d?(re(p>0,"first attribute must not be a constant"),v.x=+d.x||0,v.y=+d.y||0,v.z=+d.z||0,v.w=+d.w||0,v.state=2):re(!1,"invalid attribute spec for location "+p)}for(var y=0;y<r.buffers.length;++y)!c[y]&&r.buffers[y]&&(r.buffers[y].destroy(),r.buffers[y]=null);return r.refresh(),s}return i.vaoCount+=1,s.destroy=function(){for(var e=0;e<r.buffers.length;++e)r.buffers[e]&&r.buffers[e].destroy();r.buffers.length=0,r.ownsElements&&(r.elements.destroy(),r.elements=null,r.ownsElements=!1),r.destroy()},s._vao=r,s._reglType="vao",s(e)}return E.prototype.bindAttrs=function(){for(var t=m(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(e.enableVertexAttribArray(r),e.bindBuffer(Vi,i.buffer.buffer),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),t&&i.divisor&&t.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var a=n.length;a<u;++a)e.disableVertexAttribArray(a);var s=o.getElements(this.elements);s?e.bindBuffer(Hi,s.buffer.buffer):e.bindBuffer(Hi,null)},E.prototype.refresh=function(){var e=v();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),h.currentVAO=null,e.bindVertexArrayOES(null))},E.prototype.destroy=function(){if(this.vao){var e=v();this===h.currentVAO&&(h.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),p[this.id]&&(delete p[this.id],i.vaoCount-=1)},h}var Yi=35632,qi=35633,Zi=35718,Ki=35721;function Qi(e,t,r,i){var a={},o={};function s(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function u(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function l(n,r,i){var s=n===Yi?a:o,u=s[r];if(!u){var l=t.str(r);u=e.createShader(n),e.shaderSource(u,l),e.compileShader(u),re.shaderError(e,u,l,n,i),s[r]=u}return u}var c={},f=[],p=0;function h(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function d(n,r,a){var o,c,f=l(Yi,n.fragId),p=l(qi,n.vertId),h=n.program=e.createProgram();if(e.attachShader(h,f),e.attachShader(h,p),a)for(o=0;o<a.length;++o){var d=a[o];e.bindAttribLocation(h,d[0],d[1])}e.linkProgram(h),re.linkError(e,h,t.str(n.fragId),t.str(n.vertId),r);var v=e.getProgramParameter(h,Zi);i.profile&&(n.stats.uniformsCount=v);var m=n.uniforms;for(o=0;o<v;++o)if(c=e.getActiveUniform(h,o))if(c.size>1)for(var y=0;y<c.size;++y){var g=c.name.replace("[0]","["+y+"]");u(m,new s(g,t.id(g),e.getUniformLocation(h,g),c))}else u(m,new s(c.name,t.id(c.name),e.getUniformLocation(h,c.name),c));var _=e.getProgramParameter(h,Ki);i.profile&&(n.stats.attributesCount=_);var b=n.attributes;for(o=0;o<_;++o)(c=e.getActiveAttrib(h,o))&&u(b,new s(c.name,t.id(c.name),e.getAttribLocation(h,c.name),c))}function v(){a={},o={};for(var e=0;e<f.length;++e)d(f[e],null,f[e].attributes.map((function(e){return[e.location,e.name]})))}return i.profile&&(r.getMaxUniformsCount=function(){var e=0;return f.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},r.getMaxAttributesCount=function(){var e=0;return f.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);At(a).forEach(t),a={},At(o).forEach(t),o={},f.forEach((function(t){e.deleteProgram(t.program)})),f.length=0,c={},r.shaderCount=0},program:function(t,i,s,u){re.command(t>=0,"missing vertex shader",s),re.command(i>=0,"missing fragment shader",s);var l=c[i];l||(l=c[i]={});var p=l[t];if(p&&(p.refCount++,!u))return p;var v=new h(i,t);return r.shaderCount++,d(v,s,u),p||(l[t]=v),f.push(v),n(v,{destroy:function(){if(v.refCount--,v.refCount<=0){e.deleteProgram(v.program);var t=f.indexOf(v);f.splice(t,1),r.shaderCount--}l[v.vertId].refCount<=0&&(e.deleteShader(o[v.vertId]),delete o[v.vertId],delete c[v.fragId][v.vertId]),Object.keys(c[v.fragId]).length||(e.deleteShader(a[v.fragId]),delete a[v.fragId],delete c[v.fragId])}})},restore:v,shader:l,frag:-1,vert:-1}}var Ji=6408,$i=5121,ea=3333,ta=5126;function na(e,n,r,i,a,o,s){function u(u){var l;null===n.next?(re(a.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),l=$i):(re(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),l=n.next.colorAttachments[0].texture._texture.type,re.optional((function(){o.oes_texture_float?(re(l===$i||l===ta,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),l===ta&&re(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):re(l===$i,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var c=0,f=0,p=i.framebufferWidth,h=i.framebufferHeight,d=null;t(u)?d=u:u&&(re.type(u,"object","invalid arguments to regl.read()"),c=0|u.x,f=0|u.y,re(c>=0&&c<i.framebufferWidth,"invalid x offset for regl.read"),re(f>=0&&f<i.framebufferHeight,"invalid y offset for regl.read"),p=0|(u.width||i.framebufferWidth-c),h=0|(u.height||i.framebufferHeight-f),d=u.data||null),d&&(l===$i?re(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):l===ta&&re(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),re(p>0&&p+c<=i.framebufferWidth,"invalid width for read pixels"),re(h>0&&h+f<=i.framebufferHeight,"invalid height for read pixels"),r();var v=p*h*4;return d||(l===$i?d=new Uint8Array(v):l===ta&&(d=d||new Float32Array(v))),re.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),re(d.byteLength>=v,"data buffer for regl.read() too small"),e.pixelStorei(ea,4),e.readPixels(c,f,p,h,Ji,l,d),d}function l(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=u(e)})),t}function c(e){return e&&"framebuffer"in e?l(e):u(e)}return c}function ra(e){return Array.prototype.slice.call(e)}function ia(e){return ra(e).join("")}function aa(){var t=0,r=[],i=[];function a(e){for(var n=0;n<i.length;++n)if(i[n]===e)return r[n];var a="g"+t++;return r.push(a),i.push(e),a}function o(){var e=[];function r(){e.push.apply(e,ra(arguments))}var i=[];function a(){var n="v"+t++;return i.push(n),arguments.length>0&&(e.push(n,"="),e.push.apply(e,ra(arguments)),e.push(";")),n}return n(r,{def:a,toString:function(){return ia([i.length>0?"var "+i.join(",")+";":"",ia(e)])}})}function s(){var e=o(),t=o(),r=e.toString,i=t.toString;function a(n,r){t(n,r,"=",e.def(n,r),";")}return n((function(){e.apply(e,ra(arguments))}),{def:e.def,entry:e,exit:t,save:a,set:function(t,n,r){a(t,n),e(t,n,"=",r,";")},toString:function(){return r()+i()}})}function u(){var e=ia(arguments),t=s(),r=s(),i=t.toString,a=r.toString;return n(t,{then:function(){return t.apply(t,ra(arguments)),this},else:function(){return r.apply(r,ra(arguments)),this},toString:function(){var t=a();return t&&(t="else{"+t+"}"),ia(["if(",e,"){",i(),"}",t])}})}var l=o(),c={};function f(e,t){var r=[];function i(){var e="a"+r.length;return r.push(e),e}t=t||0;for(var a=0;a<t;++a)i();var o=s(),u=o.toString;return c[e]=n(o,{arg:i,toString:function(){return ia(["function(",r.join(),"){",u(),"}"])}})}function p(){var t=['"use strict";',l,"return {"];Object.keys(c).forEach((function(e){t.push('"',e,'":',c[e].toString(),",")})),t.push("}");var n=ia(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return("undefined"!=typeof my&&my&&"function"==typeof my.showToast?e.Function.apply(null,r.concat(n)):Function.apply(null,r.concat(n))).apply(null,i)}return{global:l,link:a,block:o,proc:f,scope:s,cond:u,compile:p}}var oa="xyzw".split(""),sa=5121,ua=1,la=2,ca=0,fa=1,pa=2,ha=3,da=4,va=5,ma=6,ya="dither",ga="blend.enable",_a="blend.color",ba="blend.equation",Ea="blend.func",xa="depth.enable",Sa="depth.func",Ta="depth.range",Aa="depth.mask",wa="colorMask",Ca="cull.enable",ka="cull.face",Oa="frontFace",Ma="lineWidth",Ra="polygonOffset.enable",Pa="polygonOffset.offset",Ia="sample.alpha",La="sample.enable",Na="sample.coverage",Da="stencil.enable",Fa="stencil.mask",ja="stencil.func",Ua="stencil.opFront",Ba="stencil.opBack",za="scissor.enable",Va="scissor.box",Ha="viewport",Ga="profile",Wa="framebuffer",Xa="vert",Ya="frag",qa="elements",Za="primitive",Ka="count",Qa="offset",Ja="instances",$a="vao",eo="Width",to="Height",no=Wa+eo,ro=Wa+to,io=Ha+eo,ao=Ha+to,oo="drawingBuffer",so=oo+eo,uo=oo+to,lo=[Ea,ba,ja,Ua,Ba,Na,Ha,Va,Pa],co=34962,fo=34963,po=3553,ho=34067,vo=2884,mo=3042,yo=3024,go=2960,_o=2929,bo=3089,Eo=32823,xo=32926,So=32928,To=5126,Ao=35664,wo=35665,Co=35666,ko=5124,Oo=35667,Mo=35668,Ro=35669,Po=35670,Io=35671,Lo=35672,No=35673,Do=35674,Fo=35675,jo=35676,Uo=35678,Bo=35680,zo=4,Vo=1028,Ho=1029,Go=2304,Wo=2305,Xo=32775,Yo=32776,qo=519,Zo=7680,Ko=0,Qo=1,Jo=32774,$o=513,es=36160,ts=36064,ns={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},rs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],is={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},as={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},os={frag:35632,vert:35633},ss={cw:Go,ccw:Wo};function us(e){return Array.isArray(e)||t(e)||Tt(e)}function ls(e){return e.sort((function(e,t){return e===Ha?-1:t===Ha?1:e<t?-1:1}))}function cs(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function fs(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function ps(e){return new cs(!1,!1,!1,e)}function hs(e,t){var n=e.type;if(n===ca){var r=e.data.length;return new cs(!0,r>=1,r>=2,t)}if(n===da){var i=e.data;return new cs(i.thisDep,i.contextDep,i.propDep,t)}if(n===va)return new cs(!1,!1,!1,t);if(n===ma){for(var a=!1,o=!1,s=!1,u=0;u<e.data.length;++u){var l=e.data[u];if(l.type===fa)s=!0;else if(l.type===pa)o=!0;else if(l.type===ha)a=!0;else if(l.type===ca){a=!0;var c=l.data;c>=1&&(o=!0),c>=2&&(s=!0)}else l.type===da&&(a=a||l.data.thisDep,o=o||l.data.contextDep,s=s||l.data.propDep)}return new cs(a,o,s,t)}return new cs(n===ha,n===pa,n===fa,t)}var ds=new cs(!1,!1,!1,(function(){}));function vs(e,t,r,i,a,o,s,u,l,c,f,p,h,d,v){var m=c.Record,y={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(y.min=Xo,y.max=Yo);var g=r.angle_instanced_arrays,_=r.webgl_draw_buffers,b=r.oes_vertex_array_object,E={dirty:!0,profile:v.profile},x={},S=[],T={},A={};function w(e){return e.replace(".","_")}function C(e,t,n){var r=w(e);S.push(e),x[r]=E[r]=!!n,T[r]=t}function k(e,t,n){var r=w(e);S.push(e),Array.isArray(n)?(E[r]=n.slice(),x[r]=n.slice()):E[r]=x[r]=n,A[r]=t}C(ya,yo),C(ga,mo),k(_a,"blendColor",[0,0,0,0]),k(ba,"blendEquationSeparate",[Jo,Jo]),k(Ea,"blendFuncSeparate",[Qo,Ko,Qo,Ko]),C(xa,_o,!0),k(Sa,"depthFunc",$o),k(Ta,"depthRange",[0,1]),k(Aa,"depthMask",!0),k(wa,wa,[!0,!0,!0,!0]),C(Ca,vo),k(ka,"cullFace",Ho),k(Oa,Oa,Wo),k(Ma,Ma,1),C(Ra,Eo),k(Pa,"polygonOffset",[0,0]),C(Ia,xo),C(La,So),k(Na,"sampleCoverage",[1,!1]),C(Da,go),k(Fa,"stencilMask",-1),k(ja,"stencilFunc",[qo,0,-1]),k(Ua,"stencilOpSeparate",[Vo,Zo,Zo,Zo]),k(Ba,"stencilOpSeparate",[Ho,Zo,Zo,Zo]),C(za,bo),k(Va,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),k(Ha,Ha,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var O={gl:e,context:h,strings:t,next:x,current:E,draw:p,elements:o,buffer:a,shader:f,attributes:c.state,vao:c,uniforms:l,framebuffer:u,extensions:r,timer:d,isBufferArgs:us},M={primTypes:Yt,compareFuncs:is,blendFuncs:ns,blendEquations:y,stencilOps:as,glTypes:Lt,orientationType:ss};re.optional((function(){O.isArrayLike=pn})),_&&(M.backBuffer=[Ho],M.drawBuffer=Ce(i.maxDrawbuffers,(function(e){return 0===e?[0]:Ce(e,(function(e){return ts+e}))})));var R=0;function P(){var e=aa(),n=e.link,r=e.global;e.id=R++,e.batchId="0";var i=n(O),a=e.shared={props:"a0"};Object.keys(O).forEach((function(e){a[e]=r.def(i,".",e)})),re.optional((function(){e.CHECK=n(re),e.commandStr=re.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},M.invalidBlendCombinations=rs}));var o=e.next={},s=e.current={};Object.keys(A).forEach((function(e){Array.isArray(E[e])&&(o[e]=r.def(a.next,".",e),s[e]=r.def(a.current,".",e))}));var u=e.constants={};Object.keys(M).forEach((function(e){u[e]=r.def(JSON.stringify(M[e]))})),e.invoke=function(t,r){switch(r.type){case ca:var i=["this",a.context,a.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case fa:return t.def(a.props,r.data);case pa:return t.def(a.context,r.data);case ha:return t.def("this",r.data);case da:return r.data.append(e,t),r.data.ref;case va:return r.data.toString();case ma:return r.data.map((function(n){return e.invoke(t,n)}))}},e.attribCache={};var l={};return e.scopeAttrib=function(e){var r=t.id(e);if(r in l)return l[r];var i=c.scope[r];return i||(i=c.scope[r]=new m),l[r]=n(i)},e}function I(e){var t,n=e.static,r=e.dynamic;if(Ga in n){var i=!!n[Ga];(t=ps((function(e,t){return i}))).enable=i}else if(Ga in r){var a=r[Ga];t=hs(a,(function(e,t){return e.invoke(t,a)}))}return t}function L(e,t){var n=e.static,r=e.dynamic;if(Wa in n){var i=n[Wa];return i?(i=u.getFramebuffer(i),re.command(i,"invalid framebuffer object"),ps((function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var a=r.context;return t.set(a,"."+no,n+".width"),t.set(a,"."+ro,n+".height"),n}))):ps((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+no,r+"."+so),t.set(r,"."+ro,r+"."+uo),"null"}))}if(Wa in r){var a=r[Wa];return hs(a,(function(e,t){var n=e.invoke(t,a),r=e.shared,i=r.framebuffer,o=t.def(i,".getFramebuffer(",n,")");re.optional((function(){e.assert(t,"!"+n+"||"+o,"invalid framebuffer object")})),t.set(i,".next",o);var s=r.context;return t.set(s,"."+no,o+"?"+o+".width:"+s+"."+so),t.set(s,"."+ro,o+"?"+o+".height:"+s+"."+uo),o}))}return null}function N(e,t,n){var r=e.static,i=e.dynamic;function a(e){if(e in r){var a=r[e];re.commandType(a,"object","invalid "+e,n.commandStr);var o,s,u=!0,l=0|a.x,c=0|a.y;return"width"in a?(o=0|a.width,re.command(o>=0,"invalid "+e,n.commandStr)):u=!1,"height"in a?(s=0|a.height,re.command(s>=0,"invalid "+e,n.commandStr)):u=!1,new cs(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,(function(e,t){var n=e.shared.context,r=o;"width"in a||(r=t.def(n,".",no,"-",l));var i=s;return"height"in a||(i=t.def(n,".",ro,"-",c)),[l,c,r,i]}))}if(e in i){var f=i[e],p=hs(f,(function(t,n){var r=t.invoke(n,f);re.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}));var i=t.shared.context,a=n.def(r,".x|0"),o=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",no,"-",a,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",ro,"-",o,")");return re.optional((function(){t.assert(n,s+">=0&&"+u+">=0","invalid "+e)})),[a,o,s,u]}));return t&&(p.thisDep=p.thisDep||t.thisDep,p.contextDep=p.contextDep||t.contextDep,p.propDep=p.propDep||t.propDep),p}return t?new cs(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",no),t.def(n,".",ro)]})):null}var o=a(Ha);if(o){var s=o;o=new cs(o.thisDep,o.contextDep,o.propDep,(function(e,t){var n=s.append(e,t),r=e.shared.context;return t.set(r,"."+io,n[2]),t.set(r,"."+ao,n[3]),n}))}return{viewport:o,scissor_box:a(Va)}}function D(e,t){var n=e.static;if("string"==typeof n[Ya]&&"string"==typeof n[Xa]){if(Object.keys(t.dynamic).length>0)return null;var r=t.static,i=Object.keys(r);if(i.length>0&&"number"==typeof r[i[0]]){for(var a=[],o=0;o<i.length;++o)re("number"==typeof r[i[o]],"must specify all vertex attribute locations when using vaos"),a.push([0|r[i[o]],i[o]]);return a}}return null}function F(e,n,r){var i=e.static,a=e.dynamic;function o(e){if(e in i){var n=t.id(i[e]);re.optional((function(){f.shader(os[e],n,re.guessCommand())}));var r=ps((function(){return n}));return r.id=n,r}if(e in a){var o=a[e];return hs(o,(function(t,n){var r=t.invoke(n,o),i=n.def(t.shared.strings,".id(",r,")");return re.optional((function(){n(t.shared.shader,".shader(",os[e],",",i,",",t.command,");")})),i}))}return null}var s,u=o(Ya),l=o(Xa),c=null;return fs(u)&&fs(l)?(c=f.program(l.id,u.id,null,r),s=ps((function(e,t){return e.link(c)}))):s=new cs(u&&u.thisDep||l&&l.thisDep,u&&u.contextDep||l&&l.contextDep,u&&u.propDep||l&&l.propDep,(function(e,t){var n,r=e.shared.shader;n=u?u.append(e,t):t.def(r,".",Ya);var i=r+".program("+(l?l.append(e,t):t.def(r,".",Xa))+","+n;return re.optional((function(){i+=","+e.command})),t.def(i+")")})),{frag:u,vert:l,progVar:s,program:c}}function j(e,t){var n=e.static,r=e.dynamic,i={},a=!1;function s(){if($a in n){var e=n[$a];return null!==e&&null===c.getVAO(e)&&(e=c.createVAO(e)),a=!0,i.vao=e,ps((function(t){var n=c.getVAO(e);return n?t.link(n):"null"}))}if($a in r){a=!0;var t=r[$a];return hs(t,(function(e,n){var r=e.invoke(n,t);return n.def(e.shared.vao+".getVAO("+r+")")}))}return null}var u=s(),l=!1;function f(){if(qa in n){var e=n[qa];if(i.elements=e,us(e)){var s=i.elements=o.create(e,!0);e=o.getElements(s),l=!0}else e&&(e=o.getElements(e),l=!0,re.command(e,"invalid elements",t.commandStr));var c=ps((function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null}));return c.value=e,c}if(qa in r){l=!0;var f=r[qa];return hs(f,(function(e,t){var n=e.shared,r=n.isBufferArgs,i=n.elements,a=e.invoke(t,f),o=t.def("null"),s=t.def(r,"(",a,")"),u=e.cond(s).then(o,"=",i,".createStream(",a,");").else(o,"=",i,".getElements(",a,");");return re.optional((function(){e.assert(u.else,"!"+a+"||"+o,"invalid elements")})),t.entry(u),t.exit(e.cond(s).then(i,".destroyStream(",o,");")),e.ELEMENTS=o,o}))}return a?new cs(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.elements+".getElements("+e.shared.vao+".currentVAO.elements):null")})):null}var p=f();function h(){if(Za in n){var e=n[Za];return i.primitive=e,re.commandParameter(e,Yt,"invalid primitve",t.commandStr),ps((function(t,n){return Yt[e]}))}if(Za in r){var o=r[Za];return hs(o,(function(e,t){var n=e.constants.primTypes,r=e.invoke(t,o);return re.optional((function(){e.assert(t,r+" in "+n,"invalid primitive, must be one of "+Object.keys(Yt))})),t.def(n,"[",r,"]")}))}return l?fs(p)?p.value?ps((function(e,t){return t.def(e.ELEMENTS,".primType")})):ps((function(){return zo})):new cs(p.thisDep,p.contextDep,p.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",zo)})):a?new cs(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.primitive:"+zo)})):null}function d(e,o){if(e in n){var s=0|n[e];return o?i.offset=s:i.instances=s,re.command(!o||s>=0,"invalid "+e,t.commandStr),ps((function(e,t){return o&&(e.OFFSET=s),s}))}if(e in r){var c=r[e];return hs(c,(function(t,n){var r=t.invoke(n,c);return o&&(t.OFFSET=r,re.optional((function(){t.assert(n,r+">=0","invalid "+e)}))),r}))}if(o){if(l)return ps((function(e,t){return e.OFFSET=0,0}));if(a)return new cs(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.offset:0")}))}else if(a)return new cs(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.instances:-1")}));return null}var v=d(Qa,!0);function m(){if(Ka in n){var e=0|n[Ka];return i.count=e,re.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),ps((function(){return e}))}if(Ka in r){var o=r[Ka];return hs(o,(function(e,t){var n=e.invoke(t,o);return re.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(l){if(fs(p)){if(p)return v?new cs(v.thisDep,v.contextDep,v.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return re.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):ps((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var s=ps((function(){return-1}));return re.optional((function(){s.MISSING=!0})),s}var c=new cs(p.thisDep||v.thisDep,p.contextDep||v.contextDep,p.propDep||v.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return re.optional((function(){c.DYNAMIC=!0})),c}return a?new cs(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao,".currentVAO?",e.shared.vao,".currentVAO.count:-1")})):null}var y=h(),g=m(),_=d(Ja,!1);return{elements:p,primitive:y,count:g,instances:_,offset:v,vao:u,vaoActive:a,elementsActive:l,static:i}}function U(e,t){var n=e.static,r=e.dynamic,a={};return S.forEach((function(e){var o=w(e);function s(t,i){if(e in n){var s=t(n[e]);a[o]=ps((function(){return s}))}else if(e in r){var u=r[e];a[o]=hs(u,(function(e,t){return i(e,t,e.invoke(t,u))}))}}switch(e){case Ca:case ga:case ya:case Da:case xa:case za:case Ra:case Ia:case La:case Aa:return s((function(n){return re.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,r){return re.optional((function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)})),r}));case Sa:return s((function(n){return re.commandParameter(n,is,"invalid "+e,t.commandStr),is[n]}),(function(t,n,r){var i=t.constants.compareFuncs;return re.optional((function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(is))})),n.def(i,"[",r,"]")}));case Ta:return s((function(e){return re.command(pn(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){return re.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]}));case Ea:return s((function(e){re.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,a="dstAlpha"in e?e.dstAlpha:e.dst;return re.commandParameter(n,ns,o+".srcRGB",t.commandStr),re.commandParameter(r,ns,o+".srcAlpha",t.commandStr),re.commandParameter(i,ns,o+".dstRGB",t.commandStr),re.commandParameter(a,ns,o+".dstAlpha",t.commandStr),re.command(-1===rs.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[ns[n],ns[i],ns[r],ns[a]]}),(function(t,n,r){var i=t.constants.blendFuncs;function a(a,o){var s=n.def('"',a,o,'" in ',r,"?",r,".",a,o,":",r,".",a);return re.optional((function(){t.assert(n,s+" in "+i,"invalid "+e+"."+a+o+", must be one of "+Object.keys(ns))})),s}re.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var o=a("src","RGB"),s=a("dst","RGB");re.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+o+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(i,"[",o,"]"),l=n.def(i,"[",a("src","Alpha"),"]");return[u,n.def(i,"[",s,"]"),l,n.def(i,"[",a("dst","Alpha"),"]")]}));case ba:return s((function(n){return"string"==typeof n?(re.commandParameter(n,y,"invalid "+e,t.commandStr),[y[n],y[n]]):"object"==typeof n?(re.commandParameter(n.rgb,y,e+".rgb",t.commandStr),re.commandParameter(n.alpha,y,e+".alpha",t.commandStr),[y[n.rgb],y[n.alpha]]):void re.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,r){var i=t.constants.blendEquations,a=n.def(),o=n.def(),s=t.cond("typeof ",r,'==="string"');return re.optional((function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(y))}n(s.then,e,r),t.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(s.else,e+".rgb",r+".rgb"),n(s.else,e+".alpha",r+".alpha")})),s.then(a,"=",o,"=",i,"[",r,"];"),s.else(a,"=",i,"[",r,".rgb];",o,"=",i,"[",r,".alpha];"),n(s),[a,o]}));case _a:return s((function(e){return re.command(pn(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),Ce(4,(function(t){return+e[t]}))}),(function(e,t,n){return re.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),Ce(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case Fa:return s((function(e){return re.commandType(e,"number",o,t.commandStr),0|e}),(function(e,t,n){return re.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case ja:return s((function(n){re.commandType(n,"object",o,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,a="mask"in n?n.mask:-1;return re.commandParameter(r,is,e+".cmp",t.commandStr),re.commandType(i,"number",e+".ref",t.commandStr),re.commandType(a,"number",e+".mask",t.commandStr),[is[r],i,a]}),(function(e,t,n){var r=e.constants.compareFuncs;return re.optional((function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Zo),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case Ua:case Ba:return s((function(n){re.commandType(n,"object",o,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",a=n.zpass||"keep";return re.commandParameter(r,as,e+".fail",t.commandStr),re.commandParameter(i,as,e+".zfail",t.commandStr),re.commandParameter(a,as,e+".zpass",t.commandStr),[e===Ba?Ho:Vo,as[r],as[i],as[a]]}),(function(t,n,r){var i=t.constants.stencilOps;function a(a){return re.optional((function(){t.assert(n,'!("'+a+'" in '+r+")||("+r+"."+a+" in "+i+")","invalid "+e+"."+a+", must be one of "+Object.keys(as))})),n.def('"',a,'" in ',r,"?",i,"[",r,".",a,"]:",Zo)}return re.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[e===Ba?Ho:Vo,a("fail"),a("zfail"),a("zpass")]}));case Pa:return s((function(e){re.commandType(e,"object",o,t.commandStr);var n=0|e.factor,r=0|e.units;return re.commandType(n,"number",o+".factor",t.commandStr),re.commandType(r,"number",o+".units",t.commandStr),[n,r]}),(function(t,n,r){return re.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case ka:return s((function(e){var n=0;return"front"===e?n=Vo:"back"===e&&(n=Ho),re.command(!!n,o,t.commandStr),n}),(function(e,t,n){return re.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',Vo,":",Ho)}));case Ma:return s((function(e){return re.command("number"==typeof e&&e>=i.lineWidthDims[0]&&e<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return re.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")})),n}));case Oa:return s((function(e){return re.commandParameter(e,ss,o,t.commandStr),ss[e]}),(function(e,t,n){return re.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?'+Go+":"+Wo)}));case wa:return s((function(e){return re.command(pn(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return re.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),Ce(4,(function(e){return"!!"+n+"["+e+"]"}))}));case Na:return s((function(e){re.command("object"==typeof e&&e,o,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return re.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]}),(function(e,t,n){return re.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]}))}})),a}function B(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach((function(e){var r,a=n[e];if("number"==typeof a||"boolean"==typeof a)r=ps((function(){return a}));else if("function"==typeof a){var o=a._reglType;"texture2d"===o||"textureCube"===o?r=ps((function(e){return e.link(a)})):"framebuffer"===o||"framebufferCube"===o?(re.command(a.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=ps((function(e){return e.link(a.color[0])}))):re.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else pn(a)?r=ps((function(t){return t.global.def("[",Ce(a.length,(function(n){return re.command("number"==typeof a[n]||"boolean"==typeof a[n],"invalid uniform "+e,t.commandStr),a[n]})),"]")})):re.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=a,i[e]=r})),Object.keys(r).forEach((function(e){var t=r[e];i[e]=hs(t,(function(e,n){return e.invoke(n,t)}))})),i}function z(e,n){var r=e.static,i=e.dynamic,o={};return Object.keys(r).forEach((function(e){var i=r[e],s=t.id(e),u=new m;if(us(i))u.state=ua,u.buffer=a.getBuffer(a.create(i,co,!1,!0)),u.type=0;else{var l=a.getBuffer(i);if(l)u.state=ua,u.buffer=l,u.type=0;else if(re.command("object"==typeof i&&i,"invalid data for attribute "+e,n.commandStr),"constant"in i){var c=i.constant;u.buffer="null",u.state=la,"number"==typeof c?u.x=c:(re.command(pn(c)&&c.length>0&&c.length<=4,"invalid constant for attribute "+e,n.commandStr),oa.forEach((function(e,t){t<c.length&&(u[e]=c[t])})))}else{l=us(i.buffer)?a.getBuffer(a.create(i.buffer,co,!1,!0)):a.getBuffer(i.buffer),re.command(!!l,'missing buffer for attribute "'+e+'"',n.commandStr);var f=0|i.offset;re.command(f>=0,'invalid offset for attribute "'+e+'"',n.commandStr);var p=0|i.stride;re.command(p>=0&&p<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',n.commandStr);var h=0|i.size;re.command(!("size"in i)||h>0&&h<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',n.commandStr);var d=!!i.normalized,v=0;"type"in i&&(re.commandParameter(i.type,Lt,"invalid type for attribute "+e,n.commandStr),v=Lt[i.type]);var y=0|i.divisor;re.optional((function(){"divisor"in i&&(re.command(0===y||g,'cannot specify divisor for attribute "'+e+'", instancing not supported',n.commandStr),re.command(y>=0,'invalid divisor for attribute "'+e+'"',n.commandStr));var t=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(n){re.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)}))})),u.buffer=l,u.state=ua,u.size=h,u.normalized=d,u.type=v||l.dtype,u.offset=f,u.stride=p,u.divisor=y}}o[e]=ps((function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach((function(e){r[e]=u[e]})),u.buffer&&(r.buffer=e.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(i).forEach((function(e){var t=i[e];function n(n,r){var i=n.invoke(r,t),a=n.shared,o=n.constants,s=a.isBufferArgs,u=a.buffer;re.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+a.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')}));var l={isStream:r.def(!1)},c=new m;c.state=ua,Object.keys(c).forEach((function(e){l[e]=r.def(""+c[e])}));var f=l.buffer,p=l.type;function h(e){r(l[e],"=",i,".",e,"|0;")}return r("if(",s,"(",i,")){",l.isStream,"=true;",f,"=",u,".createStream(",co,",",i,");",p,"=",f,".dtype;","}else{",f,"=",u,".getBuffer(",i,");","if(",f,"){",p,"=",f,".dtype;",'}else if("constant" in ',i,"){",l.state,"=",la,";","if(typeof "+i+'.constant === "number"){',l[oa[0]],"=",i,".constant;",oa.slice(1).map((function(e){return l[e]})).join("="),"=0;","}else{",oa.map((function(e,t){return l[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",f,"=",u,".createStream(",co,",",i,".buffer);","}else{",f,"=",u,".getBuffer(",i,".buffer);","}",p,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",f,".dtype;",l.normalized,"=!!",i,".normalized;"),h("size"),h("offset"),h("stride"),h("divisor"),r("}}"),r.exit("if(",l.isStream,"){",u,".destroyStream(",f,");","}"),l}o[e]=hs(t,n)})),o}function V(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach((function(e){var n=t[e];r[e]=ps((function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];r[e]=hs(t,(function(e,n){return e.invoke(n,t)}))})),r}function H(e,t,n,i,a){var o=e.static,s=e.dynamic;re.optional((function(){var e=[Wa,Xa,Ya,qa,Za,Qa,Ka,Ja,Ga,$a].concat(S);function t(t){Object.keys(t).forEach((function(t){re.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',a.commandStr)}))}t(o),t(s)}));var u=D(e,t),l=L(e),f=N(e,l,a),p=j(e,a),h=U(e,a),d=F(e,a,u);function v(e){var t=f[e];t&&(h[e]=t)}v(Ha),v(w(Va));var m=Object.keys(h).length>0,y={framebuffer:l,draw:p,shader:d,state:h,dirty:m,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(y.profile=I(e),y.uniforms=B(n,a),y.drawVAO=y.scopeVAO=p.vao,!y.drawVAO&&d.program&&!u&&r.angle_instanced_arrays&&p.static.elements){var g=!0,_=d.program.attributes.map((function(e){var n=t.static[e];return g=g&&!!n,n}));if(g&&_.length>0){var b=c.getVAO(c.createVAO({attributes:_,elements:p.static.elements}));y.drawVAO=new cs(null,null,null,(function(e,t){return e.link(b)})),y.useVAO=!0}}return u?y.useVAO=!0:y.attributes=z(t,a),y.context=V(i),y}function G(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach((function(a){t.save(r,"."+a);var o=n[a].append(e,t);Array.isArray(o)?i(r,".",a,"=[",o.join(),"];"):i(r,".",a,"=",o,";")})),t(i)}function W(e,t,n,r){var i,a=e.shared,o=a.gl,s=a.framebuffer;_&&(i=t.def(a.extensions,".webgl_draw_buffers"));var u,l=e.constants,c=l.drawBuffer,f=l.backBuffer;u=n?n.append(e,t):t.def(s,".next"),r||t("if(",u,"!==",s,".cur){"),t("if(",u,"){",o,".bindFramebuffer(",es,",",u,".framebuffer);"),_&&t(i,".drawBuffersWEBGL(",c,"[",u,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",es,",null);"),_&&t(i,".drawBuffersWEBGL(",f,");"),t("}",s,".cur=",u,";"),r||t("}")}function X(e,t,n){var r=e.shared,i=r.gl,a=e.current,o=e.next,s=r.current,u=r.next,l=e.cond(s,".dirty");S.forEach((function(t){var r,c,f=w(t);if(!(f in n.state))if(f in o){r=o[f],c=a[f];var p=Ce(E[f].length,(function(e){return l.def(r,"[",e,"]")}));l(e.cond(p.map((function(e,t){return e+"!=="+c+"["+t+"]"})).join("||")).then(i,".",A[f],"(",p,");",p.map((function(e,t){return c+"["+t+"]="+e})).join(";"),";"))}else{r=l.def(u,".",f);var h=e.cond(r,"!==",s,".",f);l(h),f in T?h(e.cond(r).then(i,".enable(",T[f],");").else(i,".disable(",T[f],");"),s,".",f,"=",r,";"):h(i,".",A[f],"(",r,");",s,".",f,"=",r,";")}})),0===Object.keys(n.state).length&&l(s,".dirty=false;"),t(l)}function Y(e,t,n,r){var i=e.shared,a=e.current,o=i.current,s=i.gl;ls(Object.keys(n)).forEach((function(i){var u=n[i];if(!r||r(u)){var l=u.append(e,t);if(T[i]){var c=T[i];fs(u)?t(s,l?".enable(":".disable(",c,");"):t(e.cond(l).then(s,".enable(",c,");").else(s,".disable(",c,");")),t(o,".",i,"=",l,";")}else if(pn(l)){var f=a[i];t(s,".",A[i],"(",l,");",l.map((function(e,t){return f+"["+t+"]="+e})).join(";"),";")}else t(s,".",A[i],"(",l,");",o,".",i,"=",l,";")}}))}function q(e,t){g&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function Z(e,t,n,r,i){var a,o,s,u=e.shared,l=e.stats,c=u.current,f=u.timer,p=n.profile;function h(){return"undefined"!=typeof my&&my&&"function"==typeof my.showToast||"undefined"==typeof performance?"Date.now()":"performance.now()"}function v(e){e(a=t.def(),"=",h(),";"),"string"==typeof i?e(l,".count+=",i,";"):e(l,".count++;"),d&&(r?e(o=t.def(),"=",f,".getNumPendingQueries();"):e(f,".beginQuery(",l,");"))}function m(e){e(l,".cpuTime+=",h(),"-",a,";"),d&&(r?e(f,".pushScopeStats(",o,",",f,".getNumPendingQueries(),",l,");"):e(f,".endQuery();"))}function y(e){var n=t.def(c,".profile");t(c,".profile=",e,";"),t.exit(c,".profile=",n,";")}if(p){if(fs(p))return void(p.enable?(v(t),m(t.exit),y("true")):y("false"));y(s=p.append(e,t))}else s=t.def(c,".profile");var g=e.block();v(g),t("if(",s,"){",g,"}");var _=e.block();m(_),t.exit("if(",s,"){",_,"}")}function K(e,t,n,r,i){var a=e.shared;function o(e){switch(e){case Ao:case Oo:case Io:return 2;case wo:case Mo:case Lo:return 3;case Co:case Ro:case No:return 4;default:return 1}}function s(n,r,i){var o=a.gl,s=t.def(n,".location"),u=t.def(a.attributes,"[",s,"]"),l=i.state,c=i.buffer,f=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];function h(){t("if(!",u,".buffer){",o,".enableVertexAttribArray(",s,");}");var n,a=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",u,".type!==",a,"||",u,".size!==",n,"||",p.map((function(e){return u+"."+e+"!=="+i[e]})).join("||"),"){",o,".bindBuffer(",co,",",c,".buffer);",o,".vertexAttribPointer(",[s,n,a,i.normalized,i.stride,i.offset],");",u,".type=",a,";",u,".size=",n,";",p.map((function(e){return u+"."+e+"="+i[e]+";"})).join(""),"}"),g){var l=i.divisor;t("if(",u,".divisor!==",l,"){",e.instancing,".vertexAttribDivisorANGLE(",[s,l],");",u,".divisor=",l,";}")}}function d(){t("if(",u,".buffer){",o,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",oa.map((function(e,t){return u+"."+e+"!=="+f[t]})).join("||"),"){",o,".vertexAttrib4f(",s,",",f,");",oa.map((function(e,t){return u+"."+e+"="+f[t]+";"})).join(""),"}")}l===ua?h():l===la?d():(t("if(",l,"===",ua,"){"),h(),t("}else{"),d(),t("}"))}r.forEach((function(r){var a,u=r.name,l=n.attributes[u];if(l){if(!i(l))return;a=l.append(e,t)}else{if(!i(ds))return;var c=e.scopeAttrib(u);re.optional((function(){e.assert(t,c+".state","missing attribute "+u)})),a={},Object.keys(new m).forEach((function(e){a[e]=t.def(c,".",e)}))}s(e.link(r),o(r.info.type),a)}))}function Q(e,n,r,i,a,o){for(var s,u=e.shared,l=u.gl,c=0;c<i.length;++c){var f,p=i[c],h=p.name,d=p.info.type,v=r.uniforms[h],m=e.link(p)+".location";if(v){if(!a(v))continue;if(fs(v)){var y=v.value;if(re.command(null!=y,'missing uniform "'+h+'"',e.commandStr),d===Uo||d===Bo){re.command("function"==typeof y&&(d===Uo&&("texture2d"===y._reglType||"framebuffer"===y._reglType)||d===Bo&&("textureCube"===y._reglType||"framebufferCube"===y._reglType)),"invalid texture for uniform "+h,e.commandStr);var g=e.link(y._texture||y.color[0]._texture);n(l,".uniform1i(",m,",",g+".bind());"),n.exit(g,".unbind();")}else if(d===Do||d===Fo||d===jo){re.optional((function(){re.command(pn(y),"invalid matrix for uniform "+h,e.commandStr),re.command(d===Do&&4===y.length||d===Fo&&9===y.length||d===jo&&16===y.length,"invalid length for matrix uniform "+h,e.commandStr)}));var _=e.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),b=2;d===Fo?b=3:d===jo&&(b=4),n(l,".uniformMatrix",b,"fv(",m,",false,",_,");")}else{switch(d){case To:re.commandType(y,"number","uniform "+h,e.commandStr),s="1f";break;case Ao:re.command(pn(y)&&2===y.length,"uniform "+h,e.commandStr),s="2f";break;case wo:re.command(pn(y)&&3===y.length,"uniform "+h,e.commandStr),s="3f";break;case Co:re.command(pn(y)&&4===y.length,"uniform "+h,e.commandStr),s="4f";break;case Po:re.commandType(y,"boolean","uniform "+h,e.commandStr),s="1i";break;case ko:re.commandType(y,"number","uniform "+h,e.commandStr),s="1i";break;case Io:case Oo:re.command(pn(y)&&2===y.length,"uniform "+h,e.commandStr),s="2i";break;case Lo:case Mo:re.command(pn(y)&&3===y.length,"uniform "+h,e.commandStr),s="3i";break;case No:case Ro:re.command(pn(y)&&4===y.length,"uniform "+h,e.commandStr),s="4i"}n(l,".uniform",s,"(",m,",",pn(y)?Array.prototype.slice.call(y):y,");")}continue}f=v.append(e,n)}else{if(!a(ds))continue;f=n.def(u.uniforms,"[",t.id(h),"]")}d===Uo?(re(!Array.isArray(f),"must specify a scalar prop for textures"),n("if(",f,"&&",f,'._reglType==="framebuffer"){',f,"=",f,".color[0];","}")):d===Bo&&(re(!Array.isArray(f),"must specify a scalar prop for cube maps"),n("if(",f,"&&",f,'._reglType==="framebufferCube"){',f,"=",f,".color[0];","}")),re.optional((function(){function t(t,r){e.assert(n,t,'bad data or missing for uniform "'+h+'".  '+r)}function r(e){re(!Array.isArray(f),"must not specify an array type for uniform"),t("typeof "+f+'==="'+e+'"',"invalid type, expected "+e)}function i(n,r){Array.isArray(f)?re(f.length===n,"must have length "+n):t(u.isArrayLike+"("+f+")&&"+f+".length==="+n,"invalid vector, should have length "+n,e.commandStr)}function a(n){re(!Array.isArray(f),"must not specify a value type"),t("typeof "+f+'==="function"&&'+f+'._reglType==="texture'+(n===po?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(d){case ko:r("number");break;case Oo:i(2);break;case Mo:i(3);break;case Ro:i(4);break;case To:r("number");break;case Ao:i(2);break;case wo:i(3);break;case Co:i(4);break;case Po:r("boolean");break;case Io:i(2);break;case Lo:i(3);break;case No:case Do:i(4);break;case Fo:i(9);break;case jo:i(16);break;case Uo:a(po);break;case Bo:a(ho)}}));var E=1;switch(d){case Uo:case Bo:var x=n.def(f,"._texture");n(l,".uniform1i(",m,",",x,".bind());"),n.exit(x,".unbind();");continue;case ko:case Po:s="1i";break;case Oo:case Io:s="2i",E=2;break;case Mo:case Lo:s="3i",E=3;break;case Ro:case No:s="4i",E=4;break;case To:s="1f";break;case Ao:s="2f",E=2;break;case wo:s="3f",E=3;break;case Co:s="4f",E=4;break;case Do:s="Matrix2fv";break;case Fo:s="Matrix3fv";break;case jo:s="Matrix4fv"}if("M"===s.charAt(0)){n(l,".uniform",s,"(",m,",");var S=Math.pow(d-Do+2,2),T=e.global.def("new Float32Array(",S,")");Array.isArray(f)?n("false,(",Ce(S,(function(e){return T+"["+e+"]="+f[e]})),",",T,")"):n("false,(Array.isArray(",f,")||",f," instanceof Float32Array)?",f,":(",Ce(S,(function(e){return T+"["+e+"]="+f+"["+e+"]"})),",",T,")"),n(");")}else if(E>1){for(var A=[],w=[],C=0;C<E;++C)Array.isArray(f)?w.push(f[C]):w.push(n.def(f+"["+C+"]")),o&&A.push(n.def());o&&n("if(!",e.batchId,"||",A.map((function(e,t){return e+"!=="+w[t]})).join("||"),"){",A.map((function(e,t){return e+"="+w[t]+";"})).join("")),n(l,".uniform",s,"(",m,",",w.join(","),");"),o&&n("}")}else{if(re(!Array.isArray(f),"uniform value must not be an array"),o){var k=n.def();n("if(!",e.batchId,"||",k,"!==",f,"){",k,"=",f,";")}n(l,".uniform",s,"(",m,",",f,");"),o&&n("}")}}}function J(e,t,n,r){var i=e.shared,a=i.gl,o=i.draw,s=r.draw;function u(){var u,l=s.elements,c=t;return l?((l.contextDep&&r.contextDynamic||l.propDep)&&(c=n),u=l.append(e,c),s.elementsActive&&c("if("+u+")"+a+".bindBuffer("+fo+","+u+".buffer.buffer);")):(u=c.def(),c(u,"=",o,".",qa,";","if(",u,"){",a,".bindBuffer(",fo,",",u,".buffer.buffer);}","else if(",i.vao,".currentVAO){",u,"=",e.shared.elements+".getElements("+i.vao,".currentVAO.elements);",b?"":"if("+u+")"+a+".bindBuffer("+fo+","+u+".buffer.buffer);","}")),u}function l(){var i,a=s.count,u=t;return a?((a.contextDep&&r.contextDynamic||a.propDep)&&(u=n),i=a.append(e,u),re.optional((function(){a.MISSING&&e.assert(t,"false","missing vertex count"),a.DYNAMIC&&e.assert(u,i+">=0","missing vertex count")}))):(i=u.def(o,".",Ka),re.optional((function(){e.assert(u,i+">=0","missing vertex count")}))),i}var c=u();function f(i){var a=s[i];return a?a.contextDep&&r.contextDynamic||a.propDep?a.append(e,n):a.append(e,t):t.def(o,".",i)}var p,h,d=f(Za),v=f(Qa),m=l();if("number"==typeof m){if(0===m)return}else n("if(",m,"){"),n.exit("}");g&&(p=f(Ja),h=e.instancing);var y=c+".type",_=s.elements&&fs(s.elements)&&!s.vaoActive;function E(){function e(){n(h,".drawElementsInstancedANGLE(",[d,m,y,v+"<<(("+y+"-"+sa+")>>1)",p],");")}function t(){n(h,".drawArraysInstancedANGLE(",[d,v,m,p],");")}c&&"null"!==c?_?e():(n("if(",c,"){"),e(),n("}else{"),t(),n("}")):t()}function x(){function e(){n(a+".drawElements("+[d,m,y,v+"<<(("+y+"-"+sa+")>>1)"]+");")}function t(){n(a+".drawArrays("+[d,v,m]+");")}c&&"null"!==c?_?e():(n("if(",c,"){"),e(),n("}else{"),t(),n("}")):t()}g&&("number"!=typeof p||p>=0)?"string"==typeof p?(n("if(",p,">0){"),E(),n("}else if(",p,"<0){"),x(),n("}")):E():x()}function $(e,t,n,r,i){var a=P(),o=a.proc("body",i);return re.optional((function(){a.commandStr=t.commandStr,a.command=a.link(t.commandStr)})),g&&(a.instancing=o.def(a.shared.extensions,".angle_instanced_arrays")),e(a,o,n,r),a.compile().body}function ee(e,t,n,r){q(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),K(e,t,n,r.attributes,(function(){return!0}))),Q(e,t,n,r.uniforms,(function(){return!0}),!1),J(e,t,t,n)}function te(e,t){var n=e.proc("draw",1);q(e,n),G(e,n,t.context),W(e,n,t.framebuffer),X(e,n,t),Y(e,n,t.state),Z(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)ee(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var i=e.global.def("{}"),a=n.def(r,".id"),o=n.def(i,"[",a,"]");n(e.cond(o).then(o,".call(this,a0);").else(o,"=",i,"[",a,"]=",e.link((function(n){return $(ee,e,t,n,1)})),"(",r,");",o,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;"),e.shared.vao&&n(e.shared.vao,".setVAO(null);")}function ne(e,t,n,r){function i(){return!0}e.batchId="a1",q(e,t),K(e,t,n,r.attributes,i),Q(e,t,n,r.uniforms,i,!1),J(e,t,t,n)}function ie(e,t,n,r){q(e,t);var i=n.contextDep,a=t.def(),o="a0",s="a1",u=t.def();e.shared.props=u,e.batchId=a;var l=e.scope(),c=e.scope();function f(e){return e.contextDep&&i||e.propDep}function p(e){return!f(e)}if(t(l.entry,"for(",a,"=0;",a,"<",s,";++",a,"){",u,"=",o,"[",a,"];",c,"}",l.exit),n.needsContext&&G(e,c,n.context),n.needsFramebuffer&&W(e,c,n.framebuffer),Y(e,c,n.state,f),n.profile&&f(n.profile)&&Z(e,c,n,!1,!0),r)n.useVAO?n.drawVAO?f(n.drawVAO)?c(e.shared.vao,".setVAO(",n.drawVAO.append(e,c),");"):l(e.shared.vao,".setVAO(",n.drawVAO.append(e,l),");"):l(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(l(e.shared.vao,".setVAO(null);"),K(e,l,n,r.attributes,p),K(e,c,n,r.attributes,f)),Q(e,l,n,r.uniforms,p,!1),Q(e,c,n,r.uniforms,f,!0),J(e,l,c,n);else{var h=e.global.def("{}"),d=n.shader.progVar.append(e,c),v=c.def(d,".id"),m=c.def(h,"[",v,"]");c(e.shared.gl,".useProgram(",d,".program);","if(!",m,"){",m,"=",h,"[",v,"]=",e.link((function(t){return $(ne,e,n,t,2)})),"(",d,");}",m,".call(this,a0[",a,"],",a,");")}}function ae(e,t){var n=e.proc("batch",2);e.batchId="0",q(e,n);var r=!1,i=!0;Object.keys(t.context).forEach((function(e){r=r||t.context[e].propDep})),r||(G(e,n,t.context),i=!1);var a=t.framebuffer,o=!1;function s(e){return e.contextDep&&r||e.propDep}a?(a.propDep?r=o=!0:a.contextDep&&r&&(o=!0),o||W(e,n,a)):W(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(r=!0),X(e,n,t),Y(e,n,t.state,(function(e){return!s(e)})),t.profile&&s(t.profile)||Z(e,n,t,!1,"a1"),t.contextDep=r,t.needsContext=i,t.needsFramebuffer=o;var u=t.shader.progVar;if(u.contextDep&&r||u.propDep)ie(e,n,t,null);else{var l=u.append(e,n);if(n(e.shared.gl,".useProgram(",l,".program);"),t.shader.program)ie(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var c=e.global.def("{}"),f=n.def(l,".id"),p=n.def(c,"[",f,"]");n(e.cond(p).then(p,".call(this,a0,a1);").else(p,"=",c,"[",f,"]=",e.link((function(n){return $(ie,e,t,n,2)})),"(",l,");",p,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;"),e.shared.vao&&n(e.shared.vao,".setVAO(null);")}function oe(e,n){var r=e.proc("scope",3);e.batchId="a2";var i=e.shared,a=i.current;function o(t){var a=n.shader[t];a&&r.set(i.shader,"."+t,a.append(e,r))}G(e,r,n.context),n.framebuffer&&n.framebuffer.append(e,r),ls(Object.keys(n.state)).forEach((function(t){var a=n.state[t].append(e,r);pn(a)?a.forEach((function(n,i){r.set(e.next[t],"["+i+"]",n)})):r.set(i.next,"."+t,a)})),Z(e,r,n,!0,!0),[qa,Qa,Ka,Ja,Za].forEach((function(t){var a=n.draw[t];a&&r.set(i.draw,"."+t,""+a.append(e,r))})),Object.keys(n.uniforms).forEach((function(a){var o=n.uniforms[a].append(e,r);Array.isArray(o)&&(o="["+o.join()+"]"),r.set(i.uniforms,"["+t.id(a)+"]",o)})),Object.keys(n.attributes).forEach((function(t){var i=n.attributes[t].append(e,r),a=e.scopeAttrib(t);Object.keys(new m).forEach((function(e){r.set(a,"."+e,i[e])}))})),n.scopeVAO&&r.set(i.vao,".targetVAO",n.scopeVAO.append(e,r)),o(Xa),o(Ya),Object.keys(n.state).length>0&&(r(a,".dirty=true;"),r.exit(a,".dirty=true;")),r("a1(",e.shared.context,",a0,",e.batchId,");")}function se(e){if("object"==typeof e&&!pn(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(ve.isDynamic(e[t[n]]))return!0;return!1}}function ue(e,t,n){var r=t.static[n];if(r&&se(r)){var i=e.global,a=Object.keys(r),o=!1,s=!1,u=!1,l=e.global.def("{}");a.forEach((function(t){var n=r[t];if(ve.isDynamic(n)){"function"==typeof n&&(n=r[t]=ve.unbox(n));var a=hs(n,null);o=o||a.thisDep,u=u||a.propDep,s=s||a.contextDep}else{switch(i(l,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}})),t.dynamic[n]=new ve.DynamicVariable(da,{thisDep:o,contextDep:s,propDep:u,ref:l,append:c}),delete t.static[n]}function c(e,t){a.forEach((function(n){var i=r[n];if(ve.isDynamic(i)){var a=e.invoke(t,i);t(l,".",n,"=",a,";")}}))}}function le(e,t,r,i,a){var o=P();o.stats=o.link(a),Object.keys(t.static).forEach((function(e){ue(o,t,e)})),lo.forEach((function(t){ue(o,e,t)}));var s=H(e,t,r,i,o);return te(o,s),oe(o,s),ae(o,s),n(o.compile(),{destroy:function(){s.shader.program.destroy()}})}return{next:x,current:E,procs:function(){var e=P(),t=e.proc("poll"),n=e.proc("refresh"),a=e.block();t(a),n(a);var o,s=e.shared,u=s.gl,l=s.next,c=s.current;a(c,".dirty=false;"),W(e,t),W(e,n,null,!0),g&&(o=e.link(g)),r.oes_vertex_array_object&&n(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var f=0;f<i.maxAttributes;++f){var p=n.def(s.attributes,"[",f,"]"),h=e.cond(p,".buffer");h.then(u,".enableVertexAttribArray(",f,");",u,".bindBuffer(",co,",",p,".buffer.buffer);",u,".vertexAttribPointer(",f,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(u,".disableVertexAttribArray(",f,");",u,".vertexAttrib4f(",f,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),n(h),g&&n(o,".vertexAttribDivisorANGLE(",f,",",p,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(T).forEach((function(r){var i=T[r],o=a.def(l,".",r),s=e.block();s("if(",o,"){",u,".enable(",i,")}else{",u,".disable(",i,")}",c,".",r,"=",o,";"),n(s),t("if(",o,"!==",c,".",r,"){",s,"}")})),Object.keys(A).forEach((function(r){var i,o,s=A[r],f=E[r],p=e.block();if(p(u,".",s,"("),pn(f)){var h=f.length;i=e.global.def(l,".",r),o=e.global.def(c,".",r),p(Ce(h,(function(e){return i+"["+e+"]"})),");",Ce(h,(function(e){return o+"["+e+"]="+i+"["+e+"];"})).join("")),t("if(",Ce(h,(function(e){return i+"["+e+"]!=="+o+"["+e+"]"})).join("||"),"){",p,"}")}else i=a.def(l,".",r),o=a.def(c,".",r),p(i,");",c,".",r,"=",i,";"),t("if(",i,"!==",o,"){",p,"}");n(p)})),e.compile()}(),compile:le}}function ms(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var ys=34918,gs=34919,_s=35007,bs=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function r(){return n.pop()||t.ext_disjoint_timer_query.createQueryEXT()}function i(e){n.push(e)}var a=[];function o(e){var n=r();t.ext_disjoint_timer_query.beginQueryEXT(_s,n),a.push(n),h(a.length-1,a.length,e)}function s(){t.ext_disjoint_timer_query.endQueryEXT(_s)}function u(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var l=[];function c(){return l.pop()||new u}function f(e){l.push(e)}var p=[];function h(e,t,n){var r=c();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,p.push(r)}var d=[],v=[];function m(){var e,n,r=a.length;if(0!==r){v.length=Math.max(v.length,r+1),d.length=Math.max(d.length,r+1),d[0]=0,v[0]=0;var o=0;for(e=0,n=0;n<a.length;++n){var s=a[n];t.ext_disjoint_timer_query.getQueryObjectEXT(s,gs)?(o+=t.ext_disjoint_timer_query.getQueryObjectEXT(s,ys),i(s)):a[e++]=s,d[n+1]=o,v[n+1]=e}for(a.length=e,e=0,n=0;n<p.length;++n){var u=p[n],l=u.startQueryIndex,c=u.endQueryIndex;u.sum+=d[c]-d[l];var h=v[l],m=v[c];m===h?(u.stats.gpuTime+=u.sum/1e6,f(u)):(u.startQueryIndex=h,u.endQueryIndex=m,p[e++]=u)}p.length=e}}return{beginQuery:o,endQuery:s,pushScopeStats:h,update:m,getNumPendingQueries:function(){return a.length},clear:function(){n.push.apply(n,a);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);a.length=0,n.length=0},restore:function(){a.length=0,n.length=0}}},Es=16384,xs=256,Ss=1024,Ts=34962,As="webglcontextlost",ws="webglcontextrestored",Cs=1,ks=2,Os=3;function Ms(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function Rs(e){var t=Ae(e);if(!t)return null;var r=t.gl,i=r.getContextAttributes(),a=r.isContextLost(),o=we(r,t);if(!o)return null;var s=ge(),u=ms(),l=o.extensions,c=bs(r,l),f=ye(),p=r.drawingBufferWidth,h=r.drawingBufferHeight,d={tick:0,time:0,viewportWidth:p,viewportHeight:h,framebufferWidth:p,framebufferHeight:h,drawingBufferWidth:p,drawingBufferHeight:h,pixelRatio:t.pixelRatio},v={},m={elements:null,primitive:4,count:-1,offset:0,instances:-1},y=St(r,l),g=Xt(r,u,t,E),_=sn(r,l,g,u),b=Xi(r,l,y,u,g,_,m);function E(e){return b.destroyBuffer(e)}var x=Qi(r,s,u,t),S=Jr(r,l,y,(function(){w.procs.poll()}),d,u,t),T=pi(r,l,y,u,t),A=Bi(r,l,y,S,T,u),w=vs(r,s,l,y,g,_,S,A,v,b,x,m,d,c,t),C=na(r,A,w.procs.poll,d,i,l,y),k=w.next,O=r.canvas,M=[],R=[],P=[],I=[t.onDestroy],L=null;function N(){if(0===M.length)return c&&c.update(),void(L=null);L=me.next(N),q();for(var e=M.length-1;e>=0;--e){var t=M[e];t&&t(d,null,0)}r.flush(),c&&c.update()}function D(){!L&&M.length>0&&(L=me.next(N))}function F(){L&&(me.cancel(N),L=null)}function j(e){e.preventDefault(),a=!0,F(),R.forEach((function(e){e()}))}function U(e){r.getError(),a=!1,o.restore(),x.restore(),g.restore(),S.restore(),T.restore(),A.restore(),b.restore(),c&&c.restore(),w.procs.refresh(),D(),P.forEach((function(e){e()}))}var B="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast;function z(){M.length=0,F(),!B&&O&&(O.removeEventListener(As,j),O.removeEventListener(ws,U)),x.clear(),A.clear(),T.clear(),b.clear(),S.clear(),_.clear(),g.clear(),c&&c.clear(),I.forEach((function(e){e()}))}function V(e){function t(e){var t=n({},e);function r(e){if(e in t){var n=t[e];delete t[e],Object.keys(n).forEach((function(r){t[e+"."+r]=n[r]}))}}return delete t.uniforms,delete t.attributes,delete t.context,delete t.vao,"stencil"in t&&t.stencil.op&&(t.stencil.opBack=t.stencil.opFront=t.stencil.op,delete t.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in e&&(t.vao=e.vao),t}function r(e,t){var n={},r={};return Object.keys(e).forEach((function(i){var a=e[i];if(ve.isDynamic(a))r[i]=ve.unbox(a,i);else{if(t&&Array.isArray(a))for(var o=0;o<a.length;++o)if(ve.isDynamic(a[o]))return void(r[i]=ve.unbox(a,i));n[i]=a}})),{dynamic:r,static:n}}re(!!e,"invalid args to regl({...})"),re.type(e,"object","invalid args to regl({...})");var i=r(e.context||{},!0),o=r(e.uniforms||{},!0),s=r(e.attributes||{},!1),u=r(t(e),!1),l={gpuTime:0,cpuTime:0,count:0},c=w.compile(u,s,o,i,l),f=c.draw,p=c.batch,h=c.scope,d=[];function v(e){for(;d.length<e;)d.push(null);return d}function m(e,t){var n;if(a&&re.raise("context lost"),"function"==typeof e)return h.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)h.call(this,null,t,n);else{if(!Array.isArray(e))return h.call(this,e,t,0);for(n=0;n<e.length;++n)h.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return p.call(this,v(0|e),0|e)}else{if(!Array.isArray(e))return f.call(this,e);if(e.length)return p.call(this,e,e.length)}}return n(m,{stats:l,destroy:function(){c.destroy()}})}!B&&O&&(O.addEventListener(As,j,!1),O.addEventListener(ws,U,!1));var H=A.setFBO=V({framebuffer:ve.define.call(null,Cs,"framebuffer")});function G(e,t){var n=0;w.procs.poll();var i=t.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=Es),"depth"in t&&(r.clearDepth(+t.depth),n|=xs),"stencil"in t&&(r.clearStencil(0|t.stencil),n|=Ss),re(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function W(e){if(re("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;t<6;++t)H(n({framebuffer:e.framebuffer.faces[t]},e),G);else H(e,G);else G(null,e)}function X(e){function t(){var t=Ms(M,e);function n(){var e=Ms(M,n);M[e]=M[M.length-1],M.length-=1,M.length<=0&&F()}re(t>=0,"cannot cancel a frame twice"),M[t]=n}return re.type(e,"function","regl.frame() callback must be a function"),M.push(e),D(),{cancel:t}}function Y(){var e=k.viewport,t=k.scissor_box;e[0]=e[1]=t[0]=t[1]=0,d.viewportWidth=d.framebufferWidth=d.drawingBufferWidth=e[2]=t[2]=r.drawingBufferWidth,d.viewportHeight=d.framebufferHeight=d.drawingBufferHeight=e[3]=t[3]=r.drawingBufferHeight}function q(){d.tick+=1,d.time=K(),Y(),w.procs.poll()}function Z(){S.refresh(),Y(),w.procs.refresh(),c&&c.update()}function K(){return(ye()-f)/1e3}function Q(e,t){var n;switch(re.type(t,"function","listener callback must be a function"),e){case"frame":return X(t);case"lost":n=R;break;case"restore":n=P;break;case"destroy":n=I;break;default:re.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}}Z();var J=n(V,{clear:W,prop:ve.define.bind(null,Cs),context:ve.define.bind(null,ks),this:ve.define.bind(null,Os),draw:V({}),buffer:function(e){return g.create(e,Ts,!1,!1)},elements:function(e){return _.create(e,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:T.create,framebuffer:A.create,framebufferCube:A.createCube,vao:b.createVAO,attributes:i,frame:X,on:Q,limits:y,hasExtension:function(e){return y.extensions.indexOf(e.toLowerCase())>=0},read:C,destroy:z,_gl:r,_refresh:Z,poll:function(){q(),c&&c.update()},now:K,stats:u});return t.onDone(null,J),J}return Rs}(t(rL)),aL=function(){function e(t,n){Fc(this,e),lc(this,"attribute",void 0),lc(this,"buffer",void 0);var r=n.buffer,i=n.offset,a=n.stride,o=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:a||0,normalized:o||!1,divisor:u||0},s&&(this.attribute.size=s)}return Uc(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),oL=(lc(HI={},yA.POINTS,"points"),lc(HI,yA.LINES,"lines"),lc(HI,yA.LINE_LOOP,"line loop"),lc(HI,yA.LINE_STRIP,"line strip"),lc(HI,yA.TRIANGLES,"triangles"),lc(HI,yA.TRIANGLE_FAN,"triangle fan"),lc(HI,yA.TRIANGLE_STRIP,"triangle strip"),HI),sL=(lc(GI={},yA.STATIC_DRAW,"static"),lc(GI,yA.DYNAMIC_DRAW,"dynamic"),lc(GI,yA.STREAM_DRAW,"stream"),GI),uL=(lc(WI={},yA.BYTE,"int8"),lc(WI,yA.UNSIGNED_INT,"int16"),lc(WI,yA.INT,"int32"),lc(WI,yA.UNSIGNED_BYTE,"uint8"),lc(WI,yA.UNSIGNED_SHORT,"uint16"),lc(WI,yA.UNSIGNED_INT,"uint32"),lc(WI,yA.FLOAT,"float"),WI),lL=(lc(XI={},yA.ALPHA,"alpha"),lc(XI,yA.LUMINANCE,"luminance"),lc(XI,yA.LUMINANCE_ALPHA,"luminance alpha"),lc(XI,yA.RGB,"rgb"),lc(XI,yA.RGBA,"rgba"),lc(XI,yA.RGBA4,"rgba4"),lc(XI,yA.RGB5_A1,"rgb5 a1"),lc(XI,yA.RGB565,"rgb565"),lc(XI,yA.DEPTH_COMPONENT,"depth"),lc(XI,yA.DEPTH_STENCIL,"depth stencil"),XI),cL=(lc(YI={},yA.DONT_CARE,"dont care"),lc(YI,yA.NICEST,"nice"),lc(YI,yA.FASTEST,"fast"),YI),fL=(lc(qI={},yA.NEAREST,"nearest"),lc(qI,yA.LINEAR,"linear"),lc(qI,yA.LINEAR_MIPMAP_LINEAR,"mipmap"),lc(qI,yA.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),lc(qI,yA.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),lc(qI,yA.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),qI),pL=(lc(ZI={},yA.REPEAT,"repeat"),lc(ZI,yA.CLAMP_TO_EDGE,"clamp"),lc(ZI,yA.MIRRORED_REPEAT,"mirror"),ZI),hL=(lc(KI={},yA.NONE,"none"),lc(KI,yA.BROWSER_DEFAULT_WEBGL,"browser"),KI),dL=(lc(QI={},yA.NEVER,"never"),lc(QI,yA.ALWAYS,"always"),lc(QI,yA.LESS,"less"),lc(QI,yA.LEQUAL,"lequal"),lc(QI,yA.GREATER,"greater"),lc(QI,yA.GEQUAL,"gequal"),lc(QI,yA.EQUAL,"equal"),lc(QI,yA.NOTEQUAL,"notequal"),QI),vL=(lc(JI={},yA.FUNC_ADD,"add"),lc(JI,yA.MIN_EXT,"min"),lc(JI,yA.MAX_EXT,"max"),lc(JI,yA.FUNC_SUBTRACT,"subtract"),lc(JI,yA.FUNC_REVERSE_SUBTRACT,"reverse subtract"),JI),mL=(lc($I={},yA.ZERO,"zero"),lc($I,yA.ONE,"one"),lc($I,yA.SRC_COLOR,"src color"),lc($I,yA.ONE_MINUS_SRC_COLOR,"one minus src color"),lc($I,yA.SRC_ALPHA,"src alpha"),lc($I,yA.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),lc($I,yA.DST_COLOR,"dst color"),lc($I,yA.ONE_MINUS_DST_COLOR,"one minus dst color"),lc($I,yA.DST_ALPHA,"dst alpha"),lc($I,yA.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),lc($I,yA.CONSTANT_COLOR,"constant color"),lc($I,yA.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),lc($I,yA.CONSTANT_ALPHA,"constant alpha"),lc($I,yA.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),lc($I,yA.SRC_ALPHA_SATURATE,"src alpha saturate"),$I),yL=(lc(eL={},yA.NEVER,"never"),lc(eL,yA.ALWAYS,"always"),lc(eL,yA.LESS,"less"),lc(eL,yA.LEQUAL,"lequal"),lc(eL,yA.GREATER,"greater"),lc(eL,yA.GEQUAL,"gequal"),lc(eL,yA.EQUAL,"equal"),lc(eL,yA.NOTEQUAL,"notequal"),eL),gL=(lc(tL={},yA.ZERO,"zero"),lc(tL,yA.KEEP,"keep"),lc(tL,yA.REPLACE,"replace"),lc(tL,yA.INVERT,"invert"),lc(tL,yA.INCR,"increment"),lc(tL,yA.DECR,"decrement"),lc(tL,yA.INCR_WRAP,"increment wrap"),lc(tL,yA.DECR_WRAP,"decrement wrap"),tL),_L=(lc(nL={},yA.FRONT,"front"),lc(nL,yA.BACK,"back"),nL),bL=function(){function e(t,n){Fc(this,e),lc(this,"buffer",void 0);var r=n.data,i=n.usage,a=n.type;this.buffer=t.buffer({data:r,usage:sL[i||yA.STATIC_DRAW],type:uL[a||yA.UNSIGNED_BYTE]})}return Uc(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.buffer.subdata(t,n)}}]),e}(),EL=function(){function e(t,n){Fc(this,e),lc(this,"elements",void 0);var r=n.data,i=n.usage,a=n.type,o=n.count;this.elements=t.elements({data:r,usage:sL[i||yA.STATIC_DRAW],type:uL[a||yA.UNSIGNED_BYTE],count:o})}return Uc(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){var t=e.data;this.elements.subdata(t)}},{key:"destroy",value:function(){}}]),e}(),xL=function(){function e(t,n){Fc(this,e),lc(this,"framebuffer",void 0);var r=n.width,i=n.height,a=n.color,o=n.colors;n.depth,n.stencil;var s={width:r,height:i};Array.isArray(o)&&(s.colors=o.map((function(e){return e.get()}))),a&&"boolean"!=typeof a&&(s.color=a.get()),this.framebuffer=t.framebuffer(s)}return Uc(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.framebuffer.resize(t,n)}}]),e}();function SL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SL(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var AL,wL=function(){function e(t,n){Fc(this,e),lc(this,"reGl",void 0),lc(this,"destroyed",!1),lc(this,"drawCommand",void 0),lc(this,"drawParams",void 0),lc(this,"options",void 0),lc(this,"uniforms",{}),this.reGl=t;var r=n.vs,i=n.fs,a=n.attributes,o=n.uniforms,s=n.primitive,u=n.count,l=n.elements,c=n.depth,f=n.blend,p=n.stencil,h=n.cull,d=n.instances,v={};this.options=n,o&&(this.uniforms=this.extractUniforms(o),Object.keys(o).forEach((function(e){v[e]=t.prop(e)})));var m={};Object.keys(a).forEach((function(e){m[e]=a[e].get()}));var y={attributes:m,frag:i,uniforms:v,vert:r,primitive:oL[void 0===s?yA.TRIANGLES:s]};d&&(y.instances=d),u&&(y.count=u),l&&(y.elements=l.get()),this.initDepthDrawParams({depth:c},y),this.initBlendDrawParams({blend:f},y),this.initStencilDrawParams({stencil:p},y),this.initCullDrawParams({cull:h},y),this.drawCommand=t(y),this.drawParams=y}return Uc(e,[{key:"addUniforms",value:function(e){this.uniforms=TL(TL({},this.uniforms),this.extractUniforms(e))}},{key:"draw",value:function(e){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var t=TL(TL({},this.uniforms),this.extractUniforms(e.uniforms||{})),n={};Object.keys(t).forEach((function(e){var r=Wc(t[e]);"boolean"===r||"number"===r||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?n[e]=t[e]:n[e]=t[e].get()})),this.drawCommand(n)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach((function(e){e.destroy()})),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:dL[n.func||yA.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var r=n.enable,i=n.func,a=n.equation,o=n.color,s=void 0===o?[0,0,0,0]:o;t.blend={enable:!!r,func:{srcRGB:mL[i&&i.srcRGB||yA.SRC_ALPHA],srcAlpha:mL[i&&i.srcAlpha||yA.SRC_ALPHA],dstRGB:mL[i&&i.dstRGB||yA.ONE_MINUS_SRC_ALPHA],dstAlpha:mL[i&&i.dstAlpha||yA.ONE_MINUS_SRC_ALPHA]},equation:{rgb:vL[a&&a.rgb||yA.FUNC_ADD],alpha:vL[a&&a.alpha||yA.FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var r=n.enable,i=n.mask,a=void 0===i?-1:i,o=n.func,s=void 0===o?{cmp:yA.ALWAYS,ref:0,mask:-1}:o,u=n.opFront,l=void 0===u?{fail:yA.KEEP,zfail:yA.KEEP,zpass:yA.KEEP}:u,c=n.opBack,f=void 0===c?{fail:yA.KEEP,zfail:yA.KEEP,zpass:yA.KEEP}:c;t.stencil={enable:!!r,mask:a,func:TL(TL({},s),{},{cmp:yL[s.cmp]}),opFront:{fail:gL[l.fail],zfail:gL[l.zfail],zpass:gL[l.zpass]},opBack:{fail:gL[f.fail],zfail:gL[f.zfail],zpass:gL[f.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var r=n.enable,i=n.face,a=void 0===i?yA.BACK:i;t.cull={enable:!!r,face:_L[a]}}}},{key:"extractUniforms",value:function(e){var t=this,n={};return Object.keys(e).forEach((function(r){t.extractUniformsRecursively(r,e[r],n,"")})),n}},{key:"extractUniformsRecursively",value:function(e,t,n,r){var i=this;null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||zm(t)||""===t||"resize"in t?n["".concat(r&&r+".").concat(e)]=t:(Om(t)&&Object.keys(t).forEach((function(a){i.extractUniformsRecursively(a,t[a],n,"".concat(r&&r+".").concat(e))})),Array.isArray(t)&&t.forEach((function(t,a){Object.keys(t).forEach((function(o){i.extractUniformsRecursively(o,t[o],n,"".concat(r&&r+".").concat(e,"[").concat(a,"]"))}))})))}}]),e}(),CL=function(){function e(t,n){Fc(this,e),lc(this,"texture",void 0),lc(this,"width",void 0),lc(this,"height",void 0);var r=n.data,i=n.type,a=void 0===i?yA.UNSIGNED_BYTE:i,o=n.width,s=n.height,u=n.flipY,l=void 0!==u&&u,c=n.format,f=void 0===c?yA.RGBA:c,p=n.mipmap,h=void 0!==p&&p,d=n.wrapS,v=void 0===d?yA.CLAMP_TO_EDGE:d,m=n.wrapT,y=void 0===m?yA.CLAMP_TO_EDGE:m,g=n.aniso,_=void 0===g?0:g,b=n.alignment,E=void 0===b?1:b,x=n.premultiplyAlpha,S=void 0!==x&&x,T=n.mag,A=void 0===T?yA.NEAREST:T,w=n.min,C=void 0===w?yA.NEAREST:w,k=n.colorSpace,O=void 0===k?yA.BROWSER_DEFAULT_WEBGL:k;this.width=o,this.height=s;var M={width:o,height:s,type:uL[a],format:lL[f],wrapS:pL[v],wrapT:pL[y],mag:fL[A],min:fL[C],alignment:E,flipY:l,colorSpace:hL[O],premultiplyAlpha:S,aniso:_};r&&(M.data=r),"number"==typeof h?M.mipmap=cL[h]:"boolean"==typeof h&&(M.mipmap=h),this.texture=t.texture(M)}return Uc(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture(e)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),kL=Fx()(AL=function(){function e(){var t=this;Fc(this,e),lc(this,"extensionObject",void 0),lc(this,"gl",void 0),lc(this,"$container",void 0),lc(this,"canvas",void 0),lc(this,"width",void 0),lc(this,"height",void 0),lc(this,"isDirty",void 0),lc(this,"createModel",(function(e){return new wL(t.gl,e)})),lc(this,"createAttribute",(function(e){return new aL(t.gl,e)})),lc(this,"createBuffer",(function(e){return new bL(t.gl,e)})),lc(this,"createElements",(function(e){return new EL(t.gl,e)})),lc(this,"createTexture2D",(function(e){return new CL(t.gl,e)})),lc(this,"createFramebuffer",(function(e){return new xL(t.gl,e)})),lc(this,"useFramebuffer",(function(e,n){t.gl({framebuffer:e?e.get():null})(n)})),lc(this,"clear",(function(e){var n=e.color,r=e.depth,i=e.stencil,a=e.framebuffer,o=void 0===a?null:a,s={color:n,depth:r,stencil:i};s.framebuffer=null===o?o:o.get(),t.gl.clear(s)})),lc(this,"viewport",(function(e){var n=e.x,r=e.y,i=e.width,a=e.height;t.gl._gl.viewport(n,r,i,a),t.width=i,t.height=a,t.gl._refresh()})),lc(this,"readPixels",(function(e){var n=e.framebuffer,r={x:e.x,y:e.y,width:e.width,height:e.height};return n&&(r.framebuffer=n.get()),t.gl.read(r)})),lc(this,"getViewportSize",(function(){return{width:t.gl._gl.drawingBufferWidth,height:t.gl._gl.drawingBufferHeight}})),lc(this,"getContainer",(function(){return sp?t.canvas:null===(e=t.canvas)||void 0===e?void 0:e.parentElement;var e})),lc(this,"getCanvas",(function(){return t.canvas})),lc(this,"getGLContext",(function(){return t.gl._gl})),lc(this,"destroy",(function(){t.gl.destroy()}))}var t;return Uc(e,[{key:"init",value:(t=vA(MA.mark((function e(t,n){var r=this;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canvas=t,e.next=3,new Promise((function(e,t){iL({canvas:r.canvas,attributes:{alpha:!0,antialias:n.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:n.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(n,r){!n&&r||t(n),e(r)}})}));case 3:this.gl=e.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"testExtension",value:function(e){return!!this.getGLContext().getExtension(e)}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var e=this.getGLContext();e.disable(e.CULL_FACE)}},{key:"setDirty",value:function(e){this.isDirty=e}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||AL;function OL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ML(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?OL(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var RL,PL,IL,LL=function(){function e(t){Fc(this,e),lc(this,"sceneService",void 0),lc(this,"mapService",void 0),lc(this,"controlService",void 0),lc(this,"layerService",void 0),lc(this,"iconService",void 0),lc(this,"markerService",void 0),lc(this,"popupService",void 0),lc(this,"fontService",void 0),lc(this,"interactionService",void 0),lc(this,"container",void 0);var n=t.id,r=t.map,i=t.canvas,a=t.hasBaseMap,o=function(){var e=new Dx;return e.parent=kM,e.bind(Bx.SceneID).toConstantValue("".concat(zM++)),e.bind(Bx.ILayerService).to(XA).inSingletonScope(),e.bind(Bx.ISceneService).to(Xw).inSingletonScope(),e.bind(Bx.ICameraService).to(_T).inSingletonScope(),e.bind(Bx.ICoordinateSystemService).to(tA).inSingletonScope(),e.bind(Bx.IInteractionService).to(hA).inSingletonScope(),e.bind(Bx.IPickingService).to(GA).inSingletonScope(),e.bind(Bx.IControlService).to(AT).inSingletonScope(),e.bind(Bx.IMarkerService).to(wT).inSingletonScope(),e.bind(Bx.IIconService).to(cS).inSingletonScope(),e.bind(Bx.IFontService).to(uS).inSingletonScope(),e.bind(Bx.IPopupService).to(CT).inSingletonScope(),e.bind(Bx.INormalPass).to(HC).whenTargetNamed("clear"),e.bind(Bx.INormalPass).to(QC).whenTargetNamed("pixelPicking"),e.bind(Bx.INormalPass).to(yM).whenTargetNamed("render"),e.bind(Bx.INormalPass).to(CM).whenTargetNamed("taa"),e.bind(Bx.IFactoryNormalPass).toFactory((function(e){return function(t){return e.container.getNamed(Bx.INormalPass,t)}})),e.bind(Bx.IPostProcessingPass).to(zO).whenTargetNamed("copy"),e.bind(Bx.IPostProcessingPass).to(kO).whenTargetNamed("blurH"),e.bind(Bx.IPostProcessingPass).to(IO).whenTargetNamed("blurV"),e.bind(Bx.IPostProcessingPass).to(eM).whenTargetNamed("noise"),e.bind(Bx.IPostProcessingPass).to(lM).whenTargetNamed("sepia"),e.bind(Bx.IPostProcessingPass).to(jO).whenTargetNamed("colorHalftone"),e.bind(Bx.IPostProcessingPass).to(XO).whenTargetNamed("hexagonalPixelate"),e.bind(Bx.IPostProcessingPass).to(QO).whenTargetNamed("ink"),e.bind(Bx.IFactoryPostProcessingPass).toFactory((function(e){return function(t){var n=e.container.getNamed(Bx.IPostProcessingPass,t);return n.setName(t),n}})),e}();this.container=o,r.setContainer(o,n,i,a),o.bind(Bx.IRendererService).to(kL).inSingletonScope(),this.sceneService=o.get(Bx.ISceneService),this.mapService=o.get(Bx.IMapService),this.iconService=o.get(Bx.IIconService),this.fontService=o.get(Bx.IFontService),this.controlService=o.get(Bx.IControlService),this.layerService=o.get(Bx.ILayerService),this.markerService=o.get(Bx.IMarkerService),this.interactionService=o.get(Bx.IInteractionService),this.popupService=o.get(Bx.IPopupService),sp?this.sceneService.initMiniScene(t):(this.initComponent(n),this.sceneService.init(t),this.initControl())}return Uc(e,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(e){return this.sceneService.exportPng(e)}},{key:"exportMap",value:function(e){return this.sceneService.exportPng(e)}},{key:"registerRenderService",value:function(e){var t=this;this.sceneService.loaded?new e(this).init():this.on("loaded",(function(){new e(t).init()}))}},{key:"map",get:function(){return this.mapService.map}},{key:"setBgColor",value:function(e){this.mapService.setBgColor(e)}},{key:"addLayer",value:function(e){var t=function(e){var t=new Dx;return t.parent=e,t.bind(Bx.IStyleAttributeService).to(ow).inSingletonScope(),t.bind(Bx.IMultiPassRenderer).to(YC).inSingletonScope(),t.bind(Bx.IPostProcessor).to(cM).inSingletonScope(),t}(this.container);e.setContainer(t,this.container),this.sceneService.addLayer(e)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(e){return this.layerService.getLayer(e)}},{key:"getLayerByName",value:function(e){return this.layerService.getLayerByName(e)}},{key:"removeLayer",value:function(e,t){this.layerService.remove(e,t)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addIconFont",value:function(e,t){this.fontService.addIconFont(e,t)}},{key:"addIconFonts",value:function(e){var t=this;e.forEach((function(e){var n=Ic(e,2),r=n[0],i=n[1];t.fontService.addIconFont(r,i)}))}},{key:"addFontFace",value:function(e,t){this.sceneService.addFontFace(e,t)}},{key:"addImage",value:function(e,t){sp?this.iconService.addImageMini(e,t,this.sceneService):this.iconService.addImage(e,t)}},{key:"hasImage",value:function(e){return this.iconService.hasImage(e)}},{key:"removeImage",value:function(e){this.iconService.removeImage(e)}},{key:"addIconFontGlyphs",value:function(e,t){this.fontService.addIconGlyphs(t)}},{key:"addControl",value:function(e){this.controlService.addControl(e,this.container)}},{key:"removeControl",value:function(e){this.controlService.removeControl(e)}},{key:"getControlByName",value:function(e){return this.controlService.getControlByName(e)}},{key:"addMarker",value:function(e){this.markerService.addMarker(e)}},{key:"addMarkerLayer",value:function(e){this.markerService.addMarkerLayer(e)}},{key:"removeMarkerLayer",value:function(e){this.markerService.removeMarkerLayer(e)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(e){this.popupService.addPopup(e)}},{key:"on",value:function(e,t){-1===JM.indexOf(e)?this.mapService.on(e,t):this.sceneService.on(e,t)}},{key:"once",value:function(e,t){-1===JM.indexOf(e)?this.mapService.once(e,t):this.sceneService.once(e,t)}},{key:"off",value:function(e,t){-1===JM.indexOf(e)?this.mapService.off(e,t):this.sceneService.off(e,t)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(e){return this.mapService.getCenter(e)}},{key:"setCenter",value:function(e,t){return this.mapService.setCenter(e,t)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(e){return this.mapService.setPitch(e)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(e){this.mapService.setRotation(e)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(e){this.mapService.panTo(e)}},{key:"panBy",value:function(e,t){this.mapService.panBy(e,t)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(e){this.mapService.setZoom(e)}},{key:"fitBounds",value:function(e,t){var n=this.sceneService.getSceneConfig(),r=n.fitBoundsOptions,i=n.animate;this.mapService.fitBounds(e,t||ML(ML({},r),{},{animate:i}))}},{key:"setZoomAndCenter",value:function(e,t){this.mapService.setZoomAndCenter(e,t)}},{key:"setMapStyle",value:function(e){this.mapService.setMapStyle(e)}},{key:"setMapStatus",value:function(e){this.mapService.setMapStatus(e)}},{key:"pixelToLngLat",value:function(e){return this.mapService.pixelToLngLat(e)}},{key:"lngLatToPixel",value:function(e){return this.mapService.lngLatToPixel(e)}},{key:"containerToLngLat",value:function(e){return this.mapService.containerToLngLat(e)}},{key:"lngLatToContainer",value:function(e){return this.mapService.lngLatToContainer(e)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(e,t){this.container.bind(Bx.IPostProcessingPass).to(e).whenTargetNamed(t)}},{key:"initComponent",value:function(e){var t,n;this.controlService.init({container:(t=e,n=t,"string"==typeof t&&(n=lp.document.getElementById(t)),n)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var e=this.sceneService.getSceneConfig(),t=e.logoVisible,n=e.logoPosition;t&&this.addControl(new oR({position:n}))}}]),e}();function NL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function DL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NL(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var FL,jL,UL=(RL=BM(Bx.IGlobalConfigService),PL=function(){function e(t){Fc(this,e),DT(this,"configService",IL,this),lc(this,"config",void 0),this.config=t}return Uc(e,[{key:"setContainer",value:function(e,t,n,r){e.bind(Bx.MapConfig).toConstantValue(DL(DL({},this.config),{},{id:t,canvas:n,hasBaseMap:r})),e.bind(Bx.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),IL=FT(PL.prototype,"configService",[RL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PL),BL={exports:{}},zL=BL.exports=function(){function e(e){var r=[];return e.AMapUI&&r.push(t(e.AMapUI)),e.Loca&&r.push(n(e.Loca)),Promise.all(r)}function t(e){return new Promise((function(t,n){var s=[];if(e.plugins)for(var u=0;u<e.plugins.length;u+=1)-1==i.AMapUI.plugins.indexOf(e.plugins[u])&&s.push(e.plugins[u]);if(a.AMapUI===r.failed)n("前次请求 AMapUI 失败");else if(a.AMapUI===r.notload){a.AMapUI=r.loading,i.AMapUI.version=e.version||i.AMapUI.version,u=i.AMapUI.version;var l=document.body||document.head,c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/ui/"+u+"/main.js",c.onerror=function(e){a.AMapUI=r.failed,n("请求 AMapUI 失败")},c.onload=function(){if(a.AMapUI=r.loaded,s.length)window.AMapUI.loadUI(s,(function(){for(var e=0,n=s.length;e<n;e++){var r=s[e].split("/").slice(-1)[0];window.AMapUI[r]=arguments[e]}for(t();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()}));else for(t();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()},l.appendChild(c)}else a.AMapUI===r.loaded?e.version&&e.version!==i.AMapUI.version?n("不允许多个版本 AMapUI 混用"):s.length?window.AMapUI.loadUI(s,(function(){for(var e=0,n=s.length;e<n;e++){var r=s[e].split("/").slice(-1)[0];window.AMapUI[r]=arguments[e]}t()})):t():e.version&&e.version!==i.AMapUI.version?n("不允许多个版本 AMapUI 混用"):o.AMapUI.push((function(e){e?n(e):s.length?window.AMapUI.loadUI(s,(function(){for(var e=0,n=s.length;e<n;e++){var r=s[e].split("/").slice(-1)[0];window.AMapUI[r]=arguments[e]}t()})):t()}))}))}function n(e){return new Promise((function(t,n){if(i.AMap.version.startsWith("2.0"))n("Loca 暂不适配 JSAPI 2.0,请使用 1.4.15");else if(a.Loca===r.failed)n("前次请求 Loca 失败");else if(a.Loca===r.notload){a.Loca=r.loading,i.Loca.version=e.version||i.Loca.version;var s=i.Loca.version,u=i.key,l=document.body||document.head,c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/loca?v="+s+"&key="+u,c.onerror=function(e){a.Loca=r.failed,n("请求 AMapUI 失败")},c.onload=function(){for(a.Loca=r.loaded,t();o.Loca.length;)o.Loca.splice(0,1)[0]()},l.appendChild(c)}else a.Loca===r.loaded?e.version&&e.version!==i.Loca.version?n("不允许多个版本 Loca 混用"):t():e.version&&e.version!==i.Loca.version?n("不允许多个版本 Loca 混用"):o.Loca.push((function(e){e?n(e):n()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var r;!function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"}(r||(r={}));var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},o={AMap:[],AMapUI:[],Loca:[]},s=[],u=function(e){"function"==typeof e&&(a.AMap===r.loaded?e(window.AMap):s.push(e))};return{load:function(t){return new Promise((function(n,o){if(a.AMap==r.failed)o("");else if(a.AMap==r.notload){var l=t.key,c=t.version,f=t.plugins;l?(window.AMap&&"lbs.amap.com"!==location.host&&o("禁止多种API加载方式混用"),i.key=l,i.AMap.version=c||i.AMap.version,i.AMap.plugins=f||i.AMap.plugins,a.AMap=r.loading,c=document.body||document.head,window.___onAPILoaded=function(i){if(delete window.___onAPILoaded,i)a.AMap=r.failed,o(i);else for(a.AMap=r.loaded,e(t).then((function(){n(window.AMap)})).catch(o);s.length;)s.splice(0,1)[0]()},(f=document.createElement("script")).type="text/javascript",f.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+l+"&plugin="+i.AMap.plugins.join(","),f.onerror=function(e){a.AMap=r.failed,o(e)},c.appendChild(f)):o("请填写key")}else if(a.AMap==r.loaded)if(t.key&&t.key!==i.key)o("多个不一致的 key");else if(t.version&&t.version!==i.AMap.version)o("不允许多个版本 JSAPI 混用");else{if(l=[],t.plugins)for(c=0;c<t.plugins.length;c+=1)-1==i.AMap.plugins.indexOf(t.plugins[c])&&l.push(t.plugins[c]);l.length?window.AMap.plugin(l,(function(){e(t).then((function(){n(window.AMap)})).catch(o)})):e(t).then((function(){n(window.AMap)})).catch(o)}else if(t.key&&t.key!==i.key)o("多个不一致的 key");else if(t.version&&t.version!==i.AMap.version)o("不允许多个版本 JSAPI 混用");else{var p=[];if(t.plugins)for(c=0;c<t.plugins.length;c+=1)-1==i.AMap.plugins.indexOf(t.plugins[c])&&p.push(t.plugins[c]);u((function(){p.length?window.AMap.plugin(p,(function(){e(t).then((function(){n(window.AMap)})).catch(o)})):e(t).then((function(){n(window.AMap)})).catch(o)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},o={AMap:[],AMapUI:[],Loca:[]}}}}();function VL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VL(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function GL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={top:0,right:0,bottom:0,left:0};if("number"==typeof e)return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(4===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return HL(HL({},t),e)}(jL=FL||(FL={}))["GAODE1.x"]="GAODE1.x",jL["GAODE2.x"]="GAODE2.x",jL.MAPBOX="MAPBOX",jL.L7MAP="L7MAP",jL.GLOBEL="GLOBEL";var WL,XL,YL,qL,ZL,KL,QL,JL,$L,eN,tN,nN={dark:"amap://styles/dark",light:"amap://styles/light",normal:"amap://styles/normal",blank:"amap://styles/1a91e7ec761981d85b35f3099ff781a3"},rN=function(){function e(){Fc(this,e),lc(this,"projectionMatrix",dS()),lc(this,"viewMatrix",dS()),lc(this,"viewProjectionMatrix",dS()),lc(this,"ViewProjectionMatrixUncentered",dS()),lc(this,"viewUncenteredMatrix",dS()),lc(this,"zoom",void 0),lc(this,"center",void 0)}return Uc(e,[{key:"syncWithMapCamera",value:function(e){var t=e.zoom,n=void 0===t?1:t,r=e.center,i=void 0===r?[0,0]:r,a=e.offsetOrigin,o=void 0===a?[0,0]:a,s=e.cameraPosition,u=void 0===s?[0,0,0]:s,l=e.up,c=void 0===l?[0,1,0]:l,f=e.lookAt,p=void 0===f?[0,0,0]:f,h=e.aspect,d=void 0===h?1:h,v=e.near,m=void 0===v?.1:v,y=e.far,g=void 0===y?1e3:y,_=e.fov,b=void 0===_?45:_;this.zoom=n,this.center=i,OS(this.projectionMatrix,b/180*Math.PI,d,m,g);var E=US.apply(oT,pc(u)),x=US.apply(oT,pc(p)),S=US.apply(oT,pc(c));PS(this.viewMatrix,E,x,S),this.viewUncenteredMatrix=vS(this.viewMatrix),bS(this.viewMatrix,this.viewMatrix,US(-o[0],o[1],0)),_S(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),_S(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var e=Ic(this.center,2);return[e[0],e[1]]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(e,t){var n=85.0511287798,r=Math.max(Math.min(n,e[1]),-n),i=256<<20,a=Math.PI/180,o=e[0]*a,s=r*a;s=Math.log(Math.tan(Math.PI/4+s/2));return[o=i*(.5/Math.PI*o+.5)-215440491,s=-(i*(-.5/Math.PI*s+(a=.5))-106744817)]}}]),e}(),iN=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"];function aN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aN(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e,t){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o)}}(".amap-logo{\n display: none !important;\n}\n");var sN=0;window.forceWebGL=!0;var uN=!1,lN=[],cN=(WL=Fx(),XL=nx(Bx.IGlobalConfigService),YL=nx(Bx.MapConfig),qL=nx(Bx.ICoordinateSystemService),ZL=nx(Bx.IEventEmitter),WL((QL=function(){function e(){var t=this;Fc(this,e),lc(this,"version",FL["GAODE2.x"]),lc(this,"map",void 0),lc(this,"dragging",!1),lc(this,"sceneCenter",void 0),lc(this,"sceneCenterMKT",void 0),lc(this,"bgColor","rgba(0, 0, 0, 0)"),DT(this,"configService",JL,this),DT(this,"config",$L,this),DT(this,"coordinateSystemService",eN,this),DT(this,"eventEmitter",tN,this),lc(this,"markerContainer",void 0),lc(this,"$mapContainer",void 0),lc(this,"viewport",void 0),lc(this,"cameraChangedCallback",void 0),lc(this,"handleViewChanged",(function(e){var n=t.map.customCoords.getCameraParams(),r=n.fov,i=n.near,a=n.far,o=n.aspect,s=n.position,u=n.lookAt,l=n.up;t.emit("mapchange");var c=e.zoom,f=t.map.customCoords.getCenter();t.cameraChangedCallback&&(t.viewport.syncWithMapCamera({aspect:o,far:a,fov:r,cameraPosition:s,lookAt:u,up:l,near:i,zoom:c-1,center:f,offsetOrigin:[s[0],s[1]]}),t.coordinateSystemService.setCoordinateSystem(jT.P20_2),t.cameraChangedCallback(t.viewport))}))}var t;return Uc(e,[{key:"setBgColor",value:function(e){this.bgColor=e}},{key:"setCustomCoordCenter",value:function(e){var t;this.sceneCenter=e,this.sceneCenterMKT=(t=this.map.getProjection()).project.apply(t,pc(this.sceneCenter))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoord",value:function(e){var t=this.map.getProjection().project;return this.sceneCenter||(this.map.customCoords.setCenter(e),this.setCustomCoordCenter(e)),this._sub(t(e[0],e[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(e){var t=this;return e.map((function(e){return"number"==typeof e[0]?t.lngLatToCoord(e):e.map((function(e){return t.lngLatToCoord(e)}))}))}},{key:"addMarkerContainer",value:function(){if(this.map){var e=this.map.getContainer();if(null!==e){var t=e.getElementsByClassName("amap-maps")[0];t.style.zIndex="auto",this.markerContainer=pp("div","l7-marker-container2",t)}}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(e,t){-1!==GM.indexOf(e)?this.eventEmitter.on(e,t):this.map.on(e,t)}},{key:"off",value:function(e,t){-1!==GM.indexOf(e)?this.eventEmitter.off(e,t):this.map.off(e,t)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var e;return null===(e=this.map.getContainer())||void 0===e?void 0:e.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var e=this.map.getSize();return[e.getWidth(),e.getHeight()]}},{key:"getType",value:function(){return"amap2"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(e){return this.map.setZoom(e)}},{key:"getCenter",value:function(e){if(null!=e&&e.padding){var t=this.getCenter(),n=Ic(this.getSize(),2);n[0],n[1];var r=GL(e.padding),i=this.lngLatToPixel([t.lng,t.lat]),a=[(r.right-r.left)/2,(r.bottom-r.top)/2];return this.pixelToLngLat([i.x-a[0],i.y-a[1]])}var o=this.map.getCenter();return{lng:o.getLng(),lat:o.getLat()}}},{key:"setCenter",value:function(e,t){if(null!=t&&t.padding){var n=GL(t.padding),r=this.lngLatToPixel(e),i=[(n.right-n.left)/2,(n.bottom-n.top)/2],a=this.pixelToLngLat([r.x+i[0],r.y+i[1]]);this.map.setCenter([a.lng,a.lat])}else this.map.setCenter(e)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var e=this.map.getBounds(),t=e.getNorthEast(),n=e.getSouthWest(),r=this.getCenter(),i=r.lng>t.getLng()||r.lng<n.getLng()?180-t.getLng():t.getLng();return[[r.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[i,t.getLat()]]}},{key:"getMinZoom",value:function(){return this.map.getZooms()[0]-1}},{key:"getMaxZoom",value:function(){return this.map.getZooms()[1]-1}},{key:"setRotation",value:function(e){return this.map.setRotation(e)}},{key:"setPitch",value:function(e){return this.map.setPitch(e)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(e){this.map.panTo(e)}},{key:"panBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.map.panBy(e,t)}},{key:"fitBounds",value:function(e){this.map.setBounds(new AMap.Bounds([e[0][0],e[0][1],e[1][0],e[1][1]]))}},{key:"setZoomAndCenter",value:function(e,t){this.map.setZoomAndCenter(e,t)}},{key:"setMapStyle",value:function(e){this.map.setMapStyle(this.getMapStyle(e))}},{key:"setMapStatus",value:function(e){this.map.setStatus(e)}},{key:"pixelToLngLat",value:function(e){var t=this.map.pixelToLngLat(new AMap.Pixel(e[0],e[1]));return{lng:t.getLng(),lat:t.getLat()}}},{key:"lngLatToPixel",value:function(e){var t=this.map.lnglatToPixel(new AMap.LngLat(e[0],e[1]));return{x:t.getX(),y:t.getY()}}},{key:"containerToLngLat",value:function(e){var t=new AMap.Pixel(e[0],e[1]),n=this.map.containerToLngLat(t);return{lng:null==n?void 0:n.getLng(),lat:null==n?void 0:n.getLat()}}},{key:"lngLatToContainer",value:function(e){var t=new AMap.LngLat(e[0],e[1]),n=this.map.lngLatToContainer(t);return{x:n.getX(),y:n.getY()}}},{key:"lngLatToMercator",value:function(e,t){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=this.map.customCoords.lngLatToCoord(e),a=dS();return bS(a,a,US(i[0],i[1],t)),ES(a,a,US(r[0],r[1],r[2])),xS(a,a,n[0]),SS(a,a,n[1]),TS(a,a,n[2]),a}},{key:"init",value:(t=vA(MA.mark((function e(){var t,n,r,i,a,o,s,u,l,c,f,p,h,d,v,m,y=this;return MA.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config,n=t.id,r=t.style,i=void 0===r?"light":r,a=t.minZoom,o=void 0===a?0:a,s=t.maxZoom,u=void 0===s?18:s,l=t.token,c=void 0===l?"ff533602d57df6f8ab3b0fea226ae52f":l,f=t.mapInstance,p=t.plugin,h=void 0===p?[]:p,d=t.version,v=void 0===d?"2.0":d,m=YA(t,iN),e.next=3,new Promise((function(e){var t=function(){if(f){var t;y.map=f,y.$mapContainer=y.map.getContainer();var r=y.map.getCenter();null===(t=y.map.customCoords)||void 0===t||t.setCenter([r.lng,r.lat]),y.setCustomCoordCenter([r.lng,r.lat]),setTimeout((function(){y.map.on("viewchange",y.handleViewChanged),e()}),30)}else{y.$mapContainer=y.creatAmapContainer(n);var a=new AMap.Map(y.$mapContainer,oN({mapStyle:y.getMapStyle(i),zooms:[o,u],viewMode:"3D"},m));y.map=a;var s=a.getCenter();a.customCoords.setCenter([s.lng,s.lat]),y.setCustomCoordCenter([s.lng,s.lat]),a.on("viewchange",y.handleViewChanged),setTimeout((function(){e()}),10)}};y.viewport=new rN,uN||f?uN&&window.AMap||f?t():lN.push(t):("ff533602d57df6f8ab3b0fea226ae52f"===c&&console.warn(y.configService.getSceneWarninfo("MapToken")),uN=!0,h.push("Map3D"),zL.load({key:c,version:v,plugins:h}).then((function(e){t(),lN.length&&(lN.forEach((function(e){return e()})),lN=[])})).catch((function(e){throw new Error(e)})))}));case 3:this.map.on("dragstart",(function(){return y.dragging=!0,""})),this.map.on("dragend",(function(){return y.dragging=!1,""}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"exportMap",value:function(e){var t,n=null===(t=this.getContainer())||void 0===t?void 0:t.getElementsByClassName("amap-layer")[0];return"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png")}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).emit.apply(t,[e].concat(r))}},{key:"once",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).once.apply(t,[e].concat(r))}},{key:"destroy",value:function(){var e,t;this.map.destroy(),null===(e=this.$mapContainer)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.$mapContainer),delete window.initAMap;var n=document.getElementById("amap-script");n&&document.head.removeChild(n)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(e){this.cameraChangedCallback=e}},{key:"initViewPort",value:function(){var e,t=null===(e=this.map.customCoords)||void 0===e?void 0:e.getCameraParams(),n=t.fov,r=t.near,i=t.far,a=t.aspect,o=t.position,s=t.lookAt,u=t.up;this.emit("mapchange");var l=this.map.customCoords.getCenter(),c=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:a,far:i,fov:n,cameraPosition:o,lookAt:s,near:r,up:u,zoom:c-1,center:l,offsetOrigin:[o[0],o[1]]}),this.coordinateSystemService.setCoordinateSystem(jT.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(e,t){var n=[0,0];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}},{key:"getMapStyle",value:function(e){return nN[e]?nN[e]:e}},{key:"creatAmapContainer",value:function(e){var t=e;"string"==typeof e&&(t=document.getElementById(e));var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    ",n.id="l7_amap_div"+sN++,t.appendChild(n),n}}]),e}(),JL=FT(QL.prototype,"configService",[XL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$L=FT(QL.prototype,"config",[YL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eN=FT(QL.prototype,"coordinateSystemService",[qL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tN=FT(QL.prototype,"eventEmitter",[ZL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KL=QL))||KL);function fN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var pN,hN,dN,vN,mN,yN=function(e){Gc(n,UL);var t=fN(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getServiceConstructor",value:function(){return cN}}]),n}();var gN,_N=(pN=Fx(),hN=nx(Bx.IGlobalConfigService),pN((vN=function(){function e(){Fc(this,e),DT(this,"configService",mN,this),lc(this,"enabled",void 0)}return Uc(e,[{key:"apply",value:function(e,t){var n=this;t.rendererService;var r=t.postProcessingPassFactory,i=t.normalPassFactory;e.hooks.init.tap("MultiPassRendererPlugin",(function(){var t=e.getLayerConfig(),a=t.enableMultiPassRenderer,o=t.passes,s=void 0===o?[]:o;n.enabled=!!a&&!1!==e.getLayerConfig().enableMultiPassRenderer,n.enabled&&(e.multiPassRenderer=n.createMultiPassRenderer(e,s,r,i),e.multiPassRenderer.setRenderFlag(!0))})),e.hooks.beforeRender.tap("MultiPassRendererPlugin",(function(){}))}},{key:"createMultiPassRenderer",value:function(e,t,n,r){var i=e.multiPassRenderer,a=e.getLayerConfig(),o=a.enablePicking;return a.enableTAA,o&&i.add(r("pixelPicking")),i}}]),e}(),mN=FT(vN.prototype,"configService",[hN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dN=vN))||dN),bN=(lc(gN={},RM.additive,{enable:!0,func:{srcRGB:yA.ONE,dstRGB:yA.ONE,srcAlpha:1,dstAlpha:1}}),lc(gN,RM.none,{enable:!1}),lc(gN,RM.normal,{enable:!0,func:{srcRGB:yA.SRC_ALPHA,dstRGB:yA.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),lc(gN,RM.subtractive,{enable:!0,func:{srcRGB:yA.ONE,dstRGB:yA.ONE,srcAlpha:yA.ZERO,dstAlpha:yA.ONE_MINUS_SRC_COLOR},equation:{rgb:yA.FUNC_SUBTRACT,alpha:yA.FUNC_SUBTRACT}}),lc(gN,RM.max,{enable:!0,func:{srcRGB:yA.ONE,dstRGB:yA.ONE},equation:{rgb:yA.MAX_EXT}}),lc(gN,RM.min,{enable:!0,func:{srcRGB:yA.ONE,dstRGB:yA.ONE},equation:{rgb:yA.MIN_EXT}}),gN),EN=ld,xN=nm;var SN=function(e){return"number"==typeof e||xN(e)&&"[object Number]"==EN(e)};function TN(e,t,n,r,i){t.updateStyleAttribute(e,n,r,i)}function AN(e,t){e.opacity&&wN("opacity",t,e.opacity),e.strokeWidth&&wN("strokeWidth",t,e.strokeWidth),e.strokeOpacity&&wN("strokeOpacity",t,e.strokeOpacity),e.stroke&&function(e,t,n){cg(n)?TN(e,t,n,void 0):fm(n)&&2===n.length&&(cg(n[0])&&dd(n[1])||cg(n[0])&&fm(n[1])&&n[1].length>0)?TN(e,t,n[0],n[1]):TN(e,t,"#fff",void 0)}("stroke",t,e.stroke),e.offsets&&CN("offsets",t,e.offsets),e.textOffset&&CN("textOffset",t,e.textOffset)}function wN(e,t,n){cg(n)?TN(e,t,n,(function(e){return e})):SN(n)?TN(e,t,[n],void 0):fm(n)&&2===n.length&&(cg(n[0])&&dd(n[1])||cg(n[0])&&fm(n[1])&&SN(n[1][0])&&SN(n[1][1]))?TN(e,t,n[0],n[1]):TN(e,t,[1],void 0)}function CN(e,t,n){cg(n)?TN(e,t,n,(function(e){return e})):fm(n)&&2===n.length&&cg(n[0])&&dd(n[1])?TN(e,t,n[0],n[1]):fm(n)&&2===n.length&&SN(n[0])&&SN(n[1])?TN(e,t,n,void 0):TN(e,t,[0,0],void 0)}var kN,ON,MN,RN,PN,IN=["passes"],LN=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"];function NN(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return DN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DN(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function DN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FN(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function UN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var BN=0,zN=(kN=BM(Bx.IGlobalConfigService),ON=BM(Bx.IShaderModuleService),MN=function(e){Gc(n,Xb.exports.EventEmitter);var t=UN(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Fc(this,n),lc(Xc(e=t.call(this)),"id","".concat(BN++)),lc(Xc(e),"name","".concat(BN)),lc(Xc(e),"type",void 0),lc(Xc(e),"visible",!0),lc(Xc(e),"zIndex",0),lc(Xc(e),"minZoom",void 0),lc(Xc(e),"maxZoom",void 0),lc(Xc(e),"inited",!1),lc(Xc(e),"layerModelNeedUpdate",!1),lc(Xc(e),"pickedFeatureID",null),lc(Xc(e),"selectedFeatureID",null),lc(Xc(e),"styleNeedUpdate",!1),lc(Xc(e),"rendering",void 0),lc(Xc(e),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),lc(Xc(e),"hooks",{init:new Wb,afterInit:new Wb,beforeRender:new Wb,beforeRenderData:new Gb,afterRender:new Ub,beforePickingEncode:new Ub,afterPickingEncode:new Ub,beforeHighlight:new Ub(["pickedColor"]),afterHighlight:new Ub,beforeSelect:new Ub(["pickedColor"]),afterSelect:new Ub,beforeDestroy:new Ub,afterDestroy:new Ub}),lc(Xc(e),"models",[]),lc(Xc(e),"multiPassRenderer",void 0),lc(Xc(e),"plugins",void 0),lc(Xc(e),"sourceOption",void 0),lc(Xc(e),"layerModel",void 0),lc(Xc(e),"sceneContainer",void 0),lc(Xc(e),"layerChildren",[]),DT(Xc(e),"configService",RN,Xc(e)),DT(Xc(e),"shaderModuleService",PN,Xc(e)),lc(Xc(e),"cameraService",void 0),lc(Xc(e),"coordinateService",void 0),lc(Xc(e),"iconService",void 0),lc(Xc(e),"fontService",void 0),lc(Xc(e),"pickingService",void 0),lc(Xc(e),"rendererService",void 0),lc(Xc(e),"layerService",void 0),lc(Xc(e),"interactionService",void 0),lc(Xc(e),"mapService",void 0),lc(Xc(e),"styleAttributeService",void 0),lc(Xc(e),"layerSource",void 0),lc(Xc(e),"postProcessingPassFactory",void 0),lc(Xc(e),"normalPassFactory",void 0),lc(Xc(e),"animateOptions",{enable:!1}),lc(Xc(e),"container",void 0),lc(Xc(e),"encodedData",void 0),lc(Xc(e),"configSchema",void 0),lc(Xc(e),"currentPickId",null),lc(Xc(e),"rawConfig",void 0),lc(Xc(e),"needUpdateConfig",void 0),lc(Xc(e),"pendingStyleAttributes",[]),lc(Xc(e),"scaleOptions",{}),lc(Xc(e),"animateStartTime",void 0),lc(Xc(e),"aniamateStatus",!1),lc(Xc(e),"sourceEvent",(function(){e.dataState.dataSourceNeedUpdate=!0;var t=e.getLayerConfig(),n=t.autoFit,r=t.fitBoundsOptions;n&&e.fitBounds(r),e.emit("dataUpdate"),e.reRender()})),e.name=r.name||e.id,e.zIndex=r.zIndex||0,e.rawConfig=r,e}return Uc(n,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(e){if(this.inited){var t=this.container.get(Bx.SceneID);AN(e,this),this.configService.setLayerConfig(t,this.id,jN(jN(jN({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),e)),this.needUpdateConfig={}}else this.needUpdateConfig=jN(jN({},this.needUpdateConfig),e)}},{key:"setContainer",value:function(e,t){this.container=e,this.sceneContainer=t}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(e){return this.plugins.push(e),this}},{key:"init",value:function(){var e=this,t=this.container.get(Bx.SceneID),n=this.rawConfig.enableMultiPassRenderer,r=void 0!==n&&n;this.configService.setLayerConfig(t,this.id,{enableMultiPassRenderer:r}),this.iconService=this.container.get(Bx.IIconService),this.fontService=this.container.get(Bx.IFontService),this.rendererService=this.container.get(Bx.IRendererService),this.layerService=this.container.get(Bx.ILayerService),this.interactionService=this.container.get(Bx.IInteractionService),this.pickingService=this.container.get(Bx.IPickingService),this.mapService=this.container.get(Bx.IMapService),this.cameraService=this.container.get(Bx.ICameraService),this.coordinateService=this.container.get(Bx.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(Bx.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Bx.IFactoryNormalPass),this.styleAttributeService=this.container.get(Bx.IStyleAttributeService),this.multiPassRenderer=this.container.get(Bx.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach((function(t){var n=t.attributeName,r=t.attributeField,i=t.attributeValues,a=t.updateOptions;e.styleAttributeService.updateStyleAttribute(n,{scale:jN({field:r},e.splitValuesAndCallbackInAttribute(i,e.getLayerConfig()[n]))},a)})),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Bx.ILayerPlugin);var i,a=NN(this.plugins);try{for(a.s();!(i=a.n()).done;){i.value.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(o){a.e(o)}finally{a.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(jN(jN({},this.getDefaultConfig()),this.rawConfig));var e=this.getLayerConfig().animateOption;null!=e&&e.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(e,t,n){return this.updateStyleAttribute("color",e,t,n),this}},{key:"texture",value:function(e,t,n){return this.updateStyleAttribute("texture",e,t,n),this}},{key:"rotate",value:function(e,t,n){return this.updateStyleAttribute("rotate",e,t,n),this}},{key:"size",value:function(e,t,n){return this.updateStyleAttribute("size",e,t,n),this}},{key:"filter",value:function(e,t,n){return this.updateStyleAttribute("filter",e,t,n),this}},{key:"shape",value:function(e,t,n){return this.updateStyleAttribute("shape",e,t,n),this}},{key:"label",value:function(e,t,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:e,attributeValues:t,updateOptions:n}),this}},{key:"animate",value:function(e){var t={};return cd(e)?(t.enable=!0,t=jN(jN({},t),e)):t.enable=e,this.updateLayerConfig({animateOption:t}),this}},{key:"source",value:function(e,t){return null!=e&&e.data?(this.setSource(e),this):(this.sourceOption={data:e,options:t},this)}},{key:"setData",value:function(e,t){var n=this;return this.inited?this.layerSource.setData(e,t):this.on("inited",(function(){n.layerSource.setData(e,t)})),this}},{key:"style",value:function(e){var t=this,n=e.passes,r=YA(e,IN);return n&&function(e){return e.map((function(e){return"string"==typeof e&&(e=[e,{}]),e}))}(n).forEach((function(e){var n=t.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(e[0]);n&&n.updateOptions(e[1])})),this.rawConfig=jN(jN({},this.rawConfig),r),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(e,t){return cd(e)?this.scaleOptions=jN(jN({},this.scaleOptions),e):this.scaleOptions[e]=t,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return 0!==this.getEncodedData().length&&this.renderModels(),this}},{key:"active",value:function(e){var t={};return t.enableHighlight=!!cd(e)||e,cd(e)?(t.enableHighlight=!0,e.color&&(t.highlightColor=e.color)):t.enableHighlight=!!e,this.updateLayerConfig(t),this}},{key:"setActive",value:function(e,t){var n=this;if(cd(e)){var r=e.x,i=void 0===r?0:r,a=e.y,o=void 0===a?0:a;this.updateLayerConfig({highlightColor:cd(t)?t.color:this.getLayerConfig().highlightColor}),this.pick({x:i,y:o})}else this.updateLayerConfig({pickedFeatureID:e,highlightColor:cd(t)?t.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(bh(e)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"select",value:function(e){var t={};return t.enableSelect=!!cd(e)||e,cd(e)?(t.enableSelect=!0,e.color&&(t.selectColor=e.color)):t.enableSelect=!!e,this.updateLayerConfig(t),this}},{key:"setSelect",value:function(e,t){var n=this;if(cd(e)){var r=e.x,i=void 0===r?0:r,a=e.y,o=void 0===a?0:a;this.updateLayerConfig({selectColor:cd(t)?t.color:this.getLayerConfig().selectColor}),this.pick({x:i,y:o})}else this.updateLayerConfig({pickedFeatureID:e,selectColor:cd(t)?t.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(bh(e)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"setBlend",value:function(e){this.updateLayerConfig({blend:e}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(e){return this.zIndex=e,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(e){this.currentPickId=e}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(e){this.selectedFeatureID=e}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var e=this.mapService.getZoom(),t=this.getLayerConfig(),n=t.visible,r=t.minZoom,i=void 0===r?-1/0:r,a=t.maxZoom;return!!n&&e>=i&&e<=(void 0===a?1/0:a)}},{key:"setMinZoom",value:function(e){return this.updateLayerConfig({minZoom:e}),this}},{key:"getMinZoom",value:function(){return this.getLayerConfig().minZoom}},{key:"getMaxZoom",value:function(){return this.getLayerConfig().maxZoom}},{key:"get",value:function(e){return this.getLayerConfig()[e]}},{key:"setMaxZoom",value:function(e){return this.updateLayerConfig({maxZoom:e}),this}},{key:"fitBounds",value:function(e){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var t=this.getSource().extent;return t.some((function(e){return Math.abs(e)===1/0}))||this.mapService.fitBounds([[t[0],t[1]],[t[2],t[3]]],e),this}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach((function(e){return e.destroy()})),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter((function(e){return e.needRescale||e.needRemapping||e.needRegenerateVertices})).length}},{key:"setSource",value:function(e){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=e,this.inited&&this.layerSource.cluster){var t=this.mapService.getZoom();this.layerSource.updateClusterData(t)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(e){this.encodedData=e}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getLegendItems",value:function(e){var t=this.styleAttributeService.getLayerAttributeScale(e);return t?t.ticks?t.ticks().map((function(n){return lc({value:n},e,t(n))})):t.invertExtent?t.range().map((function(n){return lc({value:t.invertExtent(n)},e,n)})):void 0:[]}},{key:"pick",value:function(e){var t=e.x,n=e.y;this.interactionService.triggerHover({x:t,y:n})}},{key:"boxSelect",value:function(e,t){this.pickingService.boxPickLayer(this,e,t)}},{key:"buildLayerModel",value:function(e){var t=e.moduleName,n=e.vertexShader,r=e.fragmentShader,i=e.triangulation,a=e.segmentNumber,o=YA(e,LN);this.shaderModuleService.registerModule(t,{vs:n,fs:r});var s=this.shaderModuleService.getModule(t),u=s.vs,l=s.fs,c=s.uniforms,f=this.rendererService.createModel,p=this.styleAttributeService.createAttributesAndIndices(this.encodedData,i,a);return f(jN({attributes:p.attributes,uniforms:c,fs:l,vs:u,elements:p.elements,blend:bN[RM.normal]},o))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(e){var t=this.getLayerConfig(),n=t.enableHighlight,r=void 0===n||n,i=t.enableSelect,a=void 0===i||i,o=-1!==this.eventNames().indexOf(e)||-1!==this.eventNames().indexOf("un"+e);return"click"!==e&&"dblclick"!==e||!a||(o=!0),"mousemove"!==e||!r&&-1===this.eventNames().indexOf("mouseenter")&&-1===this.eventNames().indexOf("unmousemove")&&-1===this.eventNames().indexOf("mouseout")||(o=!0),this.isVisible()&&o}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var e=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach((function(t){t.draw({uniforms:e.layerModel.getUninforms()})}))),this}},{key:"updateStyleAttribute",value:function(e,t,n,r){this.inited?this.styleAttributeService.updateStyleAttribute(e,{scale:jN({field:t},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[t]))},r):this.pendingStyleAttributes.push({attributeName:e,attributeField:t,attributeValues:n,updateOptions:r})}},{key:"setEarthTime",value:function(e){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&(this.layerService.updateLayerRenderList(),this.layerService.renderLayers())}},{key:"splitValuesAndCallbackInAttribute",value:function(e,t){return{values:dd(e)?void 0:e||t,callback:dd(e)?e:void 0}}}]),n}(),RN=FT(MN.prototype,"configService",[kN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PN=FT(MN.prototype,"shaderModuleService",[ON],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MN);var VN=Qw,HN=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},GN=iC;var WN=function(e,t,n,r,i,a){var o=1&n,s=e.length,u=t.length;if(s!=u&&!(o&&u>s))return!1;var l=a.get(e),c=a.get(t);if(l&&c)return l==t&&c==e;var f=-1,p=!0,h=2&n?new VN:void 0;for(a.set(e,t),a.set(t,e);++f<s;){var d=e[f],v=t[f];if(r)var m=o?r(v,d,f,t,e,a):r(d,v,f,e,t,a);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!HN(t,(function(e,t){if(!GN(h,t)&&(d===e||i(d,e,n,r,a)))return h.push(t)}))){p=!1;break}}else if(d!==v&&!i(d,v,n,r,a)){p=!1;break}}return a.delete(e),a.delete(t),p};var XN=Uv,YN=kh,qN=WN,ZN=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},KN=aC,QN=Jh?Jh.prototype:void 0,JN=QN?QN.valueOf:void 0;var $N=function(e,t,n,r,i,a,o){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new XN(e),new XN(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return YN(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=ZN;case"[object Set]":var u=1&r;if(s||(s=KN),e.size!=t.size&&!u)return!1;var l=o.get(e);if(l)return l==t;r|=2,o.set(e,t);var c=qN(s(e),s(t),r,i,a,o);return o.delete(e),c;case"[object Symbol]":if(JN)return JN.call(e)==JN.call(t)}return!1},eD=Kg,tD=Object.prototype.hasOwnProperty;var nD=xv,rD=WN,iD=$N,aD=function(e,t,n,r,i,a){var o=1&n,s=eD(e),u=s.length;if(u!=eD(t).length&&!o)return!1;for(var l=u;l--;){var c=s[l];if(!(o?c in t:tD.call(t,c)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var h=!0;a.set(e,t),a.set(t,e);for(var d=o;++l<u;){var v=e[c=s[l]],m=t[c];if(r)var y=o?r(m,v,c,t,e,a):r(v,m,c,e,t,a);if(!(void 0===y?v===m||i(v,m,n,r,a):y)){h=!1;break}d||(d="constructor"==c)}if(h&&!d){var g=e.constructor,_=t.constructor;g==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(h=!1)}return a.delete(e),a.delete(t),h},oD=y_,sD=fm,uD=_m.exports,lD=zm,cD="[object Object]",fD=Object.prototype.hasOwnProperty;var pD=function(e,t,n,r,i,a){var o=sD(e),s=sD(t),u=o?"[object Array]":oD(e),l=s?"[object Array]":oD(t),c=(u="[object Arguments]"==u?cD:u)==cD,f=(l="[object Arguments]"==l?cD:l)==cD,p=u==l;if(p&&uD(e)){if(!uD(t))return!1;o=!0,c=!1}if(p&&!c)return a||(a=new nD),o||lD(e)?rD(e,t,n,r,i,a):iD(e,t,u,n,r,i,a);if(!(1&n)){var h=c&&fD.call(e,"__wrapped__"),d=f&&fD.call(t,"__wrapped__");if(h||d){var v=h?e.value():e,m=d?t.value():t;return a||(a=new nD),i(v,m,n,r,a)}}return!!p&&(a||(a=new nD),aD(e,t,n,r,i,a))},hD=nm;var dD=function e(t,n,r,i,a){return t===n||(null==t||null==n||!hD(t)&&!hD(n)?t!=t&&n!=n:pD(t,n,r,i,e,a))};var vD,mD,yD,gD,_D,bD=function(e,t){return dD(e,t)};function ED(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xD(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function xD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var SD=(vD=BM(Bx.IGlobalConfigService),mD=BM(Bx.IShaderModuleService),yD=function(){function e(t){Fc(this,e),lc(this,"triangulation",void 0),lc(this,"createTexture2D",void 0),lc(this,"layer",void 0),lc(this,"dataTexture",void 0),lc(this,"DATA_TEXTURE_WIDTH",void 0),lc(this,"rowCount",void 0),lc(this,"cacheStyleProperties",void 0),lc(this,"cellLength",void 0),lc(this,"cellProperties",void 0),lc(this,"cellTypeLayout",void 0),lc(this,"stylePropertyesExist",void 0),lc(this,"dataTextureTest",void 0),DT(this,"configService",gD,this),DT(this,"shaderModuleService",_D,this),lc(this,"rendererService",void 0),lc(this,"iconService",void 0),lc(this,"fontService",void 0),lc(this,"styleAttributeService",void 0),lc(this,"mapService",void 0),lc(this,"cameraService",void 0),lc(this,"layerService",void 0),this.layer=t,this.rendererService=t.getContainer().get(Bx.IRendererService),this.styleAttributeService=t.getContainer().get(Bx.IStyleAttributeService),this.mapService=t.getContainer().get(Bx.IMapService),this.iconService=t.getContainer().get(Bx.IIconService),this.fontService=t.getContainer().get(Bx.IFontService),this.cameraService=t.getContainer().get(Bx.ICameraService),this.layerService=t.getContainer().get(Bx.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var n=this.rendererService.createTexture2D;this.createTexture2D=n,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8ClampedArray(4),mag:yA.NEAREST,min:yA.NEAREST,width:1,height:1}))}return Uc(e,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,0,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(e){var t=!1;return bD(e.opacity,this.cacheStyleProperties.opacity)||(t=!0,this.cacheStyleProperties.opacity=e.opacity),bD(e.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(t=!0,this.cacheStyleProperties.strokeOpacity=e.strokeOpacity),bD(e.strokeWidth,this.cacheStyleProperties.strokeWidth)||(t=!0,this.cacheStyleProperties.strokeWidth=e.strokeWidth),bD(e.stroke,this.cacheStyleProperties.stroke)||(t=!0,this.cacheStyleProperties.stroke=e.stroke),bD(e.offsets,this.cacheStyleProperties.offsets)||(t=!0,this.cacheStyleProperties.offsets=e.offsets),void 0===this.dataTexture&&(t=!0),t}},{key:"judgeStyleAttributes",value:function(e){this.clearLastCalRes(),void 0===e.opacity||SN(e.opacity)||(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),void 0===e.strokeOpacity||SN(e.strokeOpacity)||(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),void 0===e.strokeWidth||SN(e.strokeWidth)||(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),void 0===e.stroke||this.isStaticColor(e.stroke)||(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),void 0===e.offsets||this.isOffsetStatic(e.offsets)||(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2)}},{key:"isStaticColor",value:function(e){return!!cg(e)&&!!ah(e)}},{key:"getStrokeColor",value:function(e){if(this.isStaticColor(e)){var t=gh(e);return t[0]=t[0]?t[0]:0,t[1]=t[1]?t[1]:0,t[2]=t[2]?t[2]:0,t[3]=t[3]?t[3]:0,t}return[0,0,0,0]}},{key:"isOffsetStatic",value:function(e){return!!(fm(e)&&2===e.length&&SN(e[0])&&SN(e[1]))}},{key:"patchMod",value:function(e,t){for(var n=0;n<t;n++)e.push(-1)}},{key:"patchData",value:function(e,t,n){var r,i=ED(n);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.attr,s=a.count,u=t[o];u?"stroke"===o?e.push.apply(e,pc(gh(u))):"offsets"===o?this.isOffsetStatic(u)?e.push(-u[0],u[1]):e.push(0,0):e.push(SN(u)?u:1):this.patchMod(e,s)}}catch(l){i.e(l)}finally{i.f()}}},{key:"calDataFrame",value:function(e,t,n){for(var r=t.length,i=Math.ceil(r*e/this.DATA_TEXTURE_WIDTH),a=i*this.DATA_TEXTURE_WIDTH,o=[],s=0;s<r;s++){var u=t[s];this.patchData(o,u,n)}for(var l=o.length;l<a;l++)o.push(-1);return{data:o,width:this.DATA_TEXTURE_WIDTH,height:i}}},{key:"getBlend",value:function(){var e=this.layer.getLayerConfig().blend;return bN[RM[void 0===e?"normal":e]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(e){return[e.enable?0:1,e.duration||4,e.interval||.2,e.trailLength||.1]}},{key:"startModelAnimate",value:function(){this.layer.getLayerConfig().animateOption.enable&&this.layer.setAnimateStartTime()}}]),e}(),gD=FT(yD.prototype,"configService",[vD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_D=FT(yD.prototype,"shaderModuleService",[mD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yD),TD={exports:{}};function AD(e,t,n){n=n||2;var r,i,a,o,s,u,l,c=t&&t.length,f=c?t[0]*n:e.length,p=wD(e,0,f,n,!0),h=[];if(!p||p.next===p.prev)return h;if(c&&(p=function(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=wD(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(FD(o));for(s.sort(ID),i=0;i<s.length;i++)n=CD(n=LD(s[i],n),n.next);return n}(e,t,p,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var d=n;d<f;d+=n)(s=e[d])<r&&(r=s),(u=e[d+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);l=0!==(l=Math.max(a-r,o-i))?1/l:0}return kD(p,h,n,r,i,l),h}function wD(e,t,n,r,i){var a,o;if(i===KD(e,t,n,r)>0)for(a=t;a<n;a+=r)o=YD(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=YD(a,e[a],e[a+1],o);return o&&zD(o,o.next)&&(qD(o),o=o.next),o}function CD(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!zD(r,r.next)&&0!==BD(r.prev,r,r.next))r=r.next;else{if(qD(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function kD(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=DD(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,u,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?MD(e,r,i,a):OD(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),qD(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?kD(e=RD(CD(e),t,n),t,n,r,i,a,2):2===o&&PD(e,t,n,r,i,a):kD(CD(e),t,n,r,i,a,1);break}}}function OD(e){var t=e.prev,n=e,r=e.next;if(BD(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(jD(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&BD(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function MD(e,t,n,r){var i=e.prev,a=e,o=e.next;if(BD(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=DD(s,u,t,n,r),p=DD(l,c,t,n,r),h=e.prevZ,d=e.nextZ;h&&h.z>=f&&d&&d.z<=p;){if(h!==e.prev&&h!==e.next&&jD(i.x,i.y,a.x,a.y,o.x,o.y,h.x,h.y)&&BD(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==e.prev&&d!==e.next&&jD(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&BD(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=f;){if(h!==e.prev&&h!==e.next&&jD(i.x,i.y,a.x,a.y,o.x,o.y,h.x,h.y)&&BD(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=p;){if(d!==e.prev&&d!==e.next&&jD(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&BD(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function RD(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!zD(i,a)&&VD(i,r,r.next,a)&&WD(i,a)&&WD(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),qD(r),qD(r.next),r=e=a),r=r.next}while(r!==e);return CD(r)}function PD(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&UD(o,s)){var u=XD(o,s);return o=CD(o,o.next),u=CD(u,u.next),kD(o,t,n,r,i,a),void kD(u,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function ID(e,t){return e.x-t.x}function LD(e,t){var n=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var u,l=n,c=n.x,f=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&jD(a<f?i:o,a,c,f,a<f?o:i,a,r.x,r.y)&&(u=Math.abs(a-r.y)/(i-r.x),WD(r,e)&&(u<p||u===p&&(r.x>n.x||r.x===n.x&&ND(n,r)))&&(n=r,p=u)),r=r.next}while(r!==l);return n}(e,t);if(!n)return t;var r=XD(n,e),i=CD(n,n.next);return CD(r,r.next),t===n?i:t}function ND(e,t){return BD(e.prev,e,t.prev)<0&&BD(t.next,e,e.next)<0}function DD(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function FD(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function jD(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function UD(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&VD(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(WD(e,t)&&WD(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(BD(e.prev,e,t.prev)||BD(e,t.prev,t))||zD(e,t)&&BD(e.prev,e,e.next)>0&&BD(t.prev,t,t.next)>0)}function BD(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function zD(e,t){return e.x===t.x&&e.y===t.y}function VD(e,t,n,r){var i=GD(BD(e,t,n)),a=GD(BD(e,t,r)),o=GD(BD(n,r,e)),s=GD(BD(n,r,t));return i!==a&&o!==s||(!(0!==i||!HD(e,n,t))||(!(0!==a||!HD(e,r,t))||(!(0!==o||!HD(n,e,r))||!(0!==s||!HD(n,t,r)))))}function HD(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function GD(e){return e>0?1:e<0?-1:0}function WD(e,t){return BD(e.prev,e,e.next)<0?BD(e,t,e.next)>=0&&BD(e,e.prev,t)>=0:BD(e,t,e.prev)<0||BD(e,e.next,t)<0}function XD(e,t){var n=new ZD(e.i,e.x,e.y),r=new ZD(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function YD(e,t,n,r){var i=new ZD(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function qD(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ZD(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function KD(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}TD.exports=AD,TD.exports.default=AD,AD.deviation=function(e,t,n,r){var i=t&&t.length,a=i?t[0]*n:e.length,o=Math.abs(KD(e,0,a,n));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*n,c=s<u-1?t[s+1]*n:e.length;o-=Math.abs(KD(e,l,c,n))}var f=0;for(s=0;s<r.length;s+=3){var p=r[s]*n,h=r[s+1]*n,d=r[s+2]*n;f+=Math.abs((e[p]-e[d])*(e[h+1]-e[p+1])-(e[p]-e[h])*(e[d+1]-e[p+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},AD.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)n.vertices.push(e[i][a][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n};var QD=TD.exports;function JD(e){return e/180*Math.acos(-1)}function $D(e){var t=JD(e[0])+Math.PI/2,n=JD(e[1]),r=100+.4*Math.random(),i=r*Math.cos(n)*Math.cos(t);return[r*Math.cos(n)*Math.sin(t),r*Math.sin(n),i]}var eF=lT();lT();var tF=lT(),nF=lT(),rF=lT();function iF(e,t,n,r,i){return pT(e,n,r),dT(e,e),[i/vT(t=cT(-e[1],e[0]),cT(-n[1],n[0])),t]}function aF(e,t){return function(e,t,n){return e[0]=t,e[1]=n,e}(e,-t[1],t[0])}function oF(e,t,n){return yT(e,t,n),dT(e,e),e}function sF(e,t){return e[0]===t[0]&&e[1]===t[1]}var uF,lF,cF,fF,pF,hF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Fc(this,e),lc(this,"complex",void 0),lc(this,"join",void 0),lc(this,"cap",void 0),lc(this,"miterLimit",void 0),lc(this,"thickness",void 0),lc(this,"normal",void 0),lc(this,"lastFlip",-1),lc(this,"miter",cT(0,0)),lc(this,"started",!1),lc(this,"dash",!1),lc(this,"totalDistance",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return Uc(e,[{key:"extrude_gaode2",value:function(e,t){var n=this.complex;if(e.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=e.length,i=n.startIndex,a=1;a<r;a++){var o=e[a-1],s=t[a-1],u=e[a],l=t[a],c=a<e.length-1?e[a+1]:null,f=a<t.length-1?t[a+1]:null;i+=this.segment_gaode2(n,i,o,u,c,s,l,f)}if(this.dash)for(var p=0;p<n.positions.length/6;p++)n.positions[6*p+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude",value:function(e){var t=this.complex;if(e.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=e.length,r=t.startIndex,i=1;i<n;i++){var a=e[i-1],o=e[i],s=i<e.length-1?e[i+1]:null;r+=this.segment(t,r,a,o,s)}if(this.dash)for(var u=0;u<t.positions.length/6;u++)t.positions[6*u+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}},{key:"segment_gaode2",value:function(e,t,n,r,i,a,o,s){var u=0,l=e.indices,c=e.positions,f=e.normals,p="square"===this.cap,h="bevel"===this.join,d=Lp([o[0],o[1]]),v=Lp([a[0],a[1]]);oF(tF,r,n);var m=0;if(this.dash&&(m=this.lineSegmentDistance(d,v),this.totalDistance+=m),this.normal||(this.normal=lT(),aF(this.normal,tF)),!this.started)if(this.started=!0,p){var y=lT(),g=lT();pT(y,this.normal,tF),pT(g,this.normal,tF),f.push(g[0],g[1],0),f.push(y[0],y[1],0),c.push(n[0],n[1],0|n[2],this.totalDistance-m,-this.thickness,0|n[2]),c.push(n[0],n[1],0|n[2],this.totalDistance-m,this.thickness,0|n[2])}else this.extrusions(c,f,n,this.normal,this.thickness,this.totalDistance-m);if(l.push(t+0,t+1,t+2),i){sF(r,i)&&pT(i,r,dT(i,hT(i,r,n))),oF(nF,i,r);var _=Ic(iF(rF,lT(),tF,nF,this.thickness),2),b=_[0],E=_[1],x=vT(rF,this.normal)<0?-1:1,S=h;if(!S&&"miter"===this.join)b>this.miterLimit&&(S=!0);S?(f.push(this.normal[0],this.normal[1],0),f.push(E[0],E[1],0),c.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*x,0|r[2]),c.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*x,0|r[2]),l.push.apply(l,pc(this.lastFlip!==-x?[t,t+2,t+3]:[t+2,t+1,t+3])),l.push(t+2,t+3,t+4),aF(eF,nF),fT(this.normal,eF),f.push(this.normal[0],this.normal[1],0),c.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*x,0|r[2]),u+=3):(this.extrusions(c,f,r,E,b,this.totalDistance),l.push.apply(l,pc(1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3])),x=-1,fT(this.normal,E),u+=2),this.lastFlip=x}else{if(aF(this.normal,tF),p){var T=lT(),A=lT();yT(A,tF,this.normal),pT(T,tF,this.normal),f.push(A[0],A[1],0),f.push(T[0],T[1],0),c.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),c.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2])}else this.extrusions(c,f,r,this.normal,this.thickness,this.totalDistance);l.push.apply(l,pc(1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3])),u+=2}return u}},{key:"segment",value:function(e,t,n,r,i){var a=0,o=e.indices,s=e.positions,u=e.normals,l="square"===this.cap,c="bevel"===this.join,f=Lp([r[0],r[1]]),p=Lp([n[0],n[1]]);oF(tF,f,p);var h=0;if(this.dash&&(h=this.lineSegmentDistance(f,p),this.totalDistance+=h),this.normal||(this.normal=lT(),aF(this.normal,tF)),!this.started)if(this.started=!0,l){var d=lT(),v=lT();pT(d,this.normal,tF),pT(v,this.normal,tF),u.push(v[0],v[1],0),u.push(d[0],d[1],0),s.push(n[0],n[1],0|n[2],this.totalDistance-h,-this.thickness,0|n[2]),s.push(n[0],n[1],0|n[2],this.totalDistance-h,this.thickness,0|n[2])}else this.extrusions(s,u,n,this.normal,this.thickness,this.totalDistance-h);if(o.push(t+0,t+1,t+2),i){var m=Lp([i[0],i[1]]);sF(f,m)&&pT(m,f,dT(m,hT(m,f,p))),oF(nF,m,f);var y=Ic(iF(rF,lT(),tF,nF,this.thickness),2),g=y[0],_=y[1],b=vT(rF,this.normal)<0?-1:1,E=c;if(!E&&"miter"===this.join)g>this.miterLimit&&(E=!0);E?(u.push(this.normal[0],this.normal[1],0),u.push(_[0],_[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*b,0|r[2]),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*b,0|r[2]),o.push.apply(o,pc(this.lastFlip!==-b?[t,t+2,t+3]:[t+2,t+1,t+3])),o.push(t+2,t+3,t+4),aF(eF,nF),fT(this.normal,eF),u.push(this.normal[0],this.normal[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*b,0|r[2]),a+=3):(this.extrusions(s,u,r,_,g,this.totalDistance),o.push.apply(o,pc(1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3])),b=-1,fT(this.normal,_),a+=2),this.lastFlip=b}else{if(aF(this.normal,tF),l){var x=lT(),S=lT();yT(S,tF,this.normal),pT(x,tF,this.normal),u.push(S[0],S[1],0),u.push(x[0],x[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2])}else this.extrusions(s,u,r,this.normal,this.thickness,this.totalDistance);o.push.apply(o,pc(1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3])),a+=2}return a}},{key:"extrusions",value:function(e,t,n,r,i,a){t.push(r[0],r[1],0),t.push(r[0],r[1],0),e.push(n[0],n[1],0|n[2],a,-i,0|n[2]),e.push(n[0],n[1],0|n[2],a,i,0|n[2])}},{key:"lineSegmentDistance",value:function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}}]),e}();function dF(e){if(SN(e[0]))return e;if(SN(e[0][0]))throw new Error("当前数据不支持标注");if(SN(e[0][0][0])){var t=0,n=0,r=0;return e.forEach((function(e){e.forEach((function(e){t+=e[0],n+=e[1],r++}))})),[t/r,n/r,0]}throw new Error("当前数据不支持标注")}function vF(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e[0][0],r=e[0][e[0].length-1];n[0]===r[0]&&n[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,a=QD.flatten(e),o=a.vertices,s=a.dimensions,u=[],l=[],c=[],f=0;f<o.length/s;f++)2===s?u.push(o[2*f],o[2*f+1],1,-1,-1):u.push(o[3*f],o[3*f+1],1,-1,-1),c.push(0,0,1);var p=QD(a.vertices,a.holes,a.dimensions);l.push.apply(l,pc(p));for(var h=function(e){var n=a.vertices.slice(e*s,(e+1)*s),r=a.vertices.slice((e+1)*s,(e+2)*s);0===r.length&&(r=a.vertices.slice(0,s));var i=u.length/5;u.push(n[0],n[1],1,0,0,r[0],r[1],1,.1,0,n[0],n[1],0,0,.8,r[0],r[1],0,.1,.8);var o=mF([r[0],r[1],1],[n[0],n[1],0],[n[0],n[1],1],t);c.push.apply(c,pc(o).concat(pc(o),pc(o),pc(o))),l.push.apply(l,pc([1,2,0,3,2,1].map((function(e){return e+i}))))},d=0;d<i;d++)h(d);return{positions:u,index:l,normals:c}}function mF(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=FS(),a=FS(),o=FS();r&&(e=Pp(e),t=Pp(t),n=Pp(n));var s=US.apply(oT,pc(e)),u=US.apply(oT,pc(t)),l=US.apply(oT,pc(n));JS(i,l,u),JS(a,s,u),qS(o,i,a);var c=FS();return XS(c,o),c}function yF(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2*Math.PI/e,r=[],i=0;i<e;i++)r.push(n*i+t*Math.PI/12);var a=r.map((function(e){return[Math.sin(e+Math.PI/4),Math.cos(e+Math.PI/4),0]}));return a}function gF(){return yF(30)}function _F(){return yF(4)}function bF(){return yF(3)}function EF(){return yF(6,1)}function xF(){return yF(5)}(cF=lF||(lF={})).CYLINDER="cylinder",cF.SQUARECOLUMN="squareColumn",cF.TRIANGLECOLUMN="triangleColumn",cF.HEXAGONCOLUMN="hexagonColumn",cF.PENTAGONCOLUMN="pentagonColumn",(pF=fF||(fF={})).CIRCLE="circle",pF.SQUARE="square",pF.TRIANGLE="triangle",pF.HEXAGON="hexagon",pF.PENTAGON="pentagon";var SF=(lc(uF={},fF.CIRCLE,gF),lc(uF,fF.HEXAGON,EF),lc(uF,fF.TRIANGLE,bF),lc(uF,fF.SQUARE,_F),lc(uF,fF.PENTAGON,xF),lc(uF,lF.CYLINDER,gF),lc(uF,lF.HEXAGONCOLUMN,EF),lc(uF,lF.TRIANGLECOLUMN,bF),lc(uF,lF.SQUARECOLUMN,_F),lc(uF,lF.PENTAGONCOLUMN,xF),uF),TF={};function AF(e){var t=dF(e.coordinates);return{vertices:[].concat(pc(t),pc(t),pc(t),pc(t)),indices:[0,1,2,2,3,0],size:t.length}}function wF(e){var t=$D(dF(e.coordinates));return{vertices:[].concat(pc(t),pc(t),pc(t),pc(t)),indices:[0,1,2,2,3,0],size:t.length}}function CF(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(TF&&TF[e])return TF[e];var n=vF([SF[e]?SF[e]():SF.cylinder()],t);return TF[e]=n,n}(e.shape,!1);return{vertices:t.positions,indices:t.index,normals:t.normals,size:5}}function kF(e){var t=dF(e.coordinates);return{vertices:pc(t),indices:[0],size:t.length}}function OF(e){var t=e.coordinates,n=e.originCoordinates,r=e.version,i=new hF({dash:!0,join:"bevel"});if("GAODE2.x"===r){var a=t;Array.isArray(a[0][0])||(a=[t]);var o=n;Array.isArray(o[0][0])||(o=[n]);for(var s=0;s<a.length;s++){var u=a[s],l=o[s];i.extrude_gaode2(u,l)}}else{var c=t;Array.isArray(c[0][0])||(c=[t]),c.forEach((function(e){i.extrude(e)}))}var f=i.complex;return{vertices:f.positions,indices:f.indices,normals:f.normals,size:6}}function MF(e){var t=e.coordinates,n=QD.flatten(t),r=n.vertices,i=n.dimensions,a=n.holes;return{indices:QD(r,a,i),vertices:r,size:i}}function RF(e){var t=vF(e.coordinates,!0);return{vertices:t.positions,indices:t.index,normals:t.normals,size:5}}function PF(e,t){for(var n=t||30,r=e.coordinates,i=[],a=[],o=function(e){i.push(e,1,e,r[0][0],r[0][1],r[1][0],r[1][1],e,-1,e,r[0][0],r[0][1],r[1][0],r[1][1]),e!==n-1&&a.push.apply(a,pc([0,1,2,1,3,2].map((function(t){return 2*e+t}))))},s=0;s<n;s++)o(s);return{vertices:i,indices:a,size:7}}function IF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var LF={solid:0,dash:1},NF=function(e){Gc(n,SD);var t=IF(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"texture",void 0),lc(Xc(e),"updateTexture",(function(){var t=e.rendererService.createTexture2D;if(e.texture)return e.texture.update({data:e.iconService.getCanvas()}),void e.layer.render();e.texture=t({data:e.iconService.getCanvas(),mag:yA.NEAREST,min:yA.NEAREST,premultiplyAlpha:!1,width:1024,height:e.iconService.canvasHeight||128})})),e}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.sourceColor,r=e.targetColor,i=e.textureBlend,a=void 0===i?"normal":i,o=e.lineType,s=void 0===o?"solid":o,u=e.dashArray,l=void 0===u?[10,5]:u,c=e.forward,f=void 0===c||c,p=e.lineTexture,h=void 0!==p&&p,d=e.iconStep,v=void 0===d?100:d,m=e.segmentNumber,y=void 0===m?30:m,g=e.thetaOffset,_=void 0===g?.314:g;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var b=this.layer.getEncodedData(),E=this.calDataFrame(this.cellLength,b,this.cellProperties),x=E.data,S=E.width,T=E.height;this.rowCount=T,this.dataTexture=this.cellLength>0&&x.length>0?this.createTexture2D({flipY:!0,data:x,format:yA.LUMINANCE,type:yA.FLOAT,width:S,height:T}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}2===l.length&&l.push(0,0);var A=0,w=[0,0,0,0],C=[0,0,0,0];return n&&r&&(w=gh(n),C=gh(r),A=1),this.rendererService.getDirty()&&this.texture.bind(),{u_thetaOffset:_,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1,u_textureBlend:"normal"===a?0:1,segmentNumber:y,u_line_type:LF[s||"solid"],u_dash_array:l,u_blur:.9,u_lineDir:f?1:-1,u_texture:this.texture,u_line_texture:h?1:0,u_icon_step:v,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:A,u_sourceColor:w,u_targetColor:C}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig().animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.dataTexture)||void 0===t||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var e=this.layer.getLayerConfig().segmentNumber,t=void 0===e?30:e;return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n// varying vec2 v_normal;\n\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform float u_lineDir: 1.0;\nvarying vec4 v_dash_array;\n\nuniform float u_thetaOffset: 0.314;\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = u_thetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  if(u_lineDir == 1.0) { // 正向\n    return mid;\n  } else { // 逆向\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\nvec2 interpolate (vec2 source, vec2 target, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  \n  vec2 source = a_Instance.rg;  // 起始点\n  vec2 target =  a_Instance.ba; // 终点\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  float d_distance_ratio;\n  if(u_line_type == LineTypeDash) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n\n      vec2 s = source;\n      vec2 t = target;\n      \n      if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n        s = unProjCustomCoord(source);\n        t = unProjCustomCoord(target);\n      }\n      float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n      // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n  \n  if(u_aimate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n      if(u_lineDir != 1.0) {\n        d_distance_ratio = 1.0 - d_distance_ratio;\n      }\n  }\n\n   styleMappingMat[3].b = d_distance_ratio;\n\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  //unProjCustomCoord\n  \n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n\n\n  float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置\n  styleMappingMat[3].r = d_segmentIndex;\n\n  if(LineTexture == u_line_texture) { // 开启贴图模式\n\n    float arcDistrance = length(source - target); // 起始点和终点的距离\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap\n      arcDistrance *= 1000000.0;\n    }\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox\n      // arcDistrance *= 8.0;\n      arcDistrance = project_pixel_allmap(arcDistrance);\n    }\n    v_iconMapUV = a_iconMapUV;\n\n    float pixelLen = project_pixel(u_icon_step); // 贴图沿弧线方向的长度 - 随地图缩放改变\n    float texCount = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n     styleMappingMat[3].g = texCount;\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size); // 定点位置偏移\n     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // 线图层贴图部分的 v 坐标值\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  }\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\nuniform float segmentNumber;\nvarying vec2 v_iconMapUV;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_segmentIndex = styleMappingMat[3].r;   // 当前顶点在弧线中所处的分段位置\n  float d_distance_ratio = styleMappingMat[3].b; // 当前顶点在弧线中所处的分段比例\n\n  // 设置弧线的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n  \n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= opacity;\n  if(u_line_type == LineTypeDash) {\n   float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n  }\n\n  // 当存在贴图时在底色上贴上贴图\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));\n    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);\n\n    float d_texCount = styleMappingMat[3].g; // 贴图在弧线上重复的数量\n\n    float u = 1.0 - fract(arcRadio * d_texCount + animateSpeed);\n\n    if(u_aimate.x == Animate) {\n      u = gl_FragColor.a/opacity;\n    }\n    float v = styleMappingMat[3].a; // 横向 v\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n\n    vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n    // gl_FragColor = vec4(1.0 - fract(arcRadio * 20000.0), 0.0, 0.0, 1.0);\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));\n    // gl_FragColor = filterColor(texture2D(u_texture, uv));\n    \n  } else {\n     gl_FragColor = filterColor(gl_FragColor);\n  }\n  // gl_FragColor = filterColor(gl_FragColor);\n}',triangulation:PF,depth:{enable:!1},blend:this.getBlend(),segmentNumber:t})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?1:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:FM.Attribute,descriptor:{name:"a_Instance",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:FM.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(t,n,r,i){var a=e.iconService.getIconMap()[t.texture]||{x:0,y:0};return[a.x,a.y]}}})}}]),n}();function DF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var FF={solid:0,dash:1},jF=function(e){Gc(n,SD);var t=DF(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"texture",void 0),lc(Xc(e),"updateTexture",(function(){var t=e.rendererService.createTexture2D;if(e.texture)return e.texture.update({data:e.iconService.getCanvas()}),void e.layer.render();e.texture=t({data:e.iconService.getCanvas(),mag:yA.NEAREST,min:yA.NEAREST,premultiplyAlpha:!1,width:1024,height:e.iconService.canvasHeight||128})})),e}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.sourceColor,r=e.targetColor,i=e.textureBlend,a=void 0===i?"normal":i,o=e.lineType,s=void 0===o?"solid":o,u=e.dashArray,l=void 0===u?[10,5]:u,c=e.lineTexture,f=void 0!==c&&c,p=e.iconStep,h=void 0===p?100:p,d=e.segmentNumber,v=void 0===d?30:d,m=e.globalArcHeight,y=void 0===m?10:m;2===l.length&&l.push(0,0);var g=0,_=[0,0,0,0],b=[0,0,0,0];if(n&&r&&(_=gh(n),b=gh(r),g=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var E=this.layer.getEncodedData(),x=this.calDataFrame(this.cellLength,E,this.cellProperties),S=x.data,T=x.width,A=x.height;this.rowCount=A,this.dataTexture=this.cellLength>0&&S.length>0?this.createTexture2D({flipY:!0,data:S,format:yA.LUMINANCE,type:yA.FLOAT,width:T,height:A}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_globel_radius:100,u_global_height:y,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1,u_textureBlend:"normal"===a?0:1,segmentNumber:v,u_line_type:FF[s]||0,u_dash_array:l,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:h,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:g,u_sourceColor:_,u_targetColor:b}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig().animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.dataTexture)||void 0===t||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var e=this.layer.getLayerConfig().segmentNumber,t=void 0===e?30:e;return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform float u_globel;\nuniform float u_globel_radius;\nuniform float u_global_height: 10;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n// varying vec2 v_normal;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nvarying float v_segmentIndex;\n\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // TODO: + Math.PI/2 是为了对齐坐标\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // TODO: 手动增加一些偏移，减轻面的冲突\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_aimate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  styleMappingMat[3].g = d_distance_ratio; // 当前点位距离占线总长的比例\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式  \n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel(u_icon_step);\n    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  }\n\n  // 地球模式\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // 线的偏移\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // 计算起始点和终止点的距离\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // 计算飞线各个节点相应的高度\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // 地球点位\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n    \n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n \n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float u_line_texture: 0.0;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\nvarying float v_segmentIndex;\nuniform float segmentNumber;\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].g; // 当前点位距离占线总长的比例\n\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= opacity;\n  if(u_line_type == LineTypeDash) {\n   float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));\n    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);\n    float count = styleMappingMat[3].b; // // 贴图在弧线上重复的数量\n\n    float u = fract(arcRadio * count - animateSpeed * count);\n \n    if(u_aimate.x == Animate) {\n      u = gl_FragColor.a/opacity;\n    }\n\n    float v = styleMappingMat[3].a;  // 线图层贴图部分的 v 坐标值\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n          discard;\n        } else {\n          gl_FragColor = filterColor(pattern);\n        }\n    }\n\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:PF,blend:this.getBlend(),segmentNumber:t})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?1:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:FM.Attribute,descriptor:{name:"a_Instance",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:FM.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(t,n,r,i){var a=e.iconService.getIconMap()[t.texture]||{x:0,y:0};return[a.x,a.y]}}})}}]),n}();function UF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var BF=function(e){Gc(n,SD);var t=UF(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.sourceColor,r=e.targetColor,i=e.forward,a=void 0===i||i,o=e.segmentNumber,s=void 0===o?30:o,u=e.thetaOffset,l=void 0===u?.314:u,c=0,f=[0,0,0,0],p=[0,0,0,0];return n&&r&&(f=gh(n),p=gh(r),c=1),{u_thetaOffset:l,u_opacity:SN(t)?t:1,segmentNumber:s,u_blur:.9,u_lineDir:a?1:-1,u_linearColor:c,u_sourceColor:f,u_targetColor:p}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig().animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var e=this.layer.getLayerConfig().segmentNumber,t=void 0===e?30:e;return[this.layer.buildLayerModel({moduleName:"arc2dminiline",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n// varying vec2 v_normal;\n\nuniform float u_lineDir: 1.0;\n\n// 偏移量\nuniform float u_thetaOffset: 0.314;\n\nuniform float u_opacity: 1.0;\nvarying float v_distance_ratio;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = u_thetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  if(u_lineDir == 1.0) { // 正向\n    return mid;\n  } else { // 逆向\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\nvec2 interpolate (vec2 source, vec2 target, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n  \n  vec2 source = a_Instance.rg;  // 起始点\n  vec2 target =  a_Instance.ba; // 终点\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  v_distance_ratio = segmentIndex / segmentNumber;\n  \n  if(u_aimate.x == Animate && u_lineDir != 1.0) {\n      v_distance_ratio = 1.0 - v_distance_ratio;\n  }\n\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  //unProjCustomCoord\n  \n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  }\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\n// varying vec2 v_normal;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\nuniform float segmentNumber;\nvarying float v_distance_ratio;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nvoid main() {\n\n  // 设置弧线的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, v_distance_ratio);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n  \n \n  gl_FragColor.a *= u_opacity;\n\n  if(u_aimate.x == Animate) {\n      float animateSpeed = u_time / u_aimate.y; // 运动速度\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}',triangulation:PF,depth:{enable:!1},blend:this.getBlend(),segmentNumber:t})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?1:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:FM.Attribute,descriptor:{name:"a_Instance",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}();function zF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var VF={solid:0,dash:1},HF=function(e){Gc(n,SD);var t=zF(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"texture",void 0),lc(Xc(e),"updateTexture",(function(){var t=e.rendererService.createTexture2D;if(e.texture)return e.texture.update({data:e.iconService.getCanvas()}),void e.layer.render();e.texture=t({data:e.iconService.getCanvas(),mag:yA.NEAREST,min:yA.NEAREST,premultiplyAlpha:!1,width:1024,height:e.iconService.canvasHeight||128})})),e}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.sourceColor,r=e.targetColor,i=e.textureBlend,a=void 0===i?"normal":i,o=e.lineType,s=void 0===o?"solid":o,u=e.dashArray,l=void 0===u?[10,5]:u,c=e.lineTexture,f=void 0!==c&&c,p=e.iconStep,h=void 0===p?100:p,d=e.segmentNumber,v=void 0===d?30:d;2===l.length&&l.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var m=0,y=[0,0,0,0],g=[0,0,0,0];if(n&&r&&(y=gh(n),g=gh(r),m=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var _=this.layer.getEncodedData(),b=this.calDataFrame(this.cellLength,_,this.cellProperties),E=b.data,x=b.width,S=b.height;this.rowCount=S,this.dataTexture=this.cellLength>0&&E.length>0?this.createTexture2D({flipY:!0,data:E,format:yA.LUMINANCE,type:yA.FLOAT,width:x,height:S}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1,u_textureBlend:"normal"===a?0:1,segmentNumber:v,u_line_type:VF[s]||0,u_dash_array:l,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:h,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:m,u_sourceColor:y,u_targetColor:g}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig().animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.dataTexture)||void 0===t||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n// varying vec2 v_normal;\n\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\n\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n    vec2 x = mix(source, target, ratio);\n    vec2 center = mix(source, target, 0.5);\n    float dSourceCenter = distance(source, center);\n    float dXCenter = distance(x, center);\n    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n     float vertex_height = paraboloid(source, target, segmentRatio);\n\n    return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n    );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) *\n    sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\n\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = 0.314;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  return mid;\n}\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\n\nvec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    vec2 mid = midPoint(source, target);\n    vec3 x = vec3(source.x, mid.x, target.x);\n    vec3 y = vec3(source.y, mid.y, target.y);\n    return vec2(bezier3(x ,t), bezier3(y,t));\n  }else {\n    if(abs(angularDist - PI) < 0.001) {\n      return (1.0 - t) * source + t * target;\n    }\n    float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n    float b = sin(t * angularDist) / sin(angularDist);\n    vec2 sin_source = sin(source);\n    vec2 cos_source = cos(source);\n    vec2 sin_target = sin(target);\n    vec2 cos_target = cos(target);\n    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n    float z = a * sin_source.y + b * sin_target.y;\n    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n  }\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = radians(a_Instance.rg);\n  vec2 target = radians(a_Instance.ba);\n  float angularDist = getAngularDist(source, target);\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  if(u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    total_Distance = total_Distance*8.0;\n    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  v_distance_ratio = segmentIndex / segmentNumber;\n  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));\n  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n\n  styleMappingMat[3].g = a_Position.x; // 该顶点在弧线上的分段排序\n  if(LineTexture == u_line_texture) { // 开启贴图模式  \n    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;\n    float d_arcDistrance = length(source - target);\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap\n      d_arcDistrance = d_arcDistrance * 1000000.0;\n    }\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox\n      d_arcDistrance = project_pixel_allmap(d_arcDistrance);\n    }\n    float d_pixelLen = project_pixel(u_icon_step)/8.0;\n    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // 贴图在弧线上重复的数量\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n  }\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\nuniform float u_line_texture: 0.0;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\nuniform float segmentNumber;\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n#pragma include "project"\n#pragma include "projection"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0;\n  float d_segmentIndex = styleMappingMat[3].g;\n  \n  // 设置弧线的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= opacity;\n  if(u_line_type == LineTypeDash) {\n   float flag = 0.;\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  // 设置弧线的动画模式\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n      float alpha =1.0 - fract( mod(1.0- smoothstep(0.0, 1.0, v_distance_ratio), u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n\n  // 设置弧线的贴图\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { \n    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));\n    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);\n    float count = styleMappingMat[3].b; // 贴图在弧线上重复的数量\n    float u = fract(arcRadio * count - animateSpeed * count);\n    // float u = fract(arcRadio * count - animateSpeed);\n    if(u_aimate.x == Animate) {\n      u = gl_FragColor.a/opacity;\n    }\n\n    float v = styleMappingMat[3].a; // 线图层贴图部分的 v 坐标值\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture2D(u_texture, uv);\n    \n    // 设置贴图和底色的叠加模式\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}',triangulation:PF,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?1:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:FM.Attribute,descriptor:{name:"a_Instance",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:FM.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(t,n,r,i){var a=e.iconService.getIconMap()[t.texture]||{x:0,y:0};return[a.x,a.y]}}})}}]),n}();function GF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var WF={solid:0,dash:1},XF=function(e){Gc(n,SD);var t=GF(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"texture",void 0),lc(Xc(e),"updateTexture",(function(){var t=e.rendererService.createTexture2D;if(e.texture)return e.texture.update({data:e.iconService.getCanvas()}),void e.layer.render();e.texture=t({data:e.iconService.getCanvas(),mag:yA.NEAREST,min:yA.NEAREST,premultiplyAlpha:!1,width:1024,height:e.iconService.canvasHeight||128})})),e}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.sourceColor,r=e.targetColor,i=e.textureBlend,a=void 0===i?"normal":i,o=e.lineType,s=void 0===o?"solid":o,u=e.dashArray,l=void 0===u?[10,5,0,0]:u,c=e.lineTexture,f=void 0!==c&&c,p=e.iconStep,h=void 0===p?100:p,d=e.vertexHeightScale,v=void 0===d?20:d;2===l.length&&l.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var m=0,y=[0,0,0,0],g=[0,0,0,0];if(n&&r&&(y=gh(n),g=gh(r),m=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var _=this.layer.getEncodedData(),b=this.calDataFrame(this.cellLength,_,this.cellProperties),E=b.data,x=b.width,S=b.height;this.rowCount=S,this.dataTexture=this.cellLength>0&&E.length>0?this.createTexture2D({flipY:!0,data:E,format:yA.LUMINANCE,type:yA.FLOAT,width:x,height:S}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1,u_textureBlend:"normal"===a?0:1,u_line_type:WF[s],u_dash_array:l,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:h,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:m,u_sourceColor:y,u_targetColor:g,u_vertexScale:v}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig().animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.dataTexture)||void 0===t||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\nattribute vec2 a_iconMapUV;\n\n// dash line\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nuniform float u_icon_step: 100;\n\nuniform float u_vertexScale: 1.0;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec4 v_dash_array;\nvarying vec2 v_normal;\n\n// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）\nvarying vec2 v_iconMapUV;\n\n\nuniform float u_linearColor: 0;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  float d_distance_ratio; // 当前点位距离占线总长的比例\n  float d_texPixelLen;    // 贴图的像素长度，根据地图层级缩放\n\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_pixel(u_icon_step);\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    d_texPixelLen *= 10.0;\n  }\n\n  if(u_line_type == LineTypeDash) {\n    d_distance_ratio = a_Distance / a_Total_Distance;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  }\n  if(u_aimate.x == Animate || u_linearColor == 1.0) {\n      d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));\n\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n\n  vec2 offset = project_pixel(size.xy);\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2\n  float texV = lineOffsetWidth/linePixelSize; // 线图层贴图部分的 v 坐标值\n\n  // 设置数据集的参数\n  styleMappingMat[3][0] = d_distance_ratio; // 当前点位距离占线总长的比例\n  styleMappingMat[3][1] = a_Distance;       // 当前顶点的距离\n  styleMappingMat[3][2] = d_texPixelLen;    // 贴图的像素长度，根据地图层级缩放\n  styleMappingMat[3][3] = texV;             // 线图层贴图部分的 v 坐标值\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  float h = float((a_Position.z)) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y, 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y / 8.0 + h, 1.0)); // 额外除 8.0 是为了和gaode1.x的高度兼容\n  } else {\n    float lineHeight = a_Size.y;\n    // 兼容 mapbox 在线高度上的效果表现基本一致\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      lineHeight = lineHeight*2.0/pow(2.0, 20.0 - u_Zoom);\n    }\n    \n\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nuniform float u_blur : 0.99;\nuniform float u_line_type: 0.0;\nuniform float u_opacity : 1.0;\nuniform float u_textureBlend;\nvarying vec4 v_color;\n// varying vec2 v_normal;\n\n// line texture\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\n// dash\nuniform float u_dash_offset : 0.0;\nuniform float u_dash_ratio : 0.1;\nvarying vec4 v_dash_array;\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // 控制运动\n\nvarying mat4 styleMappingMat;\n// [animate, duration, interval, trailLength],\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].r; // 当前点位距离占线总长的比例\n\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= opacity; // 全局透明度\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n // dash line\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    float aDistance = styleMappingMat[3].g;      // 当前顶点的距离\n    float d_texPixelLen = styleMappingMat[3].b;  // 贴图的像素长度，根据地图层级缩放\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = styleMappingMat[3].a;  // 线图层贴图部分的 v 坐标值\n\n    v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    \n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));\n     vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n\n  // gl_FragColor = (vec4(1.0, 0.0, 0.0, 1.0));\n \n  // if(rV < r || rV > 1.0 - r) {\n  //   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n  // } \n  // if(v > 0.9) {\n    // gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // } else if(v < 0.1) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:OF,primitive:yA.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.layer.getLayerConfig().lineType,this.styleAttributeService.registerStyleAttribute({name:"distance",type:FM.Attribute,descriptor:{name:"a_Distance",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){return[n[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:FM.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(e,t,n,r){var i=e.size,a=void 0===i?1:i;return Array.isArray(a)?[a[0],a[1]]:[a,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:FM.Attribute,descriptor:{name:"a_Normal",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:3,update:function(e,t,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:FM.Attribute,descriptor:{name:"a_Miter",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){return[n[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:FM.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(t,n,r,i){var a=e.iconService.getIconMap()[t.texture]||{x:0,y:0};return[a.x,a.y]}}})}},{key:"loadImage",value:function(e){return new Promise((function(t,n){if(e instanceof HTMLImageElement)t(e);else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){t(r)},r.onerror=function(){n(new Error("Could not load image at "+e))},r.src=e instanceof File?URL.createObjectURL(e):e}}))}}]),n}(),YF={arc:NF,arcmini:BF,arc3d:jF,greatcircle:HF,line:XF};function qF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var ZF=function(e){Gc(n,zN);var t=qF(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"type","LineLayer"),e}return Uc(n,[{key:"buildModels",value:function(){var e=this.getModelType();this.layerModel=new YF[e](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){return{line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},arcmini:{blend:"additive"},greatcircle:{blend:"additive"}}[this.getModelType()]}},{key:"getModelType",value:function(){var e,t=this.styleAttributeService.getLayerStyleAttribute("shape");return(null==t||null===(e=t.scale)||void 0===e?void 0:e.field)||"line"}}]),n}();function KF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var QF=function(e){Gc(n,SD);var t=KF(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig().opacity,t=void 0===e?1:e;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var n=this.layer.getEncodedData(),r=this.calDataFrame(this.cellLength,n,this.cellProperties),i=r.data,a=r.width,o=r.height;this.rowCount=o,this.dataTexture=this.cellLength>0&&i.length>0?this.createTexture2D({flipY:!0,data:i,format:yA.LUMINANCE,type:yA.FLOAT,width:a,height:o}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) + \n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n  vec3 size = a_Size * a_Position;\n\n  vec2 offset = project_pixel(size.xy);\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);\n\n  float lightWeight = calc_lighting(pos);\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  // gl_Position = project_common_position_to_clipspace(pos);\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * pos;\n  } else {\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  \n  if(u_globel > 0.0) {\n    // 在地球模式下，将原本垂直于 xy 平面的圆柱调整姿态到适应圆的角度\n    //旋转矩阵mx，创建绕x轴旋转矩阵\n    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n    float xRadian = getXRadian(a_Pos.y, r);\n    float xcos = cos(xRadian);//求解旋转角度余弦值\n    float xsin = sin(xRadian);//求解旋转角度正弦值\n    mat4 mx = mat4(\n      1,0,0,0,  \n      0,xcos,-xsin,0,  \n      0,xsin,xcos,0,  \n      0,0,0,1);\n\n    //旋转矩阵my，创建绕y轴旋转矩阵\n    float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n    float ycos = cos(yRadian);//求解旋转角度余弦值\n    float ysin = sin(yRadian);//求解旋转角度正弦值\n    mat4 my = mat4(\n      ycos,0,-ysin,0,  \n      0,1,0,0,  \n      ysin,0,ycos,0,  \n      0,0,0,1);\n\n    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:CF,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){var e="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:3,update:function(e,t,n,r){var i=e.size;if(i){var a=[];return Array.isArray(i)&&(a=2===i.length?[i[0],i[0],i[1]]:i),Array.isArray(i)||(a=[i,i,i]),a}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:FM.Attribute,descriptor:{name:"a_Normal",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:3,update:function(e,t,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:FM.Attribute,descriptor:{name:"a_Pos",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:3,update:function(t,n){var r=dF(t.coordinates);return e?$D([r[0],r[1]]):[r[0],r[1],0]}}})}}]),n}();function JF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var $F=function(e){Gc(n,SD);var t=JF(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t,r=e.strokeOpacity,i=void 0===r?1:r,a=e.strokeWidth,o=void 0===a?0:a,s=e.stroke,u=void 0===s?"rgba(0,0,0,0)":s,l=e.offsets,c=void 0===l?[0,0]:l;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,strokeOpacity:i,strokeWidth:o,stroke:u,offsets:c})){this.judgeStyleAttributes({opacity:n,strokeOpacity:i,strokeWidth:o,stroke:u,offsets:c});var f=this.layer.getEncodedData(),p=this.calDataFrame(this.cellLength,f,this.cellProperties),h=p.data,d=p.width,v=p.height;this.rowCount=v,this.dataTexture=this.cellLength>0&&h.length>0?this.createTexture2D({flipY:!0,data:h,format:yA.LUMINANCE,type:yA.FLOAT,width:d,height:v}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(n)?n:1,u_stroke_opacity:SN(i)?i:1,u_stroke_width:SN(o)?o:0,u_stroke_color:this.getStrokeColor(u),u_offsets:this.isOffsetStatic(c)?c:[0,0]}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig().animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),AF)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var e="GLOBEL"===this.mapService.version;return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\nuniform float u_opacity : 1;\nuniform float u_stroke_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\nuniform vec2 u_offsets;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  float newSize = setPickingSize(a_Size);\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = strokeOpacityAndOffset.r;\n  textureOffset = strokeOpacityAndOffset.g;\n\n  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // TODO: billboard\n  // anti-alias\n  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);\n\n  // construct point coords\n  // TODP: /abs(extrude.x) 是为了兼容地球模式\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  // vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);\n  vec2 offset = project_pixel(extrude.xy * (newSize + u_stroke_width) + textrueOffsets);\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n  }\n\n  if(u_globel > 0.0) {\n    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);\n  }\n \n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"#define Animate 0.0\n\nuniform float u_globel;\nuniform float u_blur : 0;\n// uniform float u_stroke_width : 1;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n \n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n  float stroke_opacity = styleMappingMat[0][1];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;\n\n  lowp float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  // float r = v_radius / (v_radius + u_stroke_width);\n  float r = v_radius / (v_radius + strokeWidth);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(u_globel > 0.0) {\n    // TODO: 地球模式下避免多余片元绘制，同时也能避免有用片元在透明且重叠的情况下无法写入\n    // 付出的代价是边缘会有一些锯齿\n    if(outer_df > antialiased_blur + 0.018) discard;\n  }\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n  \n \n  // float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n  //   antialiased_blur,\n  //   0.0,\n  //   inner_df\n  // );\n   float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);\n\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n  if(u_aimate.x == Animate) {\n    float d = length(v_data.xy);\n    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);\n    gl_FragColor = vec4(gl_FragColor.xyz, intensity);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n\n  \n\n}\n",triangulation:e?wF:AF,depth:{enable:e},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"animateOption2Array",value:function(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var e=this,t="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:FM.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:3,update:function(e,n,r,i){var a;if(t){var o=Ic(r,3),s=o[0],u=o[1],l=o[2],c=US(0,0,1),f=US(s,0,l),p=s>=0?KS(c,f):2*Math.PI-KS(c,f),h=2*Math.PI-Math.asin(u/100),d=dS();SS(d,d,p),xS(d,d,h);var v=US(1,1,0);ZS(v,v,d),XS(v,v);var m=US(-1,1,0);ZS(m,m,d),XS(m,m);var y=US(-1,-1,0);ZS(y,y,d),XS(y,y);var g=US(1,-1,0);ZS(g,g,d),XS(g,g),a=[].concat(pc(v),pc(m),pc(y),pc(g))}else a=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var _=i%4*3;return[a[_],a[_+1],a[_+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?5:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:FM.Attribute,descriptor:{name:"a_Shape",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(t,n,r,i){var a=t.shape,o=void 0===a?2:a;return[e.layer.getLayerConfig().shape2d.indexOf(o)]}}})}}]),n}();function ej(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var tj=function(e){Gc(n,SD);var t=ej(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"texture",void 0),e}return Uc(n,[{key:"getUninforms",value:function(){return{u_opacity:this.layer.getLayerConfig().opacity||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var e=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",(function(){e.updateTexture(),e.layer.render()})),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - 数据纹理映射部分的计算\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:kF,primitive:yA.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size;return Array.isArray(i)?[i[0]]:[i]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:FM.Attribute,descriptor:{name:"a_Uv",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(t,n,r,i){var a=e.fontService.mapping,o=t.shape,s=a[e.fontService.getGlyph(o)];return[s.x,s.y]}}})}},{key:"updateTexture",value:function(){var e=this.rendererService.createTexture2D,t=this.fontService.canvas;this.texture=e({data:t,mag:yA.LINEAR,min:yA.LINEAR,width:t.width,height:t.height})}},{key:"initIconFontGlyphs",value:function(){var e=this,t=this.layer.getLayerConfig(),n=t.fontWeight,r=void 0===n?"normal":n,i=t.fontFamily,a=void 0===i?"sans-serif":i,o=this.layer.getEncodedData(),s=[];o.forEach((function(t){var n=t.shape,r=void 0===n?"":n;r=r.toString();var i=e.fontService.getGlyph(r);-1===s.indexOf(i)&&s.push(i)})),this.fontService.setFontOptions({characterSet:s,fontWeight:r,fontFamily:a,fontSize:48})}}]),n}();function nj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var rj=function(e){Gc(n,SD);var t=nj(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"texture",void 0),lc(Xc(e),"updateTexture",(function(){var t=e.rendererService.createTexture2D;if(e.texture)return e.texture.update({data:e.iconService.getCanvas()}),void e.layer.renderLayers();e.texture=t({data:e.iconService.getCanvas(),mag:yA.LINEAR,min:yA.LINEAR,premultiplyAlpha:!1,width:1024,height:e.iconService.canvasHeight||128})})),e}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.offsets,r=void 0===n?[0,0]:n;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t,offsets:r})){this.judgeStyleAttributes({opacity:t,offsets:r});var i=this.layer.getEncodedData(),a=this.calDataFrame(this.cellLength,i,this.cellProperties),o=a.data,s=a.width,u=a.height;this.rowCount=u,this.dataTexture=this.cellLength>0&&o.length>0?this.createTexture2D({flipY:!0,data:o,format:yA.LUMINANCE,type:yA.FLOAT,width:s,height:u}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:SN(t)?t:1,u_offsets:this.isOffsetStatic(r)?r:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.dataTexture)||void 0===t||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - 数据纹理映射部分的计算\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:kF,primitive:yA.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?5:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:FM.Attribute,descriptor:{name:"a_Uv",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(t,n,r,i){var a=e.iconService.getIconMap()[t.shape]||{x:0,y:0};return[a.x,a.y]}}})}}]),n}();function ij(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function aj(e){var t=e.coordinates;return{vertices:pc(t),indices:[0],size:t.length}}var oj=function(e){Gc(n,SD);var t=ij(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t,r=e.offsets,i=void 0===r?[0,0]:r;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,offsets:i})){this.judgeStyleAttributes({opacity:n,offsets:i});var a=this.layer.getEncodedData(),o=this.calDataFrame(this.cellLength,a,this.cellProperties),s=o.data,u=o.width,l=o.height;this.rowCount=l,this.dataTexture=this.cellLength>0&&s.length>0?this.createTexture2D({flipY:!0,data:s,format:yA.LUMINANCE,type:yA.FLOAT,width:u,height:l}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(n)?n:1,u_offsets:this.isOffsetStatic(i)?i:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:'\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - 数据纹理映射部分的计算\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n  \n  // vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\\n  // \n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // vec2 offset = project_pixel((u_offsets));\n    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);\n  } else { // else\n    // vec2 offset = project_pixel(u_offsets);\n    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n\n  gl_FragColor = v_color;\n  // gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor.a =gl_FragColor.a * opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:aj,depth:{enable:!1},primitive:yA.POINTS,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?1:i;return Array.isArray(a)?[a[0]]:[a]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:RM.additive}}}]),n}();function sj(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return uj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uj(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function uj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lj=function(){function e(t,n,r){Fc(this,e),lc(this,"boxCells",[]),lc(this,"xCellCount",void 0),lc(this,"yCellCount",void 0),lc(this,"boxKeys",void 0),lc(this,"bboxes",void 0),lc(this,"width",void 0),lc(this,"height",void 0),lc(this,"xScale",void 0),lc(this,"yScale",void 0),lc(this,"boxUid",void 0);var i=this.boxCells;this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(n/r);for(var a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=t,this.height=n,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/n,this.boxUid=0}return Uc(e,[{key:"insert",value:function(e,t,n,r,i){this.forEachCell(t,n,r,i,this.insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}},{key:"query",value:function(e,t,n,r,i){return this.queryHitTest(e,t,n,r,!1,i)}},{key:"hitTest",value:function(e,t,n,r,i){return this.queryHitTest(e,t,n,r,!0,i)}},{key:"insertBoxCell",value:function(e,t,n,r,i,a){this.boxCells[i].push(a)}},{key:"queryHitTest",value:function(e,t,n,r,i,a){if(n<0||e>this.width||r<0||t>this.height)return!i&&[];var o=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)o.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});return a?o.filter(a):o}var u={hitTest:i,seenUids:{box:{},circle:{}}};return this.forEachCell(e,t,n,r,this.queryCell,o,u,a),i?o.length>0:o}},{key:"queryCell",value:function(e,t,n,r,i,a,o,s){var u=o.seenUids,l=this.boxCells[i];if(null!==l){var c,f=this.bboxes,p=sj(l);try{for(p.s();!(c=p.n()).done;){var h=c.value;if(!u.box[h]){u.box[h]=!0;var d=4*h;if(e<=f[d+2]&&t<=f[d+3]&&n>=f[d+0]&&r>=f[d+1]&&(!s||s(this.boxKeys[h]))){if(o.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[h],x1:f[d],y1:f[d+1],x2:f[d+2],y2:f[d+3]})}}}}catch(v){p.e(v)}finally{p.f()}}return!1}},{key:"forEachCell",value:function(e,t,n,r,i,a,o,s){for(var u=this.convertToXCellCoord(e),l=this.convertToYCellCoord(t),c=this.convertToXCellCoord(n),f=this.convertToYCellCoord(r),p=u;p<=c;p++)for(var h=l;h<=f;h++){var d=this.xCellCount*h+p;if(i.call(this,e,t,n,r,d,a,o,s))return}}},{key:"convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}}]),e}(),cj=function(){function e(t,n){Fc(this,e),lc(this,"width",void 0),lc(this,"height",void 0),lc(this,"grid",void 0),lc(this,"viewportPadding",100),lc(this,"screenRightBoundary",void 0),lc(this,"screenBottomBoundary",void 0),lc(this,"gridRightBoundary",void 0),lc(this,"gridBottomBoundary",void 0),this.width=t,this.height=n,this.viewportPadding=Math.max(t,n),this.grid=new lj(t+this.viewportPadding,n+this.viewportPadding,25),this.screenRightBoundary=t+this.viewportPadding,this.screenBottomBoundary=n+this.viewportPadding,this.gridRightBoundary=t+2*this.viewportPadding,this.gridBottomBoundary=n+2*this.viewportPadding}return Uc(e,[{key:"placeCollisionBox",value:function(e){var t=e.x1+e.anchorPointX+this.viewportPadding,n=e.y1+e.anchorPointY+this.viewportPadding,r=e.x2+e.anchorPointX+this.viewportPadding,i=e.y2+e.anchorPointY+this.viewportPadding;return!this.isInsideGrid(t,n,r,i)||this.grid.hitTest(t,n,r,i)?{box:[]}:{box:[t,n,r,i]}}},{key:"insertCollisionBox",value:function(e,t){var n={featureIndex:t};this.grid.insert(n,e[0],e[1],e[2],e[3])}},{key:"project",value:function(e,t,n){var r=function(e,t,n,r){var i=new pS(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}(t,n,0,1),i=sT();return uT(i,r,mS.apply(DS,pc(e))),{x:(i[0]/i[3]+1)/2*this.width+this.viewportPadding,y:(-i[1]/i[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary}}]),e}();function fj(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pj(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function pj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hj(e){var t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5}return{horizontalAlign:t,verticalAlign:n}}function dj(e,t,n,r,i){if(i){var a=e[r],o=a.glyph;if(o)for(var s=t[o].advance*a.scale,u=(e[r].x+s)*i,l=n;l<=r;l++)e[l].x-=u}}function vj(e,t,n,r,i,a,o){var s,u=(t-n)*i,l=(-r*o+.5)*a,c=fj(e);try{for(c.s();!(s=c.n()).done;){var f=s.value;f.x+=u,f.y+=l}}catch(p){c.e(p)}finally{c.f()}}function mj(e,t,n,r,i,a,o){var s=0,u=-8,l=0,c=e.positionedGlyphs,f="right"===a?1:"left"===a?0:.5,p=c.length;n.forEach((function(e){if(e.split("").forEach((function(e){var n=t[e];n&&(c.push({glyph:e,x:s,y:u+0,vertical:!1,scale:1,metrics:n}),s+=n.advance+o)})),c.length!==p){var n=s-o;l=Math.max(n,l),dj(c,t,p,c.length-1,f)}s=0,u-=r+5}));var h=hj(i),d=h.horizontalAlign,v=h.verticalAlign;vj(c,f,d,v,l,r,n.length);var m=u- -8;e.top+=-v*m,e.bottom=e.top-m,e.left+=-d*l,e.right=e.left+l}function yj(e,t,n,r,i,a,o){var s=0,u=-8,l=0,c=e.positionedGlyphs,f="right"===a?1:"left"===a?0:.5,p=c.length;n.forEach((function(e){var n=t[e];if(n&&(c.push({glyph:e,x:s,y:u+0,vertical:!1,scale:1,metrics:n}),s+=n.advance+o),c.length!==p){var i=s-o;l=Math.max(i,l),dj(c,t,p,c.length-1,f)}s=0,u-=r+5}));var h=hj(i),d=h.horizontalAlign,v=h.verticalAlign;vj(c,f,d,v,l,r,n.length);var m=u- -8;e.top+=-v*m,e.bottom=e.top-m,e.left+=-d*l,e.right=e.left+l}function gj(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _j(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Ej='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform vec4 u_stroke_color : [0, 0, 0, 1];\nuniform float u_stroke_width : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n  float opacity = styleMappingMat[0][0];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',xj='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute float a_Rotate;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n   styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n  \n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // 文本缩放比例\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  highp float angle_sin = sin(a_Rotate);\n  highp float angle_cos = cos(a_Rotate);\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  \n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  vec4 projected_position;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));\n  } else { // else\n   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function Sj(e){var t=this,n=e.id,r=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[n])return{vertices:[],indices:[],size:7};var a=t.glyphInfoMap[n].centroid,o=2===a.length?[a[0],a[1],0]:a;return t.glyphInfoMap[n].glyphQuads.forEach((function(e,t){r.push.apply(r,pc(o).concat([e.tex.x,e.tex.y+e.tex.height,e.tl.x,e.tl.y],pc(o),[e.tex.x+e.tex.width,e.tex.y+e.tex.height,e.tr.x,e.tr.y],pc(o),[e.tex.x+e.tex.width,e.tex.y,e.br.x,e.br.y],pc(o),[e.tex.x,e.tex.y,e.bl.x,e.bl.y])),i.push(0+4*t,1+4*t,2+4*t,2+4*t,3+4*t,0+4*t)})),{vertices:r,indices:i,size:7}}var Tj=function(e){Gc(n,SD);var t=bj(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"glyphInfo",void 0),lc(Xc(e),"glyphInfoMap",{}),lc(Xc(e),"texture",void 0),lc(Xc(e),"currentZoom",-1),lc(Xc(e),"extent",void 0),lc(Xc(e),"textureHeight",0),lc(Xc(e),"textCount",0),lc(Xc(e),"preTextStyle",{}),lc(Xc(e),"buildModels",(function(){return e.initGlyph(),e.updateTexture(),e.filterGlyphs(),e.reBuildModel(),[e.layer.buildLayerModel({moduleName:"pointText",vertexShader:xj,fragmentShader:Ej,triangulation:Sj.bind(Xc(e)),depth:{enable:!1},blend:e.getBlend()})]})),e}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t,r=e.stroke,i=void 0===r?"#fff":r,a=e.strokeWidth,o=void 0===a?0:a,s=e.textAnchor,u=void 0===s?"center":s,l=e.textAllowOverlap,c=void 0!==l&&l,f=e.halo,p=void 0===f?.5:f,h=e.gamma,d=void 0===h?2:h,v=this.fontService,m=v.canvas,y=v.mapping;if(Object.keys(y).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(y).length),this.preTextStyle={textAnchor:u,textAllowOverlap:c},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,strokeWidth:o,stroke:i})){this.judgeStyleAttributes({opacity:n,strokeWidth:o,stroke:i});var g=this.layer.getEncodedData(),_=this.calDataFrame(this.cellLength,g,this.cellProperties),b=_.data,E=_.width,x=_.height;this.rowCount=x,this.dataTexture=this.cellLength>0&&b.length>0?this.createTexture2D({flipY:!0,data:b,format:yA.LUMINANCE,type:yA.FLOAT,width:E,height:x}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(n)?n:1,u_stroke_width:SN(o)?o:0,u_stroke_color:this.getStrokeColor(i),u_sdf_map:this.texture,u_halo_blur:p,u_gamma_scale:d,u_sdf_map_size:[m.width,m.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var e=this.layer.getLayerConfig(),t=e.textAnchor,n=void 0===t?"center":t,r=e.textAllowOverlap,i=void 0===r||r;return this.preTextStyle={textAnchor:n,textAllowOverlap:i},this.buildModels()}},{key:"needUpdate",value:function(){var e=this.layer.getLayerConfig().textAllowOverlap,t=void 0!==e&&e,n=this.mapService.getZoom(),r=this.mapService.getBounds(),i=Fp(this.extent,r);return(!t&&(Math.abs(this.currentZoom-n)>1||!i)||t!==this.preTextStyle.textAllowOverlap)&&(this.reBuildModel(),!0)}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:FM.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.rotate,a=void 0===i?0:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:FM.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(e,t,n,r){return[n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?12:i;return Array.isArray(a)?[a[0]]:[a]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:FM.Attribute,descriptor:{name:"a_tex",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:2,update:function(e,t,n,r){return[n[3],n[4]]}}})}},{key:"textExtent",value:function(){return Dp(this.mapService.getBounds(),.5)}},{key:"initTextFont",value:function(){var e=this.layer.getLayerConfig(),t=e.fontWeight,n=void 0===t?"400":t,r=e.fontFamily,i=void 0===r?"sans-serif":r,a=this.layer.getEncodedData(),o=[];a.forEach((function(e){var t,n=e.shape,r=void 0===n?"":n,i=gj(r=r.toString());try{for(i.s();!(t=i.n()).done;){var a=t.value;-1===o.indexOf(a)&&o.push(a)}}catch(s){i.e(s)}finally{i.f()}})),this.fontService.setFontOptions({characterSet:o,fontWeight:n,fontFamily:i,iconfont:!1})}},{key:"initIconFontTex",value:function(){var e=this.layer.getLayerConfig(),t=e.fontWeight,n=void 0===t?"400":t,r=e.fontFamily,i=void 0===r?"sans-serif":r,a=this.layer.getEncodedData(),o=[];a.forEach((function(e){var t=e.shape,n=void 0===t?"":t;n="".concat(n),-1===o.indexOf(n)&&o.push(n)})),this.fontService.setFontOptions({characterSet:o,fontWeight:n,fontFamily:i,iconfont:!0})}},{key:"generateGlyphLayout",value:function(e){var t=this,n=this.fontService.mapping,r=this.layer.getLayerConfig(),i=r.spacing,a=void 0===i?2:i,o=r.textAnchor,s=void 0===o?"center":o,u=this.layer.getEncodedData();this.glyphInfo=u.map((function(r){var i=r.shape,o=void 0===i?"":i,u=r.id,l=r.size,c=void 0===l?1:l,f=r.textOffset,p=void 0===f?[0,0]:f,h=function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],s=arguments.length>7?arguments[7]:void 0,u=e.split("\n"),l=[],c={positionedGlyphs:l,top:o[1],bottom:o[1],left:o[0],right:o[0],lineCount:u.length,text:e};return s?yj(c,t,u,n,r,i,a):mj(c,t,u,n,r,i,a),!!l.length&&c}(o.toString(),n,c,s,"left",a,p,e),d=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,i=e.positionedGlyphs,a=[],o=fj(void 0===i?[]:i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.metrics,l=4,c=u.advance*s.scale/2,f=r?[s.x+c,s.y]:[0,0],p=r?[0,0]:[s.x+c+n[0],s.y+n[1]],h=(0-l)*s.scale-c+p[0],d=(0-l)*s.scale+p[1],v=h+u.width*s.scale,m=d+u.height*s.scale,y={x:h,y:d},g={x:v,y:d},_={x:h,y:m},b={x:v,y:m};a.push({tl:y,tr:g,bl:_,br:b,tex:u,glyphOffset:f})}}catch(E){o.e(E)}finally{o.f()}return a}(h,p,!1);return r.shaping=h,r.glyphQuads=d,r.centroid=dF(r.coordinates),r.originCentroid="GAODE2.x"===r.version?dF(r.originCoordinates):r.originCentroid=r.centroid,t.glyphInfoMap[u]={shaping:h,glyphQuads:d,centroid:dF(r.coordinates)},r}))}},{key:"filterGlyphs",value:function(){var e=this,t=this.layer.getLayerConfig(),n=t.padding,r=void 0===n?[4,4]:n,i=t.textAllowOverlap;if(!(void 0!==i&&i)){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var a=this.rendererService.getViewportSize(),o=a.width,s=a.height,u=new cj(o,s);this.glyphInfo.filter((function(t){var n=t.shaping,i=t.id,a=void 0===i?0:i,o="GAODE2.x"===t.version?t.originCentroid:t.centroid,s=t.size/24,l=e.mapService.lngLatToContainer(o),c=u.placeCollisionBox({x1:n.left*s-r[0],x2:n.right*s+r[0],y1:n.top*s-r[1],y2:n.bottom*s+r[1],anchorPointX:l.x,anchorPointY:l.y}).box;return!(!c||!c.length)&&(u.insertCollisionBox(c,a),!0)})).forEach((function(t){e.glyphInfoMap[t.id]=t}))}}},{key:"initGlyph",value:function(){var e=this.layer.getLayerConfig().iconfont,t=void 0!==e&&e;t?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(t)}},{key:"updateTexture",value:function(){var e=this.rendererService.createTexture2D,t=this.fontService.canvas;this.textureHeight=t.height,this.texture&&this.texture.destroy(),this.texture=e({data:t,mag:yA.LINEAR,min:yA.LINEAR,width:t.width,height:t.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:xj,fragmentShader:Ej,triangulation:Sj.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),n}(),Aj={fill:$F,image:rj,normal:oj,extrude:QF,text:Tj,icon:tj};function wj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Cj=function(e){Gc(n,zN);var t=wj(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"type","PointLayer"),e}return Uc(n,[{key:"buildModels",value:function(){var e=this.getModelType();this.layerModel=new Aj[e](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){return{normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}}[this.getModelType()]}},{key:"getModelType",value:function(){var e=this.getEncodedData(),t=this.getLayerConfig(),n=t.shape2d,r=t.shape3d,i=this.iconService.getIconMap(),a=e.find((function(e){return e.hasOwnProperty("shape")}));if(a){var o=a.shape;return"dot"===o?"normal":-1!==(null==n?void 0:n.indexOf(o))?"fill":-1!==(null==r?void 0:r.indexOf(o))?"extrude":i.hasOwnProperty(o)?"image":""!==this.fontService.getGlyph(o)?"icon":"text"}return"normal"}}]),n}();function kj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Oj=function(e){Gc(n,SD);var t=kj(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig().opacity,t=void 0===e?1:e;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var n=this.layer.getEncodedData(),r=this.calDataFrame(this.cellLength,n,this.cellProperties),i=r.data,a=r.width,o=r.height;this.rowCount=o,this.dataTexture=this.cellLength>0&&i.length>0?this.createTexture2D({flipY:!0,data:i,format:yA.LUMINANCE,type:yA.FLOAT,width:a,height:o}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:RF})]}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:FM.Attribute,descriptor:{name:"a_Normal",buffer:{usage:yA.STATIC_DRAW,data:[],type:yA.FLOAT},size:3,update:function(e,t,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:FM.Attribute,descriptor:{name:"a_Size",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){var i=e.size,a=void 0===i?10:i;return Array.isArray(a)?[a[0]]:[a]}}})}}]),n}();function Mj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Rj={fill:function(e){Gc(n,SD);var t=Mj(n);function n(){return Fc(this,n),t.apply(this,arguments)}return Uc(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig().opacity,t=void 0===e?1:e;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:t})){this.judgeStyleAttributes({opacity:t});var n=this.layer.getEncodedData(),r=this.calDataFrame(this.cellLength,n,this.cellProperties),i=r.data,a=r.width,o=r.height;this.rowCount=o,this.dataTexture=this.cellLength>0&&i.length>0?this.createTexture2D({flipY:!0,data:i,format:yA.LUMINANCE,type:yA.FLOAT,width:a,height:o}):this.createTexture2D({flipY:!0,data:[1],format:yA.LUMINANCE,type:yA.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:SN(t)?t:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:MF,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"clearModels",value:function(){var e;null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){}}]),n}(),line:XF,extrude:Oj,text:Tj,point_fill:$F,point_image:rj,point_normal:oj,point_extrude:QF};function Pj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qc(e);if(t){var i=qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}var Ij,Lj,Nj,Dj,Fj,jj,Uj,Bj,zj,Vj=function(e){Gc(n,zN);var t=Pj(n);function n(){var e;Fc(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return lc(Xc(e=t.call.apply(t,[this].concat(i))),"type","PolygonLayer"),e}return Uc(n,[{key:"buildModels",value:function(){var e=this.getModelType();this.layerModel=new Rj[e](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var e,t=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null==t||null===(e=t.scale)||void 0===e?void 0:e.field;return"fill"===n?"fill":"extrude"===n?"extrude":"line"===n?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var e=this.getEncodedData(),t=this.getLayerConfig(),n=t.shape2d,r=t.shape3d,i=this.iconService.getIconMap(),a=e.find((function(e){return e.hasOwnProperty("shape")}));if(a){var o=a.shape;return"dot"===o?"point_normal":-1!==(null==n?void 0:n.indexOf(o))?"point_fill":-1!==(null==r?void 0:r.indexOf(o))?"point_extrude":i.hasOwnProperty(o)?"point_image":"text"}return"fill"}}]),n}();function Hj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Gj,Wj=(Ij=Fx(),Lj=nx(Bx.IGlobalConfigService),Nj=nx(Bx.IMapService),Dj=nx(Bx.IFontService),Ij((jj=function(){function e(){Fc(this,e),DT(this,"configService",Uj,this),DT(this,"mapService",Bj,this),DT(this,"fontService",zj,this)}return Uc(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("DataMappingPlugin",(function(){n.generateMaping(e,{styleAttributeService:r})})),e.hooks.beforeRenderData.tap("DataMappingPlugin",(function(){return e.dataState.dataMappingNeedUpdate=!1,n.generateMaping(e,{styleAttributeService:r}),!0})),e.hooks.beforeRender.tap("DataMappingPlugin",(function(){if(!e.layerModelNeedUpdate){var t=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter"),a=e.getSource().data.dataArray,o=t.filter((function(e){return e.needRemapping})),s=a;null!=i&&i.needRemapping&&null!=i&&i.scale&&(s=a.filter((function(e){return n.applyAttributeMapping(i,e)[0]}))),o.length&&(null!=i&&i.needRemapping?(e.setEncodedData(n.mapping(t,s)),i.needRemapping=!1):e.setEncodedData(n.mapping(o,s,e.getEncodedData())),e.emit("remapping",null))}}))}},{key:"generateMaping",value:function(e,t){var n=this,r=t.styleAttributeService,i=r.getLayerStyleAttributes()||[],a=r.getLayerStyleAttribute("filter"),o=e.getSource().data.dataArray,s=o;null!=a&&a.scale&&(s=o.filter((function(e){return n.applyAttributeMapping(a,e)[0]}))),e.setEncodedData(this.mapping(i,s))}},{key:"mapping",value:function(e,t,n){var r=this,i=t.map((function(t,i){var a=n?n[i]:{},o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hj(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:t._id,coordinates:t.coordinates},a);return e.filter((function(e){return void 0!==e.scale})).forEach((function(e){var n=r.applyAttributeMapping(e,t);e.needRemapping=!1,"color"===e.name&&(n=n.map((function(e){return gh(e)}))),o[e.name]=Array.isArray(n)&&1===n.length?n[0]:n,"shape"===e.name&&(o.shape=r.fontService.getIconFontKey(o[e.name]))})),o}));return i.length>0&&"GAODE2.x"===this.mapService.version&&("number"==typeof i[0].coordinates[0]?i.filter((function(e){return!e.originCoordinates})).map((function(e){e.version="GAODE2.x",e.originCoordinates=mb(e.coordinates),e.coordinates=r.mapService.lngLatToCoord(e.coordinates)})):i.filter((function(e){return!e.originCoordinates})).map((function(e){e.version="GAODE2.x",e.originCoordinates=mb(e.coordinates),e.coordinates=r.mapService.lngLatToCoords(e.coordinates)}))),i}},{key:"applyAttributeMapping",value:function(e,t){var n;if(!e.scale)return[];var r=(null==e||null===(n=e.scale)||void 0===n?void 0:n.scalers)||[],i=[];return r.forEach((function(n){var r,a=n.field;(t.hasOwnProperty(a)||"variable"===(null===(r=e.scale)||void 0===r?void 0:r.type))&&i.push(t[a])})),e.mapping?e.mapping(i):[]}}]),e}(),Uj=FT(jj.prototype,"configService",[Lj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bj=FT(jj.prototype,"mapService",[Nj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zj=FT(jj.prototype,"fontService",[Dj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fj=jj))||Fj),Xj=Fx()(Gj=function(){function e(){Fc(this,e),lc(this,"mapService",void 0)}return Uc(e,[{key:"apply",value:function(e){var t=this;this.mapService=e.getContainer().get(Bx.IMapService),e.hooks.init.tap("DataSourcePlugin",(function(){if(!e.getSource()){var n=e.sourceOption||{data:gE,options:_E},r=n.data,i=n.options;e.setSource(new aE(r,i))}t.updateClusterData(e)})),e.hooks.beforeRenderData.tap("DataSourcePlugin",(function(){var n=t.updateClusterData(e),r=e.dataState.dataSourceNeedUpdate;return e.dataState.dataSourceNeedUpdate=!1,n||r}))}},{key:"updateClusterData",value:function(e){var t=e.getSource(),n=t.cluster,r=t.clusterOptions,i=r.zoom,a=void 0===i?0:i,o=r.maxZoom,s=void 0===o?16:o,u=this.mapService.getZoom()-1,l=e.dataState.dataSourceNeedUpdate;return!!(n&&(l||Math.abs(a-u)>1)&&s>a)&&(t.updateClusterData(Math.floor(u)),!0)}}]),e}())||Gj;function Yj(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qj(e){var t;return 1===e.length&&(t=e,e=function(e,n){return Yj(t(e),n)}),{left:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}}var Zj=qj(Yj).right;function Kj(e){return null===e?NaN:+e}var Qj=Math.sqrt(50),Jj=Math.sqrt(10),$j=Math.sqrt(2);function eU(e,t,n){var r,i,a,o,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(o=tU(e,t,n))||!isFinite(o))return[];if(o>0)for(e=Math.ceil(e/o),t=Math.floor(t/o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(e+s)*o;else for(e=Math.floor(e*o),t=Math.ceil(t*o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(e-s)/o;return r&&a.reverse(),a}function tU(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Qj?10:a>=Jj?5:a>=$j?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Qj?10:a>=Jj?5:a>=$j?2:1)}function nU(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=Qj?i*=10:a>=Jj?i*=5:a>=$j&&(i*=2),t<e?-i:i}function rU(e,t,n){if(null==n&&(n=Kj),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e);return o+(+n(e[a+1],a+1,e)-o)*(i-a)}}function iU(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function aU(){}function oU(e,t){var n=new aU;if(e instanceof aU)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var r,i=-1,a=e.length;if(null==t)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(t(r=e[i],i,e),r)}else if(e)for(var o in e)n.set(o,e[o]);return n}function sU(){}aU.prototype=oU.prototype={constructor:aU,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var uU=oU.prototype;sU.prototype={constructor:sU,has:uU.has,add:function(e){return this["$"+(e+="")]=e,this},remove:uU.remove,clear:uU.clear,values:uU.keys,size:uU.size,empty:uU.empty,each:uU.each};var lU=Array.prototype,cU=lU.map,fU=lU.slice,pU={name:"implicit"};function hU(){var e=oU(),t=[],n=[],r=pU;function i(i){var a=i+"",o=e.get(a);if(!o){if(r!==pU)return r;e.set(a,o=t.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=oU();for(var r,a,o=-1,s=n.length;++o<s;)e.has(a=(r=n[o])+"")||e.set(a,t.push(r));return i},i.range=function(e){return arguments.length?(n=fU.call(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return hU(t,n).unknown(r)},iU.apply(i,arguments),i}function dU(e){return function(){return e}}function vU(e){return 1==(e=+e)?mU:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):dU(isNaN(t)?n:t)}}function mU(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):dU(isNaN(e)?t:e)}var yU=function e(t){var n=vU(t);function r(e,t){var r=n((e=lh(e)).r,(t=lh(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=mU(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function gU(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function _U(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=wU(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function bU(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function EU(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function xU(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=wU(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var SU=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,TU=new RegExp(SU.source,"g");function AU(e,t){var n,r,i,a=SU.lastIndex=TU.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=SU.exec(e))&&(r=TU.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:EU(n,r)})),a=TU.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function wU(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?dU(t):("number"===i?EU:"string"===i?(n=ah(t))?(t=n,yU):AU:t instanceof ah?yU:t instanceof Date?bU:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?_U:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?xU:EU:gU))(e,t)}function CU(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function kU(e){return+e}var OU=[0,1];function MU(e){return e}function RU(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function PU(e){var t,n=e[0],r=e[e.length-1];return n>r&&(t=n,n=r,r=t),function(e){return Math.max(n,Math.min(r,e))}}function IU(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=RU(i,r),a=n(o,a)):(r=RU(r,i),a=n(a,o)),function(e){return a(r(e))}}function LU(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=RU(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=Zj(e,t,1,r)-1;return a[n](i[n](t))}}function NU(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function DU(){var e,t,n,r,i,a,o=OU,s=OU,u=wU,l=MU;function c(){return r=Math.min(o.length,s.length)>2?LU:IU,i=a=null,f}function f(t){return isNaN(t=+t)?n:(i||(i=r(o.map(e),s,u)))(e(l(t)))}return f.invert=function(n){return l(t((a||(a=r(s,o.map(e),EU)))(n)))},f.domain=function(e){return arguments.length?(o=cU.call(e,kU),l===MU||(l=PU(o)),c()):o.slice()},f.range=function(e){return arguments.length?(s=fU.call(e),c()):s.slice()},f.rangeRound=function(e){return s=fU.call(e),u=CU,c()},f.clamp=function(e){return arguments.length?(l=e?PU(o):MU,f):l!==MU},f.interpolate=function(e){return arguments.length?(u=e,c()):u},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,c()}}function FU(e,t){return DU()(e,t)}function jU(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function UU(e){return(e=jU(Math.abs(e)))?e[1]:NaN}var BU,zU=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function VU(e){if(!(t=zU.exec(e)))throw new Error("invalid format: "+e);var t;return new HU({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function HU(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function GU(e,t){var n=jU(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}VU.prototype=HU.prototype,HU.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var WU={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return GU(100*e,t)},r:GU,s:function(e,t){var n=jU(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(BU=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+jU(e,Math.max(0,t+a-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function XU(e){return e}var YU,qU,ZU,KU=Array.prototype.map,QU=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function JU(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?XU:(t=KU.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?XU:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(KU.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"-":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=VU(e)).fill,n=e.align,f=e.sign,p=e.symbol,h=e.zero,d=e.width,v=e.comma,m=e.precision,y=e.trim,g=e.type;"n"===g?(v=!0,g="g"):WU[g]||(void 0===m&&(m=12),y=!0,g="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var _="$"===p?i:"#"===p&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",b="$"===p?a:/[%p]/.test(g)?u:"",E=WU[g],x=/[defgprs%]/.test(g);function S(e){var i,a,u,p=_,S=b;if("c"===g)S=E(e)+S,e="";else{var T=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:E(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0==+e&&"+"!==f&&(T=!1),p=(T?"("===f?f:l:"-"===f||"("===f?"":f)+p,S=("s"===g?QU[8+BU/3]:"")+S+(T&&"("===f?")":""),x)for(i=-1,a=e.length;++i<a;)if(48>(u=e.charCodeAt(i))||u>57){S=(46===u?o+e.slice(i+1):e.slice(i))+S,e=e.slice(0,i);break}}v&&!h&&(e=r(e,1/0));var A=p.length+e.length+S.length,w=A<d?new Array(d-A+1).join(t):"";switch(v&&h&&(e=r(w+e,w.length?d-S.length:1/0),w=""),n){case"<":e=p+e+S+w;break;case"=":e=p+w+e+S;break;case"^":e=w.slice(0,A=w.length>>1)+p+e+S+w.slice(A);break;default:e=w+p+e+S}return s(e)}return m=void 0===m?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return e+""},S}return{format:f,formatPrefix:function(e,t){var n=f(((e=VU(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(UU(t)/3))),i=Math.pow(10,-r),a=QU[8+r/3];return function(e){return n(i*e)+a}}}}function $U(e,t,n,r){var i,a=nU(e,t,n);switch((r=VU(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(UU(t)/3)))-UU(Math.abs(e)))}(a,o))||(r.precision=i),ZU(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,UU(t)-UU(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-UU(Math.abs(e)))}(a))||(r.precision=i-2*("%"===r.type))}return qU(r)}function eB(e){var t=e.domain;return e.ticks=function(e){var n=t();return eU(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return $U(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i=t(),a=0,o=i.length-1,s=i[a],u=i[o];return u<s&&(r=s,s=u,u=r,r=a,a=o,o=r),(r=tU(s,u,n))>0?r=tU(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=tU(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(u/r)*r,t(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(u*r)/r,t(i)),e},e}function tB(e,t){var n,r=0,i=(e=e.slice()).length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e}function nB(e){return Math.log(e)}function rB(e){return Math.exp(e)}function iB(e){return-Math.log(-e)}function aB(e){return-Math.exp(-e)}function oB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function sB(e){return function(t){return-e(-t)}}function uB(e){var t,n,r=e(nB,rB),i=r.domain,a=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(a),n=function(e){return 10===e?oB:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(a),i()[0]<0?(t=sB(t),n=sB(n),e(iB,aB)):e(nB,rB),r}return r.base=function(e){return arguments.length?(a=+e,o()):a},r.domain=function(e){return arguments.length?(i(e),o()):i()},r.ticks=function(e){var r,o=i(),s=o[0],u=o[o.length-1];(r=u<s)&&(p=s,s=u,u=p);var l,c,f,p=t(s),h=t(u),d=null==e?10:+e,v=[];if(!(a%1)&&h-p<d){if(p=Math.round(p)-1,h=Math.round(h)+1,s>0){for(;p<h;++p)for(c=1,l=n(p);c<a;++c)if(!((f=l*c)<s)){if(f>u)break;v.push(f)}}else for(;p<h;++p)for(c=a-1,l=n(p);c>=1;--c)if(!((f=l*c)<s)){if(f>u)break;v.push(f)}}else v=eU(p,h,Math.min(h-p,d)).map(n);return r?v.reverse():v},r.tickFormat=function(e,i){if(null==i&&(i=10===a?".0e":","),"function"!=typeof i&&(i=qU(i)),e===1/0)return i;null==e&&(e=10);var o=Math.max(1,a*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*a<a-.5&&(r*=a),r<=o?i(e):""}},r.nice=function(){return i(tB(i(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function lB(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function cB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function fB(e){return e<0?-e*e:e*e}function pB(e){var t=e(MU,MU),n=1;function r(){return 1===n?e(MU,MU):.5===n?e(cB,fB):e(lB(n),lB(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},eB(t)}YU=JU({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),qU=YU.format,ZU=YU.formatPrefix;var hB=new Date,dB=new Date;function vB(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return s;do{s.push(o=new Date(+n)),t(n,a),e(n)}while(o<n&&n<r);return s},i.filter=function(n){return vB((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(i.count=function(t,r){return hB.setTime(+t),dB.setTime(+r),e(hB),e(dB),Math.floor(n(hB,dB))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var mB=vB((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));mB.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?vB((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):mB:null};var yB=mB,gB=vB((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+1e3*t)}),(function(e,t){return(t-e)/1e3}),(function(e){return e.getUTCSeconds()})),_B=vB((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getMinutes()})),bB=vB((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getHours()})),EB=vB((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5}),(function(e){return e.getDate()-1}));function xB(e){return vB((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5}))}var SB=xB(0),TB=xB(1);xB(2),xB(3);var AB=xB(4);xB(5),xB(6);var wB=vB((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),CB=vB((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));CB.every=function(e){return isFinite(e=Math.floor(e))&&e>0?vB((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var kB=CB,OB=vB((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/864e5}),(function(e){return e.getUTCDate()-1}));function MB(e){return vB((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/6048e5}))}var RB=MB(0),PB=MB(1);MB(2),MB(3);var IB=MB(4);MB(5),MB(6);var LB=vB((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));LB.every=function(e){return isFinite(e=Math.floor(e))&&e>0?vB((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var NB=LB;function DB(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function FB(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function jB(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var UB,BB,zB={"-":"",_:" ",0:"0"},VB=/^\s*\d+/,HB=/^%/,GB=/[\\^$*+?|[\]().{}]/g;function WB(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function XB(e){return e.replace(GB,"\\$&")}function YB(e){return new RegExp("^(?:"+e.map(XB).join("|")+")","i")}function qB(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function ZB(e,t,n){var r=VB.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function KB(e,t,n){var r=VB.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function QB(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function JB(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function $B(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function ez(e,t,n){var r=VB.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function tz(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function nz(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rz(e,t,n){var r=VB.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function iz(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function az(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function oz(e,t,n){var r=VB.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function sz(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function uz(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function lz(e,t,n){var r=VB.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function cz(e,t,n){var r=VB.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function fz(e,t,n){var r=VB.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function pz(e,t,n){var r=HB.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function hz(e,t,n){var r=VB.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function dz(e,t,n){var r=VB.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function vz(e,t){return WB(e.getDate(),t,2)}function mz(e,t){return WB(e.getHours(),t,2)}function yz(e,t){return WB(e.getHours()%12||12,t,2)}function gz(e,t){return WB(1+EB.count(kB(e),e),t,3)}function _z(e,t){return WB(e.getMilliseconds(),t,3)}function bz(e,t){return _z(e,t)+"000"}function Ez(e,t){return WB(e.getMonth()+1,t,2)}function xz(e,t){return WB(e.getMinutes(),t,2)}function Sz(e,t){return WB(e.getSeconds(),t,2)}function Tz(e){var t=e.getDay();return 0===t?7:t}function Az(e,t){return WB(SB.count(kB(e)-1,e),t,2)}function wz(e){var t=e.getDay();return t>=4||0===t?AB(e):AB.ceil(e)}function Cz(e,t){return e=wz(e),WB(AB.count(kB(e),e)+(4===kB(e).getDay()),t,2)}function kz(e){return e.getDay()}function Oz(e,t){return WB(TB.count(kB(e)-1,e),t,2)}function Mz(e,t){return WB(e.getFullYear()%100,t,2)}function Rz(e,t){return WB((e=wz(e)).getFullYear()%100,t,2)}function Pz(e,t){return WB(e.getFullYear()%1e4,t,4)}function Iz(e,t){var n=e.getDay();return WB((e=n>=4||0===n?AB(e):AB.ceil(e)).getFullYear()%1e4,t,4)}function Lz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+WB(t/60|0,"0",2)+WB(t%60,"0",2)}function Nz(e,t){return WB(e.getUTCDate(),t,2)}function Dz(e,t){return WB(e.getUTCHours(),t,2)}function Fz(e,t){return WB(e.getUTCHours()%12||12,t,2)}function jz(e,t){return WB(1+OB.count(NB(e),e),t,3)}function Uz(e,t){return WB(e.getUTCMilliseconds(),t,3)}function Bz(e,t){return Uz(e,t)+"000"}function zz(e,t){return WB(e.getUTCMonth()+1,t,2)}function Vz(e,t){return WB(e.getUTCMinutes(),t,2)}function Hz(e,t){return WB(e.getUTCSeconds(),t,2)}function Gz(e){var t=e.getUTCDay();return 0===t?7:t}function Wz(e,t){return WB(RB.count(NB(e)-1,e),t,2)}function Xz(e){var t=e.getUTCDay();return t>=4||0===t?IB(e):IB.ceil(e)}function Yz(e,t){return e=Xz(e),WB(IB.count(NB(e),e)+(4===NB(e).getUTCDay()),t,2)}function qz(e){return e.getUTCDay()}function Zz(e,t){return WB(PB.count(NB(e)-1,e),t,2)}function Kz(e,t){return WB(e.getUTCFullYear()%100,t,2)}function Qz(e,t){return WB((e=Xz(e)).getUTCFullYear()%100,t,2)}function Jz(e,t){return WB(e.getUTCFullYear()%1e4,t,4)}function $z(e,t){var n=e.getUTCDay();return WB((e=n>=4||0===n?IB(e):IB.ceil(e)).getUTCFullYear()%1e4,t,4)}function eV(){return"+0000"}function tV(){return"%"}function nV(e){return+e}function rV(e){return Math.floor(+e/1e3)}!function(e){UB=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=YB(i),c=qB(i),f=YB(a),p=qB(a),h=YB(o),d=qB(o),v=YB(s),m=qB(s),y=YB(u),g=qB(u),_={a:function(e){return o[e.getDay()]},A:function(e){return a[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:vz,e:vz,f:bz,g:Rz,G:Iz,H:mz,I:yz,j:gz,L:_z,m:Ez,M:xz,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:nV,s:rV,S:Sz,u:Tz,U:Az,V:Cz,w:kz,W:Oz,x:null,X:null,y:Mz,Y:Pz,Z:Lz,"%":tV},b={a:function(e){return o[e.getUTCDay()]},A:function(e){return a[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Nz,e:Nz,f:Bz,g:Qz,G:$z,H:Dz,I:Fz,j:jz,L:Uz,m:zz,M:Vz,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:nV,s:rV,S:Hz,u:Gz,U:Wz,V:Yz,w:qz,W:Zz,x:null,X:null,y:Kz,Y:Jz,Z:eV,"%":tV},E={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,n,r){return T(e,t,n,r)},d:az,e:az,f:fz,g:tz,G:ez,H:sz,I:sz,j:oz,L:cz,m:iz,M:uz,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:rz,Q:hz,s:dz,S:lz,u:KB,U:QB,V:JB,w:ZB,W:$B,x:function(e,t,r){return T(e,n,t,r)},X:function(e,t,n){return T(e,r,t,n)},y:tz,Y:ez,Z:nz,"%":pz};function x(e,t){return function(n){var r,i,a,o=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(o.push(e.slice(u,s)),null!=(i=zB[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(a=t[r])&&(r=a(n,i)),o.push(r),u=s+1);return o.push(e.slice(u,s)),o.join("")}}function S(e,t){return function(n){var r,i,a=jB(1900,void 0,1);if(T(a,e,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(t&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=FB(jB(a.y,0,1))).getUTCDay(),r=i>4||0===i?PB.ceil(r):PB(r),r=OB.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=DB(jB(a.y,0,1))).getDay(),r=i>4||0===i?TB.ceil(r):TB(r),r=EB.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?FB(jB(a.y,0,1)).getUTCDay():DB(jB(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,FB(a)):DB(a)}}function T(e,t,n,r){for(var i,a,o=0,s=t.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(a=E[i in zB?t.charAt(o++):i])||(r=a(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=x(n,_),_.X=x(r,_),_.c=x(t,_),b.x=x(n,b),b.X=x(r,b),b.c=x(t,b),{format:function(e){var t=x(e+="",_);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=x(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}(e),BB=UB.format}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var iV,aV,oV,sV,uV,lV;function cV(e){return new Date(e)}function fV(e){return e instanceof Date?+e:+new Date(+e)}function pV(e,t,n,r,i,a,o,s,u){var l=FU(MU,MU),c=l.invert,f=l.domain,p=u(".%L"),h=u(":%S"),d=u("%I:%M"),v=u("%I %p"),m=u("%a %d"),y=u("%b %d"),g=u("%B"),_=u("%Y"),b=[[o,1,1e3],[o,5,5e3],[o,15,15e3],[o,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function E(s){return(o(s)<s?p:a(s)<s?h:i(s)<s?d:r(s)<s?v:t(s)<s?n(s)<s?m:y:e(s)<s?g:_)(s)}function x(t,n,r,i){if(null==t&&(t=10),"number"==typeof t){var a=Math.abs(r-n)/t,o=qj((function(e){return e[2]})).right(b,a);o===b.length?(i=nU(n/31536e6,r/31536e6,t),t=e):o?(i=(o=b[a/b[o-1][2]<b[o][2]/a?o-1:o])[1],t=o[0]):(i=Math.max(nU(n,r,t),1),t=s)}return null==i?t:t.every(i)}return l.invert=function(e){return new Date(c(e))},l.domain=function(e){return arguments.length?f(cU.call(e,fV)):f().map(cV)},l.ticks=function(e,t){var n,r=f(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=(n=x(e,i,a,t))?n.range(i,a+1):[],o?n.reverse():n},l.tickFormat=function(e,t){return null==t?E:u(t)},l.nice=function(e,t){var n=f();return(e=x(e,n[0],n[n.length-1],t))?f(tB(n,e)):l},l.copy=function(){return NU(l,pV(e,t,n,r,i,a,o,s,u))},l}var hV,dV,vV,mV,yV,gV,_V,bV=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,EV=(lc(iV={},IM.LINEAR,(function e(){var t=FU(MU,MU);return t.copy=function(){return NU(t,e())},iU.apply(t,arguments),eB(t)})),lc(iV,IM.POWER,(function e(){var t=pB(DU());return t.copy=function(){return NU(t,e()).exponent(t.exponent())},iU.apply(t,arguments),t})),lc(iV,IM.LOG,(function e(){var t=uB(DU()).domain([1,10]);return t.copy=function(){return NU(t,e()).base(t.base())},iU.apply(t,arguments),t})),lc(iV,IM.IDENTITY,(function e(t){var n;function r(e){return isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=cU.call(e,kU),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?cU.call(t,kU):[0,1],eB(r)})),lc(iV,IM.TIME,(function(){return iU.apply(pV(kB,wB,SB,EB,bB,_B,gB,yB,BB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)})),lc(iV,IM.QUANTILE,(function e(){var t,n=[],r=[],i=[];function a(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=rU(n,e/t);return o}function o(e){return isNaN(e=+e)?t:r[Zj(i,e)]}return o.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];for(var t,r=0,i=e.length;r<i;++r)null==(t=e[r])||isNaN(t=+t)||n.push(t);return n.sort(Yj),a()},o.range=function(e){return arguments.length?(r=fU.call(e),a()):r.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return i.slice()},o.copy=function(){return e().domain(n).range(r).unknown(t)},iU.apply(o,arguments)})),lc(iV,IM.QUANTIZE,(function e(){var t,n=0,r=1,i=1,a=[.5],o=[0,1];function s(e){return e<=e?o[Zj(a,e,0,i)]:t}function u(){var e=-1;for(a=new Array(i);++e<i;)a[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?(n=+e[0],r=+e[1],u()):[n,r]},s.range=function(e){return arguments.length?(i=(o=fU.call(e)).length-1,u()):o.slice()},s.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,a[0]]:t>=i?[a[i-1],r]:[a[t-1],a[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return a.slice()},s.copy=function(){return e().domain([n,r]).range(o).unknown(t)},iU.apply(eB(s),arguments)})),lc(iV,IM.THRESHOLD,(function e(){var t,n=[.5],r=[0,1],i=1;function a(e){return e<=e?r[Zj(n,e,0,i)]:t}return a.domain=function(e){return arguments.length?(n=fU.call(e),i=Math.min(n.length,r.length-1),a):n.slice()},a.range=function(e){return arguments.length?(r=fU.call(e),i=Math.min(n.length,r.length-1),a):r.slice()},a.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},a.unknown=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return e().domain(n).range(r).unknown(t)},iU.apply(a,arguments)})),lc(iV,IM.CAT,hU),iV),xV=(aV=Fx(),oV=nx(Bx.IGlobalConfigService),aV((uV=function(){function e(){Fc(this,e),DT(this,"configService",lV,this),lc(this,"scaleCache",{}),lc(this,"scaleOptions",{})}return Uc(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("FeatureScalePlugin",(function(){n.scaleOptions=e.getScaleOptions();var t=r.getLayerStyleAttributes(),i=e.getSource().data.dataArray;0!==i.length&&n.caculateScalesForAttributes(t||[],i)})),e.hooks.beforeRenderData.tap("FeatureScalePlugin",(function(){n.scaleOptions=e.getScaleOptions();var t=r.getLayerStyleAttributes(),i=e.getSource().data.dataArray;return n.caculateScalesForAttributes(t||[],i),e.layerModelNeedUpdate=!0,!0})),e.hooks.beforeRender.tap("FeatureScalePlugin",(function(){if(!e.layerModelNeedUpdate){n.scaleOptions=e.getScaleOptions();var t=r.getLayerStyleAttributes();if(t){var i=e.getSource().data.dataArray;if(0===i.length)return;var a=t.filter((function(e){return e.needRescale}));a.length&&n.caculateScalesForAttributes(a,i)}}}))}},{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},{key:"caculateScalesForAttributes",value:function(e,t){var n=this;this.scaleCache={},e.forEach((function(e){if(e.scale){var r=e.scale,i=e.name;r.names=n.parseFields(e.scale.field||[]);var a=[];r.names.forEach((function(r){a.push(n.getOrCreateScale(r,e,t))})),a.some((function(e){return e.type===NM.VARIABLE}))?(r.type=NM.VARIABLE,a.forEach((function(e){var t;if(!r.callback)if(r.values&&"text"!==r.values){var n;if("linear"===(null===(n=e.option)||void 0===n?void 0:n.type)&&r.values.length>2){var a=e.scale.ticks(r.values.length);"color"===i&&e.scale.domain(a)}e.scale.range(r.values)}else"cat"===(null===(t=e.option)||void 0===t?void 0:t.type)&&e.scale.range(e.option.domain)}))):(r.type=NM.CONSTANT,r.defaultValues=a.map((function(e,t){return e.scale(r.names[t])}))),r.scalers=a.map((function(e){return{field:e.field,func:e.scale,option:e.option}})),e.needRescale=!1}}))}},{key:"getOrCreateScale",value:function(e,t,n){var r;[e,t.name].join("_");var i=null===(r=t.scale)||void 0===r?void 0:r.values;return this.createScale(e,t.name,i,n)}},{key:"parseFields",value:function(e){return Array.isArray(e)?e:cg(e)?e.split("*"):[e]}},{key:"createScale",value:function(e,t,n,r){var i,a,o=this.scaleOptions[t]&&(null===(i=this.scaleOptions[t])||void 0===i?void 0:i.field)===e?this.scaleOptions[t]:this.scaleOptions[e],s={field:e,scale:void 0,type:NM.VARIABLE,option:o};if(!r||!r.length)return o&&o.type?s.scale=this.createDefaultScale(o):(s.scale=hU([e]),s.type=NM.CONSTANT),s;var u=null===(a=r.find((function(t){return!ew(t[e])})))||void 0===a?void 0:a[e];if(this.isNumber(e)||ew(u)&&!o)s.scale=hU([e]),s.type=NM.CONSTANT;else{var l=o&&o.type||this.getDefaultType(u);"text"===n&&(l=IM.CAT);var c=this.createDefaultScaleConfig(l,e,r);Object.assign(c,o),s.scale=this.createDefaultScale(c),s.option=c}return s}},{key:"getDefaultType",value:function(e){var t=IM.LINEAR;return"string"==typeof e&&(t=bV.test(e)?IM.TIME:IM.CAT),t}},{key:"createDefaultScaleConfig",value:function(e,t,n){var r={type:e},i=(null==n?void 0:n.map((function(e){return e[t]})))||[];return e!==IM.CAT&&e!==IM.QUANTILE?r.domain=function(e,t){var n,r,i,a=e.length,o=-1;if(null==t){for(;++o<a;)if(null!=(n=e[o])&&n>=n)for(r=i=n;++o<a;)null!=(n=e[o])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=i=n;++o<a;)null!=(n=t(e[o],o,e))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]}(i):e===IM.CAT?r.domain=mC(i):e===IM.QUANTILE&&(r.domain=i),r}},{key:"createDefaultScale",value:function(e){var t=e.type,n=e.domain,r=EV[t]();return n&&r.domain(n),r}}]),e}(),lV=FT(uV.prototype,"configService",[oV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sV=uV))||sV);function SV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var TV,AV,wV,CV=(hV=Fx(),dV=nx(Bx.ICameraService),vV=nx(Bx.IRendererService),hV((yV=function(){function e(){Fc(this,e),DT(this,"cameraService",gV,this),DT(this,"rendererService",_V,this)}return Uc(e,[{key:"apply",value:function(e){e.hooks.beforeRender.tap("LayerAnimateStylePlugin",(function(){e.models.forEach((function(t){t.addUniforms(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SV(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.layerModel.getAnimateUniforms()))}))}))}}]),e}(),gV=FT(yV.prototype,"cameraService",[dV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_V=FT(yV.prototype,"rendererService",[vV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mV=yV))||mV),kV=Fx()(TV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e){e.hooks.init.tap("LayerModelPlugin",(function(){e.prepareBuildModel(),e.buildModels(),e.styleNeedUpdate=!1})),e.hooks.beforeRenderData.tap("DataSourcePlugin",(function(){return e.prepareBuildModel(),e.clearModels(),e.buildModels(),e.layerModelNeedUpdate=!1,!1}))}}]),e}())||TV,OV=Fx()(AV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e){e.hooks.afterInit.tap("LayerStylePlugin",(function(){e.updateLayerConfig({});var t=e.getLayerConfig(),n=t.autoFit,r=t.fitBoundsOptions;n&&setTimeout((function(){e.fitBounds(r)}),100)}))}}]),e}())||AV,MV=["type"];function RV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RV(Object(n),!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var IV={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},LV={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},NV={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},DV={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};var FV,jV,UV,BV,zV,VV,HV,GV,WV,XV,YV,qV,ZV,KV,QV,JV=Fx()(wV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e){e.hooks.beforeRender.tap("LightingPlugin",(function(){e.getLayerConfig().enableLighting&&e.models.forEach((function(e){return e.addUniforms(PV({},(n={u_DirectionalLights:new Array(3).fill(PV({},NV)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(PV({},DV)),u_NumOfSpotLights:0},t&&t.length||(t=[LV]),t.forEach((function(e,t){var r=e.type,i=void 0===r?"directional":r,a=YA(e,MV),o=IV[i].lights,s=IV[i].num,u=n[s];n[o][u]=PV(PV({},n[o][u]),a),n[s]++})),n)));var t,n}))}))}}]),e}())||wV,$V=1,eH=2,tH=Fx()(FV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e,t){t.rendererService;var n=t.styleAttributeService;e.hooks.init.tap("PixelPickingPlugin",(function(){var t=e.getLayerConfig().enablePicking;n.registerStyleAttribute({name:"pickingColor",type:FM.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:yA.FLOAT},size:3,update:function(e,n){var r=e.id;return t?bh(r):[0,0,0]}}})})),e.hooks.beforePickingEncode.tap("PixelPickingPlugin",(function(){e.getLayerConfig().enablePicking&&e.isVisible()&&e.models.forEach((function(e){return e.addUniforms({u_PickingStage:$V})}))})),e.hooks.afterPickingEncode.tap("PixelPickingPlugin",(function(){e.getLayerConfig().enablePicking&&e.isVisible()&&e.models.forEach((function(e){return e.addUniforms({u_PickingStage:eH})}))})),e.hooks.beforeHighlight.tap("PixelPickingPlugin",(function(t){var n=e.getLayerConfig().highlightColor,r="string"==typeof n?gh(n):n||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:_h(new Uint8Array(t))}),e.models.forEach((function(e){return e.addUniforms({u_PickingStage:eH,u_PickingColor:t,u_HighlightColor:r.map((function(e){return 255*e}))})}))})),e.hooks.beforeSelect.tap("PixelPickingPlugin",(function(t){var n=e.getLayerConfig().selectColor,r="string"==typeof n?gh(n):n||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:_h(new Uint8Array(t))}),e.models.forEach((function(e){return e.addUniforms({u_PickingStage:eH,u_PickingColor:t,u_HighlightColor:r.map((function(e){return 255*e}))})}))}))}}]),e}())||FV,nH=Fx()(jV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("RegisterStyleAttributePlugin",(function(){n.registerBuiltinAttributes(r)}))}},{key:"registerBuiltinAttributes",value:function(e){e.registerStyleAttribute({name:"position",type:FM.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:yA.FLOAT},size:3,update:function(e,t,n){return 2===n.length?[n[0],n[1],0]:[n[0],n[1],n[2]]}}}),e.registerStyleAttribute({name:"filter",type:FM.Attribute,descriptor:{name:"filter",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t){return e.filter?[1]:[0]}}}),e.registerStyleAttribute({name:"color",type:FM.Attribute,descriptor:{name:"a_Color",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:4,update:function(e,t){var n=e.color;return n&&n.length?n:[1,1,1,1]}}}),e.registerStyleAttribute({name:"vertexId",type:FM.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:yA.DYNAMIC_DRAW,data:[],type:yA.FLOAT},size:1,update:function(e,t,n,r){return[t]}}})}}]),e}())||jV,rH=(UV=Fx(),BV=nx(Bx.ICameraService),zV=nx(Bx.ICoordinateSystemService),VV=nx(Bx.IRendererService),HV=nx(Bx.IMapService),UV((WV=function(){function e(){Fc(this,e),DT(this,"cameraService",XV,this),DT(this,"coordinateSystemService",YV,this),DT(this,"rendererService",qV,this),DT(this,"mapService",ZV,this)}return Uc(e,[{key:"apply",value:function(e){var t=this,n=this.mapService.version,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=[0,0];e.hooks.beforeRender.tap("ShaderUniformPlugin",(function(){t.coordinateSystemService.refresh(),"GAODE2.x"===n&&(r=t.mapService.map.customCoords.getMVPMatrix(),i=t.mapService.getCustomCoordCenter());var a=t.rendererService.getViewportSize(),o=a.width,s=a.height;e.models.forEach((function(n){var a;n.addUniforms((lc(a={},WM,t.cameraService.getProjectionMatrix()),lc(a,XM,t.cameraService.getViewMatrix()),lc(a,YM,t.cameraService.getViewProjectionMatrix()),lc(a,qM,t.cameraService.getZoom()),lc(a,ZM,t.cameraService.getZoomScale()),lc(a,KM,t.cameraService.getFocalDistance()),lc(a,QM,t.cameraService.getCameraPosition()),lc(a,YT,t.coordinateSystemService.getCoordinateSystem()),lc(a,qT,t.coordinateSystemService.getViewportCenter()),lc(a,ZT,t.coordinateSystemService.getViewportCenterProjection()),lc(a,KT,t.coordinateSystemService.getPixelsPerDegree()),lc(a,QT,t.coordinateSystemService.getPixelsPerDegree2()),lc(a,JT,t.coordinateSystemService.getPixelsPerMeter()),lc(a,$T,r),lc(a,"u_SceneCenterMKT",i),lc(a,"u_ViewportSize",[o,s]),lc(a,"u_ModelMatrix",t.cameraService.getModelMatrix()),lc(a,"u_DevicePixelRatio",lp.devicePixelRatio),lc(a,"u_PickingBuffer",e.getLayerConfig().pickingBuffer||0),lc(a,"u_Dragging",Number(t.mapService.dragging)),a))}))}))}}]),e}(),XV=FT(WV.prototype,"cameraService",[BV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YV=FT(WV.prototype,"coordinateSystemService",[zV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qV=FT(WV.prototype,"rendererService",[VV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZV=FT(WV.prototype,"mapService",[HV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GV=WV))||GV),iH=Fx()(KV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e){e.hooks.beforeRender.tap("UpdateModelPlugin",(function(){e.layerModel&&e.layerModel.needUpdate()}))}}]),e}())||KV,aH=Fx()(QV=function(){function e(){Fc(this,e)}return Uc(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("UpdateStyleAttributePlugin",(function(){n.initStyleAttribute(e,{styleAttributeService:r})})),e.hooks.beforeRender.tap("UpdateStyleAttributePlugin",(function(){e.layerModelNeedUpdate||n.updateStyleAtrribute(e,{styleAttributeService:r})}))}},{key:"updateStyleAtrribute",value:function(e,t){var n=t.styleAttributeService,r=n.getLayerStyleAttributes()||[],i=n.getLayerStyleAttribute("filter"),a=n.getLayerStyleAttribute("shape");if(i&&i.needRegenerateVertices||a&&a.needRegenerateVertices)return e.layerModelNeedUpdate=!0,void r.forEach((function(e){return e.needRegenerateVertices=!1}));r.filter((function(e){return e.needRegenerateVertices})).forEach((function(t){n.updateAttributeByFeatureRange(t.name,e.getEncodedData(),t.featureRange.startIndex,t.featureRange.endIndex),t.needRegenerateVertices=!1}))}},{key:"initStyleAttribute",value:function(e,t){var n=t.styleAttributeService;(n.getLayerStyleAttributes()||[]).filter((function(e){return e.needRegenerateVertices})).forEach((function(t){n.updateAttributeByFeatureRange(t.name,e.getEncodedData(),t.featureRange.startIndex,t.featureRange.endIndex),t.needRegenerateVertices=!1}))}}]),e}())||QV;kM.bind(Bx.ILayerPlugin).to(Xj).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(nH).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(xV).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(Wj).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(OV).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(aH).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(iH).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(_N).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(rH).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(CV).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(JV).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(tH).inRequestScope(),kM.bind(Bx.ILayerPlugin).to(kV).inRequestScope();var oH=2,sH={1:{world:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/35bb8365-1926-471c-b357-db2c02ff3a81.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8ec671c3-a4f9-4fdf-8e88-85d2ab1d8930.bin"},label:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/90c51eb3-04d7-402f-bd05-95e4bd27dd62.bin",parser:{type:"geojson"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"}},country:{CHN:{1:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/380370e0-76aa-4240-8874-5732de77e71d.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/70ec087e-c48a-4b76-8825-6452f17bae7a.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"},label:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/36832a45-68f8-4b51-b006-9dec71f92a23.json"}},2:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/feeb1f06-11c6-4495-84c9-f41ea6f77123.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"}},3:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/24a9ee83-2be1-4fc1-b187-769ac939269d.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},countryLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"},nationalBoundaries2:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/f2189cc4-662b-4358-8573-36f0f918b7ca.json"},island:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/fe49b393-1147-4769-94ed-70471f4ff15d.json"}}},province:{11e4:""}},2:{world:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/ad26cd25-96ea-40fd-935d-7e21a5c08893.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/62f61f5f-cca7-4137-845d-13c8f9969664.bin"},label:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/90c51eb3-04d7-402f-bd05-95e4bd27dd62.bin",parser:{type:"geojson"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"}},country:{CHN:{1:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/71ac4de3-bb14-449d-a97d-2b98e25ec8df.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/70ec087e-c48a-4b76-8825-6452f17bae7a.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/0024caaf-86b2-4e75-a3d1-6d2146490b67.bin"},label:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/36832a45-68f8-4b51-b006-9dec71f92a23.json"}},2:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/522c6496-c711-4581-88db-c3741cd39abd.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/f6a4e2b1-359b-43a6-921c-39d2088d1dab.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/f6a4e2b1-359b-43a6-921c-39d2088d1dab.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/0024caaf-86b2-4e75-a3d1-6d2146490b67.bin"}},3:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/516b2703-d692-44e6-80dd-b3f5df0186e7.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},countryLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"},nationalBoundaries2:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/f2189cc4-662b-4358-8573-36f0f918b7ca.json"},island:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/fe49b393-1147-4769-94ed-70471f4ff15d.json"}}},province:{11e4:""}}};function uH(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oH;return sH[e]}function lH(e){oH=e}var cH,fH,pH,hH,dH,vH={},mH=function(e,t){cH={},pH=[],fH=0,hH=0,dH=1,gH(e),dH=Math.min(dH,1e6);for(var n=Math.ceil(Math.log(dH)/Math.LN10),r=0;r<pH.length;r++)t.writeStringField(1,pH[r]);2!==hH&&t.writeVarintField(2,hH);6!==n&&t.writeVarintField(3,n);"FeatureCollection"===e.type?t.writeMessage(4,SH,e):"Feature"===e.type?t.writeMessage(5,TH,e):t.writeMessage(6,AH,e);return cH=null,t.finish()},yH={Point:0,MultiPoint:1,LineString:2,MultiLineString:3,Polygon:4,MultiPolygon:5,GeometryCollection:6};function gH(e){var t,n;if("FeatureCollection"===e.type)for(t=0;t<e.features.length;t++)gH(e.features[t]);else if("Feature"===e.type)for(n in null!==e.geometry&&gH(e.geometry),e.properties)xH(n);else if("Point"===e.type)EH(e.coordinates);else if("MultiPoint"===e.type)bH(e.coordinates);else if("GeometryCollection"===e.type)for(t=0;t<e.geometries.length;t++)gH(e.geometries[t]);else if("LineString"===e.type)bH(e.coordinates);else if("Polygon"===e.type||"MultiLineString"===e.type)_H(e.coordinates);else if("MultiPolygon"===e.type)for(t=0;t<e.coordinates.length;t++)_H(e.coordinates[t]);for(n in e)RH(n,e.type)||xH(n)}function _H(e){for(var t=0;t<e.length;t++)bH(e[t])}function bH(e){for(var t=0;t<e.length;t++)EH(e[t])}function EH(e){hH=Math.max(hH,e.length);for(var t=0;t<e.length;t++)for(;Math.round(e[t]*dH)/dH!==e[t]&&dH<1e6;)dH*=10}function xH(e){void 0===cH[e]&&(pH.push(e),cH[e]=fH++)}function SH(e,t){for(var n=0;n<e.features.length;n++)t.writeMessage(1,TH,e.features[n]);wH(e,t,!0)}function TH(e,t){null!==e.geometry&&t.writeMessage(1,AH,e.geometry),void 0!==e.id&&("number"==typeof e.id&&e.id%1==0?t.writeSVarintField(12,e.id):t.writeStringField(11,e.id)),e.properties&&wH(e.properties,t),wH(e,t,!0)}function AH(e,t){t.writeVarintField(1,yH[e.type]);var n=e.coordinates;if("Point"===e.type)!function(e,t){for(var n=[],r=0;r<hH;r++)n.push(Math.round(e[r]*dH));t.writePackedSVarint(3,n)}(n,t);else if("MultiPoint"===e.type)kH(n,t);else if("LineString"===e.type)kH(n,t);else if("MultiLineString"===e.type)OH(n,t);else if("Polygon"===e.type)OH(n,t,!0);else if("MultiPolygon"===e.type)!function(e,t){var n,r,i=e.length;if(1!==i||1!==e[0].length){var a=[i];for(n=0;n<i;n++)for(a.push(e[n].length),r=0;r<e[n].length;r++)a.push(e[n][r].length-1);t.writePackedVarint(2,a)}var o=[];for(n=0;n<i;n++)for(r=0;r<e[n].length;r++)MH(o,e[n][r],!0);t.writePackedSVarint(3,o)}(n,t);else if("GeometryCollection"===e.type)for(var r=0;r<e.geometries.length;r++)t.writeMessage(4,AH,e.geometries[r]);wH(e,t,!0)}function wH(e,t,n){var r=[],i=0;for(var a in e)n&&RH(a,e.type)||(t.writeMessage(13,CH,e[a]),r.push(cH[a]),r.push(i++));t.writePackedVarint(n?15:14,r)}function CH(e,t){if(null!==e){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(5,e):"object"===n?t.writeStringField(6,JSON.stringify(e)):"number"===n&&(e%1!=0?t.writeDoubleField(2,e):e>=0?t.writeVarintField(3,e):t.writeVarintField(4,-e))}}function kH(e,t){var n=[];MH(n,e),t.writePackedSVarint(3,n)}function OH(e,t,n){var r,i=e.length;if(1!==i){var a=[];for(r=0;r<i;r++)a.push(e[r].length-(n?1:0));t.writePackedVarint(2,a)}var o=[];for(r=0;r<i;r++)MH(o,e[r],n);t.writePackedSVarint(3,o)}function MH(e,t,n){var r,i,a=t.length-(n?1:0),o=new Array(hH);for(i=0;i<hH;i++)o[i]=0;for(r=0;r<a;r++)for(i=0;i<hH;i++){var s=Math.round(t[r][i]*dH)-o[i];e.push(s),o[i]+=s}}function RH(e,t){if("type"===e)return!0;if("FeatureCollection"===t){if("features"===e)return!0}else if("Feature"===t){if("id"===e||"properties"===e||"geometry"===e)return!0}else if("GeometryCollection"===t){if("geometries"===e)return!0}else if("coordinates"===e)return!0;return!1}var PH,IH,LH,NH,DH,FH=function(e){NH=2,DH=Math.pow(10,6),LH=null,PH=[],IH=[];var t=e.readFields(UH,{});return PH=null,t},jH=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"];function UH(e,t,n){1===e?PH.push(n.readString()):2===e?NH=n.readVarint():3===e?DH=Math.pow(10,n.readVarint()):4===e?function(e,t){t.type="FeatureCollection",t.features=[],e.readMessage(VH,t)}(n,t):5===e?BH(n,t):6===e&&zH(n,t)}function BH(e,t){t.type="Feature";var n=e.readMessage(HH,t);return"geometry"in n||(n.geometry=null),n}function zH(e,t){return t.type="Point",e.readMessage(GH,t)}function VH(e,t,n){1===e?t.features.push(BH(n,{})):13===e?IH.push(WH(n)):15===e&&XH(n,t)}function HH(e,t,n){1===e?t.geometry=zH(n,{}):11===e?t.id=n.readString():12===e?t.id=n.readSVarint():13===e?IH.push(WH(n)):14===e?t.properties=XH(n,{}):15===e&&XH(n,t)}function GH(e,t,n){1===e?t.type=jH[n.readVarint()]:2===e?LH=n.readPackedVarint():3===e?function(e,t,n){"Point"===n?e.coordinates=function(e){var t=e.readVarint()+e.pos,n=[];for(;e.pos<t;)n.push(e.readSVarint()/DH);return n}(t):"MultiPoint"===n||"LineString"===n?e.coordinates=qH(t):"MultiLineString"===n?e.coordinates=ZH(t):"Polygon"===n?e.coordinates=ZH(t,!0):"MultiPolygon"===n&&(e.coordinates=function(e){var t=e.readVarint()+e.pos;if(!LH)return[[YH(e,t,null,!0)]];for(var n=[],r=1,i=0;i<LH[0];i++){for(var a=[],o=0;o<LH[r];o++)a.push(YH(e,t,LH[r+1+o],!0));r+=LH[r]+1,n.push(a)}return LH=null,n}(t))}(t,n,t.type):4===e?(t.geometries=t.geometries||[],t.geometries.push(zH(n,{}))):13===e?IH.push(WH(n)):15===e&&XH(n,t)}function WH(e){for(var t=e.readVarint()+e.pos,n=null;e.pos<t;){var r=e.readVarint()>>3;1===r?n=e.readString():2===r?n=e.readDouble():3===r?n=e.readVarint():4===r?n=-e.readVarint():5===r?n=e.readBoolean():6===r&&(n=JSON.parse(e.readString()))}return n}function XH(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;)t[PH[e.readVarint()]]=IH[e.readVarint()];return IH=[],t}function YH(e,t,n,r){var i,a,o=0,s=[],u=[];for(a=0;a<NH;a++)u[a]=0;for(;n?o<n:e.pos<t;){for(i=[],a=0;a<NH;a++)u[a]+=e.readSVarint(),i[a]=u[a]/DH;s.push(i),o++}return r&&s.push(s[0]),s}function qH(e){return YH(e,e.readVarint()+e.pos)}function ZH(e,t){var n=e.readVarint()+e.pos;if(!LH)return[YH(e,n,null,t)];for(var r=[],i=0;i<LH.length;i++)r.push(YH(e,n,LH[i],t));return LH=null,r}vH.encode=mH,vH.decode=FH;var KH={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,p=n?-1:1,h=e[t+f];for(f+=p,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+f],f+=p,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+f],f+=p,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=l}return(h?-1:1)*o*Math.pow(2,a-r)},write:function(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,f=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,d=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+f>=1?p/u:p*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*u-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&s,h+=d,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+h]=255&o,h+=d,o/=256,l-=8);e[n+h-d]|=128*v}},QH=$H,JH=KH;function $H(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}$H.Varint=0,$H.Fixed64=1,$H.Bytes=2,$H.Fixed32=5;var eG="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function tG(e){return e.type===$H.Bytes?e.readVarint()+e.pos:e.pos+1}function nG(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function rG(e,t,n){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=e;i--)n.buf[i+r]=n.buf[i]}function iG(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function aG(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function oG(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function sG(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function uG(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function lG(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function cG(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function fG(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function pG(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function hG(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function dG(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function vG(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}$H.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,a=this.pos;this.type=7&r,e(i,t,this),this.pos===a&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=hG(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=vG(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=hG(this.buf,this.pos)+4294967296*hG(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=hG(this.buf,this.pos)+4294967296*vG(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=JH.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=JH.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,r=this.buf;return t=127&(n=r[this.pos++]),n<128?t:(t|=(127&(n=r[this.pos++]))<<7,n<128?t:(t|=(127&(n=r[this.pos++]))<<14,n<128?t:(t|=(127&(n=r[this.pos++]))<<21,n<128?t:function(e,t,n){var r,i,a=n.buf;if(i=a[n.pos++],r=(112&i)>>4,i<128)return nG(e,r,t);if(i=a[n.pos++],r|=(127&i)<<3,i<128)return nG(e,r,t);if(i=a[n.pos++],r|=(127&i)<<10,i<128)return nG(e,r,t);if(i=a[n.pos++],r|=(127&i)<<17,i<128)return nG(e,r,t);if(i=a[n.pos++],r|=(127&i)<<24,i<128)return nG(e,r,t);if(i=a[n.pos++],r|=(1&i)<<31,i<128)return nG(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&eG?function(e,t,n){return eG.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){var r="",i=t;for(;i<n;){var a,o,s,u=e[i],l=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c>n)break;1===c?u<128&&(l=u):2===c?128==(192&(a=e[i+1]))&&(l=(31&u)<<6|63&a)<=127&&(l=null):3===c?(a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&((l=(15&u)<<12|(63&a)<<6|63&o)<=2047||l>=55296&&l<=57343)&&(l=null)):4===c&&(a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&((l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,c=1):l>65535&&(l-=65536,r+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),r+=String.fromCharCode(l),i+=c}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==$H.Bytes)return e.push(this.readVarint(t));var n=tG(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==$H.Bytes)return e.push(this.readSVarint());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==$H.Bytes)return e.push(this.readBoolean());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==$H.Bytes)return e.push(this.readFloat());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==$H.Bytes)return e.push(this.readDouble());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==$H.Bytes)return e.push(this.readFixed32());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==$H.Bytes)return e.push(this.readSFixed32());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==$H.Bytes)return e.push(this.readFixed64());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==$H.Bytes)return e.push(this.readSFixed64());var t=tG(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===$H.Varint)for(;this.buf[this.pos++]>127;);else if(t===$H.Bytes)this.pos=this.readVarint()+this.pos;else if(t===$H.Fixed32)this.pos+=4;else{if(t!==$H.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),dG(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),dG(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),dG(this.buf,-1&e,this.pos),dG(this.buf,Math.floor(2.3283064365386963e-10*e),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),dG(this.buf,-1&e,this.pos),dG(this.buf,Math.floor(2.3283064365386963e-10*e),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,r;e>=0?(n=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos]=127&e}(n,0,t),function(e,t){var n=(7&e)<<4;if(t.buf[t.pos++]|=n|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var r,i,a=0;a<t.length;a++){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){r>56319||a+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):i=r;continue}if(r<56320){e[n++]=239,e[n++]=191,e[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(e[n++]=239,e[n++]=191,e[n++]=189,i=null);r<128?e[n++]=r:(r<2048?e[n++]=r>>6|192:(r<65536?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&rG(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),JH.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),JH.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var r=this.pos-n;r>=128&&rG(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,n){this.writeTag(e,$H.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,iG,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,aG,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,uG,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,oG,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,sG,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,lG,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,cG,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,fG,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,pG,t)},writeBytesField:function(e,t){this.writeTag(e,$H.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,$H.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,$H.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,$H.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,$H.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,$H.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,$H.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,$H.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,$H.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,$H.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var mG={exports:{}},yG=function(e,t){this.p1=e,this.p2=t};yG.prototype.rise=function(){return this.p2[1]-this.p1[1]},yG.prototype.run=function(){return this.p2[0]-this.p1[0]},yG.prototype.slope=function(){return this.rise()/this.run()},yG.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},yG.prototype.isVertical=function(){return!isFinite(this.slope())},yG.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},yG.prototype._perpendicularDistanceHorizontal=function(e){return Math.abs(this.p1[1]-e[1])},yG.prototype._perpendicularDistanceVertical=function(e){return Math.abs(this.p1[0]-e[0])},yG.prototype._perpendicularDistanceHasSlope=function(e){var t=this.slope(),n=this.yIntercept();return Math.abs(t*e[0]-e[1]+n)/Math.sqrt(Math.pow(t,2)+1)},yG.prototype.perpendicularDistance=function(e){return this.isVertical()?this._perpendicularDistanceVertical(e):this.isHorizontal()?this._perpendicularDistanceHorizontal(e):this._perpendicularDistanceHasSlope(e)};var gG=yG,_G=function(e,t){for(var n=0,r=0,i=1;i<=e.length-2;i++){var a=new gG(e[0],e[e.length-1]).perpendicularDistance(e[i]);a>n&&(r=i,n=a)}if(n>t)var o=_G(e.slice(0,r),t),s=_G(e.slice(r,e.length),t),u=o.concat(s);else u=e.length>1?[e[0],e[e.length-1]]:[e[0]];return u},bG=_G;!function(e){var t=bG;function n(t,n){var r=t.geometry,i=r.type;if("LineString"===i)r.coordinates=e.exports.simplify(r.coordinates,n);else if("Polygon"===i||"MultiLineString"===i)for(var a=0;a<r.coordinates.length;a++)r.coordinates[a]=e.exports.simplify(r.coordinates[a],n);else if("MultiPolygon"===i)for(var o=0;o<r.coordinates.length;o++)for(var s=0;s<r.coordinates[o].length;s++)r.coordinates[o][s]=e.exports.simplify(r.coordinates[o][s],n);return t}e.exports=function(e,t,r){return r||(e=JSON.parse(JSON.stringify(e))),e.features?function(e,t){for(var r=0;r<e.features.length;r++)e.features[r]=n(e.features[r],t);return e}(e,t):e.type&&"Feature"===e.type?n(e,t):new Error("FeatureCollection or individual Feature required")},e.exports.simplify=function(e,n){return t(e,n)}}(mG);var EG=mG.exports;function xG(e){return(xG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SG(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function TG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function AG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TG(Object(n),!0).forEach((function(t){wG(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wG(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OG(e,t,n){return(OG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IG(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function MG(e,t){return(MG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=IG(e);if(t){var i=IG(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return PG(this,n)}}function PG(e,t){return!t||"object"!==xG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IG(e){return(IG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LG=["loaded"];function NG(e,t){if(Array.isArray(t))return t}var DG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MG(e,t)}(s,Xb.exports.EventEmitter);var t,n,r,i,a,o=RG(s);function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return CG(this,s),(t=o.call(this)).fillLayer=void 0,t.lineLayer=void 0,t.labelLayer=void 0,t.bubbleLayer=void 0,t.loaded=!1,t.scene=void 0,t.options=void 0,t.layers=[],t.fillData=void 0,t.layerType=void 0,t.popup=void 0,t.scene=e,t.options=og(t.getDefaultOption(),n,NG),lH(t.options.geoDataLevel),t}return t=s,(n=[{key:"destroy",value:function(){var e=this;this.layers.forEach((function(t){return e.scene.removeLayer(t)})),this.layers.length=0}},{key:"show",value:function(){this.layers.forEach((function(e){return e.show()}))}},{key:"hide",value:function(){this.layers.forEach((function(e){return e.hide()}))}},{key:"setOption",value:function(e){this.options=og(this.options,e,NG)}},{key:"getFillData",value:function(){return this.fillData}},{key:"getOptions",value:function(){return this.options}},{key:"getLayer",value:function(e){return this[e+"Layer"]}},{key:"on",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fill";return-1!==LG.indexOf(e)?OG(IG(s.prototype),"on",this).call(this,e,t):this.loaded&&this.getLayer(r)?this.getLayer(r).on(e,t):OG(IG(s.prototype),"once",this).call(this,"loaded",(function(){n.getLayer(r).on(e,t)})),this}},{key:"off",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fill";return-1!==LG.indexOf(e)?OG(IG(s.prototype),"on",this).call(this,e,t):this.getLayer(r)&&(this.loaded&&this.getLayer(r)?this.getLayer(r).off(e,t):OG(IG(s.prototype),"once",this).call(this,"loaded",(function(){n.getLayer(r).off(e,t)}))),this}},{key:"updateData",value:function(e,t){var n;this.setOption({data:e,joinBy:t});var r=this.options,i=r.data,a=void 0===i?[]:i,o=r.joinBy;if(this.fillLayer.setData(this.fillData,{transforms:0===a.length?[]:[{type:"join",sourceField:o[1],targetField:o[0],data:a}]}),this.options.bubble&&!1!==(null===(n=this.options.bubble)||void 0===n?void 0:n.enable)){var s={};a.forEach((function(e){s[e[o[1]]]=e}));var u=this.fillData.features.map((function(e){return AG(AG({},e.properties),{},{center:[e.properties.x,e.properties.y]})})).filter((function(e){return s[e[o[0]]]}));this.bubbleLayer.setData(u,{transforms:0===a.length?[]:[{type:"join",sourceField:o[1],targetField:o[0],data:a}]})}}},{key:"fetchData",value:(i=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pbf"!==t.type){e.next=11;break}return e.next=3,fetch(t.url);case 3:return e.next=5,e.sent.arrayBuffer();case 5:return n=e.sent,r=vH.decode(new QH(n)),!1!==this.options.simplifyTolerance&&(r=EG(r,this.options.simplifyTolerance||.8)),e.abrupt("return",r);case 11:if(!cd(t.url)){e.next=15;break}e.t0=t.url,e.next=18;break;case 15:return e.next=17,fetch(t.url);case 17:e.t0=e.sent.json();case 18:return e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=i.apply(e,t);function o(e){SG(a,n,r,o,s,"next",e)}function s(e){SG(a,n,r,o,s,"throw",e)}o(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"getDefaultOption",value:function(){return{zIndex:0,visible:!0,viewType:"normal",enablePropagation:!0,geoDataLevel:2,regionType:"province",depth:1,adcode:[],joinBy:["name","name"],simplifyTolerance:!1,label:{enable:!0,color:"#000",field:"name",size:10,stroke:"#fff",strokeWidth:2,textAllowOverlap:!0,opacity:1,textOffset:[0,0],padding:[5,5]},bubble:{enable:!1,shape:"circle",color:"#1AA9FF",size:15,style:{opacity:1,stroke:"#fff",strokeWidth:1}},fill:{scale:null,color:"#ddd",style:{opacity:1},activeColor:!1},autoFit:!0,showBorder:!0,strokeOpacity:1,stroke:"#bdbdbd",strokeVisible:!0,strokeWidth:.6,cityStroke:"#636363",cityStrokeWidth:.6,countyStrokeWidth:.6,provinceStrokeWidth:.6,provinceStroke:"#f0f0f0",provinceStrokeVisible:!0,countyStroke:"#525252",coastlineStroke:"#4190da",coastlineWidth:.6,nationalStroke:"#c994c7",nationalWidth:.5,chinaNationalStroke:"gray",chinaNationalWidth:1,popup:{enable:!0,openTriggerEvent:"mousemove",closeTriggerEvent:"mouseout",option:{},Html:function(e){return"".concat(e.name)}}}}},{key:"addFillLayer",value:function(e){var t,n=this,r=this.options;r.popup;var i=r.data,a=void 0===i?[]:i,o=r.fill,s=r.autoFit,u=r.joinBy,l=r.visible,c=r.enablePropagation,f=r.zIndex;this.fillData=e;var p,h=new Vj({autoFit:s,visible:l,enablePropagation:c,zIndex:f}).source(e,{transforms:0===a.length?[]:[{type:"join",sourceField:u[1],targetField:u[0],data:a}]});if(this.setLayerAttribute(h,"color",o.color),this.setLayerAttribute(h,"filter",o.filter),o.scale&&cd(o.color)&&h.scale("color",{type:o.scale,field:null==o||null===(p=o.color)||void 0===p?void 0:p.field}),h.shape("fill").style(o.style),o.activeColor&&h.active({color:o.activeColor}),this.fillLayer=h,this.layers.push(h),this.scene.addLayer(h),this.options.onClick&&this.fillLayer.on("click",(function(e){n.options&&n.options.onClick&&n.options.onClick(e,n.layerType)})),this.options.bubble&&!1!==(null===(t=this.options.bubble)||void 0===t?void 0:t.enable)){var d=e.features.map((function(e){return AG(AG({},e.properties),{},{center:[e.properties.x,e.properties.y]})}));this.addBubbleLayer(d)}this.addPopup()}},{key:"updateLayerAttribute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fill",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=this.getLayer(e);this.setLayerAttribute(r,t,n)}},{key:"enablePopup",value:function(){this.setOption({popup:AG(AG({},this.options.popup),{},{enable:!0})})}},{key:"disablePopup",value:function(){this.setOption({popup:AG(AG({},this.options.popup),{},{enable:!1})})}},{key:"addFillLine",value:function(e){var t=this.options,n=t.stroke,r=t.strokeWidth,i=t.zIndex,a=t.visible,o=t.strokeOpacity,s=new ZF({zIndex:i+.1,visible:a}).source(e).color(n).size(r).style({opacity:o});this.scene.addLayer(s),this.layers.push(s),this.lineLayer=s}},{key:"addLabelLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json",n=this.addLabel(e,t);this.scene.addLayer(n),this.layers.push(n),this.labelLayer=n}},{key:"addBubbleLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json",n=this.options,r=n.bubble,i=n.zIndex,a=n.data,o=void 0===a?[]:a,s=n.joinBy,u=n.visible,l=new Cj({zIndex:i+.3,visible:u}).source(e,{parser:{type:t,coordinates:"center"},transforms:0===o.length?[]:[{type:"join",sourceField:s[1],targetField:s[0],data:o}]});return this.setLayerAttribute(l,"color",r.color),this.setLayerAttribute(l,"size",r.size),this.setLayerAttribute(l,"shape",r.shape),this.setLayerAttribute(l,"filter",r.filter),r.scale&&l.scale(r.scale.field,{type:r.scale.type}),l.style(r.style),this.scene.addLayer(l),this.layers.push(l),this.bubbleLayer=l,l}},{key:"addLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json",n=this.options,r=n.label,i=n.zIndex,a=n.visible,o=new Cj({zIndex:i+5,visible:a}).source(e,{parser:{type:t,coordinates:"center"}}).shape(r.field,"text").style(r);return this.setLayerAttribute(o,"color",r.color),this.setLayerAttribute(o,"size",r.size),this.setLayerAttribute(o,"filter",r.filter),o}},{key:"addPopup",value:function(){var e,t=this,n=this.options.popup;(e=n.triggerLayer?"bubble"===n.triggerLayer?this.bubbleLayer:this.fillLayer:this.options.bubble.enable?this.bubbleLayer:this.fillLayer).on(n.openTriggerEvent,(function(e){if(n.enable){var r=n.Html?n.Html(e.feature.properties?e.feature.properties:e.feature):"";t.popup=new _R(AG({closeButton:!1},n.option)).setLnglat(e.lngLat).setHTML(r),t.scene.addPopup(t.popup)}})),e.on(n.closeTriggerEvent,(function(e){t.popup&&t.popup.remove()}))}},{key:"setLayerAttribute",value:function(e,t,n){n&&(cd(n)?e[t](n.field,n.values):e[t](n))}}])&&kG(t.prototype,n),r&&kG(t,r),s}(),FG={100:{name:"华北区",code:"100",child:[11e4,12e4,13e4,15e4,21e4,22e4,23e4,37e4],center:[118.740234375,42.87596410238256]},101:{name:"华东区",code:"101",child:[32e4,34e4,31e4],center:[118.564453125,31.765537409484374]},102:{name:"华南区",code:"102",child:[44e4,45e4,46e4],center:[110.709228515625,22.238259929564308]},103:{name:"华西区",code:"103",child:[5e5,51e4,52e4,53e4],center:[90.263671875,36.73888412439431]},104:{name:"华中区",code:"104",child:[33e4,35e4,36e4,42e4,43e4],center:[118.05908203124999,28.38173504322308]},301:{name:"中西区",code:"301",child:[14e4,41e4,54e4,61e4,62e4,63e4,64e4,65e4],center:[109.1162109375,35.209721645221386]},701:{name:"港澳台",code:"701",child:[71e4,81e4,82e4]}};function jG(e){return(jG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function BG(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zG(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function VG(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){zG(a,r,i,o,s,"next",e)}function s(e){zG(a,r,i,o,s,"throw",e)}o(void 0)}))}}function HG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WG(e,t){return(WG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qG(e);if(t){var i=qG(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return YG(this,n)}}function YG(e,t){return!t||"object"!==jG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qG(e){return(qG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WG(e,t)}(h,DG);var t,n,r,i,a,o,s,u,l,c,f,p=XG(h);function h(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return HG(this,h),(t=p.call(this,e,n)).layerType="Country",t.fillRawData=void 0,t.init(),t}return t=h,(n=[{key:"init",value:(f=VG(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.depth,r=t.showBorder,e.next=3,this.addProvinceFill();case 3:return e.next=5,this.addProvinceLabel();case 5:if(i=uH(this.options.geoDataLevel).country.CHN[n],!r){e.next=15;break}return e.next=9,this.addProvinceLine(i.provinceLine);case 9:if(2!==n){e.next=12;break}return e.next=12,this.addCityBorder(i.fill);case 12:if(3!==n){e.next=15;break}return e.next=15,this.addCountyBorder(i.fill);case 15:this.emit("loaded"),this.loaded=!0;case 17:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"addProvinceFill",value:(c=VG(regeneratorRuntime.mark((function e(){var t,n,r,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.depth,r=t.adcode,i=uH(this.options.geoDataLevel).country.CHN[n],e.next=4,this.fetchData(i.fill);case 4:a=e.sent,this.fillRawData=a,o=a,r&&Array.isArray(r)&&0!==r.length&&(o=this.filterData(a,r)),this.fillData=o,this.addFillLayer(o);case 10:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"addProvinceLabel",value:(l=VG(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.options.depth,!(r=uH(this.options.geoDataLevel).country.CHN[n]).label){e.next=8;break}return e.next=5,this.fetchData(r.label);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=null;case 9:(i=e.t0)&&(null===(t=this.options.label)||void 0===t?void 0:t.enable)&&("standard"===this.getOptions().viewType?(this.addLabelLayer(i.filter((function(e){return"澳门"!==e.name}))),this.addMCLabel()):this.addLabelLayer(i));case 11:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"addProvinceLine",value:(u=VG(regeneratorRuntime.mark((function e(t){var n,r,i,a,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData(t);case 2:n=e.sent,r=n.features.filter((function(e){return"1"===e.properties.type})),i=n.features.filter((function(e){return"4"===e.properties.type})),a={type:"FeatureCollection",features:r},o={type:"FeatureCollection",features:i},s=n.features.filter((function(e){var t=e.properties.type;return"1"!==t&&"4"!==t})),u={type:"FeatureCollection",features:s},this.addNationBorder(u,a,o);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"addNormalProvinceLine",value:(s=VG(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"addNationBorder",value:(o=VG(regeneratorRuntime.mark((function e(t,n,r){var i,a,o,s,u,l,c,f,p,h,d,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.options,a=i.provinceStroke,o=i.provinceStrokeWidth,s=i.chinaNationalStroke,u=i.chinaNationalWidth,l=i.coastlineStroke,c=i.coastlineWidth,f=i.showBorder,p=i.visible,h=i.zIndex,d=new ZF({zIndex:h+.1,visible:p&&f}).source(t).size("type",(function(e){return"3"===e?o:"2"===e?c:"0"===e?u:"#fff"})).shape("line").color("type",(function(e){return"3"===e?a:"2"===e?l:"0"===e?s:"#fff"})),v=new ZF({zIndex:h+.1,visible:p&&f}).source(n).size(u).shape("line").color(s).style({lineType:"dash",dashArray:[2,2]}),m=new ZF({zIndex:h+.1,visible:p&&f}).source(r).size(o).shape("line").color(a).style({lineType:"dash",dashArray:[4,2,2,2]}),this.scene.addLayer(d),this.scene.addLayer(v),this.scene.addLayer(m),this.layers.push(d,v,m);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"addCityBorder",value:(a=VG(regeneratorRuntime.mark((function e(t){var n,r,i,a,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData(t);case 2:n=e.sent,r=this.options,i=r.cityStroke,a=r.cityStrokeWidth,o=r.visible,s=r.strokeOpacity,u=new ZF({zIndex:2,visible:o}).source(n).color(i).size(a).style({opacity:s}),this.scene.addLayer(u),this.layers.push(u);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"addCountyBorder",value:(i=VG(regeneratorRuntime.mark((function e(t){var n,r,i,a,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData(t);case 2:n=e.sent,r=this.options,i=r.countyStrokeWidth,a=r.countyStroke,o=r.visible,s=r.strokeOpacity,u=new ZF({zIndex:2,visible:o}).source(n).color(a).size(i).style({opacity:s}),this.scene.addLayer(u),this.layers.push(u);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"addMCLabel",value:function(){var e=[{name:"澳门",center:[113.537747,22.187009]}],t=this.addText(e,{maxZoom:2.9},[-45,-10]),n=this.addText(e,{minZoom:3,maxZoom:4},[-35,-10]),r=this.addText(e,{minZoom:4.1},[0,0]);this.scene.addLayer(r),this.scene.addLayer(t),this.scene.addLayer(n),this.layers.push(r,t,n)}},{key:"filterData",value:function(e,t){var n=Array.isArray(t)?t:[t];return{type:"FeatureCollection",features:e.features.filter((function(e){var t=e.properties,r=t.REGION_CODE,i=t.adcode_pro;return-1!==n.indexOf("86")||-1!==n.indexOf(86)||-1!==n.indexOf(r)||-1!==n.indexOf(""+r)||-1!==n.indexOf(i)||-1!==n.indexOf(""+i)}))}}},{key:"addText",value:function(e,t,n){var r=this.options,i=r.label,a=r.zIndex,o=r.visible;return new Cj(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UG(Object(n),!0).forEach((function(t){BG(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({zIndex:a+.4,visible:o},t)).source(e,{parser:{type:"json",coordinates:"center"}}).color(i.color).shape("name","text").size(i.size).style({opacity:i.opacity,stroke:i.stroke,strokeWidth:i.strokeWidth,textAllowOverlap:i.textAllowOverlap,textOffset:n})}},{key:"addRegionLabel",value:function(){Object.values(FG).map((function(e){return e}))}}])&&GG(t.prototype,n),r&&GG(t,r),h}();export{yN as A,ZG as C,U as R,LL as S,Kl as a,n as r};
